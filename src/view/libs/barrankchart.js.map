{"version":3,"sources":["webpack:///barrankchart.js","webpack:///webpack/bootstrap f9589e8d34a71c0eaaf4","webpack:///./src/index.js","webpack:///./src/component.js","webpack:///./src/template.html"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_component","_component2","obj","default","VERSION_INFO","version","build","Vizabi","Tool","extend","init","placeholder","externalModel","this","components","component","model","Component","_super","default_model","state","time","autoconfig","type","entities","excludeIDs","entities_colorlegend","entities_tags","includeOnlyIDs","marker_tags","space","label","use","which","hook_parent","entities_allpossible","marker_allpossible","marker","axis_x","allow","scales","axis_y","color","syncModels","marker_colorlegend","hook_rank","hook_geoshape","locale","ui","chart","datawarning","doubtDomain","doubtRange","buttons","dialogs","popup","sidebar","moreoptions","presentation","versionInfo","_defineProperty","key","writable","_toConsumableArray","arr","Array","isArray","arr2","length","from","_slicedToArray","sliceIterator","_arr","_n","_d","_e","undefined","_s","_i","Symbol","iterator","next","done","push","err","TypeError","utils","axisWithLabelPicker","helpers","iconQuestion","iconset","question","iconWarn","warn","BarRankChart","config","context","_this2","template","model_expects","model_binds","change:time.value","_ready","_readyOnce","onTimeChange","change:marker.select","_selectBars","_updateOpacity","_updateDoubtOpacity","_scroll","change:marker.axis_x.scaleType","loadData","draw","change:marker.color.palette","_drawColors","change:marker.highlight","change:marker.opacitySelectDim","change:marker.opacityRegular","xScale","cScale","d3","scaleOrdinal","schemeCategory10","xAxis","_this3","getFrame","values","readyOnce","element","select","header","infoEl","barViewport","barSvg","barContainer","dataWarningEl","wScale","scaleLinear","domain","range","tickFormat","getTickFormatter","_localeId","id","_entityLabels","_presentation","_formatter","ready","_this4","resize","_this5","_this","translator","getTFunction","xAxisValues","keys","sortedEntities","_sortByIndicator","on","parent","findChildByName","markerID","alignX","alignY","updateView","toggle","getScale","copy","setIcon","attr","append","text","conceptPropsX","getConceptprops","style","Number","Boolean","description","sourceLink","pin","rect","getBBox","ctx","makeAbsoluteContext","farthestViewportElement","coord","x","y","height","setHook","show","setPos","hide","force","arguments","time_1","duration","playing","delayAnimations","drawAxes","drawData","profiles","small","margin","top","right","left","bottom","headerMargin","infoElHeight","infoElMargin","barHeight","barMargin","barRectMargin","barValueMargin","scrollMargin","medium","large","presentationProfileChanges","activeProfile","getActiveProfile","_activeProfile","parseInt","width","headerTitle","_model$marker$axis_x$","unit","headerTitleText","node","headerTitleBBox","titleTx","titleTy","headerInfo","infoTx","infoTy","headerTotal","transition","delay","formatDate","interrupt","getLayoutProfile","headerTotalBBox","totalTx","totalTy","classed","warningBBox","_this6","_createAndDeleteBars","selectAll","data","entity","presentationModeChanged","entitiesCountChanged","_entitiesCount","_resizeSvg","_activeProfile2","limits","getLimits","ltr","Math","abs","max","min","hasNegativeValues","rightEdge","_getWidestLabelWidth","scaleType","apply","shift","barWidth","isLtrValue","labelAnchor","valueAnchor","labelX","barX","valueX","isLabelBig","forEach","bar","isNew","changedValue","barLabel","labelFull","labelSmall","barRect","barValue","changedWidth","ease","easeLinear","changedIndex","self","_getBarPosition","index","_activeProfile3","follow","empty","datum","yPos","scrollTo","tween","_scrollTopTween","updatedBars","_sortedEntities","localeChanged","exit","remove","enter","each","substring","selectedLabel","size","labelFullWidth","labelSmallWidth","assign","isSelected","_id","highlightMarker","clearHighlighted","selectMarker","merge","big","widthKey","labelKey","reduce","a","b","_this7","_ref","colorValue","isColorValid","fillColor","String","_getColor","strokeColor","_ref2","_getDarkerColor","rgb","darker","scrollTop","interpolateNumber","t","_entities","_this8","map","_this8$_entities$enti","cached","formattedValue","dim","sort","_ref3","_ref4","_this9","entityDim","selected","selectedBar","highlight","OPACITY_HIGHLIGHT_DIM","opacityHighlightDim","OPACITY_SELECT_DIM","opacitySelectDim","OPACITY_REGULAR","opacityRegular","someHighlighted","someSelected","isHighlighted","opacity","getUTCFullYear","toString"],"mappings":"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","file":"barrankchart.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 4);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n__webpack_require__(2);\n\nvar _component = __webpack_require__(1);\n\nvar _component2 = _interopRequireDefault(_component);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar VERSION_INFO = { version: \"1.0.23\", build: 1507740594615 };\n\nexports.default = Vizabi.Tool.extend(\"BarRankChart\", {\n\n  // Run when the tool is created\n  init: function init(placeholder, externalModel) {\n\n    this.name = \"barrankchart\";\n\n    this.components = [{\n      component: _component2.default,\n      placeholder: \".vzb-tool-viz\",\n      model: [\"state.time\", \"state.entities\", \"state.marker\", \"locale\", \"ui\"]\n    }, {\n      component: Vizabi.Component.get(\"timeslider\"),\n      placeholder: \".vzb-tool-timeslider\",\n      model: [\"state.time\", \"state.entities\", \"state.marker\", \"ui\"]\n    }, {\n      component: Vizabi.Component.get(\"dialogs\"),\n      placeholder: \".vzb-tool-dialogs\",\n      model: [\"state\", \"ui\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"buttonlist\"),\n      placeholder: \".vzb-tool-buttonlist\",\n      model: [\"state\", \"ui\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"treemenu\"),\n      placeholder: \".vzb-tool-treemenu\",\n      model: [\"state.marker\", \"state.marker_tags\", \"state.time\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"datanotes\"),\n      placeholder: \".vzb-tool-datanotes\",\n      model: [\"state.marker\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"datawarning\"),\n      placeholder: \".vzb-tool-datawarning\",\n      model: [\"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"steppedspeedslider\"),\n      placeholder: \".vzb-tool-stepped-speed-slider\",\n      model: [\"state.time\", \"locale\"]\n    }];\n\n    // constructor is the same as any tool\n    this._super(placeholder, externalModel);\n  },\n\n  /**\n   * Determines the default model of this tool\n   */\n  default_model: {\n    \"state\": {\n      \"time\": {\n        \"autoconfig\": {\n          \"type\": \"time\"\n        }\n      },\n      \"entities\": {\n        \"autoconfig\": {\n          \"type\": \"entity_domain\",\n          \"excludeIDs\": [\"tag\"]\n        }\n      },\n      \"entities_colorlegend\": {\n        \"autoconfig\": {\n          \"type\": \"entity_domain\",\n          \"excludeIDs\": [\"tag\"]\n        }\n      },\n      entities_tags: {\n        \"autoconfig\": {\n          \"type\": \"entity_domain\",\n          \"includeOnlyIDs\": [\"tag\"]\n        }\n      },\n      marker_tags: {\n        space: [\"entities_tags\"],\n        label: {\n          use: \"property\",\n          which: \"name\"\n        },\n        hook_parent: {}\n      },\n      \"entities_allpossible\": {\n        \"autoconfig\": {\n          \"type\": \"entity_domain\",\n          \"excludeIDs\": [\"tag\"]\n        }\n      },\n      \"marker_allpossible\": {\n        \"space\": [\"entities_allpossible\"],\n        \"label\": {\n          \"use\": \"property\",\n          \"autoconfig\": {\n            \"includeOnlyIDs\": [\"name\"],\n            \"type\": \"string\"\n          }\n        }\n      },\n      \"marker\": {\n        \"space\": [\"entities\", \"time\"],\n        \"axis_x\": {\n          \"use\": \"indicator\",\n          \"autoconfig\": {\n            \"type\": \"measure\"\n          },\n          \"allow\": { scales: [\"linear\", \"log\"] }\n        },\n        \"axis_y\": {\n          \"use\": \"property\",\n          \"allow\": { scales: [\"ordinal\", \"nominal\"] },\n          \"autoconfig\": {\n            \"type\": \"entity_domain\"\n          }\n        },\n        \"label\": {\n          \"use\": \"property\",\n          \"autoconfig\": {\n            \"includeOnlyIDs\": [\"name\"],\n            \"type\": \"string\"\n          }\n        },\n        \"color\": {\n          \"syncModels\": [\"marker_colorlegend\"],\n          \"autoconfig\": {}\n        }\n      },\n      \"marker_colorlegend\": {\n        \"space\": [\"entities_colorlegend\"],\n        \"label\": {\n          \"use\": \"property\",\n          \"which\": \"name\"\n        },\n        \"hook_rank\": {\n          \"use\": \"property\",\n          \"which\": \"rank\"\n        },\n        \"hook_geoshape\": {\n          \"use\": \"property\",\n          \"which\": \"shape_lores_svg\"\n        }\n      }\n    },\n    locale: {},\n    ui: {\n      chart: {},\n      datawarning: {\n        doubtDomain: [],\n        doubtRange: []\n      },\n      \"buttons\": [\"colors\", \"find\", \"show\", \"moreoptions\", \"fullscreen\", \"presentation\"],\n      \"dialogs\": {\n        \"popup\": [\"timedisplay\", \"colors\", \"find\", \"axes\", \"show\", \"moreoptions\"],\n        \"sidebar\": [\"timedisplay\", \"colors\", \"find\"],\n        \"moreoptions\": [\"opacity\", \"speed\", \"colors\", \"presentation\", \"about\"]\n      },\n      presentation: false\n    }\n  },\n\n  versionInfo: VERSION_INFO\n});\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nvar utils = Vizabi.utils;\n\nvar axisWithLabelPicker = Vizabi.helpers['d3.axisWithLabelPicker'];\nvar iconQuestion = Vizabi.iconset.question;\nvar iconWarn = Vizabi.iconset.warn;\n\nvar COLOR_BLACKISH = \"rgb(51, 51, 51)\";\nvar COLOR_WHITEISH = \"rgb(253, 253, 253)\";\n\nvar BarRankChart = Vizabi.Component.extend(\"barrankchart\", {\n\n  /**\n   * Initializes the component (Bar Chart).\n   * Executed once before any template is rendered.\n   * @param {Object} config The config passed to the component\n   * @param {Object} context The component's parent\n   */\n  init: function init(config, context) {\n    var _this2 = this;\n\n    this.name = 'barrankchart';\n    this.template = __webpack_require__(3);\n\n    //define expected models for this component\n    this.model_expects = [{\n      name: \"time\",\n      type: \"time\"\n    }, {\n      name: \"entities\",\n      type: \"entities\"\n    }, {\n      name: \"marker\",\n      type: \"marker\"\n    }, {\n      name: \"locale\",\n      type: \"locale\"\n    }, {\n      name: \"ui\",\n      type: \"ui\"\n    }];\n\n    this.model_binds = {\n      'change:time.value': function changeTimeValue() {\n        // TODO: review this after vizabi#2450 will be fixed\n        if (!_this2.model._ready) return;\n\n        if (_this2._readyOnce) {\n          _this2.onTimeChange();\n        }\n      },\n      'change:marker.select': function changeMarkerSelect() {\n        if (_this2._readyOnce) {\n          _this2._selectBars();\n          _this2._updateOpacity();\n          _this2._updateDoubtOpacity();\n          _this2._scroll();\n        }\n      },\n      'change:marker.axis_x.scaleType': function changeMarkerAxis_xScaleType() {\n        if (_this2._readyOnce) {\n          if (_this2.loadData()) {\n            _this2.draw(true);\n          }\n        }\n      },\n      'change:marker.color.palette': function changeMarkerColorPalette() {\n        _this2._drawColors();\n      },\n      'change:marker.highlight': function changeMarkerHighlight() {\n        _this2._updateOpacity();\n      },\n      'change:marker.opacitySelectDim': function changeMarkerOpacitySelectDim() {\n        _this2._updateOpacity();\n      },\n      'change:marker.opacityRegular': function changeMarkerOpacityRegular() {\n        _this2._updateOpacity();\n      }\n    };\n\n    //contructor is the same as any component\n    this._super(config, context);\n\n    // set up the scales\n    this.xScale = null;\n    this.cScale = d3.scaleOrdinal(d3.schemeCategory10);\n\n    // set up the axes\n    this.xAxis = axisWithLabelPicker(\"bottom\");\n  },\n  onTimeChange: function onTimeChange() {\n    var _this3 = this;\n\n    this.model.marker.getFrame(this.model.time.value, function (values) {\n      _this3.values = values;\n\n      if (_this3.values) {\n        if (_this3.loadData()) {\n          _this3.draw();\n        }\n      }\n    });\n  },\n\n\n  /**\n   * DOM and model are ready\n   */\n  readyOnce: function readyOnce() {\n    this.element = d3.select(this.element);\n\n    // reference elements\n    //this.graph = this.element.select('.vzb-br-graph');\n    //this.yearEl = this.element.select('.vzb-br-year');\n    //this.year = new DynamicBackground(this.yearEl);\n    this.header = this.element.select('.vzb-br-header');\n    this.infoEl = this.element.select('.vzb-br-axis-info');\n    this.barViewport = this.element.select('.vzb-br-barsviewport');\n    this.barSvg = this.element.select('.vzb-br-bars-svg');\n    this.barContainer = this.element.select('.vzb-br-bars');\n    this.dataWarningEl = this.element.select('.vzb-data-warning');\n    this.wScale = d3.scaleLinear().domain(this.model.ui.datawarning.doubtDomain).range(this.model.ui.datawarning.doubtRange);\n\n    // set up formatters\n    this.xAxis.tickFormat(this.model.marker.axis_x.getTickFormatter());\n\n    this._localeId = this.model.locale.id;\n    this._entityLabels = {};\n    this._presentation = !this.model.ui.presentation;\n    this._formatter = this.model.marker.axis_x.getTickFormatter();\n\n    this.ready();\n\n    this._selectBars();\n  },\n\n\n  /**\n   * Both model and DOM are ready\n   */\n  ready: function ready() {\n    var _this4 = this;\n\n    this.model.marker.getFrame(this.model.time.value, function (values) {\n      _this4.values = values;\n\n      if (_this4.values) {\n        if (_this4.loadData()) {\n          _this4.draw(true);\n          _this4._updateOpacity();\n          _this4._drawColors();\n        }\n      }\n    });\n  },\n  resize: function resize() {\n    this.draw(true);\n    this._drawColors();\n  },\n  loadData: function loadData() {\n    var _this5 = this;\n\n    var _this = this;\n\n    this.translator = this.model.locale.getTFunction();\n    // sort the data (also sets this.total)\n    var xAxisValues = this.values.axis_x;\n    if (!Object.keys(xAxisValues).length) return false;\n\n    this.sortedEntities = this._sortByIndicator(xAxisValues);\n\n    this.header.select('.vzb-br-title').select('text').on('click', function () {\n      return _this5.parent.findChildByName('gapminder-treemenu').markerID('axis_x').alignX('left').alignY('top').updateView().toggle();\n    });\n\n    // new scales and axes\n    this.xScale = this.model.marker.axis_x.getScale().copy();\n    this.cScale = this.model.marker.color.getScale();\n\n    utils.setIcon(this.dataWarningEl, iconWarn).select('svg').attr('width', 0).attr('height', 0);\n\n    this.dataWarningEl.append('text').text(this.translator('hints/dataWarning'));\n\n    this.dataWarningEl.on('click', function () {\n      return _this5.parent.findChildByName('gapminder-datawarning').toggle();\n    }).on('mouseover', function () {\n      return _this5._updateDoubtOpacity(1);\n    }).on('mouseout', function () {\n      return _this5._updateDoubtOpacity();\n    });\n\n    var conceptPropsX = this.model.marker.axis_x.getConceptprops();\n    utils.setIcon(this.infoEl, iconQuestion).select('svg').attr('width', 0).attr('height', 0).style('opacity', Number(Boolean(conceptPropsX.description || conceptPropsX.sourceLink)));\n\n    this.infoEl.on('click', function () {\n      _this5.parent.findChildByName('gapminder-datanotes').pin();\n    });\n\n    this.infoEl.on('mouseover', function () {\n      var rect = this.getBBox();\n      var ctx = utils.makeAbsoluteContext(this, this.farthestViewportElement);\n      var coord = ctx(rect.x - 10, rect.y + rect.height + 10);\n      _this.parent.findChildByName('gapminder-datanotes').setHook('axis_x').show().setPos(coord.x, coord.y);\n    });\n\n    this.infoEl.on('mouseout', function () {\n      _this.parent.findChildByName('gapminder-datanotes').hide();\n    });\n\n    return true;\n  },\n  draw: function draw() {\n    var force = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    this.time_1 = this.time == null ? this.model.time.value : this.time;\n    this.time = this.model.time.value;\n    //smooth animation is needed when playing, except for the case when time jumps from end to start\n    var duration = this.model.time.playing && this.time - this.time_1 > 0 ? this.model.time.delayAnimations : 0;\n\n    //return if drawAxes exists with error\n    if (this.drawAxes(duration, force)) return;\n    this.drawData(duration, force);\n  },\n\n\n  /*\n   * draw the chart/stage\n   */\n  drawAxes: function drawAxes() {\n    var duration = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n    var profiles = {\n      small: {\n        margin: { top: 60, right: 5, left: 5, bottom: 20 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 5,\n        barHeight: 18,\n        barMargin: 3,\n        barRectMargin: 5,\n        barValueMargin: 5,\n        scrollMargin: 20\n      },\n      medium: {\n        margin: { top: 60, right: 5, left: 5, bottom: 20 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 5,\n        barHeight: 21,\n        barMargin: 3,\n        barRectMargin: 5,\n        barValueMargin: 5,\n        scrollMargin: 25\n      },\n      large: {\n        margin: { top: 60, right: 5, left: 5, bottom: 20 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 5,\n        barHeight: 28,\n        barMargin: 4,\n        barRectMargin: 5,\n        barValueMargin: 5,\n        scrollMargin: 25\n      }\n    };\n\n    var presentationProfileChanges = {\n      medium: {\n        margin: { top: 60, right: 10, left: 10, bottom: 40 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 25,\n        infoElMargin: 10,\n        barHeight: 25,\n        barMargin: 6\n      },\n      large: {\n        margin: { top: 60, right: 10, left: 10, bottom: 40 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 10,\n        barHeight: 30,\n        barMargin: 6\n      }\n    };\n\n    this.activeProfile = this.getActiveProfile(profiles, presentationProfileChanges);\n\n    var _activeProfile = this.activeProfile,\n        margin = _activeProfile.margin,\n        headerMargin = _activeProfile.headerMargin,\n        infoElHeight = _activeProfile.infoElHeight,\n        infoElMargin = _activeProfile.infoElMargin;\n\n\n    this.height = parseInt(this.element.style('height'), 10) || 0;\n    this.width = parseInt(this.element.style('width'), 10) || 0;\n\n    if (!this.height || !this.width) return utils.warn('Dialog resize() abort: vizabi container is too little or has display:none');\n\n    this.barViewport.style('height', this.height - margin.bottom - margin.top + \"px\");\n\n    // header\n    this.header.attr('height', margin.top);\n    var headerTitle = this.header.select('.vzb-br-title');\n\n    // change header titles for new data\n\n    var _model$marker$axis_x$ = this.model.marker.axis_x.getConceptprops(),\n        name = _model$marker$axis_x$.name,\n        unit = _model$marker$axis_x$.unit;\n\n    var headerTitleText = headerTitle.select('text');\n\n    if (unit) {\n      headerTitleText.text(name + \", \" + unit);\n\n      var rightEdgeOfLeftText = headerMargin.left + headerTitle.node().getBBox().width + infoElMargin + infoElHeight;\n\n      if (rightEdgeOfLeftText > this.width - headerMargin.right) {\n        headerTitleText.text(name);\n      }\n    } else {\n      headerTitleText.text(name);\n    }\n\n    var headerTitleBBox = headerTitle.node().getBBox();\n\n    var titleTx = headerMargin.left;\n    var titleTy = headerMargin.top + headerTitleBBox.height;\n    headerTitle.attr('transform', \"translate(\" + titleTx + \", \" + titleTy + \")\");\n\n    var headerInfo = this.infoEl;\n\n    headerInfo.select('svg').attr('width', infoElHeight + \"px\").attr('height', infoElHeight + \"px\");\n\n    var infoTx = titleTx + headerTitle.node().getBBox().width + infoElMargin;\n    var infoTy = headerMargin.top + infoElHeight / 4;\n    headerInfo.attr('transform', \"translate(\" + infoTx + \", \" + infoTy + \")\");\n\n    var headerTotal = this.header.select('.vzb-br-total');\n\n    if (duration) {\n      headerTotal.select('text').transition('text').delay(duration).text(this.model.time.formatDate(this.time));\n    } else {\n      headerTotal.select('text').interrupt().text(this.model.time.formatDate(this.time));\n    }\n    headerTotal.style('opacity', Number(this.getLayoutProfile() !== 'large'));\n\n    var headerTotalBBox = headerTotal.node().getBBox();\n\n    var totalTx = this.width - headerMargin.right - headerTotalBBox.width;\n    var totalTy = headerMargin.top + headerTotalBBox.height;\n    headerTotal.attr('transform', \"translate(\" + totalTx + \", \" + totalTy + \")\").classed('vzb-transparent', headerTitleBBox.width + headerTotalBBox.width + 10 > this.width);\n\n    this.element.select('.vzb-data-warning-svg').style('height', margin.bottom + \"px\");\n\n    var warningBBox = this.dataWarningEl.select('text').node().getBBox();\n    this.dataWarningEl.attr('transform', \"translate(\" + (this.width - margin.right - warningBBox.width) + \", \" + warningBBox.height + \")\").select('text');\n\n    this.dataWarningEl.select('svg').attr('width', warningBBox.height).attr('height', warningBBox.height).attr('x', -warningBBox.height - 5).attr('y', -warningBBox.height + 1);\n\n    this._updateDoubtOpacity();\n  },\n  drawData: function drawData() {\n    var _this6 = this;\n\n    var duration = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var force = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n    // update the shown bars for new data-set\n    this._createAndDeleteBars(this.barContainer.selectAll('.vzb-br-bar').data(this.sortedEntities, function (d) {\n      return d.entity;\n    }));\n\n    var presentation = this.model.ui.presentation;\n\n    var presentationModeChanged = this._presentation !== presentation;\n\n    if (presentationModeChanged) {\n      this._presentation = presentation;\n    }\n\n    var entitiesCountChanged = typeof this._entitiesCount === 'undefined' || this._entitiesCount !== this.sortedEntities.length;\n\n    if (presentationModeChanged || entitiesCountChanged) {\n      if (entitiesCountChanged) {\n        this._entitiesCount = this.sortedEntities.length;\n      }\n    }\n\n    this._resizeSvg();\n    this._scroll(duration);\n    this._drawColors();\n\n    var _activeProfile2 = this.activeProfile,\n        barRectMargin = _activeProfile2.barRectMargin,\n        barValueMargin = _activeProfile2.barValueMargin,\n        scrollMargin = _activeProfile2.scrollMargin,\n        margin = _activeProfile2.margin;\n    var axis_x = this.model.marker.axis_x;\n\n    var limits = axis_x.getLimits(axis_x.which);\n    var ltr = Math.abs(limits.max) >= Math.abs(limits.min);\n    var hasNegativeValues = ltr ? limits.min < 0 : limits.max > 0;\n\n    var rightEdge = (this.width - margin.right - margin.left - barRectMargin - scrollMargin - (hasNegativeValues ? 0 : this._getWidestLabelWidth())) / (hasNegativeValues ? 2 : 1);\n\n    this.xScale.range([0, rightEdge]);\n\n    if (this.model.marker.axis_x.scaleType !== \"log\") {\n      this.xScale.domain([0, Math.max.apply(Math, _toConsumableArray(this.xScale.domain()))]);\n    }\n\n    var shift = hasNegativeValues ? rightEdge : this._getWidestLabelWidth();\n\n    var barWidth = function barWidth(value) {\n      return _this6.xScale(value);\n    };\n    var isLtrValue = function isLtrValue(value) {\n      return ltr ? value >= 0 : value > 0;\n    };\n\n    var labelAnchor = function labelAnchor(value) {\n      return isLtrValue(value) ? 'end' : 'start';\n    };\n    var valueAnchor = function valueAnchor(value) {\n      return isLtrValue(value) ? 'start' : 'end';\n    };\n\n    var labelX = function labelX(value) {\n      return isLtrValue(value) ? margin.left + shift : _this6.width - shift - scrollMargin - margin.right;\n    };\n\n    var barX = function barX(value) {\n      return isLtrValue(value) ? labelX(value) + barRectMargin : labelX(value) - barRectMargin;\n    };\n\n    var valueX = function valueX(value) {\n      return isLtrValue(value) ? barX(value) + barValueMargin : barX(value) - barValueMargin;\n    };\n\n    var isLabelBig = this._getWidestLabelWidth(true) + (ltr ? margin.left : margin.right) < shift;\n    this.sortedEntities.forEach(function (bar) {\n      var value = bar.value;\n\n\n      if (force || presentationModeChanged || bar.isNew || bar.changedValue) {\n        bar.barLabel.attr('x', labelX(value)).attr('y', _this6.activeProfile.barHeight / 2).attr('text-anchor', labelAnchor(value)).text(isLabelBig ? bar.labelFull : bar.labelSmall);\n\n        bar.barRect.attr('rx', _this6.activeProfile.barHeight / 4).attr('ry', _this6.activeProfile.barHeight / 4).attr('height', _this6.activeProfile.barHeight);\n\n        bar.barValue.attr('x', valueX(value)).attr('y', _this6.activeProfile.barHeight / 2).attr('text-anchor', valueAnchor(value));\n      }\n\n      if (force || bar.changedWidth || presentationModeChanged) {\n        var width = Math.max(0, value && barWidth(Math.abs(value))) || 0;\n\n        if (force || bar.changedWidth || presentationModeChanged) {\n          bar.barRect.transition().duration(duration).ease(d3.easeLinear).attr('width', width);\n        }\n\n        bar.barRect.attr('x', barX(value) - (value < 0 ? width : 0));\n\n        if (force || bar.changedValue) {\n          bar.barValue.text(_this6._formatter(value) || _this6.translator('hints/nodata'));\n        }\n      }\n\n      if (force || bar.changedIndex || presentationModeChanged) {\n        (duration ? bar.self.transition().duration(duration).ease(d3.easeLinear) : bar.self).attr('transform', \"translate(0, \" + _this6._getBarPosition(bar.index) + \")\");\n      }\n    });\n  },\n  _resizeSvg: function _resizeSvg() {\n    var _activeProfile3 = this.activeProfile,\n        barHeight = _activeProfile3.barHeight,\n        barMargin = _activeProfile3.barMargin;\n\n    this.barSvg.attr('height', (barHeight + barMargin) * this.sortedEntities.length + \"px\");\n  },\n  _scroll: function _scroll() {\n    var duration = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n    var follow = this.barContainer.select('.vzb-selected');\n    if (!follow.empty()) {\n      var d = follow.datum();\n      var yPos = this._getBarPosition(d.index);\n\n      var margin = this.activeProfile.margin;\n\n      var height = this.height - margin.top - margin.bottom;\n\n      var scrollTo = yPos - (height + this.activeProfile.barHeight) / 2;\n      this.barViewport.transition().duration(duration).tween('scrollfor' + d.entity, this._scrollTopTween(scrollTo));\n    }\n  },\n  _createAndDeleteBars: function _createAndDeleteBars(updatedBars) {\n    var _this = this;\n\n    // TODO: revert this commit after fixing https://github.com/vizabi/vizabi/issues/2450\n\n    var _sortedEntities = _slicedToArray(this.sortedEntities, 1),\n        entity = _sortedEntities[0];\n\n    if (!this._entityLabels[entity.entity]) {\n      this._entityLabels[entity.entity] = entity.label;\n    }\n\n    var localeChanged = this._entityLabels[entity.entity] !== this.values.label[entity.entity] && this.model.locale.id !== this._localeId;\n\n    if (localeChanged) {\n      this._localeId = this.model.locale.id;\n      this._entityLabels[entity.entity] = this.values.label[entity.entity];\n    }\n\n    // remove groups for entities that are gone\n    updatedBars.exit().remove();\n\n    // make the groups for the entities which were not drawn yet (.data.enter() does this)\n    updatedBars = (localeChanged ? updatedBars : updatedBars.enter().append('g')).each(function (d) {\n      var self = d3.select(this);\n\n      var labelFull = _this.values.label[d.entity];\n      var labelSmall = labelFull.length < 12 ? labelFull : labelFull.substring(0, 9) + \"...\";\n\n      var selectedLabel = self.select('.vzb-br-label');\n      var barLabel = selectedLabel.size() ? selectedLabel : self.append('text').attr('class', 'vzb-br-label').attr('dy', '.325em');\n\n      var labelFullWidth = barLabel.text(labelFull).node().getBBox().width;\n      var labelSmallWidth = barLabel.text(labelSmall).node().getBBox().width;\n\n      Object.assign(d, {\n        labelFullWidth: labelFullWidth,\n        labelSmallWidth: labelSmallWidth,\n        labelFull: labelFull,\n        labelSmall: labelSmall,\n        barLabel: barLabel\n      });\n\n      if (!localeChanged) {\n        self.attr('class', 'vzb-br-bar').classed('vzb-selected', _this.model.marker.isSelected(d)).attr('id', \"vzb-br-bar-\" + d.entity + \"-\" + _this._id).on('mousemove', function (d) {\n          return _this.model.marker.highlightMarker(d);\n        }).on('mouseout', function () {\n          return _this.model.marker.clearHighlighted();\n        }).on('click', function (d) {\n          _this.model.marker.selectMarker(d);\n        });\n\n        var barRect = self.append('rect').attr('stroke', 'transparent');\n\n        var barValue = self.append('text').attr('class', 'vzb-br-value').attr('dy', '.325em');\n\n        Object.assign(d, {\n          self: self,\n          isNew: true,\n          barRect: barRect,\n          barValue: barValue\n        });\n      }\n    }).merge(updatedBars);\n  },\n  _getWidestLabelWidth: function _getWidestLabelWidth() {\n    var big = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    var widthKey = big ? 'labelFullWidth' : 'labelSmallWidth';\n    var labelKey = big ? 'labelFull' : 'labelSmall';\n\n    var bar = this.sortedEntities.reduce(function (a, b) {\n      return a[widthKey] < b[widthKey] ? b : a;\n    });\n\n    var text = bar.barLabel.text();\n    var width = bar.barLabel.text(bar[labelKey]).node().getBBox().width;\n    bar.barLabel.text(text);\n\n    return width;\n  },\n  _drawColors: function _drawColors() {\n    var _this7 = this;\n\n    var _this = this;\n\n    this.barContainer.selectAll('.vzb-br-bar>rect').each(function (_ref) {\n      var entity = _ref.entity;\n\n      var rect = d3.select(this);\n\n      var colorValue = _this.values.color[entity];\n      var isColorValid = colorValue || colorValue === 0;\n\n      var fillColor = isColorValid ? String(_this._getColor(colorValue)) : COLOR_WHITEISH;\n      var strokeColor = isColorValid ? 'transparent' : COLOR_BLACKISH;\n\n      rect.style('fill') !== fillColor && rect.style('fill', fillColor);\n      rect.style('stroke') !== strokeColor && rect.style('stroke', strokeColor);\n    });\n\n    this.barContainer.selectAll('.vzb-br-bar>text').style('fill', function (_ref2) {\n      var entity = _ref2.entity;\n      return _this7._getDarkerColor(_this7.values.color[entity] || null);\n    });\n  },\n  _getColor: function _getColor(value) {\n    return d3.rgb(this.cScale(value));\n  },\n  _getDarkerColor: function _getDarkerColor(d) {\n    return this._getColor(d).darker(2);\n  },\n\n\n  /**\n   * DATA HELPER FUNCTIONS\n   */\n\n  _scrollTopTween: function _scrollTopTween(scrollTop) {\n    return function () {\n      var node = this,\n          i = d3.interpolateNumber(this.scrollTop, scrollTop);\n      return function (t) {\n        node.scrollTop = i(t);\n      };\n    };\n  },\n  _getBarPosition: function _getBarPosition(i) {\n    return (this.activeProfile.barHeight + this.activeProfile.barMargin) * i;\n  },\n\n\n  _entities: {},\n\n  _sortByIndicator: function _sortByIndicator(values) {\n    var _this8 = this;\n\n    return Object.keys(values).map(function (entity) {\n      var _this8$_entities$enti;\n\n      var cached = _this8._entities[entity];\n      var value = values[entity];\n      var label = _this8.values.label[entity];\n      var formattedValue = _this8._formatter(value);\n\n      if (cached) {\n        return Object.assign(cached, {\n          value: value,\n          label: label,\n          formattedValue: formattedValue,\n          changedValue: formattedValue !== cached.formattedValue,\n          changedWidth: value !== cached.value,\n          isNew: false\n        });\n      }\n\n      return _this8._entities[entity] = (_this8$_entities$enti = {\n        entity: entity,\n        value: value,\n        formattedValue: formattedValue\n      }, _defineProperty(_this8$_entities$enti, _this8.model.entities.dim, entity), _defineProperty(_this8$_entities$enti, \"changedValue\", true), _defineProperty(_this8$_entities$enti, \"changedWidth\", true), _defineProperty(_this8$_entities$enti, \"isNew\", true), _this8$_entities$enti);\n    }).sort(function (_ref3, _ref4) {\n      var a = _ref3.value;\n      var b = _ref4.value;\n      return b - a;\n    }).map(function (entity, index) {\n      return Object.assign(entity, {\n        index: index,\n        changedIndex: index !== entity.index\n      });\n    });\n  },\n  _selectBars: function _selectBars() {\n    var _this9 = this;\n\n    var entityDim = this.model.entities.dim;\n    var selected = this.model.marker.select;\n\n    // unselect all bars\n    this.barContainer.classed('vzb-dimmed-selected', false);\n    this.barContainer.selectAll('.vzb-br-bar.vzb-selected').classed('vzb-selected', false);\n\n    // select the selected ones\n    if (selected.length) {\n      this.barContainer.classed('vzb-dimmed-selected', true);\n      selected.forEach(function (selectedBar) {\n        _this9.barContainer.select(\"#vzb-br-bar-\" + selectedBar[entityDim] + \"-\" + _this9._id).classed('vzb-selected', true);\n      });\n    }\n  },\n  _updateOpacity: function _updateOpacity() {\n    var marker = this.model.marker;\n\n\n    var OPACITY_HIGHLIGHT_DEFAULT = 1;\n    var highlight = marker.highlight,\n        select = marker.select,\n        OPACITY_HIGHLIGHT_DIM = marker.opacityHighlightDim,\n        OPACITY_SELECT_DIM = marker.opacitySelectDim,\n        OPACITY_REGULAR = marker.opacityRegular;\n    var someHighlighted = highlight.length > 0,\n        someSelected = select.length > 0;\n\n\n    this.barContainer.selectAll('.vzb-br-bar').style('opacity', function (d) {\n      if (someHighlighted && marker.isHighlighted(d)) {\n        return OPACITY_HIGHLIGHT_DEFAULT;\n      }\n\n      if (someSelected) {\n        return marker.isSelected(d) ? OPACITY_REGULAR : OPACITY_SELECT_DIM;\n      }\n\n      if (someHighlighted) {\n        return OPACITY_HIGHLIGHT_DIM;\n      }\n\n      return OPACITY_REGULAR;\n    });\n  },\n  _updateDoubtOpacity: function _updateDoubtOpacity(opacity) {\n    this.dataWarningEl.style('opacity', opacity || (!this.model.marker.select.length ? this.wScale(+this.model.time.value.getUTCFullYear().toString()) : 1));\n  }\n});\n\nexports.default = BarRankChart;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports) {\n\nmodule.exports = \"<!-- Bar Chart Component -->\\n<div class=\\\"vzb-barrankchart\\\">\\n  <svg class=\\\"vzb-br-header\\\">\\n    <g class=\\\"vzb-br-title\\\">\\n      <text></text>\\n    </g>\\n    <g class=\\\"vzb-br-total\\\">\\n      <text></text>\\n    </g>\\n    <g class=\\\"vzb-br-axis-info vzb-noexport\\\"></g>\\n  </svg>\\n\\n  <div class=\\\"vzb-br-barsviewport vzb-dialog-scrollable\\\">\\n    <svg class=\\\"vzb-br-bars-svg\\\">\\n      <g class=\\\"vzb-br-bars\\\"></g>\\n    </svg>\\n  </div>\\n\\n  <svg class=\\\"vzb-data-warning-svg\\\">\\n    <g class=\\\"vzb-data-warning vzb-noexport\\\">\\n      <svg></svg>\\n      <text></text>\\n    </g>\\n  </svg>\\n</div>\\n\";\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(0);\n\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// barrankchart.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap f9589e8d34a71c0eaaf4","import \"./styles.scss\";\nimport component from \"./component\";\n\nconst VERSION_INFO = { version: __VERSION, build: __BUILD };\n\nexport default Vizabi.Tool.extend(\"BarRankChart\", {\n\n  // Run when the tool is created\n  init: function (placeholder, externalModel) {\n\n    this.name = \"barrankchart\";\n\n    this.components = [{\n      component: component,\n      placeholder: \".vzb-tool-viz\",\n      model: [\"state.time\", \"state.entities\", \"state.marker\", \"locale\", \"ui\"]\n    }, {\n      component: Vizabi.Component.get(\"timeslider\"),\n      placeholder: \".vzb-tool-timeslider\",\n      model: [\"state.time\", \"state.entities\", \"state.marker\", \"ui\"]\n    }, {\n      component: Vizabi.Component.get(\"dialogs\"),\n      placeholder: \".vzb-tool-dialogs\",\n      model: [\"state\", \"ui\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"buttonlist\"),\n      placeholder: \".vzb-tool-buttonlist\",\n      model: [\"state\", \"ui\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"treemenu\"),\n      placeholder: \".vzb-tool-treemenu\",\n      model: [\"state.marker\", \"state.marker_tags\", \"state.time\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"datanotes\"),\n      placeholder: \".vzb-tool-datanotes\",\n      model: [\"state.marker\", \"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"datawarning\"),\n      placeholder: \".vzb-tool-datawarning\",\n      model: [\"locale\"]\n    }, {\n      component: Vizabi.Component.get(\"steppedspeedslider\"),\n      placeholder: \".vzb-tool-stepped-speed-slider\",\n      model: [\"state.time\", \"locale\"]\n    }];\n\n    // constructor is the same as any tool\n    this._super(placeholder, externalModel);\n  },\n\n  /**\n   * Determines the default model of this tool\n   */\n  default_model: {\n    \"state\": {\n      \"time\": {\n        \"autoconfig\": {\n          \"type\": \"time\"\n        }\n      },\n      \"entities\": {\n        \"autoconfig\": {\n          \"type\": \"entity_domain\",\n          \"excludeIDs\": [\"tag\"]\n        }\n      },\n      \"entities_colorlegend\": {\n        \"autoconfig\": {\n          \"type\": \"entity_domain\",\n          \"excludeIDs\": [\"tag\"]\n        }\n      },\n      entities_tags: {\n        \"autoconfig\": {\n          \"type\": \"entity_domain\",\n          \"includeOnlyIDs\": [\"tag\"]\n        }\n      },\n      marker_tags: {\n        space: [\"entities_tags\"],\n        label: {\n          use: \"property\",\n          which: \"name\"\n        },\n        hook_parent: {}\n      },\n      \"entities_allpossible\": {\n        \"autoconfig\": {\n          \"type\": \"entity_domain\",\n          \"excludeIDs\": [\"tag\"]\n        }\n      },\n      \"marker_allpossible\": {\n        \"space\": [\"entities_allpossible\"],\n        \"label\": {\n          \"use\": \"property\",\n          \"autoconfig\": {\n            \"includeOnlyIDs\": [\"name\"],\n            \"type\": \"string\"\n          }\n        }\n      },\n      \"marker\": {\n        \"space\": [\"entities\", \"time\"],\n        \"axis_x\": {\n          \"use\": \"indicator\",\n          \"autoconfig\": {\n            \"type\": \"measure\"\n          },\n          \"allow\": { scales: [\"linear\", \"log\"] }\n        },\n        \"axis_y\": {\n          \"use\": \"property\",\n          \"allow\": { scales: [\"ordinal\", \"nominal\"] },\n          \"autoconfig\": {\n            \"type\": \"entity_domain\"\n          }\n        },\n        \"label\": {\n          \"use\": \"property\",\n          \"autoconfig\": {\n            \"includeOnlyIDs\": [\"name\"],\n            \"type\": \"string\"\n          }\n        },\n        \"color\": {\n          \"syncModels\": [\"marker_colorlegend\"],\n          \"autoconfig\": {}\n        }\n      },\n      \"marker_colorlegend\": {\n        \"space\": [\"entities_colorlegend\"],\n        \"label\": {\n          \"use\": \"property\",\n          \"which\": \"name\"\n        },\n        \"hook_rank\": {\n          \"use\": \"property\",\n          \"which\": \"rank\"\n        },\n        \"hook_geoshape\": {\n          \"use\": \"property\",\n          \"which\": \"shape_lores_svg\"\n        }\n      }\n    },\n    locale: {},\n    ui: {\n      chart: {},\n      datawarning: {\n        doubtDomain: [],\n        doubtRange: []\n      },\n      \"buttons\": [\"colors\", \"find\", \"show\", \"moreoptions\", \"fullscreen\", \"presentation\"],\n      \"dialogs\": {\n        \"popup\": [\"timedisplay\", \"colors\", \"find\", \"axes\", \"show\", \"moreoptions\"],\n        \"sidebar\": [\"timedisplay\", \"colors\", \"find\"],\n        \"moreoptions\": [\"opacity\", \"speed\", \"colors\", \"presentation\", \"about\"]\n      },\n      presentation: false\n    }\n  },\n\n  versionInfo: VERSION_INFO\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","const utils = Vizabi.utils;\n\nconst axisWithLabelPicker = Vizabi.helpers['d3.axisWithLabelPicker'];\nconst iconQuestion = Vizabi.iconset.question;\nconst iconWarn = Vizabi.iconset.warn;\n\nconst COLOR_BLACKISH = \"rgb(51, 51, 51)\";\nconst COLOR_WHITEISH = \"rgb(253, 253, 253)\";\n\nconst BarRankChart = Vizabi.Component.extend(\"barrankchart\", {\n\n  /**\n   * Initializes the component (Bar Chart).\n   * Executed once before any template is rendered.\n   * @param {Object} config The config passed to the component\n   * @param {Object} context The component's parent\n   */\n  init(config, context) {\n\n    this.name = 'barrankchart';\n    this.template = require('./template.html');\n\n    //define expected models for this component\n    this.model_expects = [{\n      name: \"time\",\n      type: \"time\"\n    }, {\n      name: \"entities\",\n      type: \"entities\"\n    }, {\n      name: \"marker\",\n      type: \"marker\"\n    }, {\n      name: \"locale\",\n      type: \"locale\"\n    }, {\n      name: \"ui\",\n      type: \"ui\"\n    }];\n\n    this.model_binds = {\n      'change:time.value': () => {\n        // TODO: review this after vizabi#2450 will be fixed\n        if (!this.model._ready) return;\n\n        if (this._readyOnce) {\n          this.onTimeChange();\n        }\n      },\n      'change:marker.select': () => {\n        if (this._readyOnce) {\n          this._selectBars();\n          this._updateOpacity();\n          this._updateDoubtOpacity();\n          this._scroll();\n        }\n      },\n      'change:marker.axis_x.scaleType': () => {\n        if (this._readyOnce) {\n          if (this.loadData()) {\n            this.draw(true);\n          }\n        }\n      },\n      'change:marker.color.palette': () => {\n        this._drawColors();\n      },\n      'change:marker.highlight': () => {\n        this._updateOpacity();\n      },\n      'change:marker.opacitySelectDim': () => {\n        this._updateOpacity();\n      },\n      'change:marker.opacityRegular': () => {\n        this._updateOpacity();\n      },\n    };\n\n    //contructor is the same as any component\n    this._super(config, context);\n\n    // set up the scales\n    this.xScale = null;\n    this.cScale = d3.scaleOrdinal(d3.schemeCategory10);\n\n    // set up the axes\n    this.xAxis = axisWithLabelPicker(\"bottom\");\n  },\n\n  onTimeChange() {\n    this.model.marker.getFrame(this.model.time.value, values => {\n      this.values = values;\n\n      if (this.values) {\n        if (this.loadData()) {\n          this.draw();\n        }\n      }\n    });\n  },\n\n  /**\n   * DOM and model are ready\n   */\n  readyOnce() {\n    this.element = d3.select(this.element);\n\n    // reference elements\n    //this.graph = this.element.select('.vzb-br-graph');\n    //this.yearEl = this.element.select('.vzb-br-year');\n    //this.year = new DynamicBackground(this.yearEl);\n    this.header = this.element.select('.vzb-br-header');\n    this.infoEl = this.element.select('.vzb-br-axis-info');\n    this.barViewport = this.element.select('.vzb-br-barsviewport');\n    this.barSvg = this.element.select('.vzb-br-bars-svg');\n    this.barContainer = this.element.select('.vzb-br-bars');\n    this.dataWarningEl = this.element.select('.vzb-data-warning');\n    this.wScale = d3.scaleLinear()\n      .domain(this.model.ui.datawarning.doubtDomain)\n      .range(this.model.ui.datawarning.doubtRange);\n\n    // set up formatters\n    this.xAxis.tickFormat(this.model.marker.axis_x.getTickFormatter());\n\n    this._localeId = this.model.locale.id;\n    this._entityLabels = {};\n    this._presentation = !this.model.ui.presentation;\n    this._formatter = this.model.marker.axis_x.getTickFormatter();\n\n    this.ready();\n\n    this._selectBars();\n\n  },\n\n  /**\n   * Both model and DOM are ready\n   */\n  ready() {\n    this.model.marker.getFrame(this.model.time.value, values => {\n      this.values = values;\n\n      if (this.values) {\n        if (this.loadData()) {\n          this.draw(true);\n          this._updateOpacity();\n          this._drawColors();\n        }\n      }\n    });\n  },\n\n  resize() {\n    this.draw(true);\n    this._drawColors();\n  },\n\n  loadData() {\n    const _this = this;\n\n    this.translator = this.model.locale.getTFunction();\n    // sort the data (also sets this.total)\n    const xAxisValues = this.values.axis_x;\n    if (!Object.keys(xAxisValues).length) return false;\n\n    this.sortedEntities = this._sortByIndicator(xAxisValues);\n\n    this.header\n      .select('.vzb-br-title')\n      .select('text')\n      .on('click', () =>\n        this.parent\n          .findChildByName('gapminder-treemenu')\n          .markerID('axis_x')\n          .alignX('left')\n          .alignY('top')\n          .updateView()\n          .toggle()\n      );\n\n    // new scales and axes\n    this.xScale = this.model.marker.axis_x.getScale().copy();\n    this.cScale = this.model.marker.color.getScale();\n\n    utils.setIcon(this.dataWarningEl, iconWarn)\n      .select('svg')\n      .attr('width', 0).attr('height', 0);\n\n    this.dataWarningEl.append('text')\n      .text(this.translator('hints/dataWarning'));\n\n    this.dataWarningEl\n      .on('click', () => this.parent.findChildByName('gapminder-datawarning').toggle())\n      .on('mouseover', () => this._updateDoubtOpacity(1))\n      .on('mouseout', () => this._updateDoubtOpacity());\n\n    const conceptPropsX = this.model.marker.axis_x.getConceptprops();\n    utils.setIcon(this.infoEl, iconQuestion)\n      .select('svg').attr('width', 0).attr('height', 0)\n      .style('opacity', Number(Boolean(conceptPropsX.description || conceptPropsX.sourceLink)));\n\n    this.infoEl.on('click', () => {\n      this.parent.findChildByName('gapminder-datanotes').pin();\n    });\n\n    this.infoEl.on('mouseover', function() {\n      const rect = this.getBBox();\n      const ctx = utils.makeAbsoluteContext(this, this.farthestViewportElement);\n      const coord = ctx(rect.x - 10, rect.y + rect.height + 10);\n      _this.parent.findChildByName('gapminder-datanotes')\n        .setHook('axis_x')\n        .show()\n        .setPos(coord.x, coord.y);\n    });\n\n    this.infoEl.on('mouseout', () => {\n      _this.parent.findChildByName('gapminder-datanotes').hide();\n    });\n\n    return true;\n  },\n\n  draw(force = false) {\n    this.time_1 = this.time == null ? this.model.time.value : this.time;\n    this.time = this.model.time.value;\n    //smooth animation is needed when playing, except for the case when time jumps from end to start\n    const duration = this.model.time.playing && (this.time - this.time_1 > 0) ? this.model.time.delayAnimations : 0;\n\n    //return if drawAxes exists with error\n    if (this.drawAxes(duration, force)) return;\n    this.drawData(duration, force);\n  },\n\n  /*\n   * draw the chart/stage\n   */\n  drawAxes(duration = 0) {\n    const profiles = {\n      small: {\n        margin: { top: 60, right: 5, left: 5, bottom: 20 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 5,\n        barHeight: 18,\n        barMargin: 3,\n        barRectMargin: 5,\n        barValueMargin: 5,\n        scrollMargin: 20,\n      },\n      medium: {\n        margin: { top: 60, right: 5, left: 5, bottom: 20 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 5,\n        barHeight: 21,\n        barMargin: 3,\n        barRectMargin: 5,\n        barValueMargin: 5,\n        scrollMargin: 25,\n      },\n      large: {\n        margin: { top: 60, right: 5, left: 5, bottom: 20 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 5,\n        barHeight: 28,\n        barMargin: 4,\n        barRectMargin: 5,\n        barValueMargin: 5,\n        scrollMargin: 25,\n      }\n    };\n\n    const presentationProfileChanges = {\n      medium: {\n        margin: { top: 60, right: 10, left: 10, bottom: 40 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 25,\n        infoElMargin: 10,\n        barHeight: 25,\n        barMargin: 6\n      },\n      large: {\n        margin: { top: 60, right: 10, left: 10, bottom: 40 },\n        headerMargin: { top: 10, right: 20, bottom: 20, left: 20 },\n        infoElHeight: 16,\n        infoElMargin: 10,\n        barHeight: 30,\n        barMargin: 6\n      }\n    };\n\n    this.activeProfile = this.getActiveProfile(profiles, presentationProfileChanges);\n\n    const {\n      margin,\n      headerMargin,\n      infoElHeight,\n      infoElMargin,\n    } = this.activeProfile;\n\n    this.height = parseInt(this.element.style('height'), 10) || 0;\n    this.width = parseInt(this.element.style('width'), 10) || 0;\n\n    if (!this.height || !this.width) return utils.warn('Dialog resize() abort: vizabi container is too little or has display:none');\n\n    this.barViewport\n      .style('height', `${this.height - margin.bottom - margin.top}px`);\n\n    // header\n    this.header.attr('height', margin.top);\n    const headerTitle = this.header.select('.vzb-br-title');\n\n    // change header titles for new data\n    const { name, unit } = this.model.marker.axis_x.getConceptprops();\n\n    const headerTitleText = headerTitle\n      .select('text');\n\n    if (unit) {\n      headerTitleText.text(`${name}, ${unit}`);\n\n      const rightEdgeOfLeftText = headerMargin.left\n        + headerTitle.node().getBBox().width\n        + infoElMargin\n        + infoElHeight;\n\n      if (rightEdgeOfLeftText > this.width - headerMargin.right) {\n        headerTitleText.text(name);\n      }\n    } else {\n      headerTitleText.text(name);\n    }\n\n    const headerTitleBBox = headerTitle.node().getBBox();\n\n    const titleTx = headerMargin.left;\n    const titleTy = headerMargin.top + headerTitleBBox.height;\n    headerTitle\n      .attr('transform', `translate(${titleTx}, ${titleTy})`);\n\n    const headerInfo = this.infoEl;\n\n    headerInfo.select('svg')\n      .attr('width', `${infoElHeight}px`)\n      .attr('height', `${infoElHeight}px`);\n\n    const infoTx = titleTx + headerTitle.node().getBBox().width + infoElMargin;\n    const infoTy = headerMargin.top + infoElHeight / 4;\n    headerInfo.attr('transform', `translate(${infoTx}, ${infoTy})`);\n\n\n    const headerTotal = this.header.select('.vzb-br-total');\n\n    if (duration) {\n      headerTotal.select('text')\n        .transition('text')\n        .delay(duration)\n        .text(this.model.time.formatDate(this.time));\n    } else {\n      headerTotal.select('text')\n        .interrupt()\n        .text(this.model.time.formatDate(this.time));\n    }\n    headerTotal.style('opacity', Number(this.getLayoutProfile() !== 'large'));\n\n    const headerTotalBBox = headerTotal.node().getBBox();\n\n    const totalTx = this.width - headerMargin.right - headerTotalBBox.width;\n    const totalTy = headerMargin.top + headerTotalBBox.height;\n    headerTotal\n      .attr('transform', `translate(${totalTx}, ${totalTy})`)\n      .classed('vzb-transparent', headerTitleBBox.width + headerTotalBBox.width + 10 > this.width);\n\n    this.element.select('.vzb-data-warning-svg')\n      .style('height', `${margin.bottom}px`);\n\n\n    const warningBBox = this.dataWarningEl.select('text').node().getBBox();\n    this.dataWarningEl\n      .attr('transform', `translate(${this.width - margin.right - warningBBox.width}, ${warningBBox.height})`)\n      .select('text');\n\n    this.dataWarningEl\n      .select('svg')\n      .attr('width', warningBBox.height)\n      .attr('height', warningBBox.height)\n      .attr('x', -warningBBox.height - 5)\n      .attr('y', -warningBBox.height + 1);\n\n    this._updateDoubtOpacity();\n  },\n\n  drawData(duration = 0, force = false) {\n    // update the shown bars for new data-set\n    this._createAndDeleteBars(\n      this.barContainer.selectAll('.vzb-br-bar')\n        .data(this.sortedEntities, d => d.entity)\n    );\n\n\n    const { presentation } = this.model.ui;\n    const presentationModeChanged = this._presentation !== presentation;\n\n    if (presentationModeChanged) {\n      this._presentation = presentation;\n    }\n\n\n    const entitiesCountChanged = typeof this._entitiesCount === 'undefined'\n      || this._entitiesCount !== this.sortedEntities.length;\n\n    if (presentationModeChanged || entitiesCountChanged) {\n      if (entitiesCountChanged) {\n        this._entitiesCount = this.sortedEntities.length;\n      }\n    }\n\n    this._resizeSvg();\n    this._scroll(duration);\n    this._drawColors();\n\n\n    const { barRectMargin, barValueMargin, scrollMargin, margin } = this.activeProfile;\n    const { axis_x } = this.model.marker;\n    const limits = axis_x.getLimits(axis_x.which);\n    const ltr = Math.abs(limits.max) >= Math.abs(limits.min);\n    const hasNegativeValues = ltr ? limits.min < 0 : limits.max > 0;\n\n\n    const rightEdge = (\n        this.width\n        - margin.right\n        - margin.left\n        - barRectMargin\n        - scrollMargin\n        - (hasNegativeValues ? 0 : this._getWidestLabelWidth())\n      ) / (hasNegativeValues ? 2 : 1);\n\n    this.xScale\n      .range([0, rightEdge]);\n    \n    if (this.model.marker.axis_x.scaleType !== \"log\") {\n      this.xScale\n        .domain([0, Math.max(...this.xScale.domain())]);\n    }\n\n    const shift = hasNegativeValues ? rightEdge : this._getWidestLabelWidth();\n\n    const barWidth = (value) => this.xScale(value);\n    const isLtrValue = value => ltr ? value >= 0 : value > 0;\n\n    const labelAnchor = value => isLtrValue(value) ? 'end' : 'start';\n    const valueAnchor = value => isLtrValue(value) ? 'start' : 'end';\n\n    const labelX = value => isLtrValue(value) ?\n      (margin.left + shift) :\n      (this.width - shift - scrollMargin - margin.right);\n\n    const barX = value => isLtrValue(value) ?\n      (labelX(value) + barRectMargin) :\n      (labelX(value) - barRectMargin);\n\n    const valueX = value => isLtrValue(value) ?\n      (barX(value) + barValueMargin) :\n      (barX(value) - barValueMargin);\n\n    const isLabelBig = (this._getWidestLabelWidth(true) + (ltr ? margin.left : margin.right)) < shift;\n    this.sortedEntities.forEach((bar) => {\n      const { value } = bar;\n\n      if (force || presentationModeChanged || bar.isNew || bar.changedValue) {\n        bar.barLabel\n          .attr('x', labelX(value))\n          .attr('y', this.activeProfile.barHeight / 2)\n          .attr('text-anchor', labelAnchor(value))\n          .text(isLabelBig ? bar.labelFull : bar.labelSmall);\n\n        bar.barRect\n          .attr('rx', this.activeProfile.barHeight / 4)\n          .attr('ry', this.activeProfile.barHeight / 4)\n          .attr('height', this.activeProfile.barHeight);\n\n        bar.barValue\n          .attr('x', valueX(value))\n          .attr('y', this.activeProfile.barHeight / 2)\n          .attr('text-anchor', valueAnchor(value));\n      }\n\n      if (force || bar.changedWidth || presentationModeChanged) {\n        const width = Math.max(0, value && barWidth(Math.abs(value))) || 0;\n\n        if (force || bar.changedWidth || presentationModeChanged) {\n          bar.barRect\n            .transition().duration(duration).ease(d3.easeLinear)\n            .attr('width', width)\n        }\n\n        bar.barRect\n          .attr('x', barX(value) - (value < 0 ? width : 0));\n\n        if (force || bar.changedValue) {\n          bar.barValue\n            .text(this._formatter(value) || this.translator('hints/nodata'));\n        }\n      }\n\n      if (force || bar.changedIndex || presentationModeChanged) {\n        (duration ? bar.self.transition().duration(duration).ease(d3.easeLinear) : bar.self)\n          .attr('transform', `translate(0, ${this._getBarPosition(bar.index)})`);\n      }\n    });\n  },\n\n  _resizeSvg() {\n    const { barHeight, barMargin } = this.activeProfile;\n    this.barSvg.attr('height', `${(barHeight + barMargin) * this.sortedEntities.length}px`);\n  },\n\n  _scroll(duration = 0) {\n    const follow = this.barContainer.select('.vzb-selected');\n    if (!follow.empty()) {\n      const d = follow.datum();\n      const yPos = this._getBarPosition(d.index);\n\n      const { margin } = this.activeProfile;\n      const height = this.height - margin.top - margin.bottom;\n\n      const scrollTo = yPos - (height + this.activeProfile.barHeight) / 2;\n      this.barViewport.transition().duration(duration)\n        .tween('scrollfor' + d.entity, this._scrollTopTween(scrollTo));\n    }\n  },\n\n  _createAndDeleteBars(updatedBars) {\n    const _this = this;\n\n    // TODO: revert this commit after fixing https://github.com/vizabi/vizabi/issues/2450\n    const [entity] = this.sortedEntities;\n    if (!this._entityLabels[entity.entity]) {\n      this._entityLabels[entity.entity] = entity.label;\n    }\n\n    const localeChanged = this._entityLabels[entity.entity] !== this.values.label[entity.entity]\n      && this.model.locale.id !== this._localeId;\n\n    if (localeChanged) {\n      this._localeId = this.model.locale.id;\n      this._entityLabels[entity.entity] = this.values.label[entity.entity];\n    }\n\n    // remove groups for entities that are gone\n    updatedBars.exit().remove();\n\n    // make the groups for the entities which were not drawn yet (.data.enter() does this)\n    updatedBars = (localeChanged ? updatedBars : updatedBars.enter().append('g'))\n      .each(function(d) {\n        const self = d3.select(this);\n\n        const labelFull = _this.values.label[d.entity];\n        const labelSmall = labelFull.length < 12 ? labelFull : `${labelFull.substring(0, 9)}...`;\n\n        const selectedLabel = self.select('.vzb-br-label');\n        const barLabel = selectedLabel.size() ?\n          selectedLabel :\n          self.append('text')\n            .attr('class', 'vzb-br-label')\n            .attr('dy', '.325em');\n\n        const labelFullWidth = barLabel.text(labelFull).node().getBBox().width;\n        const labelSmallWidth = barLabel.text(labelSmall).node().getBBox().width;\n\n        Object.assign(d, {\n          labelFullWidth,\n          labelSmallWidth,\n          labelFull,\n          labelSmall,\n          barLabel,\n        });\n\n        if (!localeChanged) {\n          self\n            .attr('class', 'vzb-br-bar')\n            .classed('vzb-selected', _this.model.marker.isSelected(d))\n            .attr('id', `vzb-br-bar-${d.entity}-${_this._id}`)\n            .on('mousemove', d => _this.model.marker.highlightMarker(d))\n            .on('mouseout', () => _this.model.marker.clearHighlighted())\n            .on('click', d => {\n              _this.model.marker.selectMarker(d);\n            });\n\n          const barRect = self.append('rect')\n            .attr('stroke', 'transparent');\n\n          const barValue = self.append('text')\n            .attr('class', 'vzb-br-value')\n            .attr('dy', '.325em');\n\n          Object.assign(d, {\n            self,\n            isNew: true,\n            barRect,\n            barValue,\n          });\n        }\n      })\n      .merge(updatedBars);\n  },\n\n  _getWidestLabelWidth(big = false) {\n    const widthKey = big ? 'labelFullWidth' : 'labelSmallWidth';\n    const labelKey = big ? 'labelFull' : 'labelSmall';\n\n    const bar = this.sortedEntities\n      .reduce((a, b) => a[widthKey] < b[widthKey] ? b : a);\n\n    const text = bar.barLabel.text();\n    const width = bar.barLabel.text(bar[labelKey]).node().getBBox().width;\n    bar.barLabel.text(text);\n\n    return width;\n  },\n\n  _drawColors() {\n    const _this = this;\n\n    this.barContainer.selectAll('.vzb-br-bar>rect')\n      .each(function({ entity }) {\n        const rect = d3.select(this);\n\n        const colorValue = _this.values.color[entity];\n        const isColorValid = colorValue || colorValue === 0;\n\n        const fillColor = isColorValid ? String(_this._getColor(colorValue)) : COLOR_WHITEISH;\n        const strokeColor = isColorValid ? 'transparent' : COLOR_BLACKISH;\n\n        rect.style('fill') !== fillColor && rect.style('fill', fillColor);\n        rect.style('stroke') !== strokeColor && rect.style('stroke', strokeColor);\n      });\n\n    this.barContainer.selectAll('.vzb-br-bar>text')\n      .style('fill', ({ entity }) => this._getDarkerColor(this.values.color[entity] || null));\n  },\n\n  _getColor(value) {\n    return d3.rgb(this.cScale(value));\n  },\n\n  _getDarkerColor(d) {\n    return this._getColor(d).darker(2);\n  },\n\n\n  /**\n   * DATA HELPER FUNCTIONS\n   */\n\n  _scrollTopTween(scrollTop) {\n    return function() {\n      const node = this, i = d3.interpolateNumber(this.scrollTop, scrollTop);\n      return function(t) {\n        node.scrollTop = i(t);\n      };\n    };\n  },\n\n  _getBarPosition(i) {\n    return (this.activeProfile.barHeight + this.activeProfile.barMargin) * i;\n  },\n\n  _entities: {},\n\n  _sortByIndicator(values) {\n    return Object.keys(values).map(entity => {\n      const cached = this._entities[entity];\n      const value = values[entity];\n      const label = this.values.label[entity];\n      const formattedValue = this._formatter(value);\n\n      if (cached) {\n        return Object.assign(cached, {\n          value,\n          label,\n          formattedValue,\n          changedValue: formattedValue !== cached.formattedValue,\n          changedWidth: value !== cached.value,\n          isNew: false\n        });\n      }\n\n      return this._entities[entity] = {\n        entity,\n        value,\n        formattedValue,\n        [this.model.entities.dim]: entity,\n        changedValue: true,\n        changedWidth: true,\n        isNew: true\n      };\n    }).sort(({ value: a }, { value: b }) => b - a)\n      .map((entity, index) =>\n        Object.assign(entity, {\n          index,\n          changedIndex: index !== entity.index\n        }));\n  },\n\n  _selectBars() {\n    const entityDim = this.model.entities.dim;\n    const selected = this.model.marker.select;\n\n    // unselect all bars\n    this.barContainer.classed('vzb-dimmed-selected', false);\n    this.barContainer.selectAll('.vzb-br-bar.vzb-selected').classed('vzb-selected', false);\n\n    // select the selected ones\n    if (selected.length) {\n      this.barContainer.classed('vzb-dimmed-selected', true);\n      selected.forEach(selectedBar => {\n        this.barContainer\n          .select(`#vzb-br-bar-${selectedBar[entityDim]}-${this._id}`)\n          .classed('vzb-selected', true);\n      });\n    }\n\n  },\n\n  _updateOpacity() {\n    const { model: { marker } } = this;\n\n    const OPACITY_HIGHLIGHT_DEFAULT = 1;\n    const {\n      highlight,\n      select,\n\n      opacityHighlightDim: OPACITY_HIGHLIGHT_DIM,\n      opacitySelectDim: OPACITY_SELECT_DIM,\n      opacityRegular: OPACITY_REGULAR,\n    } = marker;\n\n    const [\n      someHighlighted,\n      someSelected\n    ] = [\n      highlight.length > 0,\n      select.length > 0\n    ];\n\n    this.barContainer.selectAll('.vzb-br-bar')\n      .style('opacity', d => {\n        if (someHighlighted && marker.isHighlighted(d)) {\n          return OPACITY_HIGHLIGHT_DEFAULT;\n        }\n\n        if (someSelected) {\n          return marker.isSelected(d) ? OPACITY_REGULAR : OPACITY_SELECT_DIM;\n        }\n\n        if (someHighlighted) {\n          return OPACITY_HIGHLIGHT_DIM;\n        }\n\n        return OPACITY_REGULAR;\n      });\n  },\n\n  _updateDoubtOpacity(opacity) {\n    this.dataWarningEl.style('opacity',\n      opacity || (\n        !this.model.marker.select.length ?\n          this.wScale(+this.model.time.value.getUTCFullYear().toString()) :\n          1\n      )\n    );\n  },\n\n});\n\nexport default BarRankChart;\n\n\n\n// WEBPACK FOOTER //\n// ./src/component.js","module.exports = \"<!-- Bar Chart Component -->\\n<div class=\\\"vzb-barrankchart\\\">\\n  <svg class=\\\"vzb-br-header\\\">\\n    <g class=\\\"vzb-br-title\\\">\\n      <text></text>\\n    </g>\\n    <g class=\\\"vzb-br-total\\\">\\n      <text></text>\\n    </g>\\n    <g class=\\\"vzb-br-axis-info vzb-noexport\\\"></g>\\n  </svg>\\n\\n  <div class=\\\"vzb-br-barsviewport vzb-dialog-scrollable\\\">\\n    <svg class=\\\"vzb-br-bars-svg\\\">\\n      <g class=\\\"vzb-br-bars\\\"></g>\\n    </svg>\\n  </div>\\n\\n  <svg class=\\\"vzb-data-warning-svg\\\">\\n    <g class=\\\"vzb-data-warning vzb-noexport\\\">\\n      <svg></svg>\\n      <text></text>\\n    </g>\\n  </svg>\\n</div>\\n\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/template.html\n// module id = 3\n// module chunks = 0"],"sourceRoot":""}