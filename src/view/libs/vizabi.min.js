/**
 * vizabi - Vizabi Framework, Interactive charts and visualization tools animated through time
 * @version v0.26.6
 * @build timestamp Thu Oct 26 2017 07:54:48 GMT+0000 (UTC)
 * @link http://vizabi.org
 * @license BSD-3-Clause
 */

!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Vizabi",[],e):"object"==typeof exports?exports.Vizabi=e():t.Vizabi=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=185)}([function(t,e,n){var i=n(3),r=n(25),a=n(15),s=n(16),o=n(22),l=function(t,e,n){var c,u,h,d,f=t&l.F,p=t&l.G,v=t&l.S,g=t&l.P,m=t&l.B,b=p?i:v?i[e]||(i[e]={}):(i[e]||{}).prototype,_=p?r:r[e]||(r[e]={}),y=_.prototype||(_.prototype={});p&&(n=e);for(c in n)u=!f&&b&&void 0!==b[c],h=(u?b:n)[c],d=m&&u?o(h,i):g&&"function"==typeof h?o(Function.call,h):h,b&&s(b,c,h,t&l.U),_[c]!=h&&a(_,c,d),g&&y[c]!=h&&(y[c]=h)};i.core=r,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},function(t,e,n){"use strict";function i(t){return Boolean(t instanceof Date||t instanceof RegExp)}function r(t){if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp)return new RegExp(t);throw new Error("Unexpected situation")}function a(t){var e=[];return M(t,function(t,n){"object"===(void 0===t?"undefined":u(t))&&null!==t?f(t)?e[n]=a(t):i(t)?e[n]=r(t):e[n]=w({},t):e[n]=t}),e}function s(t,e){return function(n,i){var r=e.getBoundingClientRect(),a=t.getScreenCTM();return{x:a.a*n+a.c*i+a.e-r.left,y:a.b*n+a.d*i+a.f-r.top}}}function o(){function t(t){return t}function e(t){return"string"==typeof t?t.toLowerCase():t}function n(n,i){if(i="number"==typeof i?{direction:i}:i||{},"function"!=typeof n){var r=n;n=function(t){return t[r]?t[r]:""}}if(1===n.length){var a=n,s=i.ignoreCase?e:t;n=function(t,e){return s(a(t))<s(a(e))?-1:s(a(t))>s(a(e))?1:0}}return-1===i.direction?function(t,e){return-n(t,e)}:n}function i(t,e){var r="function"==typeof this&&this,a=n(t,e),s=r?function(t,e){return r(t,e)||a(t,e)}:a;return s.thenBy=i,s}return i}function l(t){var e=t.transform.baseVal.consolidate().matrix,n=e.a,i=e.b,r=e.c,a=e.d,s=e.e,o=e.f;return function(t,e,n,i,r,a){var s=void 0,o=void 0,l=void 0;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(o=Math.sqrt(n*n+i*i))&&(n/=o,i/=o,l/=o),t*i<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:r,translateY:a,rotate:Math.atan2(e,t)*Math.PI/180,skewX:Math.atan(l)*Math.PI/180,scaleX:s,scaleY:o}}(n,i,r,a,s,o)}function c(t,e,n){for(var i=e,r=0,a=n.length;r<a&&(i=i[t[n[r]]]);r++);return i}Object.defineProperty(e,"__esModule",{value:!0}),e.px2num=e.getProp=e.isFunction=e.isMobileOrTablet=e.capitalize=e.setIcon=e.pruneTree=e.isTouchDevice=e.debounce=e.memoize=e.post=e.get=e.ajax=e.interpolatePoint=e.interpolateVector=e.nestArrayToObj=e.hashCode=e.clearDelay=e.delay=e.defer=e.diffObject=e.arrayLast=e.arrayMedian=e.arraySum=e.arrayMean=e.arrayMax=e.arrayMin=e.values=e.keys=e.throttle=e.hasClass=e.classed=e.removeClass=e.addClass=e.countDecimals=e.error=e.groupEnd=e.groupCollapsed=e.warn=e.timeStamp=e.areaToRadius=e.cathetus=e.hypotenuse=e.radiusToArea=e.preventAncestorScrolling=e.matchAny=e.filterAny=e.filter=e.find=e.uniqueLast=e.unique=e.without=e.deepClone=e.clone=e.merge=e.deepExtend=e.extend=e.forEach=e.strToFloat=e.roundStep=e.findScrollableAncestor=e.getViewportPosition=e.comparePlainObjects=e.arrayEquals=e.isPlainObject=e.isNumber=e.isEmpty=e.isNaN=e.isString=e.isDate=e.isObject=e.isArray=e.isElement=e.uniqueId=e.printAutoconfigResult=e.approxEqual=void 0;var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.makeAbsoluteContext=s,e.firstBy=o,e.transform=l,e.getValueMD=c;var h=n(389),d=function(t){return t&&t.__esModule?t:{default:t}}(h),f=(e.approxEqual=function(t,e,n){return n=n||0,e>0?(1-n)*e<=t&&t<=e*(1+n):e<0?(1+n)*e<=t&&t<=e*(1-n):Math.abs(t)<=n},e.printAutoconfigResult=function(t){console.info("AUTOCONFIG: "+t._name+(t.use?" of "+t._parent._name:"")+" choses "+(t.dim||t.which)+" from "+(t.dataSource?t.dataSource._name:"<DATA SOURCE MISSING!>")+" to be "+("entities"===t._type||"time"===t._type?"DIM":"WHICH"))},e.uniqueId=function(){var t=0;return function(e){return e?e+(t+=1):t+=1}}(),e.isElement=function(t){return!(!t||1!==t.nodeType)},e.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}),p=e.isObject=function(t){return"object"===(void 0===t?"undefined":u(t))&&!!t},v=(e.isDate=function(t){return t instanceof Date},e.isString=function(t){return"string"==typeof t}),g=e.isNaN=function(t){return b(t)&&t!==+t},m=e.isEmpty=function(t){return 0===Object.keys(t).length&&t.constructor===Object},b=e.isNumber=function(t){return"number"==typeof t||!!t&&"object"===(void 0===t?"undefined":u(t))&&"[object Number]"===Object.prototype.toString.call(t)},_=e.isPlainObject=function(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)},y=e.arrayEquals=function(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!=e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0},M=(e.comparePlainObjects=function(t,e){var n=function(t){return Object.prototype.toString.call(t).match(/^\[object\s(.*)\]$/)[1]},i=function(t){if(void 0===t)return"undefined";if(null===t)return"null";var e=void 0===t?"undefined":u(t);return"object"===e&&(e=n(t).toLowerCase()),"number"===e?t.toString().indexOf(".")>0?"float":"integer":e},r=function(t,e){if(t===e)return!0;for(var n in t){if(!e.hasOwnProperty(n))return!1;if(!o(t[n],e[n]))return!1}for(var i in e)if(!t.hasOwnProperty(i))return!1;return!0},a=function(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!o(t[n],e[n]))return!1;return!0},s={};s.array=a,s.object=r,s.date=function(t,e){return t.getTime()===e.getTime()},s.regexp=function(t,e){return t.toString()===e.toString()};var o=function(t,e){if(t!==e){var n=i(t);return n===i(e)&&(s.hasOwnProperty(n)?s[n](t,e):t==e)}return!0};return r(t,e)},e.getViewportPosition=function(t){for(var e=0,n=0;t;)e+=t.offsetLeft-t.scrollLeft+t.clientLeft,n+=t.offsetTop-t.scrollTop+t.clientTop,t=t.offsetParent;return{x:e,y:n}},e.findScrollableAncestor=function(t){for(var e=["scroll","auto"];t=t.parentNode;){if(t.scrollHeight>t.clientHeight&&-1!==e.indexOf(d3.select(t).style("overflow")))return t}return null},e.roundStep=function(t,e){return Math.round(t/e)*e},e.strToFloat=function(t){return+t.replace(/[^\d.-]/g,"")},e.forEach=function(t,e,n){if(t){var i=void 0,r=void 0;if(f(t))for(r=t.length,i=0;i<r;i+=1){var a=e.apply(n,[t[i],i]);if(!1===a)break}else{var s=Object.keys(t);for(r=s.length,i=0;i<r;i+=1){if(!1===e.apply(n,[t[s[i]],s[i]]))break}}}}),w=(e.extend=function(t){var e=Array.prototype.slice.call(arguments,1);return M(e,function(e,n){M(e,function(n,i){e.hasOwnProperty(i)&&(t[i]=n)})}),t},e.deepExtend=function t(){if(arguments.length<1||"object"!==u(arguments[0]))return!1;if(arguments.length<2)return arguments[0];var e=arguments[0],n="boolean"==typeof arguments[arguments.length-1],s=n&&arguments[arguments.length-1],o=Array.prototype.slice.call(arguments,1,n?-1:arguments.length),l=void 0,c=void 0;return M(o,function(n){"object"!==(void 0===n?"undefined":u(n))||f(n)||M(Object.keys(n),function(o){c=e[o],(l=n[o])===e||("object"!==(void 0===l?"undefined":u(l))||null===l||l._data?e[o]=l:f(l)?e[o]=a(l):i(l)?e[o]=r(l):"object"!==(void 0===c?"undefined":u(c))||null===c||f(c)?e[o]=t({},l):s&&m(l)?e[o]={}:e[o]=t(c,l,s))})}),e}),x=(e.merge=function(t){var e=Array.prototype.slice.call(arguments,1);return M(e,function(e,n){M(e,function(n,i){e.hasOwnProperty(i)&&(t.hasOwnProperty(i)?(f(t[i])||(t[i]=[t[i]]),t[i].push(n)):t[i]=n)})}),t},e.clone=function(t,e,n){if(f(t))return t.slice(0);var i={};return M(t,function(r,a){e&&-1===e.indexOf(a)||n&&-1!==n.indexOf(a)||t.hasOwnProperty(a)&&(i[a]=r)}),i},e.deepClone=function t(e){var n={};return f(e)&&(n=[]),M(e,function(e,i){p(e)||f(e)?n[i]=t(e):n[i]=e}),n},e.without=function(t,e){var n=t.indexOf(e);return-1!==n&&t.splice(n,1),t},e.unique=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},n={};return t.filter(function(t){var i=e(t);return!n.hasOwnProperty(i)&&(n[i]=1,!0)})},e.uniqueLast=function(t,e){var n={},i=[];e||(e=function(t){return t});for(var r=0,a=t.length;r<a;r+=1){var s=e(t[r]);n.hasOwnProperty(s)&&i.splice(n[s],1),i.push(t[r]),n[s]=i.length-1}return i},e.find=function(t,e){var n=void 0;return M(t,function(t){if(e(t))return n=t,!1}),n},e.filter=function(t,e){for(var n=-1,i=t.length,r=-1,a=[],s=Object.keys(e),o=s.length,l=void 0,c=void 0;(n+=1)<i;){var u=t[n],h=!0;for(l=0;l<o;l+=1)if(c=s[l],!u.hasOwnProperty(c)||u[c]!==e[c]){h=!1;break}h&&(a[r+=1]=u)}return a},e.filterAny=function(t,e,n){for(var i=-1,r=t.length,a=-1,s=[],o=Object.keys(e),l=o.length,c=void 0,u=void 0;(i+=1)<r;){var h=t[i],d=!0;for(c=0;c<l;c+=1)if(u=o[c],!h.hasOwnProperty(u)||!x(h[u],e[u],n)){d=!1;break}d&&(s[a+=1]=h)}return s},e.matchAny=function(t,e,n){f(t)||(t=[t]),n||(n="*");for(var i=!1,r=0;r<t.length;r++){var a=t[r];if(!f(e)&&a==e){i=!0;break}if(f(e)){for(var s=-1,o=0;o<e.length;o++){var l=e[o];if(!(f(l)||l!=a&&l!==n)){s=o;break}if(f(l)){var c=l[0],u=l[1]||c;if(a>=c&&a<=u){s=o;break}}}if(-1!==s){i=!0;break}}}return i}),S=(e.preventAncestorScrolling=function(t){var e=!1;t.on("mousewheel",function(n,i){var r=this.scrollTop,a=this.scrollHeight,s=t.node().offsetHeight,o=d3.event.wheelDelta,l=o>0,c=function(t){return function(){var e=this,n=d3.interpolateNumber(this.scrollTop,t);return function(t){e.scrollTop=n(t)}}};if(l?l&&(o>r&&r>0?(t.transition().delay(0).duration(0).tween("scrolltween",c(0)),e=!0,setTimeout(function(){e=!1},2e3)):a==s+r&&(e=!1)):-o>a-s-r&&a!=s+r?(t.transition().delay(0).duration(0).tween("scrolltween",c(a)),e=!0,setTimeout(function(){e=!1},2e3)):0==r&&(e=!1),e)return function(){return d3.event.stopPropagation(),d3.event.preventDefault(),d3.event.returnValue=!1,!1}()})},e.radiusToArea=function(t){return t*t*Math.PI},e.hypotenuse=function(t,e){return Math.sqrt(t*t+e*e)},e.cathetus=function(t,e){return Math.sqrt(t*t-e*e)},e.areaToRadius=function(t){return Math.sqrt(t/Math.PI)},e.timeStamp=function(t){console&&"function"==typeof console.timeStamp&&console.timeStamp(t)},e.warn=function(t){return t=Array.prototype.slice.call(arguments).map(function(t){return t instanceof Object?JSON.stringify(t,null,4):t}).join(" "),console&&"function"==typeof console.warn&&console.warn(t),!0}),z=(e.groupCollapsed=function(t){t=Array.prototype.slice.call(arguments).join(" "),console&&"function"==typeof console.groupCollapsed&&console.groupCollapsed(t)},e.groupEnd=function(){console&&"function"==typeof console.groupEnd&&console.groupEnd()},e.error=function(t){console&&"function"==typeof console.error&&(t.stack?console.error(t.stack):console.error(t),arguments.length>1&&console.error.apply(this,Array.prototype.slice.call(arguments,1)))},e.countDecimals=function(t){return Math.floor(t.valueOf())===t.valueOf()?0:t.toString().split(".")[1].length||0},e.addClass=function(t,e){t.classList?t.classList.add(e):t.className+=" "+e}),O=e.removeClass=function(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")},E=(e.classed=function(t,e,n){if(!0===n)z(t,e);else{if(!1!==n)return E(t,e);O(t,e)}},e.hasClass=function(t,e){return t.classList?t.classList.contains(e):new RegExp("(^| )"+e+"( |$)","gi").test(t.className)}),k=(e.throttle=function(t,e){var n=!1,i=void 0,r=void 0,a=void 0,s=function(){n&&(n=!1,t.apply(r,i))},o=function(){if(a>Date.now())return n=!0,i=arguments,void(r=this);a=Date.now()+e,n=!1,t.apply(this,arguments),setTimeout(function(){s()},e)};return o.recallLast=s,o},e.keys=function(t){return Object.keys(t)},e.values=function(t){for(var e=[],n=Object.keys(t),i=n.length,r=0;r<i;r+=1)e.push(t[n[r]]);return e},e.arrayMin=function(t){return t.reduce(function(t,e){return t<e?t:e})},e.arrayMax=function(t){return t.reduce(function(t,e){return t>e?t:e})},e.arrayMean=function(t){return k(t)/t.length},e.arraySum=function(t){return t.reduce(function(t,e){return t+e})}),T=(e.arrayMedian=function(t){t=t.sort(function(t,e){return t-e});var e=Math.floor((t.length-1)/2);return t.length%2?t[e]:(t[e]+t[e+1])/2},e.arrayLast=function(t){return t.length?t[t.length-1]:null},e.diffObject=function t(e,n){var i={};return M(n,function(n,r){!e.hasOwnProperty(r)&&_(n)&&(i[r]=t({},n))}),M(e,function(e,r){if(n.hasOwnProperty(r)){if(e!==n[r])if(_(e)&&_(n[r]))if(m(e))m(n[r])||(i[r]={});else{var a=t(e,n[r]);Object.keys(a).length>0&&(i[r]=a)}else f(e)&&f(n[r])&&y(e,n[r])||(i[r]=e)}else i[r]=e}),i},e.defer=function(t){setTimeout(t,1)},e.delay=function(t){return new Promise(function(e){return setTimeout(e,t)})},e.clearDelay=function(t){return clearTimeout(t)},e.hashCode=function(t){v(t)||(t=JSON.stringify(t));var e=0,n=t.length,i=void 0;if(0===n)return e;for(var r=0;r<n;r+=1)i=t.charCodeAt(r),e=(e<<5)-e+i,e&=e;return e.toString()},e.nestArrayToObj=function t(e){if(!e||!e.length||!e[0].key)return e;for(var n={},i=0;i<e.length;i++)n[e[i].key]=t(e[i].values);return n},e.interpolateVector=function(){},e.interpolatePoint=function(t,e,n,i,r,a,s,o){if(!t||0===t.length)return S("interpolatePoint failed because incoming array is empty. It was "+n),null;if("constant"===e)return n;if("property"===e)return t[0][n];if(o){if(a-t[0][r]<=0)return t[0][n];if(a-t[t.length-1][r]>=0)return t[t.length-1][n]}else if(a<t[0][r]||a>t[t.length-1][r])return null;if(i||0===i||(i=d3.bisectLeft(t.map(function(t){return t[r]}),a)),0===i)return t[0][n];if(void 0===t[i]||null===t[i][n]||null===t[i-1][n]||""===t[i][n])return S("interpolatePoint failed because next/previous points are bad in "+n),null;var l=d.default[s||"linear"](t[i-1][r],t[i][r],t[i-1][n],t[i][n],a);return n===r&&(l=new Date(l)),g(l)&&(S("interpolatePoint failed because result is NaN. It was "+n),l=null),l},e.ajax=function(t){var e=new XMLHttpRequest;e.open(t.method,t.url,!0),"POST"!==t.method||t.json?"POST"===t.method&&t.json&&e.setRequestHeader("Content-Type","application/json; charset=UTF-8"):e.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),e.onload=function(){if(e.status>=200&&e.status<400){var n=t.json?JSON.parse(e.responseText):e.responseText;t.success&&t.success(n)}else t.error&&t.error()},e.onerror=function(){t.error&&t.error()},e.send(t.data)});e.get=function(t,e,n,i,r){e=e||[],M(e,function(t,n){e.push(n+"="+t)}),t=e.length?t+"?"+e.join("&"):t,T({method:"GET",url:t,success:n,error:i,json:r})},e.post=function(t,e,n,i,r){T({method:"POST",url:t,success:n,error:i,json:r,data:e})},e.memoize=function(t){return function(){for(var e=Array.prototype.slice.call(arguments),n="",i=e.length,r=null;i--;)r=e[i],n+=r===Object(r)?JSON.stringify(r):r,t.memoize||(t.memoize={});return n in t.memoize?t.memoize[n]:t.memoize[n]=t.apply(this,e)}},e.debounce=function(t,e,n){var i=void 0;return function(){var r=this,a=arguments,s=function(){i=null,n||t.apply(r,a)},o=n&&!i;clearTimeout(i),i=setTimeout(s,e),o&&t.apply(r,a)}},e.isTouchDevice=function(){return null!=((d3.event||{}).sourceCapabilities||{}).firesTouchEvents?d3.event.sourceCapabilities.firesTouchEvents:!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)},e.pruneTree=function t(e,n){var i={},r=[];return e.hasOwnProperty("children")&&(r=e.children.map(function(e){return t(e,n)}).filter(function(t){return 0!==Object.keys(t).length})),(0!=r.length||n(e))&&M(e,function(t,e){i[e]=t}),0!=r.length&&(i.children=r),i},e.setIcon=function(t,e){return t.selectAll("*").remove(),t.node().appendChild(t.node().ownerDocument.importNode((new DOMParser).parseFromString(e,"application/xml").documentElement,!0)),t},e.capitalize=function(t){return t.slice(0,1).toUpperCase()+t.slice(1).toLowerCase()},e.isMobileOrTablet=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(t.substr(0,4))},e.isFunction=function(t){return"function"==typeof t},e.getProp=function(t,e,n){for(;e.length;){var i=e.shift();if(!t.hasOwnProperty(i))return n;t=t[i]}return t},e.px2num=function(t){return v(t)&&t.endsWith("px")?parseFloat(t):console.warn("Strange pixels value: "+t)||t}},function(t,e,n){var i=n(6);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){var n=function(e){return t.replace(/<%=([^%]*)%>/g,function(t){var n=t.match(/t\s*\(([^)]+)\)/g);return n.length?n=e.t(n[0].match(/"([^"]+)"/g)[0].split('"').join("")):(n=t.match(/([a-z\-A-Z]+([a-z\-A-Z0-9]?[a-zA-Z0-9]?)?)/g)[0],n=e[n]||n),n})},i=/<[a-z][\s\S]*>/i.test(t)?n:f[t]=f[t]||r(d.default.templates[t]);return e?i(e):i}Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(a),o=n(50),l=i(o),c=n(49),u=i(c),h=n(107),d=i(h),f={},p=l.default.extend({init:function(t,e){if(this._id=this._id||s.uniqueId("c"),this._ready=!1,this._readyOnce=!1,this.name=this.name||t.name||this._id,this.template=this.template||"<div></div>",this.placeholder=this.placeholder||t.placeholder,this.template_data=this.template_data||{name:this.name},this.placeholder&&!s.isElement(this.placeholder))try{this.placeholder=e.placeholder.querySelector(this.placeholder)}catch(t){s.error("Error finding placeholder '"+this.placeholder+"' for component '"+this.name+"'")}this.parent=e||null,this.root=this.parent?this.parent.root:this,this.components=this.components||[],this._components_config=this.components.map(function(t){return s.clone(t)}),this.model_expects=this.model_expects||[],this.model_binds=this.model_binds||{},this.createModel(t.model),this.ui=this.model.ui||this.ui||t.ui,this._super(),this.registerListeners()},createModel:function(t){this.model=this._modelMapping(t)},registerListeners:function(){this.on({readyOnce:this.readyOnce,ready:this.ready,domReady:this.domReady,resize:this.resize})},startPreload:function(){var t=[];return t.push(this.preload()),s.forEach(this.components,function(e){return t.push(e.startPreload())}),Promise.all(t)},preload:function(){return Promise.resolve()},afterPreload:function(){this.model&&this.model.afterPreload(),s.forEach(this.components,function(t){t.afterPreload()})},render:function(){this.prerender(),this.postrender()},prerender:function(){this.loadTemplate(),this.loadSubComponents()},postrender:function(){var t=this;s.forEach(this.components,function(e){e.render(),t.on("resize",function(){e.trigger("resize")})}),this.startLoading()},startLoading:function(){var t=this;this.model.on("ready",function(){t.loadingDone()}),this.model&&this.model.isLoading()||this.loadingDone()},loadingDone:function(){s.removeClass(this.placeholder,"vzb-loading-first"),s.removeClass(this.placeholder,"vzb-loading-data"),this.setReady()},renderError:function(){s.removeClass(this.placeholder,"vzb-loading-first"),s.removeClass(this.placeholder,"vzb-loading-data"),s.addClass(this.placeholder,"vzb-error"),this.setError({type:"data"})},setError:function(t){"function"==typeof this.error&&this.error(t)},setReady:function(t){this._readyOnce||(this.trigger("readyOnce"),this._readyOnce=!0),this._ready=!0,this.trigger("ready")},loadTemplate:function(){var t=this.template,e=this.template_data,n="";if(this.placeholder){if(e=s.extend(e,{t:this.getTranslationFunction(!0)}),this.template)try{n=r(t,e)}catch(t){s.error("Templating error for component: '"+this.name+"' - Check if template name is unique and correct. E.g.: 'bubblechart'"),s.removeClass(this.placeholder,"vzb-loading-data"),s.addClass(this.placeholder,"vzb-error"),this.setError({type:"template"})}s.addClass(this.placeholder,"vzb-loading-data"),s.addClass(this.placeholder,"vzb-loading-first"),this.placeholder.innerHTML=n,this.element=this.placeholder.children[0],this.trigger("domReady")}},getActiveProfile:function(t,e){var n=this.getLayoutProfile(),i=this.getPresentationMode(),r=s.deepClone(t[n]);return i&&(e||{})[n]&&s.deepExtend(r,e[n]),r},loadSubComponents:function(){var t=this,e=void 0,n=void 0;this.components=[],s.forEach(this._components_config,function(i){if(i.model=i.model||{},!i.component)return void s.error("Error loading component: name not provided");if(n=s.isString(i.component)?p.get(i.component):i.component){e=s.extend(i,{name:i.component,ui:t._uiMapping(i.placeholder,i.ui)});var r=new n(e,t);t.components.push(r)}})},findChildByName:function(t){return s.find(this.components,function(e){return e.name===t})},getLayoutProfile:function(){return this.model.ui?this.model.ui.currentProfile():this.parent.getLayoutProfile()},getPresentationMode:function(){return this.model.ui?this.model.ui.getPresentationMode():this.parent.getPresentationMode()},_uiMapping:function(t,e){if(e)return new u.default("ui",e);if(t&&this.ui){t=t.replace(".","");var n=this.ui[t];if(n)return n}return this.ui},_modelMapping:function(t){function e(t){for(var e=t.split("."),i=n.parent.model,r="";e.length;)r=e.shift(),i=i[r];return{name:t,model:i,type:i?i.getType():null}}var n=this,i={};if(s.isArray(t)&&s.isArray(this.model_expects)){this.model_expects.length!==t.length&&(s.groupCollapsed("DIFFERENCE IN NUMBER OF MODELS EXPECTED AND RECEIVED"),s.warn("Please, configure the 'model_expects' attribute accordingly in '"+this.name+"' or check the models passed in '"+n.parent.name+"'.\n\nComponent: '"+n.parent.name+"'\nSubcomponent: '"+this.name+"'\nNumber of Models Expected: "+this.model_expects.length+"\nNumber of Models Received: "+t.length),s.groupEnd()),s.forEach(t,function(r,a){if(r){var o=e(r),l=void 0;n.model_expects[a]?(l=n.model_expects[a].name,!n.model_expects[a].type||o.type===n.model_expects[a].type||s.isArray(n.model_expects[a].type)&&-1!==n.model_expects[a].type.indexOf(o.type)||(s.groupCollapsed("UNEXPECTED MODEL TYPE: '"+o.type+"' instead of '"+n.model_expects[a].type+"'"),s.warn("Please, configure the 'model_expects' attribute accordingly in '"+n.name+"' or check the models passed in '"+n.parent.name+"'.\n\nComponent: '"+n.parent.name+"'\nSubcomponent: '"+n.name+"'\nExpected Model: '"+n.model_expects[a].type+"'\nReceived Model: '"+o.type+"'\nModel order: "+a),s.groupEnd())):(s.groupCollapsed("UNEXPECTED MODEL: '"+t[a]+"'"),s.warn("Please, configure the 'model_expects' attribute accordingly in '"+n.name+"' or check the models passed in '"+n.parent.name+"'.\n\nComponent: '"+n.parent.name+"'\nSubcomponent: '"+n.name+"'\nNumber of Models Expected: "+n.model_expects.length+"\nNumber of Models Received: "+t.length),s.groupEnd(),l=o.name),i[l]=o.model}});var r=t.length,a=this.model_expects.length;return a>r&&(this.model_expects.splice(0,r),s.forEach(a,function(t){i[t.name]={}})),new u.default(this.name,i,null,this.model_binds)}},getTranslationFunction:function(t){var e=void 0;try{e=this.model.get("locale").getTFunction()}catch(t){this.parent&&this.parent!==this&&(e=this.parent.getTranslationFunction())}return e||(e=function(t){return t}),t?this._translatedStringFunction(e):e},_translatedStringFunction:function(t){return function(e){return'<span data-vzb-translate="'+e+'">'+t(e)+"</span>"}},translateStrings:function(){var t=this.getTranslationFunction(),e=this.placeholder.querySelectorAll("[data-vzb-translate]");0!==e.length&&s.forEach(e,function(e){e&&e.getAttribute&&(e.innerHTML=t(e.getAttribute("data-vzb-translate")))})},readyOnce:function(){},ready:function(){},resize:function(){},domReady:function(){},clear:function(){this.freeze(),this.model&&this.model.freeze(),s.forEach(this.components,function(t){t.clear()})}});p.isComponent=function(t){return t._id&&("t"===t._id[0]||"c"===t._id[0])},e.default=p},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var i=n(61)("wks"),r=n(39),a=n(3).Symbol,s="function"==typeof a;(t.exports=function(t){return i[t]||(i[t]=s&&a[t]||(s?a:r)("Symbol."+t))}).store=i},function(t,e,n){t.exports=!n(4)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(2),r=n(109),a=n(26),s=Object.defineProperty;e.f=n(8)?Object.defineProperty:function(t,e,n){if(i(t),e=a(e,!0),i(n),r)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var i=n(28),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e,n){var i=void 0,r=void 0,a=void 0,o=void 0,l=void 0,c=void 0,u=void 0,h=void 0,d=void 0,f=void 0,p=void 0,v=void 0,g=void 0,m=void 0;return{move:function(e,n){t.style("right",e+"px"),t.style("top",n+"px")},dragStart:function(b){if(s.isTouchDevice()){var _=d3.touches(e.node());i=_[0][0],r=_[0][1]}else i=b.sourceEvent.clientX,r=b.sourceEvent.clientY;a=parseInt(t.style("top"))||0,o=parseInt(t.style("right"))||0,c=parseInt(t.style("margin-left"))||0,l=parseInt(t.style("margin-right"))||0,h=Math.min(n,c),u=Math.min(n,l),d=parseInt(t.style("width"),10)+c-h||0,f=parseInt(t.style("height"),10)||0,p=parseInt(e.style("width"),10)-l||0,v=parseInt(e.style("height"),10)||0,g=i+o,m=r-a},drag:function(t){if(s.isTouchDevice()){var n=d3.touches(e.node());i=n[0][0],r=n[0][1]}else i=t.sourceEvent.clientX,r=t.sourceEvent.clientY;var a=-i+g,o=r-m;a<-u&&(a=-u),o<0&&(o=0),a+d>p&&(a=p-d),o+f>v&&(o=v-f),this.move(a,o)}}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(a),o=n(5),l=i(o),c=n(21),u=n(104),h=i(u),d=(0,h.default)(n(401)),f=l.default.extend({isDialog:!0,init:function(t,e){this.name=this.name||"",this.model_expects=this.model_expects||[{name:"state",type:"model"},{name:"ui",type:"ui"},{name:"locale",type:"locale"}],this.template=d[this.name],this._super(t,e),this.transitionEvents=["webkitTransitionEnd","transitionend","msTransitionEnd","oTransitionEnd"]},readyOnce:function(){this.element=d3.select(this.element),this.titleEl=this.element.selectAll(".vzb-top-dialog > .vzb-dialog-modal > .vzb-dialog-title"),this.buttonsEl=this.element.selectAll(".vzb-top-dialog > .vzb-dialog-modal > .vzb-dialog-buttons"),this.contentEl=this.element.selectAll(".vzb-top-dialog > .vzb-dialog-modal > .vzb-dialog-content")},ready:function(){var t=this;this.placeholderEl=d3.select(this.placeholder),this.rootEl=this.root.element instanceof Array?this.root.element:d3.select(this.root.element),this.dragHandler=this.placeholderEl.select("[data-click='dragDialog']"),this.dragHandler.html(c.drag),this.pinIcon=this.placeholderEl.select("[data-click='pinDialog']"),this.pinIcon.html(c.pin),this.topPos="";var e=this.getLayoutProfile(),n=r(this.placeholderEl,this.rootEl,10),i=d3.drag().on("start",function(){var e=t.placeholderEl.node().offsetTop;t.placeholderEl.style("top",e+"px"),t.placeholderEl.style("bottom","auto"),t.trigger("dragstart"),n.dragStart(d3.event)}).on("drag",function(){t.trigger("drag"),n.drag(d3.event)}).on("end",function(){t.rightPos=t.placeholderEl.style("right"),t.topPos=t.placeholderEl.style("top"),t.trigger("dragend")});this.dragHandler.call(i),this.dragHandler.classed("vzb-hidden","small"===e),this.pinIcon.classed("vzb-hidden","small"===e),this.resize()},resize:function(){if(this.placeholderEl&&this.rootEl&&this.placeholderEl.classed("vzb-top-dialog")){this.placeholderEl.classed("notransition",!0);var t=this.getLayoutProfile();if("small"!==t){var e=parseInt(this.rootEl.style("width"),10)||0,n=parseInt(this.rootEl.style("height"),10)||0,i=parseInt(this.placeholderEl.style("width"),10)||0,r=parseInt(this.placeholderEl.style("height"),10)||0,a=parseInt(this.rightPos,10),o=parseInt(this.topPos,10),l=parseInt(this.placeholderEl.style("margin-right"),10)||0;s.isNumber(a)&&a>e-i-l&&this.rightPos&&(this.rightPos=e-i-l+"px",this.isOpen&&this.placeholderEl.style("right",this.rightPos)),s.isNumber(o)&&s.isNumber(r)&&o>=0&&o>n-r&&this.topPos&&(this.topPos=(n-r>0?n-r:0)+"px",this.isOpen&&this.placeholderEl.style("top",this.topPos)),this.topPos&&"large"===this.getLayoutProfile()&&this.rootEl.classed("vzb-dialog-expand-true")&&this.placeholderEl.style("bottom","auto"),this.rootEl.classed("vzb-landscape"),this.element.style("max-height","")}else this.rightPos="",this.topPos="",this.placeholderEl.attr("style","");this.dragHandler.classed("vzb-hidden","small"===t),this.pinIcon.classed("vzb-hidden","small"===t),this._setMaxHeight()}},_setMaxHeight:function(){var t=this.root.element.offsetHeight;if("small"!==this.getLayoutProfile())if(!this.topPos&&"large"===this.getLayoutProfile()&&this.rootEl.classed("vzb-dialog-expand-true")){var e=parseInt(this.placeholderEl.style("bottom"),10);t-=e}else{var n=this.topPos?parseInt(this.topPos,10):this.placeholderEl.node().offsetTop;t-=n}else t=this.rootEl.classed("vzb-portrait")?t-50:t-10;this.element.style("max-height",t+"px");var i=t-this.titleEl.node().offsetHeight-this.buttonsEl.node().offsetHeight;this.contentEl.style("max-height",i+"px")},beforeOpen:function(){var t=this;if(this.transitionEvents.forEach(function(e){t.placeholderEl.on(e,t.transitionEnd.bind(t,e))}),this.placeholderEl.classed("notransition",!0),this.placeholderEl.style("top",""),this.placeholderEl.style("bottom",""),this.topPos&&"large"===this.getLayoutProfile()&&this.rootEl.classed("vzb-dialog-expand-true")){var e=this.placeholderEl.node().offsetTop;this.placeholderEl.style("top",e+"px"),this.placeholderEl.style("bottom","auto")}else this.getLayoutProfile();this.placeholderEl.node().offsetTop,this.placeholderEl.classed("notransition",!1),"small"===this.getLayoutProfile()?this.placeholderEl.style("top",""):this.rootEl.classed("vzb-landscape")},open:function(){this.isOpen=!0,"small"!==this.getLayoutProfile()&&this.topPos&&(this.placeholderEl.style("top",this.topPos),this.placeholderEl.style("right",this.rightPos))},beforeClose:function(){this.rootEl.classed("vzb-portrait")&&"small"===this.getLayoutProfile()&&this.placeholderEl.style("top","auto"),"large"===this.getLayoutProfile()&&this.rootEl.classed("vzb-dialog-expand-true")&&(this.topPos0=this.topPos?this.placeholderEl.node().parentNode.offsetHeight-this.placeholderEl.node().offsetHeight+"px":""),this.placeholderEl.classed("notransition",!1),this.placeholderEl.node().offsetHeight},close:function(){this.rootEl.classed("vzb-portrait")&&"small"===this.getLayoutProfile()||(this.placeholderEl.style("top",""),this.placeholderEl.style("right","")),"large"===this.getLayoutProfile()&&this.rootEl.classed("vzb-dialog-expand-true")&&(this.placeholderEl.style("top",this.topPos0),this.placeholderEl.style("right","")),this.isOpen=!1,this.trigger("close")},transitionEnd:function(t){var e=this;this.transitionEvents.forEach(function(t){e.placeholderEl.on(t,null)}),this.isOpen&&this.placeholderEl.classed("notransition",!0)}});e.default=f},function(t,e,n){var i=n(27);t.exports=function(t){return Object(i(t))}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var i=n(9),r=n(38);t.exports=n(8)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var i=n(3),r=n(15),a=n(14),s=n(39)("src"),o=Function.toString,l=(""+o).split("toString");n(25).inspectSource=function(t){return o.call(t)},(t.exports=function(t,e,n,o){var c="function"==typeof n;c&&(a(n,"name")||r(n,"name",e)),t[e]!==n&&(c&&(a(n,s)||r(n,s,t[e]?""+t[e]:l.join(String(e)))),t===i?t[e]=n:o?t[e]?t[e]=n:r(t,e,n):(delete t[e],r(t,e,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[s]||o.call(this)})},function(t,e,n){var i=n(0),r=n(4),a=n(27),s=/"/g,o=function(t,e,n,i){var r=String(a(t)),o="<"+e;return""!==n&&(o+=" "+n+'="'+String(i).replace(s,"&quot;")+'"'),o+">"+r+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(o),i(i.P+i.F*r(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",n)}},function(t,e,n){var i=n(56),r=n(27);t.exports=function(t){return i(r(t))}},function(t,e,n){var i=n(57),r=n(38),a=n(18),s=n(26),o=n(14),l=n(109),c=Object.getOwnPropertyDescriptor;e.f=n(8)?c:function(t,e){if(t=a(t),e=s(e,!0),l)try{return c(t,e)}catch(t){}if(o(t,e))return r(!i.f.call(t,e),t[e])}},function(t,e,n){var i=n(14),r=n(12),a=n(80)("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,a)?t[a]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.paintbrush='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M1615 0q70 0 122.5 46.5t52.5 116.5q0 63-45 151-332 629-465 752-97 91-218 91-126 0-216.5-92.5t-90.5-219.5q0-128 92-212l638-579q59-54 130-54zm-909 1034q39 76 106.5 130t150.5 76l1 71q4 213-129.5 347t-348.5 134q-123 0-218-46.5t-152.5-127.5-86.5-183-29-220q7 5 41 30t62 44.5 59 36.5 46 17q41 0 55-37 25-66 57.5-112.5t69.5-76 88-47.5 103-25.5 125-10.5z"/></svg>',e.search='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M1216 832q0-185-131.5-316.5t-316.5-131.5-316.5 131.5-131.5 316.5 131.5 316.5 316.5 131.5 316.5-131.5 131.5-316.5zm512 832q0 52-38 90t-90 38q-54 0-90-38l-343-342q-179 124-399 124-143 0-273.5-55.5t-225-150-150-225-55.5-273.5 55.5-273.5 150-225 225-150 273.5-55.5 273.5 55.5 225 150 150 225 55.5 273.5q0 220-124 399l343 343q37 37 37 90z"/></svg>',e.circle='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M1664 896q0 209-103 385.5t-279.5 279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5 385.5-103 385.5 103 279.5 279.5 103 385.5z"/></svg>',e.expand='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M883 1056q0 13-10 23l-332 332 144 144q19 19 19 45t-19 45-45 19h-448q-26 0-45-19t-19-45v-448q0-26 19-45t45-19 45 19l144 144 332-332q10-10 23-10t23 10l114 114q10 10 10 23zm781-864v448q0 26-19 45t-45 19-45-19l-144-144-332 332q-10 10-23 10t-23-10l-114-114q-10-10-10-23t10-23l332-332-144-144q-19-19-19-45t19-45 45-19h448q26 0 45 19t19 45z"/></svg>',e.asterisk='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M1546 1050q46 26 59.5 77.5t-12.5 97.5l-64 110q-26 46-77.5 59.5t-97.5-12.5l-266-153v307q0 52-38 90t-90 38h-128q-52 0-90-38t-38-90v-307l-266 153q-46 26-97.5 12.5t-77.5-59.5l-64-110q-26-46-12.5-97.5t59.5-77.5l266-154-266-154q-46-26-59.5-77.5t12.5-97.5l64-110q26-46 77.5-59.5t97.5 12.5l266 153v-307q0-52 38-90t90-38h128q52 0 90 38t38 90v307l266-153q46-26 97.5-12.5t77.5 59.5l64 110q26 46 12.5 97.5t-59.5 77.5l-266 154z"/></svg>',e.trails='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M 1381.375 17.1875 C 1375.7825 17.176804 1370.1216 17.316078 1364.4375 17.5625 C 1273.4913 21.505489 1197.0982 57.199956 1135.2188 124.6875 C 1076.5961 188.62338 1047.6964 263.96059 1048.5312 350.65625 L 835.71875 433 C 797.77288 391.67699 749.96961 361.96416 692.3125 343.84375 C 604.96227 316.39162 520.95691 323.70366 440.25 365.8125 C 359.5432 407.92133 305.45225 472.64985 278 560 C 250.54783 647.35004 257.89117 731.38694 300 812.09375 C 342.10886 892.80075 406.83755 946.89147 494.1875 974.34375 C 576.9404 1000.3512 657.38873 994.58645 735.5625 957.09375 L 959.28125 1171.4375 L 972.375 1184.4062 C 966.2931 1198.3454 961.94845 1209.2226 959.34375 1217.0625 C 956.73915 1224.9024 953.7186 1236.224 950.25 1251.0312 L 711.03125 1285.1875 C 669.59175 1209.0324 607.72526 1157.2863 525.40625 1129.9375 C 438.51381 1101.0693 354.34933 1107.021 272.96875 1147.8125 C 191.58796 1188.6039 136.49335 1252.4513 107.625 1339.3438 C 78.756758 1426.2362 84.708528 1510.3694 125.5 1591.75 C 166.29138 1673.1307 230.1387 1728.2567 317.03125 1757.125 C 403.92369 1785.9933 488.05682 1780.0415 569.4375 1739.25 C 650.81799 1698.4587 705.94425 1634.6111 734.8125 1547.7188 C 737.41718 1539.8788 740.43763 1528.5573 743.90625 1513.75 L 983.125 1479.5938 C 1024.5644 1555.7487 1086.4309 1607.4948 1168.75 1634.8438 C 1255.6425 1663.7119 1339.8069 1657.7603 1421.1875 1616.9688 C 1502.5682 1576.1772 1557.6631 1512.3299 1586.5312 1425.4375 C 1615.3996 1338.5451 1609.4477 1254.4119 1568.6562 1173.0312 C 1527.8647 1091.6506 1464.0174 1036.5244 1377.125 1007.6562 C 1294.9259 980.34721 1214.5066 984.74084 1135.8438 1020.8125 L 1120.2812 1005.9062 L 898.0625 785.96875 C 902.79653 774.40321 906.33847 765.03422 908.5 758.15625 C 920.42249 720.22 925.7916 682.90194 924.59375 646.21875 L 1130.9688 566.34375 C 1141.2015 577.59424 1149.3796 586.0106 1155.4688 591.59375 C 1222.9566 653.47326 1302.1474 682.44278 1393.0938 678.5 C 1484.04 674.55731 1560.4642 638.83151 1622.3438 571.34375 C 1684.2232 503.85591 1713.1929 424.6337 1709.25 333.6875 C 1705.3072 242.74139 1669.5816 166.34819 1602.0938 104.46875 C 1538.8238 46.456824 1465.2625 17.347946 1381.375 17.1875 z "/></svg>',e.lock='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M640 768h512v-192q0-106-75-181t-181-75-181 75-75 181v192zm832 96v576q0 40-28 68t-68 28h-960q-40 0-68-28t-28-68v-576q0-40 28-68t68-28h32v-192q0-184 132-316t316-132 316 132 132 316v192h32q40 0 68 28t28 68z"/></svg>',e.unlock='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M1376 768q40 0 68 28t28 68v576q0 40-28 68t-68 28h-960q-40 0-68-28t-28-68v-576q0-40 28-68t68-28h32v-320q0-185 131.5-316.5t316.5-131.5 316.5 131.5 131.5 316.5q0 26-19 45t-45 19h-64q-26 0-45-19t-19-45q0-106-75-181t-181-75-181 75-75 181v320h736z"/></svg>',e.unexpand='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M896 960v448q0 26-19 45t-45 19-45-19l-144-144-332 332q-10 10-23 10t-23-10l-114-114q-10-10-10-23t10-23l332-332-144-144q-19-19-19-45t19-45 45-19h448q26 0 45 19t19 45zm755-672q0 13-10 23l-332 332 144 144q19 19 19 45t-19 45-45 19h-448q-26 0-45-19t-19-45v-448q0-26 19-45t45-19 45 19l144 144 332-332q10-10 23-10t23 10l114 114q10 10 10 23z"/></svg>',e.axes='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 500"><path d="M430.25,379.655l-75.982-43.869v59.771H120.73V151.966h59.774l-43.869-75.983L92.767,0L48.898,75.983L5.029,151.966h59.775 v271.557c0,15.443,12.52,27.965,27.963,27.965h261.5v59.773l75.982-43.869l75.982-43.867L430.25,379.655z"/></svg>',e.gear='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M1152 896q0-106-75-181t-181-75-181 75-75 181 75 181 181 75 181-75 75-181zm512-109v222q0 12-8 23t-20 13l-185 28q-19 54-39 91 35 50 107 138 10 12 10 25t-9 23q-27 37-99 108t-94 71q-12 0-26-9l-138-108q-44 23-91 38-16 136-29 186-7 28-36 28h-222q-14 0-24.5-8.5t-11.5-21.5l-28-184q-49-16-90-37l-141 107q-10 9-25 9-14 0-25-11-126-114-165-168-7-10-7-23 0-12 8-23 15-21 51-66.5t54-70.5q-27-50-41-99l-183-27q-13-2-21-12.5t-8-23.5v-222q0-12 8-23t19-13l186-28q14-46 39-92-40-57-107-138-10-12-10-24 0-10 9-23 26-36 98.5-107.5t94.5-71.5q13 0 26 10l138 107q44-23 91-38 16-136 29-186 7-28 36-28h222q14 0 24.5 8.5t11.5 21.5l28 184q49 16 90 37l142-107q9-9 24-9 13 0 25 10 129 119 165 170 7 8 7 22 0 12-8 23-15 21-51 66.5t-54 70.5q26 50 41 98l183 28q13 2 21 12.5t8 23.5z"/></svg>',e.stack='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 54.849 54.849"><g><path d="M54.497,39.614l-10.363-4.49l-14.917,5.968c-0.537,0.214-1.165,0.319-1.793,0.319c-0.627,0-1.254-0.104-1.79-0.318     l-14.921-5.968L0.351,39.614c-0.472,0.203-0.467,0.524,0.01,0.716L26.56,50.81c0.477,0.191,1.251,0.191,1.729,0L54.488,40.33     C54.964,40.139,54.969,39.817,54.497,39.614z"/><path d="M54.497,27.512l-10.364-4.491l-14.916,5.966c-0.536,0.215-1.165,0.321-1.792,0.321c-0.628,0-1.256-0.106-1.793-0.321     l-14.918-5.966L0.351,27.512c-0.472,0.203-0.467,0.523,0.01,0.716L26.56,38.706c0.477,0.19,1.251,0.19,1.729,0l26.199-10.479     C54.964,28.036,54.969,27.716,54.497,27.512z"/><path d="M0.361,16.125l13.662,5.465l12.537,5.015c0.477,0.191,1.251,0.191,1.729,0l12.541-5.016l13.658-5.463     c0.477-0.191,0.48-0.511,0.01-0.716L28.277,4.048c-0.471-0.204-1.236-0.204-1.708,0L0.351,15.41     C-0.121,15.614-0.116,15.935,0.361,16.125z"/></g></svg>',e.drag='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M896 384q-53 0-90.5 37.5t-37.5 90.5v128h-32v-93q0-48-32-81.5t-80-33.5q-46 0-79 33t-33 79v429l-32-30v-172q0-48-32-81.5t-80-33.5q-46 0-79 33t-33 79v224q0 47 35 82l310 296q39 39 39 102 0 26 19 45t45 19h640q26 0 45-19t19-45v-25q0-41 10-77l108-436q10-36 10-77v-246q0-48-32-81.5t-80-33.5q-46 0-79 33t-33 79v32h-32v-125q0-40-25-72.5t-64-40.5q-14-2-23-2-46 0-79 33t-33 79v128h-32v-122q0-51-32.5-89.5t-82.5-43.5q-5-1-13-1zm0-128q84 0 149 50 57-34 123-34 59 0 111 27t86 76q27-7 59-7 100 0 170 71.5t70 171.5v246q0 51-13 108l-109 436q-6 24-6 71 0 80-56 136t-136 56h-640q-84 0-138-58.5t-54-142.5l-308-296q-76-73-76-175v-224q0-99 70.5-169.5t169.5-70.5q11 0 16 1 6-95 75.5-160t164.5-65q52 0 98 21 72-69 174-69z"/></svg>',e.warn='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512.209 512.209"><path d="M507.345,439.683L288.084,37.688c-3.237-5.899-7.71-10.564-13.429-13.988c-5.705-3.427-11.893-5.142-18.554-5.142   s-12.85,1.718-18.558,5.142c-5.708,3.424-10.184,8.089-13.418,13.988L4.859,439.683c-6.663,11.998-6.473,23.989,0.57,35.98   c3.239,5.517,7.664,9.897,13.278,13.128c5.618,3.237,11.66,4.859,18.132,4.859h438.529c6.479,0,12.519-1.622,18.134-4.859   c5.62-3.23,10.038-7.611,13.278-13.128C513.823,463.665,514.015,451.681,507.345,439.683z M292.655,411.132   c0,2.662-0.91,4.897-2.71,6.704c-1.807,1.811-3.949,2.71-6.427,2.71h-54.816c-2.474,0-4.616-0.899-6.423-2.71   c-1.809-1.807-2.713-4.042-2.713-6.704v-54.248c0-2.662,0.905-4.897,2.713-6.704c1.807-1.811,3.946-2.71,6.423-2.71h54.812   c2.479,0,4.62,0.899,6.428,2.71c1.803,1.807,2.71,4.042,2.71,6.704v54.248H292.655z M292.088,304.357   c-0.198,1.902-1.198,3.47-3.001,4.709c-1.811,1.238-4.046,1.854-6.711,1.854h-52.82c-2.663,0-4.947-0.62-6.849-1.854   c-1.908-1.243-2.858-2.807-2.858-4.716l-4.853-130.47c0-2.667,0.953-4.665,2.856-5.996c2.474-2.093,4.758-3.14,6.854-3.14h62.809   c2.098,0,4.38,1.043,6.854,3.14c1.902,1.331,2.851,3.14,2.851,5.424L292.088,304.357z"/></svg>',e.pin='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M800 864v-448q0-14-9-23t-23-9-23 9-9 23v448q0 14 9 23t23 9 23-9 9-23zm672 352q0 26-19 45t-45 19h-429l-51 483q-2 12-10.5 20.5t-20.5 8.5h-1q-27 0-32-27l-76-485h-404q-26 0-45-19t-19-45q0-123 78.5-221.5t177.5-98.5v-512q-52 0-90-38t-38-90 38-90 90-38h640q52 0 90 38t38 90-38 90-90 38v512q99 0 177.5 98.5t78.5 221.5z"/></svg>',e.question='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="17 17 483 483"> <circle stroke-width="40" cx="258.57" cy="258.57" r="220"/> <path d="M299.756,413.021v-61.78c0-3.003-0.966-5.472-2.896-7.401s-4.398-2.896-7.401-2.896h-61.78 c-3.003,0-5.47,0.965-7.4,2.896c-1.932,1.931-2.896,4.398-2.896,7.401v61.78c0,3.002,0.965,5.47,2.896,7.399 c1.931,1.931,4.396,2.896,7.4,2.896h61.779c3.003,0,5.472-0.967,7.401-2.896S299.756,416.021,299.756,413.021z"/> <path d="M382.128,196.789c0-18.877-5.952-36.36-17.856-52.449c-11.905-16.088-26.762-28.53-44.566-37.325 c-17.804-8.795-36.037-13.192-54.7-13.192c-52.127,0-91.919,22.845-119.377,68.537c-3.218,5.148-2.359,9.653,2.574,13.514 l42.474,32.177c1.502,1.287,3.54,1.931,6.114,1.931c3.433,0,6.115-1.287,8.044-3.861c11.369-14.587,20.594-24.454,27.672-29.603 c7.294-5.148,16.519-7.723,27.673-7.723c10.297,0,19.468,2.789,27.513,8.366c8.044,5.578,12.065,11.906,12.065,18.985 c0,8.151-2.146,14.694-6.437,19.628c-4.29,4.934-11.583,9.76-21.881,14.479c-13.514,6.006-25.901,15.284-37.164,27.834 c-11.263,12.549-16.894,26.01-16.894,40.382v11.583c0,3.004,0.965,5.472,2.896,7.401c1.931,1.93,4.396,2.896,7.4,2.896h61.779 c3.003,0,5.471-0.965,7.401-2.896c1.93-1.931,2.896-4.397,2.896-7.401c0-4.075,2.306-9.385,6.917-15.928 c4.612-6.542,10.458-11.852,17.537-15.927c6.863-3.861,12.119-6.918,15.768-9.171c3.646-2.252,8.579-6.008,14.802-11.263 c6.22-5.255,10.993-10.402,14.317-15.443c3.325-5.042,6.328-11.53,9.01-19.467C380.788,214.916,382.128,206.228,382.128,196.789z"/> </svg>',e.close='<svg class="vzb-icon vzb-icon-pin" viewBox="-150 -250 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1149 414q0 26 -19 45l-181 181l181 181q19 19 19 45q0 27 -19 46l-90 90q-19 19 -46 19q-26 0 -45 -19l-181 -181l-181 181q-19 19 -45 19q-27 0 -46 -19l-90 -90q-19 -19 -19 -46q0 -26 19 -45l181 -181l-181 -181q-19 -19 -19 -45q0 -27 19 -46l90 -90q19 -19 46 -19 q26 0 45 19l181 181l181 -181q19 -19 45 -19q27 0 46 19l90 90q19 19 19 46z"/></svg>',e.presentation='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path id="flip-chart-1" d="M334.549,393.834l58.607,68.666h-45.096l-58.709-68.666H334.549z M240.333,462.5h34.333v-68.666h-34.333 V462.5z M360.5,153.5h-34.334v137.334H360.5V153.5z M121.566,462.5h45.113l58.709-68.666h-45.197L121.566,462.5z M206,273.666 h-34.333v17.168H206V273.666z M257.5,239.333h-34.333v51.5H257.5V239.333z M309,205h-34.334v85.834H309V205z M446.334,102h-17.168 v257.5H85.833V102H68.667V50.5h377.667V102z M394.834,102H120.167v223.166h274.667V102z"/></svg>',e.about='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1792 1792"><path d="M1088 1256v240q0 16-12 28t-28 12h-240q-16 0-28-12t-12-28v-240q0-16 12-28t28-12h240q16 0 28 12t12 28zm316-600q0 54-15.5 101t-35 76.5-55 59.5-57.5 43.5-61 35.5q-41 23-68.5 65t-27.5 67q0 17-12 32.5t-28 15.5h-240q-15 0-25.5-18.5t-10.5-37.5v-45q0-83 65-156.5t143-108.5q59-27 84-56t25-76q0-42-46.5-74t-107.5-32q-65 0-108 29-35 25-107 115-13 16-31 16-12 0-25-8l-164-125q-13-10-15.5-25t5.5-28q160-266 464-266 80 0 161 31t146 83 106 127.5 41 158.5z"/></svg>',e.cursorArrow='<svg class="vzb-icon" viewBox="-200 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1389 1043q31 30 14 69-17 40-59 40h-382l201 476q10 25 0 49t-34 35l-177 75q-25 10-49 0t-35-34l-191-452-312 312q-19 19-45 19-12 0-24-5-40-17-40-59v-1504q0-42 40-59 12-5 24-5 27 0 45 19z"/></svg>',e.cursorPlus='<svg class="vzb-icon" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1088 800v64q0 13-9.5 22.5t-22.5 9.5h-224v224q0 13-9.5 22.5t-22.5 9.5h-64q-13 0-22.5-9.5t-9.5-22.5v-224h-224q-13 0-22.5-9.5t-9.5-22.5v-64q0-13 9.5-22.5t22.5-9.5h224v-224q0-13 9.5-22.5t22.5-9.5h64q13 0 22.5 9.5t9.5 22.5v224h224q13 0 22.5 9.5t9.5 22.5zm128 32q0-185-131.5-316.5t-316.5-131.5-316.5 131.5-131.5 316.5 131.5 316.5 316.5 131.5 316.5-131.5 131.5-316.5zm512 832q0 53-37.5 90.5t-90.5 37.5q-54 0-90-38l-343-342q-179 124-399 124-143 0-273.5-55.5t-225-150-150-225-55.5-273.5 55.5-273.5 150-225 225-150 273.5-55.5 273.5 55.5 225 150 150 225 55.5 273.5q0 220-124 399l343 343q37 37 37 90z"/></svg>',e.cursorMinus='<svg class="vzb-icon" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1088 800v64q0 13-9.5 22.5t-22.5 9.5h-576q-13 0-22.5-9.5t-9.5-22.5v-64q0-13 9.5-22.5t22.5-9.5h576q13 0 22.5 9.5t9.5 22.5zm128 32q0-185-131.5-316.5t-316.5-131.5-316.5 131.5-131.5 316.5 131.5 316.5 316.5 131.5 316.5-131.5 131.5-316.5zm512 832q0 53-37.5 90.5t-90.5 37.5q-54 0-90-38l-343-342q-179 124-399 124-143 0-273.5-55.5t-225-150-150-225-55.5-273.5 55.5-273.5 150-225 225-150 273.5-55.5 273.5 55.5 225 150 150 225 55.5 273.5q0 220-124 399l343 343q37 37 37 90z"/></svg>',e.hundredPercent='<svg class="vzb-icon" xmlns="http://www.w3.org/2000/svg"><g transform="translate(18 11)"><text transform="scale(0.9 1)" x="0" y="0">100</text><text transform="scale(0.6 1)" class="percent" x="0" y="0">%</text></g></svg>',e.percent='<svg class="vzb-icon" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1408 1280q0-52-38-90t-90-38-90 38-38 90 38 90 90 38 90-38 38-90zm-768-768q0-52-38-90t-90-38-90 38-38 90 38 90 90 38 90-38 38-90zm1024 768q0 159-112.5 271.5t-271.5 112.5-271.5-112.5-112.5-271.5 112.5-271.5 271.5-112.5 271.5 112.5 112.5 271.5zm-96-1088q0 20-13 38l-1056 1408q-19 26-51 26h-160q-26 0-45-19t-19-45q0-20 13-38l1056-1408q19-26 51-26h160q26 0 45 19t19 45zm-672 320q0 159-112.5 271.5t-271.5 112.5-271.5-112.5-112.5-271.5 112.5-271.5 271.5-112.5 271.5 112.5 112.5 271.5z"/></svg>',e.side='<svg class="vzb-icon" viewBox="-120 -1540 1792 1792" xmlns="http://www.w3.org/2000/svg"><path transform="rotate(-90) scale(1.2)" d="M1024 448q0 -26 -19 -45l-448 -448q-19 -19 -45 -19t-45 19l-448 448q-19 19 -19 45t19 45t45 19h896q26 0 45 -19t19 -45zM1024 832q0 -26 -19 -45t-45 -19h-896q-26 0 -45 19t-19 45t19 45l448 448q19 19 45 19t45 -19l448 -448q19 -19 19 -45z"/></svg>',e.cursorHand='<svg class="vzb-icon" viewBox="0 -1540 1792 1792" xmlns="http://www.w3.org/2000/svg"><path transform="scale(1,-1)" d="M880 1408q-46 0 -79 -33t-33 -79v-656h-32v528q0 46 -33 79t-79 33t-79 -33t-33 -79v-528v-256l-154 205q-38 51 -102 51q-53 0 -90.5 -37.5t-37.5 -90.5q0 -43 26 -77l384 -512q38 -51 102 -51h688q34 0 61 22t34 56l76 405q5 32 5 59v498q0 46 -33 79t-79 33t-79 -33t-33 -79v-272h-32v528q0 46 -33 79t-79 33t-79 -33t-33 -79v-528h-32v656q0 46 -33 79t-79 33zM880 1536q68 0 125.5 -35.5t88.5 -96.5q19 4 42 4q99 0 169.5 -70.5t70.5 -169.5v-17q105 6 180.5 -64t75.5 -175v-498q0 -40 -8 -83l-76 -404q-14 -79 -76.5 -131t-143.5 -52h-688q-60 0 -114.5 27.5t-90.5 74.5l-384 512q-51 68 -51 154q0 106 75 181t181 75q78 0 128 -34v434q0 99 70.5 169.5t169.5 70.5q23 0 42 -4q31 61 88.5 96.5t125.5 35.5z"/></svg>'},function(t,e,n){var i=n(13);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){"use strict";var i=n(4);t.exports=function(t,e){return!!t&&i(function(){e?t.call(null,function(){},1):t.call(null)})}},function(t,e){var n=t.exports={version:"2.5.1"};"number"==typeof __e&&(__e=n)},function(t,e,n){var i=n(6);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e,n){var i=n(0),r=n(25),a=n(4);t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],s={};s[t]=e(n),i(i.S+i.F*a(function(){n(1)}),"Object",s)}},function(t,e,n){var i=n(22),r=n(56),a=n(12),s=n(10),o=n(97);t.exports=function(t,e){var n=1==t,l=2==t,c=3==t,u=4==t,h=6==t,d=5==t||h,f=e||o;return function(e,o,p){for(var v,g,m=a(e),b=r(m),_=i(o,p,3),y=s(b.length),M=0,w=n?f(e,y):l?f(e,0):void 0;y>M;M++)if((d||M in b)&&(v=b[M],g=_(v,M,m),t))if(n)w[M]=g;else if(g)switch(t){case 3:return!0;case 5:return v;case 6:return M;case 2:w.push(v)}else if(u)return!1;return h?-1:c||u?u:w}}},function(t,e,n){"use strict";function i(t,e){function n(){this.trackInstances&&n.instances.push(this),!a&&this.init&&this.init.apply(this,arguments)}e=1===arguments.length?t:e;var o=this.prototype;a=!0;var l=new this;return a=!1,(0,r.forEach)(e,function(t,n){"function"==typeof e[n]&&"function"==typeof o[n]&&s.test(e[n])?l[n]=function(t,e){return function(){var n=this._super;this._super=o[t];var i=e.apply(this,arguments);return this._super=n,i}}(n,e[n]):l[n]=t}),n.prototype=l,n.prototype.constructor=n,n.extend=i,n._collection={},n.instances=[],n.register=function(t,e){void 0!==this._collection[t]&&(0,r.warn)('"'+t+'" is already registered. Overwriting...'),this._collection[t]=e},n.unregister=function(t){this._collection[t]=void 0},n.getCollection=function(){return this._collection},n.define=function(t,e){this.prototype[t]=e},n.get=function(t,e){return this._collection.hasOwnProperty(t)?this._collection[t]:(e||(0,r.warn)('"'+t+'" was not found.'),!1)},arguments.length>1&&this.register&&this.register(t,n),n}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=!1,s=/xyz/.test(function(){})?/\b_super\b/:/.*/,o=function(){};o.extend=i,e.default=o},function(t,e,n){"use strict";if(n(8)){var i=n(40),r=n(3),a=n(4),s=n(0),o=n(71),l=n(103),c=n(22),u=n(46),h=n(38),d=n(15),f=n(48),p=n(28),v=n(10),g=n(135),m=n(42),b=n(26),_=n(14),y=n(58),M=n(6),w=n(12),x=n(94),S=n(43),z=n(20),O=n(44).f,E=n(96),k=n(39),T=n(7),P=n(30),D=n(62),L=n(69),C=n(99),A=n(53),I=n(66),R=n(45),j=n(98),N=n(125),q=n(9),F=n(19),H=q.f,B=F.f,V=r.RangeError,W=r.TypeError,Y=r.Uint8Array,U=Array.prototype,G=l.ArrayBuffer,X=l.DataView,K=P(0),Q=P(2),$=P(3),J=P(4),Z=P(5),tt=P(6),et=D(!0),nt=D(!1),it=C.values,rt=C.keys,at=C.entries,st=U.lastIndexOf,ot=U.reduce,lt=U.reduceRight,ct=U.join,ut=U.sort,ht=U.slice,dt=U.toString,ft=U.toLocaleString,pt=T("iterator"),vt=T("toStringTag"),gt=k("typed_constructor"),mt=k("def_constructor"),bt=o.CONSTR,_t=o.TYPED,yt=o.VIEW,Mt=P(1,function(t,e){return Ot(L(t,t[mt]),e)}),wt=a(function(){return 1===new Y(new Uint16Array([1]).buffer)[0]}),xt=!!Y&&!!Y.prototype.set&&a(function(){new Y(1).set({})}),St=function(t,e){var n=p(t);if(n<0||n%e)throw V("Wrong offset!");return n},zt=function(t){if(M(t)&&_t in t)return t;throw W(t+" is not a typed array!")},Ot=function(t,e){if(!(M(t)&&gt in t))throw W("It is not a typed array constructor!");return new t(e)},Et=function(t,e){return kt(L(t,t[mt]),e)},kt=function(t,e){for(var n=0,i=e.length,r=Ot(t,i);i>n;)r[n]=e[n++];return r},Tt=function(t,e,n){H(t,e,{get:function(){return this._d[n]}})},Pt=function(t){var e,n,i,r,a,s,o=w(t),l=arguments.length,u=l>1?arguments[1]:void 0,h=void 0!==u,d=E(o);if(void 0!=d&&!x(d)){for(s=d.call(o),i=[],e=0;!(a=s.next()).done;e++)i.push(a.value);o=i}for(h&&l>2&&(u=c(u,arguments[2],2)),e=0,n=v(o.length),r=Ot(this,n);n>e;e++)r[e]=h?u(o[e],e):o[e];return r},Dt=function(){for(var t=0,e=arguments.length,n=Ot(this,e);e>t;)n[t]=arguments[t++];return n},Lt=!!Y&&a(function(){ft.call(new Y(1))}),Ct=function(){return ft.apply(Lt?ht.call(zt(this)):zt(this),arguments)},At={copyWithin:function(t,e){return N.call(zt(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return J(zt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return j.apply(zt(this),arguments)},filter:function(t){return Et(this,Q(zt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return Z(zt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return tt(zt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){K(zt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return nt(zt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return et(zt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ct.apply(zt(this),arguments)},lastIndexOf:function(t){return st.apply(zt(this),arguments)},map:function(t){return Mt(zt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return ot.apply(zt(this),arguments)},reduceRight:function(t){return lt.apply(zt(this),arguments)},reverse:function(){for(var t,e=this,n=zt(e).length,i=Math.floor(n/2),r=0;r<i;)t=e[r],e[r++]=e[--n],e[n]=t;return e},some:function(t){return $(zt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return ut.call(zt(this),t)},subarray:function(t,e){var n=zt(this),i=n.length,r=m(t,i);return new(L(n,n[mt]))(n.buffer,n.byteOffset+r*n.BYTES_PER_ELEMENT,v((void 0===e?i:m(e,i))-r))}},It=function(t,e){return Et(this,ht.call(zt(this),t,e))},Rt=function(t){zt(this);var e=St(arguments[1],1),n=this.length,i=w(t),r=v(i.length),a=0;if(r+e>n)throw V("Wrong length!");for(;a<r;)this[e+a]=i[a++]},jt={entries:function(){return at.call(zt(this))},keys:function(){return rt.call(zt(this))},values:function(){return it.call(zt(this))}},Nt=function(t,e){return M(t)&&t[_t]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},qt=function(t,e){return Nt(t,e=b(e,!0))?h(2,t[e]):B(t,e)},Ft=function(t,e,n){return!(Nt(t,e=b(e,!0))&&M(n)&&_(n,"value"))||_(n,"get")||_(n,"set")||n.configurable||_(n,"writable")&&!n.writable||_(n,"enumerable")&&!n.enumerable?H(t,e,n):(t[e]=n.value,t)};bt||(F.f=qt,q.f=Ft),s(s.S+s.F*!bt,"Object",{getOwnPropertyDescriptor:qt,defineProperty:Ft}),a(function(){dt.call({})})&&(dt=ft=function(){return ct.call(this)});var Ht=f({},At);f(Ht,jt),d(Ht,pt,jt.values),f(Ht,{slice:It,set:Rt,constructor:function(){},toString:dt,toLocaleString:Ct}),Tt(Ht,"buffer","b"),Tt(Ht,"byteOffset","o"),Tt(Ht,"byteLength","l"),Tt(Ht,"length","e"),H(Ht,vt,{get:function(){return this[_t]}}),t.exports=function(t,e,n,l){l=!!l;var c=t+(l?"Clamped":"")+"Array",h="get"+t,f="set"+t,p=r[c],m=p||{},b=p&&z(p),_=!p||!o.ABV,w={},x=p&&p.prototype,E=function(t,n){var i=t._d;return i.v[h](n*e+i.o,wt)},k=function(t,n,i){var r=t._d;l&&(i=(i=Math.round(i))<0?0:i>255?255:255&i),r.v[f](n*e+r.o,i,wt)},T=function(t,e){H(t,e,{get:function(){return E(this,e)},set:function(t){return k(this,e,t)},enumerable:!0})};_?(p=n(function(t,n,i,r){u(t,p,c,"_d");var a,s,o,l,h=0,f=0;if(M(n)){if(!(n instanceof G||"ArrayBuffer"==(l=y(n))||"SharedArrayBuffer"==l))return _t in n?kt(p,n):Pt.call(p,n);a=n,f=St(i,e);var m=n.byteLength;if(void 0===r){if(m%e)throw V("Wrong length!");if((s=m-f)<0)throw V("Wrong length!")}else if((s=v(r)*e)+f>m)throw V("Wrong length!");o=s/e}else o=g(n),s=o*e,a=new G(s);for(d(t,"_d",{b:a,o:f,l:s,e:o,v:new X(a)});h<o;)T(t,h++)}),x=p.prototype=S(Ht),d(x,"constructor",p)):a(function(){p(1)})&&a(function(){new p(-1)})&&I(function(t){new p,new p(null),new p(1.5),new p(t)},!0)||(p=n(function(t,n,i,r){u(t,p,c);var a;return M(n)?n instanceof G||"ArrayBuffer"==(a=y(n))||"SharedArrayBuffer"==a?void 0!==r?new m(n,St(i,e),r):void 0!==i?new m(n,St(i,e)):new m(n):_t in n?kt(p,n):Pt.call(p,n):new m(g(n))}),K(b!==Function.prototype?O(m).concat(O(b)):O(m),function(t){t in p||d(p,t,m[t])}),p.prototype=x,i||(x.constructor=p));var P=x[pt],D=!!P&&("values"==P.name||void 0==P.name),L=jt.values;d(p,gt,!0),d(x,_t,c),d(x,yt,!0),d(x,mt,p),(l?new p(1)[vt]==c:vt in x)||H(x,vt,{get:function(){return c}}),w[c]=p,s(s.G+s.W+s.F*(p!=m),w),s(s.S,c,{BYTES_PER_ELEMENT:e}),s(s.S+s.F*a(function(){m.of.call(p,1)}),c,{from:Pt,of:Dt}),"BYTES_PER_ELEMENT"in x||d(x,"BYTES_PER_ELEMENT",e),s(s.P,c,At),R(c),s(s.P+s.F*xt,c,{set:Rt}),s(s.P+s.F*!D,c,jt),i||x.toString==dt||(x.toString=dt),s(s.P+s.F*a(function(){new p(1).slice()}),c,{slice:It}),s(s.P+s.F*(a(function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()})||!a(function(){x.toLocaleString.call([1,2])})),c,{toLocaleString:Ct}),A[c]=D?P:L,i||D||d(x,pt,L)}}else t.exports=function(){}},function(t,e,n){var i=n(130),r=n(0),a=n(61)("metadata"),s=a.store||(a.store=new(n(133))),o=function(t,e,n){var r=s.get(t);if(!r){if(!n)return;s.set(t,r=new i)}var a=r.get(e);if(!a){if(!n)return;r.set(e,a=new i)}return a},l=function(t,e,n){var i=o(e,n,!1);return void 0!==i&&i.has(t)},c=function(t,e,n){var i=o(e,n,!1);return void 0===i?void 0:i.get(t)},u=function(t,e,n,i){o(n,i,!0).set(t,e)},h=function(t,e){var n=o(t,e,!1),i=[];return n&&n.forEach(function(t,e){i.push(e)}),i},d=function(t){return void 0===t||"symbol"==typeof t?t:String(t)},f=function(t){r(r.S,"Reflect",t)};t.exports={store:s,map:o,has:l,get:c,set:u,keys:h,key:d,exp:f}},function(t,e,n){var i=n(39)("meta"),r=n(6),a=n(14),s=n(9).f,o=0,l=Object.isExtensible||function(){return!0},c=!n(4)(function(){return l(Object.preventExtensions({}))}),u=function(t){s(t,i,{value:{i:"O"+ ++o,w:{}}})},h=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,i)){if(!l(t))return"F";if(!e)return"E";u(t)}return t[i].i},d=function(t,e){if(!a(t,i)){if(!l(t))return!0;if(!e)return!1;u(t)}return t[i].w},f=function(t){return c&&p.NEED&&l(t)&&!a(t,i)&&u(t),t},p=t.exports={KEY:i,NEED:!1,fastKey:h,getWeak:d,onFreeze:f}},function(t,e,n){var i=n(7)("unscopables"),r=Array.prototype;void 0==r[i]&&n(15)(r,i,{}),t.exports=function(t){r[i][t]=!0}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=n(1),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(a),o=n(55),l=i(o),c=n(50),u=(i(c),l.default.extend({_important:!1,objectLeafs:["autoconfig"],dataConnectedChildren:["use","which"],getClassDefaults:function(){var t={data:"data",which:null};return s.deepExtend(this._super(),t)},buildScale:function(){},setInterModelListeners:function(){var t=this,e=this._parent.getSpace(this);s.forEach(e,function(e){t._space[e]=t.getClosestModel(e),t._space[e].on("dataConnectedChange",t.handleDataConnectedChange.bind(t))}),this.getClosestModel("locale").on("dataConnectedChange",this.handleDataConnectedChange.bind(this))},onSuccessfullLoad:function(){this.validate(),this.buildScale(),this._super()},setWhich:function(t){var e={which:t.concept};t.dataSource&&(e.data=t.dataSource);var n=this.getClosestModel(e.data||this.data),i=n.getConceptprops(t.concept);"_default"===t.which?e.use="constant":i.use&&(e.use=i.use),i.scales&&(e.scaleType=i.scales[0]),"axis"!==this.getType()&&"size"!==this.getType()||(e.domainMin=null,e.domainMax=null,e.zoomedMin=null,e.zoomedMax=null),this.set(e)},setScaleType:function(t){this.buildScale(t)},preloadData:function(){return this.dataSource=this.getClosestModel(this.data),this._super()},afterPreload:function(){this.autoconfigureModel()},autoconfigureModel:function(){if(!this.which&&this.autoconfig){var t=this.dataSource.getConcept(this.autoconfig);t&&(this.which=t.concept),s.printAutoconfigResult(this)}},loadData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.which)return Promise.resolve();this.trigger("hook_change"),this.dataSource=this.getClosestModel(this.data);var e=this.getQuery(t.splashScreen);if(!0===e)return Promise.resolve();this._loadCall=!0,this.setReady(!1),s.timeStamp("Vizabi Model: Loading Data: "+this._id);var n=this._getAllParsers(),i=this.dataSource.load(e,n);return i.then(this.afterLoad.bind(this),function(t){return s.warn("Problem with query: ",t,JSON.stringify(e))}),i},handleDataConnectedChange:function(t){var e=this;s.defer(function(){e.startLoading().catch(s.warn)})},_isLoading:function(){return!this._loadedOnce||this._loadCall},afterLoad:function(t){this._dataId=t;var e=this._parent._getGrouping();e&&this.dataSource.setGrouping(t,e),s.timeStamp("Vizabi Model: Data loaded: "+this._id)},getQuery:function(t){var e=void 0;if(Object.keys(this._space).length<1)return s.error("Error:",this._id,"can't find the space"),!0;var n="property"===this.use||"constant"===this.use,i=n?{exceptType:"time"}:{},r=s.unique(this._getAllDimensions(i)),a=n&&r.length>1?[this.spaceRef?this._space[this.spaceRef].dim:this.which]:r;if(!(a=a.filter(function(t){return"_default"!==t}))||!a.length)return s.warn("getQuery() produced no query because no keys are available"),!0;var o={key:a,value:-1!=a.indexOf(this.which)||"constant"===this.use?[]:[this.which]},l=this._getFirstDimension({type:"time"}),c=n?"entities":"datapoints";if(e=this._getAllFilters(i,t),n&&r.length>1){var u={};e[a]&&(u[a]=e[a]),e=u}var h={};if(Object.keys(e).length>0){h.$and=[];for(var d in e){var f={};f[d]=e[d],h.$and.push(f)}}var p=this._getAllJoins(i,t);if(n&&r.length>1){var v={};p["$"+a]&&(v["$"+a]=p["$"+a]),p=v}return{language:this.getClosestModel("locale").id,from:c,animatable:l,select:o,where:h,join:p,order_by:n?["rank"]:[this._space.time.dim]}},_getAllDimensions:function(t){return this._parent._getAllDimensions(t)},_getFirstDimension:function(t){return this._parent._getFirstDimension(t)},_getAllFilters:function(t,e){t=t||{};var n={},i=this;return s.forEach(this._space,function(r){if(t.exceptType&&r.getType()===t.exceptType)return!0;if(t.onlyType&&r.getType()!==t.onlyType)return!0;if(!r.skipFilter&&!i._parent.skipFilter)if(s.arrayEquals(i._getAllDimensions(t),[r.getDimension()]))n=s.extend(n,r.getFilter(e));else{var a=r.getFilter(e);if(null!=a&&!s.isEmpty(a)){var o={};o[r.getDimension()]="$"+r.getDimension(),n=s.extend(n,o)}}}),n},_getAllJoins:function(t,e){var n={},i=this;return s.forEach(this._space,function(r){if(t.exceptType&&r.getType()===t.exceptType)return!0;if(t.onlyType&&r.getType()!==t.onlyType)return!0;if(s.arrayEquals(i._getAllDimensions(t),[r.getDimension()]))return!0;if(!r.skipFilter&&!i._parent.skipFilter){var a=r.getFilter(e);null==a||s.isEmpty(a)||(n["$"+r.getDimension()]={key:r.getDimension(),where:r.getFilter(e)})}}),n},_getAllParsers:function(){return Object.values(this._space).concat(this).reduce(function(t,e){var n=e.getParser(),i=e.getDimensionOrWhich();return n&&i&&!(i in t)&&(t[i]=n),t},{})},getTickFormatter:function(){var t=this;return function(e,n,i,r,a){if(a=t.getConceptprops().format,"share"===a&&(e*=100),s.isDate(e))return t._space.time.formatDate(e);if("time"===t.scaleType&&!s.isDate(e))return t._space.time.formatDate(new Date(e));if(s.isString(e)||!e&&0!==e)return e;if(Math.abs(e)<1e-14)return"0";var o="";if(r)return d3.format(".3r")(e);switch(Math.floor(Math.log(Math.abs(e))/Math.LN10+1e-14)){case-13:e*=1e12,o="p";break;case-10:e*=1e9,o="n";break;case-7:case-6:case-5:e*=1e6,o="";break;case-4:case-3:case-2:case-1:case 0:case 1:case 2:case 3:break;case 4:case 5:e/=1e3,o="k";break;case 6:case 7:case 8:e/=1e6,o="M";break;case 9:case 10:case 11:e/=1e9,o="B";break;case 12:case 13:case 14:e/=1e12,o="TR";break;default:return d3.format(".3s")(e).replace("G","B")}var l=d3.format(".3r")(e);return l.indexOf(".")>-1&&(l=l.replace(/0+$/,"").replace(/\.$/,"")),l+o+("percent"===a||"share"===a?"%":"")}},getScale:function(){return null==this.scale&&console.warn("scale is null"),this.scale},getUnique:function(t){if(this.isHook())return t||(t=this._getFirstDimension({type:"time"})),this.dataSource.getData(this._dataId,"unique",t)},getData:function(){return this.dataSource.getData(this._dataId)},getValidItems:function(){return this.dataSource.getData(this._dataId,"valid",this.which)},getNestedItems:function(t){return t?this.dataSource.getData(this._dataId,"nested",t):s.warn("No keys provided to getNestedItems(<keys>)")},getHaveNoDataPointsPerKey:function(){return this.dataSource.getData(this._dataId,"haveNoDataPointsPerKey",this.which)},getLimits:function(t){return this.dataSource.getData(this._dataId,"limits",t)},getFrame:function(t,e,n){return this.dataSource.getFrame(this._dataId,t,e,n)},getFrames:function(t,e){return this.dataSource.getFrames(this._dataId,t,e)},getItems:function(){var t=this,e=this.spaceRef&&this._space[this.spaceRef]?this._space[this.spaceRef].dim:t._getFirstDimension({exceptType:"time"}),n={},i=this.getValidItems();return s.isArray(i)&&i.forEach(function(i){n[i[e]]=i[t.which]}),n},getLimitsByDimensions:function(t){var e=this.dataSource.getData(this._dataId,"nested",t),n={},i=this.which,r=function(t,e,n){for(var r=t.reduce(function(t,e){var n=s.isDate(e[i])?e[i]:parseFloat(e[i]);return isNaN(n)||t.push(n),t},[]),a=void 0,o=void 0,l={},c=0;c<r.length;c+=1){var u=r[c];(void 0===a||u<a)&&(a=u),(void 0===o||u>o)&&(o=u)}l.min=a||0,l.max=o||100,e[n]=l};return function t(e,n,i,r){n--,s.forEach(e,function(e,a){n?(i[a]={},t(e,n,i[a],r)):r(e,i,a)})}(e,t.length,n,r),n},getConceptprops:function(){return"constant"!==this.use&&this.dataSource?this.dataSource.getConceptprops(this.which):{}},isDiscrete:function(){return"ordinal"===this.scaleType},validate:function(){var t=this;if(this._super(),this.which){var e=this.scaleType,n=this.getConceptprops(),i=n.scales,a=void 0===i?[]:i;this.allow&&this.allow.scales&&this.allow.scales.length>0&&(a=a.filter(function(e){return-1!=t.allow.scales.indexOf(e)}));var s=a.includes(e),o=a.includes("log")&&"genericLog"===e;if(!s&&!o&&a.length>0){var l=a,c=r(l,1),u=c[0];this.set({scaleType:"nominal"===u?"ordinal":u},null,!1)}}},getEntity:function(){return this._space[this.spaceRef||this._parent.getSpace()[0]]}}));e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(i),a=n(5),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o=n(21),l=s.default.extend({init:function(t,e){this.name="gapminder-indicatorpicker",this.template='<span class="vzb-ip-holder"><span class="vzb-ip-select"></span><span class="vzb-ip-info"></span></span>';var n=this;this.model_expects=[{name:"time",type:"time"},{name:"targetModel"},{name:"locale",type:"locale"}],this.showHoverValues=t.showHoverValues||!1,this.model_binds={"translate:locale":function(t){n.updateView()},ready:function(t){n.updateView()}},this.model_binds["change:targetModel"]=function(t,e){-1!=e.indexOf("."+n.targetProp)&&n.updateView()},this._super(t,e),this.model.targetModel.isHook()&&this.showHoverValues&&this.model.targetModel._parent.on("change:highlight",function(t,e){var i=n.model.targetModel;if(i.isHook()){var a=i._parent;if(n.showHoverValues&&"constant"!=i.use){var s=a.getHighlighted();s.length>1||(s.length?a.getFrame(n.model.time.value,function(t){if(!n._highlighted&&t){var e=n.multiDim&&!i.isDiscrete()&&i.which!==a._getFirstDimension({type:"time"}),s=e?null:i.getEntity().getDimension(),o=a.getHighlighted(s);if(o.length){var l=e?r.getValueMD(o[0],t[i._name],n.KEYS):t[i._name][o[0]];if(l&&"color"===i._type&&i.isDiscrete()){var c=i.getColorlegendMarker();c.label.getItems()[l]&&(l=c.label.getItems()[l])}n._highlightedValue=l,n._highlighted=!n._highlightedValue&&0!==n._highlightedValue||"constant"!==i.use,n.updateView()}}}):(null!==e&&"highlight"!==e?e&&(n._highlightedValue=e[i._name],n._highlighted=!n._highlightedValue&&0!==n._highlightedValue||"constant"!==i.use):n._highlighted=!1,n.updateView()))}}}),this.targetProp=t.targetProp||this.model.targetModel.isHook()?"which":this.model.targetModel.isEntities()?"dim":null},ready:function(){this.KEYS=this.model.targetModel.isHook()?r.unique(this.model.targetModel._parent._getAllDimensions({exceptType:"time"})):[],this.multiDim=this.KEYS.length>1,this.updateView()},readyOnce:function(){var t=this;this.el_select=d3.select(this.element).select(".vzb-ip-select"),this.el_select.on("click",function(){var e=t.el_select.node().getBoundingClientRect(),n=t.root.element instanceof Array?t.root.element:d3.select(t.root.element),i=n.node().getBoundingClientRect(),r=t.root.findChildByName("gapminder-treemenu"),a=r.activeProfile.col_width,s=parseInt(r.wrapper.style("padding-left"),10)||0,o=parseInt(r.wrapper.style("padding-right"),10)||0,l=e.bottom-i.top,c=e.left-i.left-.5*(s+o+a-e.width);r.targetModel(t.model.targetModel).alignX("left").alignY("top").top(l).left(c).updateView().toggle()}),this.infoEl=d3.select(this.element).select(".vzb-ip-info"),t.model.targetModel.isHook()&&(r.setIcon(this.infoEl,o.question).select("svg").attr("width","0px").attr("height","0px"),this.infoEl.on("click",function(){t.root.findChildByName("gapminder-datanotes").pin()}),this.infoEl.on("mouseover",function(){var e=t.el_select.node().getBoundingClientRect(),n=t.root.element.getBoundingClientRect(),i=e.bottom-n.top,r=e.left-n.left+e.width;t.root.findChildByName("gapminder-datanotes").setHook(t.model.targetModel._name).show().setPos(r,i)}),this.infoEl.on("mouseout",function(){t.root.findChildByName("gapminder-datanotes").hide()}))},updateView:function(){if(this._readyOnce){var t=this,e=this.model.locale.getTFunction(),n=t.model.targetModel,i=n[t.targetProp],a=n._type,s=void 0;n.isHook()?s=n.getConceptprops():r.forEach(n._root._data,function(e){"data"===e._type&&(s=e.getConceptprops(n[t.targetProp]))});var o=void 0;if(this.showHoverValues&&n.isHook()&&this._highlighted){var l=s.unit?" "+s.unit:"",c=n.getTickFormatter();o=this._highlightedValue||0===this._highlightedValue?c(this._highlightedValue)+l:e("hints/nodata")}else o="_default"===i?e("indicator/_default/"+a):s.name;this.el_select.text(o).attr("title",function(t){return this.offsetWidth<this.scrollWidth?o:null});var u=!s.description&&!s.sourceName&&!s.sourceLink;this.infoEl.classed("vzb-invisible",u)}}});e.default=l},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},function(t,e){t.exports=!1},function(t,e,n){var i=n(111),r=n(81);t.exports=Object.keys||function(t){return i(t,r)}},function(t,e,n){var i=n(28),r=Math.max,a=Math.min;t.exports=function(t,e){return t=i(t),t<0?r(t+e,0):a(t,e)}},function(t,e,n){var i=n(2),r=n(112),a=n(81),s=n(80)("IE_PROTO"),o=function(){},l=function(){var t,e=n(78)("iframe"),i=a.length;for(e.style.display="none",n(82).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;i--;)delete l.prototype[a[i]];return l()};t.exports=Object.create||function(t,e){var n;return null!==t?(o.prototype=i(t),n=new o,o.prototype=null,n[s]=t):n=l(),void 0===e?n:r(n,e)}},function(t,e,n){var i=n(111),r=n(81).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},function(t,e,n){"use strict";var i=n(3),r=n(9),a=n(8),s=n(7)("species");t.exports=function(t){var e=i[t];a&&e&&!e[s]&&r.f(e,s,{configurable:!0,get:function(){return this}})}},function(t,e){t.exports=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var i=n(22),r=n(123),a=n(94),s=n(2),o=n(10),l=n(96),c={},u={},e=t.exports=function(t,e,n,h,d){var f,p,v,g,m=d?function(){return t}:l(t),b=i(n,h,e?2:1),_=0;if("function"!=typeof m)throw TypeError(t+" is not iterable!");if(a(m)){for(f=o(t.length);f>_;_++)if((g=e?b(s(p=t[_])[0],p[1]):b(t[_]))===c||g===u)return g}else for(v=m.call(t);!(p=v.next()).done;)if((g=r(v,b,p.value,e))===c||g===u)return g};e.BREAK=c,e.RETURN=u},function(t,e,n){var i=n(16);t.exports=function(t,e,n){for(var r in e)i(t,r,e[r],n);return t}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e){Object.defineProperty(t,e,{configurable:!0,get:function(e){return function(){return t.get(e)}}(e),set:function(e){return function(n){return t.set(e,n)}}(e)})}function a(t,e,i,r){function a(t,e){i._ready&&(e=i._name+"."+e,i.trigger(t,e))}function s(t,e){i.trigger(t,e)}function o(t,e){i.setReady(!1),l.defer(function(){i.setReady()})}var c=void 0;if(!l.isPlainObject(e)||l.isArray(e)||i.isObjectLeaf(t)){c=new f(t,e,i,{change:a},r)}else{var u={change:a,hook_change:s,load_error:function(){return i.trigger.apply(i,arguments)},dataLoaded:function(){return i.trigger.apply(i,arguments)},ready:o};if(p.isModel(e,!0))c=e,c.on(u);else{var h=t.split("_")[0],d=p.get(h,!0);if(!d)try{d=n(391)("./"+h).default}catch(t){d=p}c=new d(t,e,i,u)}}return c}function s(t){return t._intervals||(t._parent?s(t._parent):new d.default)}Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(o),c=n(50),u=i(c),h=n(390),d=i(h),f=u.default.extend({_name:"",_parent:null,_persistent:!0,init:function(t,e,n,i,r){Object.defineProperty(this,"value",{get:this.get,set:this.set}),Object.defineProperty(this,"persistent",{get:function(){return this._persistent}}),this._super(),this._name=t,this._parent=n,this._root=n._root,this.set(e,!1,r),this.on(i)},get:function(t){return t&&!this._persistent?this._persistentVal:this._val},set:function(t,e,n){return!!this.isSetAllowed(t,e)&&(n=void 0===n||n,n&&(this._persistentVal=t),this._previousVal=l.deepClone(this._val),this._val=t,this._persistent=n,this.trigger(new c.ChangeEvent(this),this._name),!0)},isSetAllowed:function(t,e){return e||this._val!==t&&JSON.stringify(this._val)!==JSON.stringify(t)},setTreeFreezer:function(t){t?this.freeze(["hook_change"]):this.unfreeze()}}),p=u.default.extend({getClassDefaults:function(){return{}},objectLeafs:[],init:function(t,e,n,i){this._type=this._type||"model",this._id=this._id||l.uniqueId("m"),this._data={},this._parent=n,this._root=n?n._root:this,this._name=t,this._ready=!1,this._readyOnce=!1,this._loadedOnce=!1,this._intervals=s(this),this._space={},this._dataId=!1,this._limits={},this._super();var r=l.deepExtend({},this.getClassDefaults(),e);this.set(r),i&&this.on(i)},get:function(t){if(t){var e=this._data[t];return p.isModel(e)?e:e.value}return this._data},set:function(t,e,n,i){var s=this._setting,o=void 0,c=!1;if(l.isPlainObject(t)?(o=t,i=n,n=e):(o={})[t]=e,0!==Object.keys(o).length){this._setting=!0,this._freeze||(c=!0,this.setTreeFreezer(!0));var u=[];for(var h in o){e=o[h];var d=l.isPlainObject(e)&&this._data[h]instanceof p,v=(!l.isPlainObject(e)||this.isObjectLeaf(h))&&this._data[h]instanceof f;if(this._data[h]&&(d||v)){var g=this._data[h].value,m=this._data[h].set(e,n,i);v&&m&&u.push(h);var b="set"+l.capitalize(h);this.isHook()&&l.isFunction(this[b])&&e!==g&&this[b]("which"===h?{concept:e,dataSource:this.data}:e)}else this._data[h]=a(h,e,this,i),r(this,h)}s||(this.checkDataChanges(u),this.validate&&this.validate()),s&&!n||(this._setting=!1,!c||this.isHook()&&this.isLoading()||this.setTreeFreezer(!1),this.isHook()||this.isLoading()||this.setReady())}},checkDataChanges:function(){},setTreeFreezer:function(t){l.forEach(this._data,function(e){e.setTreeFreezer(t)}),t?this.freeze(["hook_change"]):this.unfreeze()},getType:function(){return this._type},getSubmodels:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=t?{}:[];return l.forEach(this._data,function(i,r){i&&void 0!==i._id&&p.isModel(i)&&e(i)&&(t?n[r]=i:n.push(i))}),n},getPlainObject:function(t){var e={},n=this;return l.forEach(this._data,function(i,r){if(i instanceof p)e[r]=i.getPlainObject(t);else if(!t||i.persistent){var a=i.get(t);l.isDate(a)&&(a=n.formatDate(a)),e[r]=a}}),e},formatDate:function(t){return t.toString()},getModelObject:function(t){return t?this._data[t]:this},clear:function(){var t=this.getSubmodels();for(var e in t)t[e].clear();this.setReady(!1),this.off(),this._intervals.clearAllIntervals(),this._data={}},validate:function(){},_isLoading:function(){return!1},isLoading:function(){if(this._isLoading())return!0;var t=this.getSubmodels(),e=void 0;for(e=0;e<t.length;e+=1)if(t[e].isLoading())return!0;return!1},setReady:function(t){if(!1===t)return this._ready=!1,void(this._parent&&this._parent.setReady&&this._parent.setReady(!1));var e=this._ready;this._ready=!this.isLoading()&&!this._setting,this._ready&&e!==this._ready&&(this._readyOnce||(this._readyOnce=!0,this.trigger("readyOnce")),this.trigger("ready"))},setInterModelListeners:function(){l.forEach(this.getSubmodels(),function(t){return t.setInterModelListeners()})},startPreload:function(){var t=[];return t.push(this.preloadData()),l.forEach(this.getSubmodels(),function(e){return t.push(e.startPreload())}),Promise.all(t)},preloadData:function(){return Promise.resolve()},startLoading:function(t){var e=this,n=[];return n.push(this.loadData(t)),l.forEach(this.getSubmodels(),function(e){return n.push(e.startLoading(t))}),Promise.all(n).then(this.onSuccessfullLoad.bind(this)).catch(function(t){var n=e.getClosestModel("locale").getTFunction();e.triggerLoadError([n("crash/error"),window.navigator.userAgent,t].join("<br>"))})},loadData:function(t){return this.isHook()&&l.warn("Hook "+this._name+" is not loading because it's not extending Hook prototype."),Promise.resolve()},loadSubmodels:function(t){var e=[],n=this.getSubmodels();return l.forEach(n,function(n){e.push(n.startLoading(t))}),e.length>0?Promise.all(e):Promise.resolve()},onSuccessfullLoad:function(){var t=this;this.validate(),l.timeStamp("Vizabi Model: Model loaded: "+this._name+"("+this._id+")"),this._loadedOnce=!0,this._loadCall=!1,this.setTreeFreezer(!1),l.defer(function(){return t.setReady()})},handleLoadError:function(){throw arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getDefaultErrorMessage()},getDefaultErrorMessage:function(){return this.getClosestModel("locale").getTFunction()("connection/error")},triggerLoadError:function(t){l.error(t),this.trigger("load_error",t)},afterPreload:function(){var t=this.getSubmodels();l.forEach(t,function(t){t.afterPreload()})},isHook:function(){return Boolean(this.use)},getSubhooks:function(t){return this.getSubmodels(t,function(t){return t.isHook()})},getHookWhich:function(t){var e=[];return this.use&&this.use===t&&e.push(this.which),l.forEach(this.getSubmodels(),function(n){e=l.unique(e.concat(n.getHookWhich(t)))}),e},getIndicators:function(){return this.getHookWhich("indicator")},getProperties:function(){return this.getHookWhich("property")},getDimension:function(){return this.dim||!1},getDimensionOrWhich:function(){return this.dim||"constant"!=this.use&&this.which},getFilter:function(){return{}},mapValue:function(t){return t},getParser:function(){return null},getDefaults:function(){return l.deepExtend({},this.getClassDefaults(),this.getSubmodelDefaults())},getSubmodelDefaults:function(){var t={};return l.forEach(this.getSubmodels(!0),function(e,n){t[n]=e.getDefaults()}),t},isObjectLeaf:function(t){return-1!==this.objectLeafs.indexOf(t)},getClosestModel:function(t){var e=this.findSubmodel(t);return e||(this._parent?this._parent.getClosestModel(t):null)},findSubmodel:function(t){for(var e in this._data)if(e===t&&p.isModel(this._data[e]))return this._data[e];return null},isEntities:function(){return!1}});p.isModel=function(t,e){return t&&(t.hasOwnProperty("_data")||e&&t.hasOwnProperty("_val"))},e.default=p},function(t,e,n){"use strict";function i(t){u=!0,t&&(o.isArray(t)||(t=[t]),o.forEach(t,function(t){d[t]=!0}))}function r(){u=!1,d={};for(var t=Object.keys(h),e=0;e<t.length;e++){var n=h[t[e]];n&&n.unfreeze()}h={}}Object.defineProperty(e,"__esModule",{value:!0}),e.ChangeEvent=e.DefaultEvent=void 0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=n(1),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(s),l=n(31),c=function(t){return t&&t.__esModule?t:{default:t}}(l),u=!1,h=[],d={},f=e.DefaultEvent=c.default.extend({source:"",type:"default",init:function(t,e){this.source=t,e&&(this.type=e)}}),p=(e.ChangeEvent=f.extend("change",{type:"change",init:function(t){this._super(t)}}),c.default.extend({init:function(){this._id=this._id||o.uniqueId("e"),this._events={},this._freeze=!1,this._freezer=[],this._freezeExceptions={}},on:function(t,e,n){if(!this.splitEventParameters(t,e,n,this.on)){var i=this.traversePath(e);i&&(i._events[t]=i._events[t]||[],"function"==typeof n?i._events[t].push(n):o.warn("Can't bind event '"+t+"'. It must be a function."))}},off:function(t,e,n){if(0==arguments.length)return void(this._events={});if(!this.splitEventParameters(t,e,n,this.off)){var i=this.traversePath(e);if(i&&i._events.hasOwnProperty(t)){if(void 0===n)return void(i._events[t]=[]);var r=i._events[t].indexOf(n);r>-1?i._events[t].splice(r,1):o.warn("Could not unbind function "+n.name+". Function not in bound function list.")}}},splitEventParameters:function(t,e,n,i){var r=void 0;if(o.isArray(t)){for(r=0;r<t.length;r+=1)i.call(this,t[r],n);return!0}if(o.isObject(t)){for(r in t)i.call(this,r,t[r]);return!0}if("function"==typeof e){if(n=e,-1!==t.indexOf(":")){var a=t.split(":");t=a[0],e=a[1]}else e=void 0;return i.call(this,t,e,n),!0}if(o.isArray(e)){for(r=0;r<e.length;r+=1)i.call(this,t,e[r],n);return!0}if(n&&o.isArray(n)){for(r=0;r<n.length;r+=1)i.call(this,t,e,n[r]);return!0}return!1},traversePath:function(t){if(void 0===t||o.isArray(t)&&0==t.length)return this;if("string"==typeof t&&(t=t.split(".")),!o.isArray(t))return o.error("Path is wrong type. Path should be a string or array but is "+(void 0===t?"undefined":a(t))+"."),null;var e=t.shift();if(void 0!==this[e])return this.getModelObject(e).traversePath(t);o.warn("Can't find child \""+e+'" of the model '+this._name+".")},createEventFromType:function(t){if(t instanceof f)return t;var e=f.get(t,!0);return e?new e(this):new f(this,t)},trigger:function(t,e){var n=this,i=void 0,r=void 0;if(o.isArray(t))for(i=0,r=t.length;i<r;i+=1)this.trigger(t[i],e);else{var a=this.createEventFromType(t);if(this._events.hasOwnProperty(a.type)){var s=this;o.forEach(this._events[a.type],function(t){var i=function(){var n="Vizabi Event: "+a.type;o.timeStamp(n),t.apply(s,[a,e])};n.allowExecution(a)?i():(n._freezer.push(i),u&&!h[n._id]&&(n.freeze(),h[n._id]=n))})}}},allowExecution:function(t){return!this._freeze&&!u||u&&d.hasOwnProperty(t.type)||!u&&this._freeze&&this._freezeExceptions.hasOwnProperty(t.type)},freeze:function(t){if(this._freeze=!0,t){o.isArray(t)||(t=[t]);for(var e=0;e<t.length;e+=1)this._freezeExceptions[t[e]]=!0}},unfreeze:function(){for(this._freeze=!1,this._freezeExceptions={};this._freezer.length;){this._freezer.shift()()}},clearFrozen:function(){this._freeze=!1,this._freezeExceptions={},this._freezer=[]}}));p.freezeAll=i,p.unfreezeAll=r,e.default=p},function(t,e,n){var i=n(9).f,r=n(14),a=n(7)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,a)&&i(t,a,{configurable:!0,value:e})}},function(t,e,n){var i=n(0),r=n(27),a=n(4),s=n(84),o="["+s+"]",l="",c=RegExp("^"+o+o+"*"),u=RegExp(o+o+"*$"),h=function(t,e,n){var r={},o=a(function(){return!!s[t]()||l[t]()!=l}),c=r[t]=o?e(d):s[t];n&&(r[n]=c),i(i.P+i.F*o,"String",r)},d=h.trim=function(t,e){return t=String(r(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(u,"")),t};t.exports=h},function(t,e){t.exports={}},function(t,e,n){var i=n(6);t.exports=function(t,e){if(!i(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(r),s=n(49),o=i(s),l=n(50),c=(i(l),o.default.extend({dataConnectedChildren:[],checkDataChanges:function(t){var e=this;if(t&&this.dataConnectedChildren&&(!a.isArray(t)&&a.isObject(t)&&(t=Object.keys(t)),0!=t.length&&0!=this.dataConnectedChildren.length)){t.filter(function(t){return-1!==e.dataConnectedChildren.indexOf(t)}).length>0&&(this.trigger("dataConnectedChange"),this.startLoading())}}}));e.default=c},function(t,e,n){var i=n(23);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var i=n(23),r=n(7)("toStringTag"),a="Arguments"==i(function(){return arguments}()),s=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,n,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=s(e=Object(t),r))?n:a?i(e):"Object"==(o=i(e))&&"function"==typeof e.callee?"Arguments":o}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(i),a=n(76),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o={THUMB_HEIGHT:17,THUMB_STROKE_WIDTH:3},l={small:{},medium:{},large:{}},c=s.default.extend({init:function(t,e){this.name="singlehandleslider";var n=r.extend({},o);this.options=r.extend(n,this.options||{});var i=r.extend({},l);this.profiles=r.extend(i,this.profiles||{}),this.slider_properties=t.properties||{};var a=this.slider_properties.roundDigits;(a||0==a)&&(this.options.ROUND_DIGITS=a),this.slider_properties.domain&&(this.options.EXTENT_MIN=this.slider_properties.domain[0],this.options.EXTENT_MAX=this.slider_properties.domain[1]),this._super(t,e)},readyOnce:function(){this._super();var t=this.options,e=t.BAR_WIDTH,n=t.THUMB_HEIGHT;this.padding.top=.5*(n+t.THUMB_STROKE_WIDTH),this.padding.bottom=.5*(n+t.THUMB_STROKE_WIDTH)-e;var i=this._getComponentWidth();i<0&&(i=0),this.rescaler.domain(this.slider_properties.domain||[this.options.EXTENT_MIN,this.options.EXTENT_MAX]),this.rescaler.range(d3.range(0,i,i/(this.rescaler.domain().length-1)).concat([i])),this.sliderEl.call(this.brush.handleSize(t.THUMB_HEIGHT+t.THUMB_STROKE_WIDTH)),this.sliderEl.selectAll(".w").classed("vzb-hidden",!0),this.sliderEl.select(".selection").classed("vzb-hidden",!0),this.sliderEl.select(".overlay").lower().style("stroke-opacity","0").style("stroke-width",.5*n+"px").attr("rx",.5*e).attr("ry",.5*e),this.sliderEl.selectAll(".vzb-slider-thumb-badge").style("stroke-width",this.options.THUMB_STROKE_WIDTH+"px")},_getBrushEventListeners:function(){var t=this,e=this,n=this._super();return{start:n.start,brush:function(){!e.nonBrushChange&&d3.event.sourceEvent&&(e.slider_properties.suppressInput?e._snap(d3.event.selection):n.brush.apply(n,arguments))},end:function(){!e.nonBrushChange&&d3.event.sourceEvent&&(e.slider_properties.snapValue&&t._snap(d3.event.selection),e._setFromExtent(!0,!0))}}},_snap:function(t){var e=this.rescaler.invert(this._extentToValue(t)),n=this.rescaler.domain(),i=n[n.length-1]>n[0],r=d3.bisector(d3[i?"ascending":"descending"]).left(n,e)||1;e=(i?1:-1)*(e-n[r-1]-(n[r]-e))>0?n[r]:n[r-1],this._moveBrush(this._valueToExtent(e))},_createThumbs:function(t){var e=(this.options.BAR_WIDTH,.5*this.options.THUMB_HEIGHT),n=d3.arc().outerRadius(e).startAngle(0).endAngle(2*Math.PI);t.attr("transform","translate("+(e+.5*this.options.THUMB_STROKE_WIDTH)+","+(e+.5*this.options.THUMB_STROKE_WIDTH)+")").append("path").attr("d",n)},_resize:function(){this._super();var t=this._getComponentWidth();this.rescaler.range(d3.range(0,t||1,t/(this.rescaler.domain().length-1)||1).concat([t]))},_valueToExtent:function(t){return[this.rescaler.domain()[0],t]},_extentToValue:function(t){return t[1]},_setModel:function(t,e,n){if(this.slider_properties.suppressInput){if(this._extentToValue(t).toFixed(this.options.ROUND_DIGITS)==this.model.submodel[this.arg])return}this._super(t,e,n)}});e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(5),r=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=r.default.extend({init:function(t,e){this.template='<span class="vzb-sc-holder vzb-dialog-checkbox"><input type="checkbox"><label></label></span>';var n=this;this.name="gapminder-simplecheckbox",this.checkbox=t.checkbox,this.submodel=t.submodel,this.model_expects=[{name:"mdl"},{name:"locale",type:"locale"}],this.model_binds={"change:mdl":function(t){n.updateView()},"translate:locale":function(t){n.updateView()}};var i=this.submodel?this.submodel+":":"";this.model_binds["change:mdl."+i+this.checkbox]=function(){n.updateView()},this._super(t,e)},ready:function(){this.parentModel=this.submodel?this.model.mdl[this.submodel]:this.model.mdl,this.updateView()},readyOnce:function(){var t=this;this.element=d3.select(this.element);var e="-check-"+t._id;this.labelEl=this.element.select("label").attr("for",e),this.checkEl=this.element.select("input").attr("id",e).on("change",function(){t._setModel(d3.select(this).property("checked"))})},updateView:function(){this.translator=this.model.locale.getTFunction(),this.labelEl.text(this.translator("check/"+this.checkbox)),this.checkEl.property("checked",!!this.parentModel[this.checkbox])},_setModel:function(t){this.parentModel[this.checkbox]=t}})},function(t,e,n){var i=n(3),r=i["__core-js_shared__"]||(i["__core-js_shared__"]={});t.exports=function(t){return r[t]||(r[t]={})}},function(t,e,n){var i=n(18),r=n(10),a=n(42);t.exports=function(t){return function(e,n,s){var o,l=i(e),c=r(l.length),u=a(s,c);if(t&&n!=n){for(;c>u;)if((o=l[u++])!=o)return!0}else for(;c>u;u++)if((t||u in l)&&l[u]===n)return t||u||0;return!t&&-1}}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var i=n(23);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){var i=n(6),r=n(23),a=n(7)("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[a])?!!e:"RegExp"==r(t))}},function(t,e,n){var i=n(7)("iterator"),r=!1;try{var a=[7][i]();a.return=function(){r=!0},Array.from(a,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!r)return!1;var n=!1;try{var a=[7],s=a[i]();s.next=function(){return{done:n=!0}},a[i]=function(){return s},t(a)}catch(t){}return n}},function(t,e,n){"use strict";var i=n(2);t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){"use strict";var i=n(15),r=n(16),a=n(4),s=n(27),o=n(7);t.exports=function(t,e,n){var l=o(t),c=n(s,l,""[t]),u=c[0],h=c[1];a(function(){var e={};return e[l]=function(){return 7},7!=""[t](e)})&&(r(String.prototype,t,u),i(RegExp.prototype,l,2==e?function(t,e){return h.call(t,this,e)}:function(t){return h.call(t,this)}))}},function(t,e,n){var i=n(2),r=n(13),a=n(7)("species");t.exports=function(t,e){var n,s=i(t).constructor;return void 0===s||void 0==(n=i(s)[a])?e:r(n)}},function(t,e,n){"use strict";var i=n(3),r=n(0),a=n(16),s=n(48),o=n(34),l=n(47),c=n(46),u=n(6),h=n(4),d=n(66),f=n(51),p=n(85);t.exports=function(t,e,n,v,g,m){var b=i[t],_=b,y=g?"set":"add",M=_&&_.prototype,w={},x=function(t){var e=M[t];a(M,t,"delete"==t?function(t){return!(m&&!u(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(m&&!u(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return m&&!u(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof _&&(m||M.forEach&&!h(function(){(new _).entries().next()}))){var S=new _,z=S[y](m?{}:-0,1)!=S,O=h(function(){S.has(1)}),E=d(function(t){new _(t)}),k=!m&&h(function(){for(var t=new _,e=5;e--;)t[y](e,e);return!t.has(-0)});E||(_=e(function(e,n){c(e,_,t);var i=p(new b,e,_);return void 0!=n&&l(n,g,i[y],i),i}),_.prototype=M,M.constructor=_),(O||k)&&(x("delete"),x("has"),g&&x("get")),(k||z)&&x(y),m&&M.clear&&delete M.clear}else _=v.getConstructor(e,t,g,y),s(_.prototype,n),o.NEED=!0;return f(_,t),w[t]=_,r(r.G+r.W+r.F*(_!=b),w),m||v.setStrong(_,t,g),_}},function(t,e,n){for(var i,r=n(3),a=n(15),s=n(39),o=s("typed_array"),l=s("view"),c=!(!r.ArrayBuffer||!r.DataView),u=c,h=0,d="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(i=r[d[h++]])?(a(i.prototype,o,!0),a(i.prototype,l,!0)):u=!1;t.exports={ABV:c,CONSTR:u,TYPED:o,VIEW:l}},function(t,e,n){"use strict";t.exports=n(40)||!n(4)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete n(3)[t]})},function(t,e,n){"use strict";var i=n(0);t.exports=function(t){i(i.S,t,{of:function(){for(var t=arguments.length,e=Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},function(t,e,n){"use strict";var i=n(0),r=n(13),a=n(22),s=n(47);t.exports=function(t){i(i.S,t,{from:function(t){var e,n,i,o,l=arguments[1];return r(this),e=void 0!==l,e&&r(l),void 0==t?new this:(n=[],e?(i=0,o=a(l,arguments[2],2),s(t,!1,function(t){n.push(o(t,i++))})):s(t,!1,n.push,n),new this(n))}})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=n(1),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(a),o=n(31),l=function(t){return t&&t.__esModule?t:{default:t}}(o),c=l.default.extend({QUERY_FROM_CONCEPTS:"concepts",QUERY_FROM_DATAPOINTS:"datapoints",QUERY_FROM_ENTITIES:"entities",SCHEMA_QUERY_FROM_CONCEPTS:"concepts.schema",SCHEMA_QUERY_FROM_DATAPOINTS:"datapoints.schema",SCHEMA_QUERY_FROM_ENTITIES:"entities.schema",CONDITION_CALLBACKS:{$gt:function(t,e){return e>t},$gte:function(t,e){return e>=t},$lt:function(t,e){return e<t},$lte:function(t,e){return e<=t},$in:function(t,e){return t.includes(e)}},ERRORS:{GENERIC_ERROR:"reader/error/generic"},_name:"reader",load:function(){return Promise.resolve({rows:[],columns:[]})},read:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=this._normalizeQuery(t,n);var i=t,r=i.select,a=i.from;return this.load(n).then(function(i){var s=i.rows,o=i.columns;switch(e.ensureDataIsCorrect(i,n),!0){case a===e.SCHEMA_QUERY_FROM_CONCEPTS:return{key:["concept"],value:"concept_type"};case a===e.SCHEMA_QUERY_FROM_ENTITIES:return o.slice(0,e.keySize).map(function(t){return{key:[t]}});case a===e.SCHEMA_QUERY_FROM_DATAPOINTS:var l=o.slice(0,e.keySize+1);return o.slice(e.keySize+1).map(function(t){return{key:l,value:t}});case a===e.QUERY_FROM_CONCEPTS:return e._getConcepts(o,e._mapRows(s,t,n));case e._isDataQuery(a)&&r.key.length>0:return e._getData(s,t,n);default:return[]}}).catch(function(t){throw"[object Error]"==={}.toString.call(t)?e.error(e.ERRORS.GENERIC_ERROR,t):t})},ensureDataIsCorrect:function(){},_normalizeQuery:function(t,e){var n=Object.assign({},t),i=n.where,a=n.join;return i.$and&&(i.$and=i.$and.reduce(function(t,n){return Object.keys(n).forEach(function(i){var s=n[i];if("string"==typeof s&&s.startsWith("$")){var o=a[s].where;Object.keys(o).forEach(function(n){var i=o[n],a=e[n];t[n]=a?"object"===(void 0===i?"undefined":r(i))?Object.keys(i).reduce(function(t,e){return t[e]=a(i[e]),t},{}):a(i):i})}else{var l=e[i];t[i]=l?l(s):s}}),t},{})),n},_getConcepts:function(t,e){var n=this;return t.map(function(r,a){var o={concept:r};if(a<n.keySize)o.concept_type="entity_domain";else if(a===n.keySize)o.concept_type="time";else{o.concept_type="measure";for(var l=e.length-1;l>-1;--l)if(s.isString(e[l][r])&&""!==e[l][r]){o.concept_type="entity_set";var c=i(t,1);o.domain=c[0];break}}return o})},_getData:function(t,e,n){var r=e.order_by,a=void 0===r?[]:r,s=i(a,1),o=s[0];return this._mapRows(t,e,n).reduce(this._applyQuery(e),[]).sort(function(t,e){return t[o]-e[o]})},_isDataQuery:function(t){return[this.QUERY_FROM_DATAPOINTS,this.QUERY_FROM_ENTITIES].includes(t)},_mapRows:function(t,e,n){return t.map(this._getRowMapper(e,n))},_getRowMapper:function(t,e){var n=this;return function(i){var r=!0,a=Object.keys(i).reduce(function(a,o){if(r){var l=i[o],c=String(l).trim(),u=e[o],h=s.isString(l)?u?u(c):n._parse(c):l;h||0===h?a[o]=h:t.select.key.includes(o)&&(r=!1)}return a},{});return r&&a}},_parse:function(t){return t},_applyQuery:function(t){var e=this,n=t.select,r=t.from,a=i(n.key,1),s=a[0],o=[];return function(i,a){if(a){var l=a[s],c=r!==e.QUERY_FROM_ENTITIES||!o.includes(l);if(e._isSuitableRow(t,a)&&c){r===e.QUERY_FROM_ENTITIES&&o.push(l);var u=Object.keys(a).reduce(function(t,e){return(n.key.includes(e)||n.value.includes(e))&&(t[e]=a[e]),t},{});i.push(u)}}return i}},_isSuitableRow:function(t,e){var n=this,i=t.where;return!i.$and||Object.keys(i.$and).every(function(t){var a=i.$and[t],o=e[t];return void 0===o||("object"!==(void 0===a?"undefined":r(a))?o===a||!0===a&&s.isString(o)&&"true"===o.toLowerCase().trim()||!1===a&&s.isString(o)&&"false"===o.toLowerCase().trim():Object.keys(a).every(function(t){return n.CONDITION_CALLBACKS[t](a[t],o)}))})},error:function(t,e,n){return{code:t,message:e,payload:n}}});e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(i),a=n(5),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o={EXTENT_MIN:0,EXTENT_MAX:1,BAR_WIDTH:6,THUMB_HEIGHT:20,THUMB_STROKE_WIDTH:4,INTRO_DURATION:250,ROUND_DIGITS:2},l={small:{},medium:{},large:{}},c=s.default.extend({init:function(t,e){this.name=this.name||"brushslider";var i=r.extend({},o);this.options=r.extend(i,this.options||{});var a=r.extend({},l);this.profiles=r.extend(a,this.profiles||{}),this.template=this.template||n(398),this.arg=t.arg||"extent",this.model_expects=this.model_expects||[{name:"submodel"},{name:"locale",type:"locale"}],this.model_binds=this.model_binds||{},this.model_binds.ready||(this.model_binds.ready=this.readyHandler.bind(this)),this.model_binds["change:submodel."+this.arg]||(this.model_binds["change:submodel."+this.arg]=this.changeHandler.bind(this)),this._setModel=r.throttle(this._setModel,50),this._super(t,e)},changeHandler:function(t,e){var n=this._valueToExtent(this.model.submodel[this.arg])||[this.options.EXTENT_MIN,this.options.EXTENT_MAX];this._moveBrush(n)},readyHandler:function(t){},readyOnce:function(){var t=this;this.element=d3.select(this.element),this.sliderSvg=this.element.select(".vzb-slider-svg"),this.sliderWrap=this.sliderSvg.select(".vzb-slider-wrap"),this.sliderEl=this.sliderWrap.select(".vzb-slider").classed("vzb-slider-"+this.name,!0);var e=this.options,n=e.BAR_WIDTH,i=.5*e.THUMB_HEIGHT,r=(this.padding={top:.5*n,left:i,right:i,bottom:i+e.THUMB_STROKE_WIDTH},this._getComponentWidth()||0);r<0&&(r=0),this.rescaler=d3.scaleLinear().domain([e.EXTENT_MIN,e.EXTENT_MAX]).range([0,r]).clamp(!0),this.brushEventListeners=this._getBrushEventListeners(),this.brush=d3.brushX().handleSize(2*i+2*n).on("start",this.brushEventListeners.start).on("brush",this.brushEventListeners.brush).on("end",this.brushEventListeners.end),this.sliderThumbs=this.sliderEl.selectAll(".handle").data([{type:"w"},{type:"e"}],function(t){return t.type}).enter().append("svg").attr("class",function(t){return"handle handle--"+t.type+" "+t.type}).classed("vzb-slider-thumb",!0),this._createThumbs(this.sliderThumbs.append("g").attr("class","vzb-slider-thumb-badge")),this.sliderEl.call(t.brush),this.sliderEl.selectAll(".selection,.overlay").attr("height",n).attr("rx",.25*n).attr("ry",.25*n).attr("transform","translate(0,"+.5*-n+")"),this.on("resize",function(){t._resize(),t._updateView()})},ready:function(){this.isRTL=this.model.locale.isRTL(),this._resize(),this._updateView()},_getBrushEventListeners:function(){var t=this;return{start:function(){if(!t.nonBrushChange&&d3.event.sourceEvent){if(d3.event.selection&&d3.event.selection[0]==d3.event.selection[1]){t.sliderEl.node().__brush.selection[1][0]+=.01}t._setFromExtent(!1,!1,!1)}},brush:function(){if(!t.nonBrushChange&&d3.event.sourceEvent){if(d3.event.selection&&d3.event.selection[0]==d3.event.selection[1]){t.sliderEl.node().__brush.selection[1][0]+=.01}t._setFromExtent(!0,!1,!1)}},end:function(){!t.nonBrushChange&&d3.event.sourceEvent&&t._setFromExtent(!0,!0)}}},_createThumbs:function(t){var e=this.options.BAR_WIDTH,n=.5*this.options.THUMB_HEIGHT;t.append("path").attr("d","M"+(n+e)+" "+(n+1.5*e)+"l"+-n+" "+1.5*n+"h"+2*n+"Z")},_updateThumbs:function(t){},_updateSize:function(){var t=this._getComponentWidth()+this.padding.left+this.padding.right;this.sliderSvg.attr("height",this._getComponentHeight()+this.padding.top+this.padding.bottom).attr("width",t),this.sliderWrap.attr("transform",this.isRTL?"translate("+(t-this.padding.right)+","+this.padding.top+") scale(-1,1)":"translate("+this.padding.left+","+this.padding.top+")")},_resize:function(){this._updateSize();var t=this._getComponentWidth();this.rescaler.range([0,t])},_getComponentWidth:function(){var t=this.element.node().offsetWidth-this.padding.left-this.padding.right;return t<0?0:t},_getComponentHeight:function(){return this.options.BAR_WIDTH},_updateView:function(){this.sliderEl.call(this.brush.extent([[0,0],[this._getComponentWidth(),this._getComponentHeight()]]));var t=this._valueToExtent(this.model.submodel[this.arg])||[this.options.EXTENT_MIN,this.options.EXTENT_MAX];this._moveBrush(t)},_moveBrush:function(t){var e=t.map(this.rescaler);this.nonBrushChange=!0,this.sliderEl.call(this.brush.move,[e[0],e[1]+.01]),this.nonBrushChange=!1,this._setFromExtent(!1,!1,!1)},_valueToExtent:function(t){return t},_extentToValue:function(t){return t},_setFromExtent:function(t,e,n){var i=d3.brushSelection(this.sliderEl.node());i&&(i=[this.rescaler.invert(i[0]),this.rescaler.invert(+i[1].toFixed(1))],this._updateThumbs(i),t&&this._setModel(i,e,n))},_setModel:function(t,e,n){var i=this.options.ROUND_DIGITS;t=[+t[0].toFixed(i),+t[1].toFixed(i)];var r={};r[this.arg]=this._extentToValue(t),this.model.submodel.set(r,e,n)}});e.default=c},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var i=n(6),r=n(3).document,a=i(r)&&i(r.createElement);t.exports=function(t){return a?r.createElement(t):{}}},function(t,e,n){var i=n(3),r=n(25),a=n(40),s=n(110),o=n(9).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=a?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||o(e,t,{value:s.f(t)})}},function(t,e,n){var i=n(61)("keys"),r=n(39);t.exports=function(t){return i[t]||(i[t]=r(t))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var i=n(3).document;t.exports=i&&i.documentElement},function(t,e,n){var i=n(6),r=n(2),a=function(t,e){if(r(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{i=n(22)(Function.call,n(19).f(Object.prototype,"__proto__").set,2),i(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return a(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:a}},function(t,e){t.exports="\t\n\v\f\r \u2028\u2029\ufeff"},function(t,e,n){var i=n(6),r=n(83).set;t.exports=function(t,e,n){var a,s=e.constructor;return s!==n&&"function"==typeof s&&(a=s.prototype)!==n.prototype&&i(a)&&r&&r(t,a),t}},function(t,e,n){"use strict";var i=n(28),r=n(27);t.exports=function(t){var e=String(r(this)),n="",a=i(t);if(a<0||a==1/0)throw RangeError("Count can't be negative");for(;a>0;(a>>>=1)&&(e+=e))1&a&&(n+=e);return n}},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e){var n=Math.expm1;t.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:n},function(t,e,n){var i=n(28),r=n(27);t.exports=function(t){return function(e,n){var a,s,o=String(r(e)),l=i(n),c=o.length;return l<0||l>=c?t?"":void 0:(a=o.charCodeAt(l),a<55296||a>56319||l+1===c||(s=o.charCodeAt(l+1))<56320||s>57343?t?o.charAt(l):a:t?o.slice(l,l+2):s-56320+(a-55296<<10)+65536)}}},function(t,e,n){"use strict";var i=n(40),r=n(0),a=n(16),s=n(15),o=n(14),l=n(53),c=n(91),u=n(51),h=n(20),d=n(7)("iterator"),f=!([].keys&&"next"in[].keys()),p=function(){return this};t.exports=function(t,e,n,v,g,m,b){c(n,e,v);var _,y,M,w=function(t){if(!f&&t in O)return O[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},x=e+" Iterator",S="values"==g,z=!1,O=t.prototype,E=O[d]||O["@@iterator"]||g&&O[g],k=E||w(g),T=g?S?w("entries"):k:void 0,P="Array"==e?O.entries||E:E;if(P&&(M=h(P.call(new t)))!==Object.prototype&&M.next&&(u(M,x,!0),i||o(M,d)||s(M,d,p)),S&&E&&"values"!==E.name&&(z=!0,k=function(){return E.call(this)}),i&&!b||!f&&!z&&O[d]||s(O,d,k),l[e]=k,l[x]=p,g)if(_={values:S?k:w("values"),keys:m?k:w("keys"),entries:T},b)for(y in _)y in O||a(O,y,_[y]);else r(r.P+r.F*(f||z),e,_);return _}},function(t,e,n){"use strict";var i=n(43),r=n(38),a=n(51),s={};n(15)(s,n(7)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=i(s,{next:r(1,n)}),a(t,e+" Iterator")}},function(t,e,n){var i=n(65),r=n(27);t.exports=function(t,e,n){if(i(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(r(t))}},function(t,e,n){var i=n(7)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[i]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,n){var i=n(53),r=n(7)("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||a[r]===t)}},function(t,e,n){"use strict";var i=n(9),r=n(38);t.exports=function(t,e,n){e in t?i.f(t,e,r(0,n)):t[e]=n}},function(t,e,n){var i=n(58),r=n(7)("iterator"),a=n(53);t.exports=n(25).getIteratorMethod=function(t){if(void 0!=t)return t[r]||t["@@iterator"]||a[i(t)]}},function(t,e,n){var i=n(278);t.exports=function(t,e){return new(i(t))(e)}},function(t,e,n){"use strict";var i=n(12),r=n(42),a=n(10);t.exports=function(t){for(var e=i(this),n=a(e.length),s=arguments.length,o=r(s>1?arguments[1]:void 0,n),l=s>2?arguments[2]:void 0,c=void 0===l?n:r(l,n);c>o;)e[o++]=t;return e}},function(t,e,n){"use strict";var i=n(35),r=n(126),a=n(53),s=n(18);t.exports=n(90)(Array,"Array",function(t,e){this._t=s(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):"keys"==e?r(0,n):"values"==e?r(0,t[n]):r(0,[n,t[n]])},"values"),a.Arguments=a.Array,i("keys"),i("values"),i("entries")},function(t,e,n){var i,r,a,s=n(22),o=n(116),l=n(82),c=n(78),u=n(3),h=u.process,d=u.setImmediate,f=u.clearImmediate,p=u.MessageChannel,v=u.Dispatch,g=0,m={},b=function(){var t=+this;if(m.hasOwnProperty(t)){var e=m[t];delete m[t],e()}},_=function(t){b.call(t.data)};d&&f||(d=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return m[++g]=function(){o("function"==typeof t?t:Function(t),e)},i(g),g},f=function(t){delete m[t]},"process"==n(23)(h)?i=function(t){h.nextTick(s(b,t,1))}:v&&v.now?i=function(t){v.now(s(b,t,1))}:p?(r=new p,a=r.port2,r.port1.onmessage=_,i=s(a.postMessage,a,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(i=function(t){u.postMessage(t+"","*")},u.addEventListener("message",_,!1)):i="onreadystatechange"in c("script")?function(t){l.appendChild(c("script")).onreadystatechange=function(){l.removeChild(this),b.call(t)}}:function(t){setTimeout(s(b,t,1),0)}),t.exports={set:d,clear:f}},function(t,e,n){var i=n(3),r=n(100).set,a=i.MutationObserver||i.WebKitMutationObserver,s=i.process,o=i.Promise,l="process"==n(23)(s);t.exports=function(){var t,e,n,c=function(){var i,r;for(l&&(i=s.domain)&&i.exit();t;){r=t.fn,t=t.next;try{r()}catch(i){throw t?n():e=void 0,i}}e=void 0,i&&i.enter()};if(l)n=function(){s.nextTick(c)};else if(a){var u=!0,h=document.createTextNode("");new a(c).observe(h,{characterData:!0}),n=function(){h.data=u=!u}}else if(o&&o.resolve){var d=o.resolve();n=function(){d.then(c)}}else n=function(){r.call(i,c)};return function(i){var r={fn:i,next:void 0};e&&(e.next=r),t||(t=r,n()),e=r}}},function(t,e,n){"use strict";function i(t){var e,n;this.promise=new t(function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i}),this.resolve=r(e),this.reject=r(n)}var r=n(13);t.exports.f=function(t){return new i(t)}},function(t,e,n){"use strict";function i(t,e,n){var i,r,a,s=Array(n),o=8*n-e-1,l=(1<<o)-1,c=l>>1,u=23===e?N(2,-24)-N(2,-77):0,h=0,d=t<0||0===t&&1/t<0?1:0;for(t=j(t),t!=t||t===I?(r=t!=t?1:0,i=l):(i=q(F(t)/H),t*(a=N(2,-i))<1&&(i--,a*=2),t+=i+c>=1?u/a:u*N(2,1-c),t*a>=2&&(i++,a/=2),i+c>=l?(r=0,i=l):i+c>=1?(r=(t*a-1)*N(2,e),i+=c):(r=t*N(2,c-1)*N(2,e),i=0));e>=8;s[h++]=255&r,r/=256,e-=8);for(i=i<<e|r,o+=e;o>0;s[h++]=255&i,i/=256,o-=8);return s[--h]|=128*d,s}function r(t,e,n){var i,r=8*n-e-1,a=(1<<r)-1,s=a>>1,o=r-7,l=n-1,c=t[l--],u=127&c;for(c>>=7;o>0;u=256*u+t[l],l--,o-=8);for(i=u&(1<<-o)-1,u>>=-o,o+=e;o>0;i=256*i+t[l],l--,o-=8);if(0===u)u=1-s;else{if(u===a)return i?NaN:c?-I:I;i+=N(2,e),u-=s}return(c?-1:1)*i*N(2,u-e)}function a(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function s(t){return[255&t]}function o(t){return[255&t,t>>8&255]}function l(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function c(t){return i(t,52,8)}function u(t){return i(t,23,4)}function h(t,e,n){O(t[T],e,{get:function(){return this[n]}})}function d(t,e,n,i){var r=+n,a=S(r);if(a+e>t[V])throw A(P);var s=t[B]._b,o=a+t[W],l=s.slice(o,o+e);return i?l:l.reverse()}function f(t,e,n,i,r,a){var s=+n,o=S(s);if(o+e>t[V])throw A(P);for(var l=t[B]._b,c=o+t[W],u=i(+r),h=0;h<e;h++)l[c+h]=u[a?h:e-h-1]}var p=n(3),v=n(8),g=n(40),m=n(71),b=n(15),_=n(48),y=n(4),M=n(46),w=n(28),x=n(10),S=n(135),z=n(44).f,O=n(9).f,E=n(98),k=n(51),T="prototype",P="Wrong index!",D=p.ArrayBuffer,L=p.DataView,C=p.Math,A=p.RangeError,I=p.Infinity,R=D,j=C.abs,N=C.pow,q=C.floor,F=C.log,H=C.LN2,B=v?"_b":"buffer",V=v?"_l":"byteLength",W=v?"_o":"byteOffset";if(m.ABV){if(!y(function(){D(1)})||!y(function(){new D(-1)})||y(function(){return new D,new D(1.5),new D(NaN),"ArrayBuffer"!=D.name})){D=function(t){return M(this,D),new R(S(t))};for(var Y,U=D[T]=R[T],G=z(R),X=0;G.length>X;)(Y=G[X++])in D||b(D,Y,R[Y]);g||(U.constructor=D)}var K=new L(new D(2)),Q=L[T].setInt8;K.setInt8(0,2147483648),K.setInt8(1,2147483649),!K.getInt8(0)&&K.getInt8(1)||_(L[T],{setInt8:function(t,e){Q.call(this,t,e<<24>>24)},setUint8:function(t,e){Q.call(this,t,e<<24>>24)}},!0)}else D=function(t){M(this,D,"ArrayBuffer");var e=S(t);this._b=E.call(Array(e),0),this[V]=e},L=function(t,e,n){M(this,L,"DataView"),M(t,D,"DataView");var i=t[V],r=w(e);if(r<0||r>i)throw A("Wrong offset!");if(n=void 0===n?i-r:x(n),r+n>i)throw A("Wrong length!");this[B]=t,this[W]=r,this[V]=n},v&&(h(D,"byteLength","_l"),h(L,"buffer","_b"),h(L,"byteLength","_l"),h(L,"byteOffset","_o")),_(L[T],{getInt8:function(t){return d(this,1,t)[0]<<24>>24},getUint8:function(t){return d(this,1,t)[0]},getInt16:function(t){var e=d(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=d(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return a(d(this,4,t,arguments[1]))},getUint32:function(t){return a(d(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return r(d(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return r(d(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){f(this,1,t,s,e)},setUint8:function(t,e){f(this,1,t,s,e)},setInt16:function(t,e){f(this,2,t,o,e,arguments[2])},setUint16:function(t,e){f(this,2,t,o,e,arguments[2])},setInt32:function(t,e){f(this,4,t,l,e,arguments[2])},setUint32:function(t,e){f(this,4,t,l,e,arguments[2])},setFloat32:function(t,e){f(this,4,t,u,e,arguments[2])},setFloat64:function(t,e){f(this,8,t,c,e,arguments[2])}});k(D,"ArrayBuffer"),k(L,"DataView"),b(L[T],m.VIEW,!0),e.ArrayBuffer=D,e.DataView=L},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){return t.match(/\//g).length},r=function(t,e){var n=t.keys();return e&&(n=n.filter("function"==typeof e?function(t){return e(i(t))}:function(t){return i(t)===e+1})),n.reduce(function(e,n){var i=/([^\/]+)\..+$/.exec(n)[1];try{var r=t(n);e[i]=r.default||r}catch(t){console.warn("Import error",n,t)}return e},{})};e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(i),a=n(36),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o=s.default.extend({_important:!0,getClassDefaults:function(){var t={use:null,which:null,domainMin:null,domainMax:null,zoomedMin:null,zoomedMax:null,scaleType:"linear",allow:{scales:["linear","log","genericLog","time","pow"]}};return r.deepExtend(this._super(),t)},autoconfigureModel:function(){if(!this.which&&this.autoconfig){var t=this.dataSource.getConcept(this.autoconfig)||this.dataSource.getConcept({type:"time"});t&&(this.which=t.concept),r.printAutoconfigResult(this)}},_type:"axis",validate:function(){if(this._super(),this.scale&&"time"==this.scaleType){var t={};null==this.zoomedMin||r.isDate(this.zoomedMin)||(t.zoomedMin=this._space.time.parse(this.zoomedMin.toString())),null==this.zoomedMax||r.isDate(this.zoomedMax)||(t.zoomedMax=this._space.time.parse(this.zoomedMax.toString())),this.set(t)}},buildScale:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scaleType,e=void 0;if("time"==t){var n=this._space.time,i=n.splash?{min:n.parse(n.startOrigin),max:n.parse(n.endOrigin)}:{min:n.start,max:n.end};e=[i.min,i.max],this.scale=d3.scaleUtc().domain(e)}else{if(this.isDiscrete())e="constant"===this.use?[this.which]:this.getUnique(this.which);else{var a=this.getLimits(this.which);e=[a.min,a.max],e[0]=null!=this.domainMin?+this.domainMin:e[0],e[1]=null!=this.domainMax?+this.domainMax:e[1]}t=d3.min(e)<=0&&d3.max(e)>=0&&"log"===t?"genericLog":t;var s=("ordinal"===t?"point":t)||"linear";this.scale=d3["scale"+r.capitalize(s)]().domain(e)}this.scaleType=t},formatDate:function(t){return this._space.time.formatDate(t)},_getZoomed:function(t){var e=this["zoomed"+t];return null!==e?e:d3[t.toLowerCase()](this.getScale().domain())},getZoomedMin:function(){return this._getZoomed("Min")},getZoomedMax:function(){return this._getZoomed("Max")}});e.default=o},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(r),s=n(49),o=i(s),l=n(75),c=i(l),u=n(50),h=i(u),d=n(392),f=o.default.extend({getClassDefaults:function(){var t={reader:"csv"};return a.deepExtend(this._super(),t)},trackInstances:!0,init:function(t,e,n,i){this._type="data",this.queryQueue={},this._collection={},this._collectionPromises={},this._super(t,e,n,i),this.readerObject=this.getReader()},preloadData:function(){return this.loadConceptProps()},load:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.dataset&&(t.dataset=this.dataset),this.version&&(t.version=this.version);var i=d.DataStorage.getDataId(t,this.readerObject,n);return i?Promise.resolve(i):(a.timeStamp("Vizabi Data: Loading Data"),h.default.freezeAll(["hook_change","resize"]),d.DataStorage.loadFromReader(t,n,this.readerObject).then(function(t){return h.default.unfreezeAll(),t}).catch(function(n){h.default.unfreezeAll(),e.handleLoadError(n,t)}))},getAsset:function(t,e){var n=this;return this.readerObject.getAsset(t).then(function(t){return e(t)}).catch(function(e){return n.handleLoadError(e,t)})},getReader:function(){var t=c.default.get(this.reader);if(!t)throw new Error("Unknown reader: "+this.reader);return new t(this.getPlainObject())},getData:function(t,e,n,i){return t?d.DataStorage.getData(t,e,n,i):a.warn("Data.js 'get' method doesn't like the dataId you gave it: "+t)},loadConceptProps:function(){var t=this,e={select:{key:["concept"],value:["concept_type","domain","indicator_url","color","scales","interpolation","tags","name","name_short","name_catalog","description","format"]},from:"concepts",where:{},language:this.getClosestModel("locale").id},n=this._root.state.time,i={};return i[n.getDimensionOrWhich()||n._type]=n.getParser(),this.load(e,i).then(this.handleConceptPropsResponse.bind(this)).catch(function(n){return t.handleLoadError(n,e)})},handleConceptPropsResponse:function(t){var e=this;this.conceptDictionary={_default:{concept_type:"string",use:"constant",scales:["ordinal"],tags:"_root"}},this.conceptArray=[],this.getData(t).forEach(function(t){var n={};t.concept_type&&(n.use="measure"==t.concept_type||"time"==t.concept_type?"indicator":"property"),n.concept_type=t.concept_type,n.sourceLink=t.indicator_url;try{n.color=t.color&&""!==t.color?JSON.parse(t.color):null}catch(t){n.color=null}try{n.scales=t.scales?JSON.parse(t.scales):null}catch(t){n.scales=null}if(!n.scales)switch(t.concept_type){case"measure":n.scales=["linear","log"];break;case"string":n.scales=["nominal"];break;case"entity_domain":case"entity_set":n.scales=["ordinal"];break;case"time":n.scales=["time"]}null==n.scales&&(n.scales=["linear","log"]),t.interpolation?n.interpolation=t.interpolation:"measure"==t.concept_type?n.interpolation=n.scales&&"log"==n.scales[0]?"exp":"linear":"time"==t.concept_type?n.interpolation="linear":n.interpolation="stepMiddle",n.concept=t.concept,n.domain=t.domain,n.tags=t.tags,n.format=t.format,n.name=t.name||t.concept||"",n.name_catalog=t.name_catalog||"",n.name_short=t.name_short||t.name||t.concept||"",n.description=t.description,e.conceptDictionary[t.concept]=n,e.conceptArray.push(n)})},getConceptprops:function(t){return t?a.getProp(this,["conceptDictionary",t])||a.warn("The concept "+t+" is not found in the dictionary"):this.conceptDictionary},getConcept:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.index,n=void 0===e?0:e,i=t.type,r=void 0===i?null:i,a=t.includeOnlyIDs,s=void 0===a?[]:a,o=t.excludeIDs,l=void 0===o?[]:o;if(!r&&0==s.length&&0==l.length)return null;var c=this.conceptArray.filter(function(t){return!(r&&t.concept_type&&t.concept_type!==r||0!=s.length&&-1===s.indexOf(t.concept)||0!=l.length&&-1!=l.indexOf(t.concept))});return c[n]||c[c.length-1]},getDatasetName:function(){if(this.readerObject.getDatasetInfo){var t=this.readerObject.getDatasetInfo();return t.name+(t.version?" "+t.version:"")}return this._name},setGrouping:function(t,e){d.DataStorage.setGrouping(t,e)},getFrames:function(t,e,n){return d.DataStorage.getFrames(t,e,n,this.getConceptprops())},getFrame:function(t,e,n,i){return d.DataStorage.getFrame(t,e,n,i)},listenFrame:function(t,e,n,i){d.DataStorage.listenFrame(t,e,n,i)},handleLoadError:function(t,e){if(a.isObject(t)){t=((this.getClosestModel("locale").getTFunction()(t.code,t.payload)||"")+" "+(t.message||"")).trim()}a.warn("Problem with query: ",e),this._super(t)}});e.default=f},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={build:1509004488665,version:"0.26.6"}},function(t,e,n){"use strict";function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function r(t){return function e(n){function r(t,e,n){return n.indexOf(t)===e}function a(t){var e=a.scale().domain(),i=a.scale().range();if(!e[0]&&0!==e[0]||!e[1]&&0!==e[1]||!i[0]&&0!==i[0]||!i[1]&&0!==i[1])return s.warn("d3.axisSmart() skips action because of invalid domain "+JSON.stringify(e)+" or range "+JSON.stringify(i)+" of the attached scale");if(null!=m)return void a.highlightValueRun(t);var r=t.append("g").attr("class","tick widthSampling"),o=r.append("text").text("0");x.cssMargin||(x.cssMargin={}),x.cssMargin.top=o.style("margin-top"),x.cssMargin.bottom=o.style("margin-bottom"),x.cssMargin.left=o.style("margin-left"),x.cssMargin.right=o.style("margin-right"),x.widthOfOneDigit=o.node().getBBox().width,x.heightOfOneDigit=o.node().getBBox().height,r.remove(),a.labelFactory(x);var l=null;n(x.transitionDuration>0?l=t.transition().duration(x.transitionDuration):t),t.attr("fill",null),t.attr("font-size",null),t.attr("font-family",null),t.attr("text-anchor",null);var c="top"==a.orient()||"bottom"==a.orient()?h:u,p=c==h&&a.pivot()||c==u&&!a.pivot()?f:d;t.selectAll(".vzb-axis-value").data([null]).enter().append("g").attr("class","vzb-axis-value").classed("vzb-hidden",!0).append("text");var v=a.tickPadding();if(t.selectAll("text").each(function(t,e){if(null!=a.pivot()){var n=d3.select(this);n.attr("transform","rotate("+(a.pivot()?-90:0)+")"),n.style("text-anchor",p==d?"middle":"end"),n.attr("x",p==d?c==u?-v:0:-v),n.attr("y",p==d?c==u?0:v:0),n.attr("dx",p==d&&c==u?v:0),n.attr("dy",p==d?c==u?-v:".72em":".32em")}}),null!=a.repositionLabels()){var g=function(){t.selectAll(".tick").each(function(t){var e=d3.select(this).select("text"),n=a.repositionLabels()[t]||{x:0,y:0};e.attr("x",+e.attr("x")+n.x),e.attr("y",+e.attr("y")+n.y)})};l?l.on("end",function(){return g()}):g()}var b=a.scale();x.viewportLength&&t.selectAll(".tick").classed("vzb-hidden",function(t){return b(t)<0||b(t)>x.viewportLength}),null==a.tickValuesMinor()&&a.tickValuesMinor([]);var _=t.selectAll(".tick-minor").data(M);_.exit().remove(),_=_.enter().append("line").attr("class","tick-minor").merge(_);var y=a.tickSizeMinor().outbound,w=a.tickSizeMinor().inbound;_.classed("vzb-hidden",function(t){return b(t)<0||b(t)>x.viewportLength}).attr("y1",c==h?("top"==a.orient()?1:-1)*w:b).attr("y2",c==h?("top"==a.orient()?-1:1)*y:b).attr("x1",c==u?("right"==a.orient()?-1:1)*w:b).attr("x2",c==u?("right"==a.orient()?1:-1)*y:b),t.selectAll("path").remove();var S=t.selectAll(".vzb-axis-line").data([0]);S.exit().remove(),S=S.enter().append("line").attr("class","vzb-axis-line").merge(S),x.viewportLength?S.attr("x1",c==u?0:-1).attr("x2",c==u?0:x.viewportLength).attr("y1",0).attr("y2",c==h?0:x.viewportLength):S.attr("x1",c==u?0:d3.min(b.range())-(x.bump||0)-1).attr("x2",c==u?0:d3.max(b.range())+(x.bump||0)).attr("y1",c==h?0:d3.min(b.range())-(x.bump||0)).attr("y2",c==h?0:d3.max(b.range())+(x.bump||0))}function o(t,e){null==e&&(e=!0);var n=[],i=[];-1!=t.indexOf(0)&&(n.push([0]),i.push(t.indexOf(0)));for(var r=t.length;r>=1;r=r<4?r-1:r/2)!function(r){n.push(t.filter(function(t,n){return!(n%Math.floor(r)!=0||-1!=i.indexOf(n)&&e)&&(i.push(n),!0)}))}(r);return n}function l(t,e,n,i,r){if(!t)return null;var a={},s=n==u?{head:e.toolMargin.top,tail:e.toolMargin.bottom}:{head:e.toolMargin.right,tail:e.toolMargin.left},o=i.range(),l=e.bump;return e.viewportLength&&(t=t.filter(function(t){return i(t)>=0&&i(t)<=e.viewportLength}),o=[0,e.viewportLength],l=0),t.forEach(function(c,d){if(0==d||d==t.length-1){var f=Math.min(s.head,.5*e.widthOfOneDigit)+l+(n==h?1:0)*d3.max(o)-(n==h?0:1)*d3.min(o)+(n==h?-1:1)*i(c)-("x"==r)*e.formatter(c).length*e.widthOfOneDigit/2-("y"==r)*e.heightOfOneDigit/2-("x"==r)*parseInt(e.cssMargin.right)-("y"==r)*parseInt(e.cssMargin.top),p=Math.min(s.tail,.5*e.widthOfOneDigit)+l+(n==u?1:0)*d3.max(o)-(n==u?0:1)*d3.min(o)+(n==u?-1:1)*i(c)-("x"==r)*e.formatter(c).length*e.widthOfOneDigit/2-("y"==r)*e.heightOfOneDigit/2-("x"==r)*parseInt(e.cssMargin.left)-("y"==r)*parseInt(e.cssMargin.bottom);f>0&&(f=0),p>0&&(p=0),a[c]={x:0,y:0},a[c][r]=("y"==r&&n==u?-1:1)*(f-p)}}),t.forEach(function(s,o){if(0!=o&&o!=t.length-1){var l=Math.abs(i(s)-i(t[t.length-1]))-("y"==r)*(n==h?-1:1)*a[t[t.length-1]][r]-("x"==r)*(n==h?1:-1)*a[t[t.length-1]][r]-("x"==r)*e.widthOfOneDigit/2*e.formatter(s).length-("x"==r)*e.widthOfOneDigit/2*e.formatter(t[t.length-1]).length-("y"==r)*e.heightOfOneDigit*.7-("x"==r)*parseInt(e.cssMargin.left)-("y"==r)*parseInt(e.cssMargin.bottom),c=Math.abs(i(s)-i(t[0]))-("y"==r)*(n==u?-1:1)*a[t[0]][r]-("x"==r)*(n==u?1:-1)*a[t[0]][r]-("x"==r)*e.widthOfOneDigit/2*e.formatter(s).length-("x"==r)*e.widthOfOneDigit/2*e.formatter(t[0]).length-("y"==r)*e.heightOfOneDigit*.7-("x"==r)*parseInt(e.cssMargin.left)-("y"==r)*parseInt(e.cssMargin.bottom);l>0&&(l=0),c>0&&(c=0),a[s]={x:0,y:0},a[s][r]=("y"==r&&n==u?-1:1)*(l-c)}}),a}function c(){var t;a.labelerOptions().isDevMode&&(t=console).log.apply(t,arguments)}var u="vertical axis",h="horizontal axis",d="labels stack side by side",f="labels stack top to bottom",p="optimistic approximation: labels have different lengths",v="pessimistic approximation: all labels have the largest length";a.highlightValueRun=function(t){x.viewportLength&&"none"!=m&&(a.scale()(m)>x.viewportLength||a.scale()(m)<0)&&(m="none");var e="top"==a.orient()||"bottom"==a.orient()?h:u,n=e==h&&a.pivot()||e==u&&!a.pivot()?"y":"x",i=a.pivot()?-1:1;t.select(".vzb-axis-value").classed("vzb-hidden","none"==m);var r=void 0,s={};"none"!=m&&(r=t.select(".vzb-axis-value").node().getBBox(),s.bump=x.bump,s.formatter=x.formatter,s.viewportLength=x.viewportLength,s.toolMargin=x.toolMargin,s.cssMargin=x.cssMargin,s.widthOfOneDigit=r[a.pivot()?"height":"width"]/x.formatter(m).length,s.heightOfOneDigit=r[a.pivot()?"width":"height"]);var o=("none"==m?{x:0,y:0}:l([m],s,e,a.scale(),n)[m])[n],c=function(t){return"none"==m?"translate(0,0)":"translate("+(e==h?a.scale()(m)+o*i:0)+","+(e==u?a.scale()(m)+o*i:0)+")"},d=function(t,s,l){if("none"==m)return 1;var c=e==h?"width":"height",u=(a.repositionLabels()[t]||{x:0,y:0})[n];return a.hlOpacityScale()(Math.abs(a.scale()(t)+u*i-a.scale()(m)-o*i)-l.getBBox()[c]/2-r[c]/2)};b?(t.select(".vzb-axis-value").transition().duration(b).ease(d3.easeLinear).attr("transform",c),t.select(".vzb-axis-value").select("text").transition("text").delay(b).text("none"==m?"":x.formatter(m)),t.selectAll(".tick:not(.vzb-hidden)").each(function(t,e){d3.select(this).select("text").transition().duration(b).ease(d3.easeLinear).style("opacity",d(t,0,this))})):(t.select(".vzb-axis-value").interrupt().attr("transform",c).transition(),t.select(".vzb-axis-value").select("text").interrupt().text("none"==m?"":x.formatter(m)).transition(),t.selectAll(".tick:not(.vzb-hidden)").each(function(t,e){d3.select(this).select("text").interrupt().style("opacity",d(t,0,this)).transition()})),m=null};var g=d3.scaleLinear().domain([0,5]).range([0,1]).clamp(!0);a.hlOpacityScale=function(t){return arguments.length?(g=t,a):g};var m=null;a.highlightValue=function(t){return arguments.length?(m=t,a):m};var b=0;a.highlightTransDuration=function(t){return arguments.length?(b=t,a):b};var _=null;a.repositionLabels=function(t){return arguments.length?(_=t,a):_};var y=!1;a.pivot=function(t){return arguments.length?(y=!!t,a):y};var M=[];a.tickValuesMinor=function(t){return arguments.length?(M=t,a):M};var w={outbound:0,inbound:0};a.tickSizeMinor=function(t,e){return arguments.length?(w={outbound:t,inbound:e||0},c("setting",w),a):w};var x={};return a.labelerOptions=function(t){return arguments.length?(x=t,a):x},a.METHOD_REPEATING="repeating specified powers",a.METHOD_DOUBLING="doubling the value",a.labelFactory=function(t){function e(e,n){return 0==e||0==n?0:(null==n&&(n=t.logBase),Math.log(e)/Math.log(n))}if(null==t&&(t={}),"linear"!=t.scaleType&&"time"!=t.scaleType&&"genericLog"!=t.scaleType&&"log"!=t.scaleType&&"ordinal"!=t.scaleType)return a.ticks(t.limitMaxTickNumber).tickFormat(null).tickValues(null).tickValuesMinor(null).pivot(null).repositionLabels(null);if("ordinal"==t.scaleType)return a;null==t.logBase&&(t.logBase=10),null==t.stops&&(t.stops=[1,2,5,3,7,4,6,8,9]),null==t.removeAllLabels&&(t.removeAllLabels=!1),null==t.formatter&&(t.formatter=a.tickFormat()?a.tickFormat():function(t){return t+""}),t.cssLabelMarginLimit=5,null==t.cssMargin&&(t.cssMargin={}),(null==t.cssMargin.left||parseInt(t.cssMargin.left)<t.cssLabelMarginLimit)&&(t.cssMargin.left=t.cssLabelMarginLimit+"px"),(null==t.cssMargin.right||parseInt(t.cssMargin.right)<t.cssLabelMarginLimit)&&(t.cssMargin.right=t.cssLabelMarginLimit+"px"),(null==t.cssMargin.top||parseInt(t.cssMargin.top)<t.cssLabelMarginLimit)&&(t.cssMargin.top=t.cssLabelMarginLimit+"px"),(null==t.cssMargin.bottom||parseInt(t.cssMargin.bottom)<t.cssLabelMarginLimit)&&(t.cssMargin.bottom=t.cssLabelMarginLimit+"px"),null==t.toolMargin&&(t.toolMargin={left:30,bottom:30,right:30,top:30}),null==t.bump&&(t.bump=0),null==t.viewportLength&&(t.viewportLength=0),null==t.pivotingLimit&&(t.pivotingLimit=t.toolMargin[this.orient()]),null==t.showOuter&&(t.showOuter=!1),null==t.limitMaxTickNumber&&(t.limitMaxTickNumber=0);var n="top"==this.orient()||"bottom"==this.orient()?h:u;null==t.isPivotAuto&&(t.isPivotAuto=n==u),null==t.cssFontSize&&(t.cssFontSize="13px"),null==t.widthToFontsizeRatio&&(t.widthToFontsizeRatio=.75),null==t.heightToFontsizeRatio&&(t.heightToFontsizeRatio=1.2),null==t.widthOfOneDigit&&(t.widthOfOneDigit=parseInt(t.cssFontSize)*t.widthToFontsizeRatio),null==t.heightOfOneDigit&&(t.heightOfOneDigit=parseInt(t.cssFontSize)*t.heightToFontsizeRatio),null!=t.fitIntoScale&&"pessimistic"!=t.fitIntoScale||(t.fitIntoScale=v),"optimistic"==t.fitIntoScale&&(t.fitIntoScale=p),c("********** "+n+" **********");var s=a.scale().domain(),d=a.scale().range(),f=(Math.abs(s[s.length-1]-s[0]),Math.abs(d[d.length-1]-d[0])),g=d3.min([s[0],s[s.length-1]]),m=d3.max([s[0],s[s.length-1]]),b=("linear"==t.scaleType?g<0:g<=0)&&m>=0&&"time"!=t.scaleType,_=t.showOuter?[g,m]:[],y=[],M=5,w=d3.max(d3.range(g,m,(m-g)/17).concat(m).map(function(e){return t.formatter(e).replace(".","").length}))*t.widthOfOneDigit+parseInt(t.cssMargin.left),x=t.isPivotAuto&&(w>t.pivotingLimit&&n==u||!(w>t.pivotingLimit)&&!(n==u)),S=n==h&&x||n==u&&!x,z=!S&&t.heightOfOneDigit>t.pivotingLimit;if(t.removeAllLabels)return a.tickValues([]);if(g==m)return a.tickValues([g]).ticks(1).tickFormat(t.formatter);var O=function(e,n,i,r){if(null==e||e.length<=1)return!0;if(null==i&&(i=v),null==r&&(scaleType="none"),S)return n>e.length*(t.heightOfOneDigit+parseInt(t.cssMargin.top)+parseInt(t.cssMargin.bottom));var s=parseInt(t.cssMargin.left)+parseInt(t.cssMargin.right),o=d3.max(e.map(function(e){return t.formatter(e).length}));return"log"==r?(n=Math.abs(a.scale()(d3.max(e))-a.scale()(d3.min(e))))>d3.sum(e.map(function(e){return(t.widthOfOneDigit*(i==v?o:t.formatter(e).length)+s)*(1+Math.log(e.toString().replace(/([0.])/g,"")[0])/Math.LN10)})):n>e.length*s+(i==v?t.widthOfOneDigit*e.length*o:0)+(i==p?t.widthOfOneDigit*e.map(function(e){return t.formatter(e)}).join("").length:0)},E=function(e,n){if(null==n||0==n.length)return!1;n instanceof Array||(n=[n]);for(var i=0;i<n.length;i++)if(e!=n[i]&&0!=e&&Math.abs(a.scale()(e)-a.scale()(n[i]))<(S?t.heightOfOneDigit:(t.formatter(e).length+t.formatter(n[i]).length)*t.widthOfOneDigit/2))return!0;return!1};if("genericLog"==t.scaleType||"log"==t.scaleType){var k=a.scale().eps?a.scale().eps():0,T=b?[0]:[],P=m<k?[]:d3.range(Math.floor(e(Math.max(k,g))),Math.ceil(e(m)),1).concat(Math.ceil(e(m))).map(function(e){return Math.pow(t.logBase,e)}),D=g>-k?[]:d3.range(Math.floor(e(Math.max(k,-m))),Math.ceil(e(-g)),1).concat(Math.ceil(e(-g))).map(function(e){return-Math.pow(t.logBase,e)});if(null==t.method){var L=b?Math.max(Math.abs(m),Math.abs(g))/k:Math.max(Math.abs(m),Math.abs(g))/Math.min(Math.abs(m),Math.abs(g));t.method=10<=L&&L<=1024?this.METHOD_DOUBLING:this.METHOD_REPEATING}if(t.method==this.METHOD_DOUBLING&&function(){var t=[];b&&_.push(0);var e=[].concat(_),n=m<k?null:4*P[Math.floor(P.length/2)-1],i=g>-k?null:4*D[Math.floor(D.length/2)-1];if(n)for(var a=n;a<=m;a*=2)t.push(a);if(n)for(var s=n/2;s>=Math.max(g,k);s/=2)t.push(s);if(i)for(var l=i;l>=g;l*=2)t.push(l);if(i)for(var c=i/2;c<=Math.min(m,-k);c/=2)t.push(c);t=t.sort(d3.ascending).filter(function(t){return g<=t&&t<=m}),y=y.concat(t),t=o(t,!1);for(var u=_,h=0;h<t.length;h++){var d=u.concat(t[h]).filter(function(t){return!E(t,e)}).filter(r);if(!O(d,f,v,"none"))break;_=d}}(),t.method==this.METHOD_REPEATING){var C=T.concat(P).concat(D).sort(d3.ascending);t.stops.forEach(function(t,e){y=y.concat(C.map(function(e){return e*t}))}),C=o(C);var A=T.concat(_),I=!1;t.stops.forEach(function(e,n){if(0==n){for(var a,s=0;s<C.length;s++){var o=_.concat(C[s].map(function(t){return t*e})).filter(function(t){return!E(t,A)}).filter(function(t){return g<=t&&t<=m}).filter(r);if(!O(o,f,v,"none"))break;_=o}C=(a=[]).concat.apply(a,i(C))}else{if(I)return;var l=_.concat(C.map(function(t){return t*e})).filter(function(t){return g<=t&&t<=m}).filter(r);if(!O(l,f,v,"log"))return void(I=!0);if(_.length>t.limitMaxTickNumber&&0!=t.limitMaxTickNumber)return void(I=!0);_=l}})}}return"linear"!=t.scaleType&&"time"!=t.scaleType||function(){b&&_.push(0);var e=[].concat(_);M=S?Math.max(Math.floor(f/(t.heightOfOneDigit+parseInt(t.cssMargin.top))),2):Math.max(Math.floor(f/w),2),0!=t.limitMaxTickNumber&&M>t.limitMaxTickNumber&&(M=t.limitMaxTickNumber);var n=a.scale().ticks(M).sort(d3.ascending).filter(function(t){return g<=t&&t<=m});y=y.concat(n),n=o(n,!1);for(var i=_,s=0;s<n.length;s++){var l=i.concat(n[s]).filter(function(t){return!E(t,e)}).filter(r);if(!O(l,f,t.fitIntoScale,"none"))break;_=l}_=_.filter(function(t){return!E(t,e)}).filter(r)}(),null!=_&&_.length<=2&&!b&&(_=Math.abs(a.scale()(g)-a.scale()(m))<(S?t.heightOfOneDigit:(t.formatter(g).length+t.formatter(m).length)*t.widthOfOneDigit)?[m]:[g,m],1!=_.length||"linear"!=t.scaleType&&"time"!=t.scaleType||(y=[])),null!=_&&_.length<=3&&b&&(_=E(0,[g,m])?[g,m]:[g,0,m]),null!=_&&_.sort(function(t,e){return(n==h?-1:1)*(a.scale()(e)-a.scale()(t))}),z&&(_=[]),y=y.filter(function(t){return-1==_.indexOf(t)&&g<=t&&t<=m}),c("final result",_),a.ticks(M).tickFormat(t.formatter).tickValues(_).tickValuesMinor(y).pivot(x).repositionLabels(l(_,t,n,a.scale(),S?"y":"x"))},a.copy=function(){return e(d3["axis"+s.capitalize(t)]())},a.orient=function(){return arguments.length?a:t},d3.rebind(a,n,"scale","ticks","tickArguments","tickValues","tickFormat","tickSize","tickSizeInner","tickSizeOuter","tickPadding")}(d3["axis"+s.capitalize(t)]())}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r;var a=n(1),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(a)},function(t,e,n){t.exports=!n(8)&&!n(4)(function(){return 7!=Object.defineProperty(n(78)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){e.f=n(7)},function(t,e,n){var i=n(14),r=n(18),a=n(62)(!1),s=n(80)("IE_PROTO");t.exports=function(t,e){var n,o=r(t),l=0,c=[];for(n in o)n!=s&&i(o,n)&&c.push(n);for(;e.length>l;)i(o,n=e[l++])&&(~a(c,n)||c.push(n));return c}},function(t,e,n){var i=n(9),r=n(2),a=n(41);t.exports=n(8)?Object.defineProperties:function(t,e){r(t);for(var n,s=a(e),o=s.length,l=0;o>l;)i.f(t,n=s[l++],e[n]);return t}},function(t,e,n){var i=n(18),r=n(44).f,a={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],o=function(t){try{return r(t)}catch(t){return s.slice()}};t.exports.f=function(t){return s&&"[object Window]"==a.call(t)?o(t):r(i(t))}},function(t,e,n){"use strict";var i=n(41),r=n(63),a=n(57),s=n(12),o=n(56),l=Object.assign;t.exports=!l||n(4)(function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach(function(t){e[t]=t}),7!=l({},t)[n]||Object.keys(l({},e)).join("")!=i})?function(t,e){for(var n=s(t),l=arguments.length,c=1,u=r.f,h=a.f;l>c;)for(var d,f=o(arguments[c++]),p=u?i(f).concat(u(f)):i(f),v=p.length,g=0;v>g;)h.call(f,d=p[g++])&&(n[d]=f[d]);return n}:l},function(t,e,n){"use strict";var i=n(13),r=n(6),a=n(116),s=[].slice,o={},l=function(t,e,n){if(!(e in o)){for(var i=[],r=0;r<e;r++)i[r]="a["+r+"]";o[e]=Function("F,a","return new F("+i.join(",")+")")}return o[e](t,n)};t.exports=Function.bind||function(t){var e=i(this),n=s.call(arguments,1),o=function(){var i=n.concat(s.call(arguments));return this instanceof o?l(e,i.length,i):a(e,i,t)};return r(e.prototype)&&(o.prototype=e.prototype),o}},function(t,e){t.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var i=n(3).parseInt,r=n(52).trim,a=n(84),s=/^[-+]?0[xX]/;t.exports=8!==i(a+"08")||22!==i(a+"0x16")?function(t,e){var n=r(String(t),3);return i(n,e>>>0||(s.test(n)?16:10))}:i},function(t,e,n){var i=n(3).parseFloat,r=n(52).trim;t.exports=1/i(n(84)+"-0")!=-1/0?function(t){var e=r(String(t),3),n=i(e);return 0===n&&"-"==e.charAt(0)?-0:n}:i},function(t,e,n){var i=n(23);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=i(t))throw TypeError(e);return+t}},function(t,e,n){var i=n(6),r=Math.floor;t.exports=function(t){return!i(t)&&isFinite(t)&&r(t)===t}},function(t,e){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,e,n){var i=n(87),r=Math.pow,a=r(2,-52),s=r(2,-23),o=r(2,127)*(2-s),l=r(2,-126),c=function(t){return t+1/a-1/a};t.exports=Math.fround||function(t){var e,n,r=Math.abs(t),u=i(t);return r<l?u*c(r/l/s)*l*s:(e=(1+s/a)*r,n=e-(e-r),n>o||n!=n?u*(1/0):u*n)}},function(t,e,n){var i=n(2);t.exports=function(t,e,n,r){try{return r?e(i(n)[0],n[1]):e(n)}catch(e){var a=t.return;throw void 0!==a&&i(a.call(t)),e}}},function(t,e,n){var i=n(13),r=n(12),a=n(56),s=n(10);t.exports=function(t,e,n,o,l){i(e);var c=r(t),u=a(c),h=s(c.length),d=l?h-1:0,f=l?-1:1;if(n<2)for(;;){if(d in u){o=u[d],d+=f;break}if(d+=f,l?d<0:h<=d)throw TypeError("Reduce of empty array with no initial value")}for(;l?d>=0:h>d;d+=f)d in u&&(o=e(o,u[d],d,c));return o}},function(t,e,n){"use strict";var i=n(12),r=n(42),a=n(10);t.exports=[].copyWithin||function(t,e){var n=i(this),s=a(n.length),o=r(t,s),l=r(e,s),c=arguments.length>2?arguments[2]:void 0,u=Math.min((void 0===c?s:r(c,s))-l,s-o),h=1;for(l<o&&o<l+u&&(h=-1,l+=u-1,o+=u-1);u-- >0;)l in n?n[o]=n[l]:delete n[o],o+=h,l+=h;return n}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){n(8)&&"g"!=/./g.flags&&n(9).f(RegExp.prototype,"flags",{configurable:!0,get:n(67)})},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var i=n(2),r=n(6),a=n(102);t.exports=function(t,e){if(i(t),r(e)&&e.constructor===t)return e;var n=a.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){"use strict";var i=n(131),r=n(54);t.exports=n(70)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=i.getEntry(r(this,"Map"),t);return e&&e.v},set:function(t,e){return i.def(r(this,"Map"),0===t?0:t,e)}},i,!0)},function(t,e,n){"use strict";var i=n(9).f,r=n(43),a=n(48),s=n(22),o=n(46),l=n(47),c=n(90),u=n(126),h=n(45),d=n(8),f=n(34).fastKey,p=n(54),v=d?"_s":"size",g=function(t,e){var n,i=f(e);if("F"!==i)return t._i[i];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,c){var u=t(function(t,i){o(t,u,e,"_i"),t._t=e,t._i=r(null),t._f=void 0,t._l=void 0,t[v]=0,void 0!=i&&l(i,n,t[c],t)});return a(u.prototype,{clear:function(){for(var t=p(this,e),n=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var n=p(this,e),i=g(n,t);if(i){var r=i.n,a=i.p;delete n._i[i.i],i.r=!0,a&&(a.n=r),r&&(r.p=a),n._f==i&&(n._f=r),n._l==i&&(n._l=a),n[v]--}return!!i},forEach:function(t){p(this,e);for(var n,i=s(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(i(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!g(p(this,e),t)}}),d&&i(u.prototype,"size",{get:function(){return p(this,e)[v]}}),u},def:function(t,e,n){var i,r,a=g(t,e);return a?a.v=n:(t._l=a={i:r=f(e,!0),k:e,v:n,p:i=t._l,n:void 0,r:!1},t._f||(t._f=a),i&&(i.n=a),t[v]++,"F"!==r&&(t._i[r]=a)),t},getEntry:g,setStrong:function(t,e,n){c(t,e,function(t,n){this._t=p(t,e),this._k=n,this._l=void 0},function(){for(var t=this,e=t._k,n=t._l;n&&n.r;)n=n.p;return t._t&&(t._l=n=n?n.n:t._t._f)?"keys"==e?u(0,n.k):"values"==e?u(0,n.v):u(0,[n.k,n.v]):(t._t=void 0,u(1))},n?"entries":"values",!n,!0),h(e)}}},function(t,e,n){"use strict";var i=n(131),r=n(54);t.exports=n(70)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return i.def(r(this,"Set"),t=0===t?0:t,t)}},i)},function(t,e,n){"use strict";var i,r=n(30)(0),a=n(16),s=n(34),o=n(114),l=n(134),c=n(6),u=n(4),h=n(54),d=s.getWeak,f=Object.isExtensible,p=l.ufstore,v={},g=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},m={get:function(t){if(c(t)){var e=d(t);return!0===e?p(h(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return l.def(h(this,"WeakMap"),t,e)}},b=t.exports=n(70)("WeakMap",g,m,l,!0,!0);u(function(){return 7!=(new b).set((Object.freeze||Object)(v),7).get(v)})&&(i=l.getConstructor(g,"WeakMap"),o(i.prototype,m),s.NEED=!0,r(["delete","has","get","set"],function(t){var e=b.prototype,n=e[t];a(e,t,function(e,r){if(c(e)&&!f(e)){this._f||(this._f=new i);var a=this._f[t](e,r);return"set"==t?this:a}return n.call(this,e,r)})}))},function(t,e,n){"use strict";var i=n(48),r=n(34).getWeak,a=n(2),s=n(6),o=n(46),l=n(47),c=n(30),u=n(14),h=n(54),d=c(5),f=c(6),p=0,v=function(t){return t._l||(t._l=new g)},g=function(){this.a=[]},m=function(t,e){return d(t.a,function(t){return t[0]===e})};g.prototype={get:function(t){var e=m(this,t);if(e)return e[1]},has:function(t){return!!m(this,t)},set:function(t,e){var n=m(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=f(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,a){var c=t(function(t,i){o(t,c,e,"_i"),t._t=e,t._i=p++,t._l=void 0,void 0!=i&&l(i,n,t[a],t)});return i(c.prototype,{delete:function(t){if(!s(t))return!1;var n=r(t);return!0===n?v(h(this,e)).delete(t):n&&u(n,this._i)&&delete n[this._i]},has:function(t){if(!s(t))return!1;var n=r(t);return!0===n?v(h(this,e)).has(t):n&&u(n,this._i)}}),c},def:function(t,e,n){var i=r(a(e),!0);return!0===i?v(t).set(e,n):i[t._i]=n,t},ufstore:v}},function(t,e,n){var i=n(28),r=n(10);t.exports=function(t){if(void 0===t)return 0;var e=i(t),n=r(e);if(e!==n)throw RangeError("Wrong length!");return n}},function(t,e,n){var i=n(44),r=n(63),a=n(2),s=n(3).Reflect;t.exports=s&&s.ownKeys||function(t){var e=i.f(a(t)),n=r.f;return n?e.concat(n(t)):e}},function(t,e,n){"use strict";function i(t,e,n,c,u,h,d,f){for(var p,v,g=u,m=0,b=!!d&&o(d,f,3);m<c;){if(m in n){if(p=b?b(n[m],m,e):n[m],v=!1,a(p)&&(v=p[l],v=void 0!==v?!!v:r(p)),v&&h>0)g=i(t,e,p,s(p.length),g,h-1)-1;else{if(g>=9007199254740991)throw TypeError();t[g]=p}g++}m++}return g}var r=n(64),a=n(6),s=n(10),o=n(22),l=n(7)("isConcatSpreadable");t.exports=i},function(t,e,n){var i=n(10),r=n(86),a=n(27);t.exports=function(t,e,n,s){var o=String(a(t)),l=o.length,c=void 0===n?" ":String(n),u=i(e);if(u<=l||""==c)return o;var h=u-l,d=r.call(c,Math.ceil(h/c.length));return d.length>h&&(d=d.slice(0,h)),s?d+o:o+d}},function(t,e,n){var i=n(41),r=n(18),a=n(57).f;t.exports=function(t){return function(e){for(var n,s=r(e),o=i(s),l=o.length,c=0,u=[];l>c;)a.call(s,n=o[c++])&&u.push(t?[n,s[n]]:s[n]);return u}}},function(t,e,n){var i=n(58),r=n(141);t.exports=function(t){return function(){if(i(this)!=t)throw TypeError(t+"#toJSON isn't generic");return r(this)}}},function(t,e,n){var i=n(47);t.exports=function(t,e){var n=[];return i(t,!1,n.push,n,e),n}},function(t,e){t.exports=Math.scale||function(t,e,n,i,r){return 0===arguments.length||t!=t||e!=e||n!=n||i!=i||r!=r?NaN:t===1/0||t===-1/0?t:(t-e)*(r-i)/(n-e)+i}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=n(1),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(a),o=n(49),l=i(o),c=n(5),u=i(c),h=n(21),d=n(50),f=i(d),p=l.default.extend({init:function(t,e){this._id=s.uniqueId("tm"),this._type="tool",this._component=t,this.getClassDefaults=function(){return t.default_model};var n=s.extend(t.getToolListeners(),e.bind);delete e.bind,this._super(t.name,e,null,n)},getDefaults:function(){return s.deepExtend({},this.getSubmodelDefaults(),this.getClassDefaults())},validate:function(){function t(i){var r=JSON.stringify(n.getPlainObject());n._component.validate(n);var a=JSON.stringify(n.getPlainObject());i>=e?s.error("Max validation loop."):r!==a&&t(i++)}var e=10,n=this;t(0)},setReady:function(t){!1!==t&&this.checkTimeLimits(),this._super(t)},checkTimeLimits:function(){var t=this.state.time,e=this.state.getSubmodels(!1,function(t){return"marker"==t._type&&t.space.includes("time")});if(t&&e.length){var n={};if(e.forEach(function(t){var e=t.getTimeLimits();n.min=d3.max([n.min,e.min]),n.max=d3.min([n.max,e.max])}),!s.isDate(n.min)||!s.isDate(n.max))return s.warn("checkTimeLimits(): min-max look wrong: "+n.min+" "+n.max+". Expecting Date objects. Ensure that time is properly parsed in the data from reader");var i={};t.start-n.min==0&&(t.start||t.startOrigin)||(i.start=d3.max([n.min,t.parse(t.startOrigin)])),t.end-n.max==0&&(t.end||t.endOrigin)||(i.end=d3.min([n.max,t.parse(t.endOrigin)])),t.set(i,!1,!1),(i.start||i.end)&&e.forEach(function(e){s.forEach(e.getSubhooks(),function(e){e.which==t.dim&&e.buildScale()})}),t.validate()}}}),v=u.default.extend({init:function(t,e){this._id=s.uniqueId("t"),this.template=this.getToolTemplate(),this._super({placeholder:t,model:e}),this.prerender(),this.setCSSClasses(),this.setResizeHandler(),this.postrender()},createModel:function(t){t=t||{},t.bind=t.bind||{},this.model=new p(this,t),this.model.setInterModelListeners()},getToolTemplate:function(){return this.template||'<div class="vzb-tool vzb-tool-'+this.name+'"><div class="vzb-tool-stage"><div class="vzb-tool-viz"></div><div class="vzb-tool-time-speed-sliders"><div class="vzb-tool-timeslider"></div><div class="vzb-tool-stepped-speed-slider"></div></div></div><div class="vzb-tool-sidebar"><div class="vzb-tool-dialogs"></div><div class="vzb-tool-buttonlist"></div></div><div class="vzb-tool-datanotes vzb-hidden"></div><div class="vzb-tool-treemenu vzb-hidden"></div><div class="vzb-tool-datawarning vzb-hidden"></div><div class="vzb-tool-labels vzb-hidden"></div></div>'},getToolListeners:function(){var t=this,e=this;return s.extend(this.model_binds,{readyOnce:function(){return t.setResizeHandler()},change:function(t,n){e._ready&&(e.model.validate(),t.source.persistent&&e.model.trigger(new d.DefaultEvent(t.source,"persistentChange")))},hook_change:function(){e.model.state.time.splash||e.beforeLoading()},"resize:ui":function(){e._ready&&e.triggerResize()},"translate:locale":function(){e.translateStrings(),e.model.ui.setRTL(e.model.locale.isRTL())},load_error:function(){t.renderError(),t.error.apply(t,arguments)}})},setResizeHandler:function(){this.model.ui.setContainer(this.element)},getVizWidthHeight:function(){var t=0,e=0;return this.element?(t=d3.select(this.element).select(".vzb-tool-viz").node().clientWidth,e=d3.select(this.element).select(".vzb-tool-viz").node().clientHeight):s.warn("Tool getVizWidthHeight(): missing this.element"),{width:t,height:e}},triggerResize:s.throttle(function(){this.trigger("resize")},100),startLoading:function(){var t=this;this._super(),Promise.all([this.model.startPreload(),this.startPreload()]).then(this.afterPreload.bind(this)).then(this.loadSplashScreen.bind(this)).then(function(){return s.delay(300)}).then(this.model.startLoading.bind(this.model)).then(this.finishLoading.bind(this)).catch(function(e){f.default.unfreezeAll(),t.model.triggerLoadError(e)})},loadSplashScreen:function(){return this.model.ui.splash?(this.model.state.time.splash=!0,this.model.startLoading({splashScreen:!0})):Promise.resolve()},finishLoading:function(){this.model.state.time.splash=!1},getPersistentModel:function(){function t(e){for(var n in e)"function"==typeof e[n]?(delete e[n],s.warn("minModel validation. Function found in enumerable properties of "+n+". This key is deleted from minModel")):"object"===r(e[n])&&t(e[n])}var e=this.model.getPlainObject(!0);return t(e),e},getPersistentMinimalModel:function(t){var e=this.model.getDefaults(),n=this.getPersistentModel(),i=s.deepExtend(e,t);return s.diffObject(n,i)},clear:function(){this.model.ui.clear(),this.setModel=this.getModel=function(){},this._super()},error:function(t,e){e||(e=t&&"data"===t.type?"Error loading chart data. <br>Please, try again later.":"Error loading chart"),this.placeholder.innerHTML='<div class="vzb-error-message"><h1>'+h.warn+"</h1><p>"+e+"</p></div>"},setModel:function(t,e){e?this.model.reset(t):this.model.set(t),this.setCSSClasses()},getModel:function(){return this.model.getPlainObject()||{}},beforeLoading:function(){s.addClass(this.placeholder,"vzb-loading-data")},validate:function(t){if(!(t=this.model||t)||!t.state)return s.warn("tool validation aborted: model.state looks wrong: "+t)},setCSSClasses:function(){s.addClass(this.placeholder,"vzb-placeholder"),this.model.ui&&this.model.ui.buttons&&this.model.ui.buttons.length?s.removeClass(this.element,"vzb-buttonlist-off"):s.addClass(this.element,"vzb-buttonlist-off")}});e.default=v},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(i),a=n(36),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o={_continuous:{_default:"#ffb600",0:"hsl(270, 80%, 55%)",25:"hsl(202.5, 80%, 55%)",50:"hsl(135, 80%, 55%)",75:"hsl(48, 70%, 62%)",100:"hsl(0, 80%, 55%)"},_discrete:{_default:"#ffb600",0:"#4cd843",1:"#e83739",2:"#ff7f00",3:"#c027d4",4:"#d66425",5:"#0ab8d8",6:"#bcfa83",7:"#ff8684",8:"#ffb04b",9:"#f599f5",10:"#f4f459",11:"#7fb5ed"},_default:{_default:"#ffb600"}},l=s.default.extend({getClassDefaults:function(){var t={use:null,which:null,scaleType:null,syncModels:[],palette:{},paletteLabels:null,allow:{scales:["linear","log","genericLog","time","pow","ordinal"]}};return r.deepExtend(this._super(),t)},autoconfigureModel:function(){if(!this.which&&this.autoconfig){var t=this.dataSource.getConcept(this.autoconfig);if(t){var e={which:t.concept,use:t.use||"indicator",scaleType:t.scales&&t.scales[0]?t.scales[0]:"linear"};this.set(e)}else{var n={which:"_default",use:"constant",scaleType:"ordinal"};this.set(n)}r.printAutoconfigResult(this)}},init:function(t,e,n,i){var r=this;this._type="color",this._super(t,e,n,i),this._syncModelReferences={},this._hasDefaultColor=!1,this.on("hook_change",function(){if(!r._readyOnce&&!r._loadCall&&(r._setSyncModels(),r.palette&&0!==Object.keys(r.palette._data).length)){var t=r.getDefaultPalette(),e=r.getPalette(!0),n={};Object.keys(t).forEach(function(i){e[i]&&t[i]!=e[i]||(n[i]=t[i])}),r.set("palette",n,!1,!1)}})},setInterModelListeners:function(){this._super(),this._setSyncModels()},getColorShade:function(t){var e=this.getPalette();if(!t)return r.warn("getColorShade() is missing arguments");if(t.colorID&&e[t.colorID]||(t.colorID="_default"),!r.isArray(e[t.colorID]))return"shade"==t.shadeID?d3.rgb(e[t.colorID]).darker(.5).toString():e[t.colorID];var n=this.getConceptprops().color,i=t.shadeID&&n&&n.shades&&n.shades[t.shadeID]?n.shades[t.shadeID]:0;return e[t.colorID][i]},isUserSelectable:function(){var t=this.getConceptprops().color;return null==t||null==t.selectable||t.selectable},setWhich:function(t){this.palette&&(this.palette._data={}),this._super(t),this._setSyncModels()},_setSyncModels:function(){var t=this;this.syncModels.forEach(function(e){var n=t.getClosestModel(e),i=n.isHook()?n._parent:n,r=i.getClosestModel(i.space[0]);t._syncModelReferences[e]={model:n,marker:i,entities:r},t.isDiscrete()&&t._setSyncModel(n,i,r)})},_setSyncModel:function(t,e,n){if(t==e){var i={dim:this.which,show:{}};e.setDataSourceForAllSubhooks(this.data),n.set(i,!1,!1)}else t.isDiscrete()&&"constant"!==t.use&&t.set({which:this.which,data:this.data},!1,!1)},getColorlegendMarker:function(){return(this._syncModelReferences.marker_colorlegend||{}).marker},getColorlegendEntities:function(){return(this._syncModelReferences.marker_colorlegend||{}).entities},setColor:function(t,e,n){var i=void 0,a=this.getPalette();this.isDiscrete()?(i=this.scale.range(),i[this.scale.domain().indexOf(e)]=t):(a[e]=t,i=r.values(a)),this.scale.range(i),this.palette.set(e,t,n,n)},mapValue:function(t){return null!=this.scale&&this.isDiscrete()&&this._hasDefaultColor&&-1==this.scale.domain().indexOf(t)&&(t="_default"),this._super(t)},getDefaultPalette:function(){var t=this.getConceptprops().color,e=void 0;return this.discreteDefaultPalette=!1,t&&t.palette?e=r.clone(t.palette):o[this.which]?e=r.clone(o[this.which]):"constant"===this.use?e=/^#([0-9a-f]{3}|[0-9a-f]{6})$/.test(this.which)?{_default:this.which}:r.clone(o._default):(e=r.clone(o[this.isDiscrete()?"_discrete":"_continuous"]),this.discreteDefaultPalette=!0),e},_getPaletteLabels:function(){var t=this.getConceptprops().color,e=null;return t&&t.paletteLabels&&(e=r.clone(t.paletteLabels)),e},getPaletteLabels:function(){return this.paletteLabels.getPlainObject()},getPalette:function(t){if(!this.palette||0===Object.keys(this.palette._data).length){var e=this.getDefaultPalette();this.set("palette",e,!1,!1);var n=this._getPaletteLabels();this.set("paletteLabels",n,!1,!1)}var i=this.palette.getPlainObject();return"indicator"!==this.use||t||delete i._default,i},buildScale:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.scaleType,e=this,n=e.getPalette(),i=Object.keys(n),a=r.values(n);if(this._hasDefaultColor=i.indexOf("_default")>-1,"time"==t){var s=this._space.time,l=s.splash?{min:s.parse(s.startOrigin),max:s.parse(s.endOrigin)}:{min:s.start,max:s.end},c=l.max-l.min==0;i=i.sort(function(t,e){return t-e}),a=i.map(function(t){return c?n[i[0]]:n[t]}),i=i.map(function(t){return l.min.valueOf()+t/100*(l.max.valueOf()-l.min.valueOf())}),this.scale=d3.scaleUtc().domain(i).range(a).interpolate(d3.interpolateCubehelix)}else if(this.isDiscrete()){if(a=a.map(function(t){return r.isArray(t)?t[0]:t}),t="ordinal",this.discreteDefaultPalette){var u=r.extend({},o._discrete);delete u._default;var h=Object.keys(u);i=[].concat(this.getUnique(this.which)),a=i.map(function(t,e){return n[t]||u[h[e%h.length]]}),i.push("_default"),a.push(n._default)}this.scale=d3["scale"+r.capitalize(t)]().domain(i).range(a)}else{var d=this.getLimits(this.which);d=[d.min,d.max];var f=d[1]-d[0]==0;if(i=i.sort(function(t,e){return t-e}),a=i.map(function(t){return f?n[i[0]]:n[t]}),i=i.map(function(t){return d[0]+t/100*(d[1]-d[0])}),d3.min(i)<=0&&d3.max(i)>=0&&"log"===t&&(t="genericLog"),"log"===t||"genericLog"===t){var p=d3.scaleGenericlog().domain(d).range(d);i=i.map(function(t){return p.invert(t)})}this.scale=d3["scale"+r.capitalize(t)]().domain(i).range(a).interpolate(d3.interpolateCubehelix)}this.scaleType=t}});e.default=l},function(t,e,n){"use strict";function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(r),s=n(55),o=function(t){return t&&t.__esModule?t:{default:t}}(s),l=o.default.extend({getClassDefaults:function(){var t={show:{},dim:null,skipFilter:!1};return a.deepExtend(this._super(),t)},objectLeafs:["show","autoconfig"],dataConnectedChildren:["show","dim","grouping"],init:function(t,e,n,i){this._type="entities",this._super(t,e,n,i)},preloadData:function(){return this.dataSource=this.getClosestModel(this.data||"data"),this._super()},afterPreload:function(){this.autoconfigureModel()},autoconfigureModel:function(){if(!this.dim&&this.autoconfig){var t=this.dataSource.getConcept(this.autoconfig);t&&(this.dim=t.concept),a.printAutoconfigResult(this)}},getDimension:function(){return this.dim},setDimension:function(t){if(this.dim!==t.concept){var e={};e.show={},e.dim=t.concept,this.set(e)}},getFilter:function(){var t=void 0;return this.skipFilter?t={}:(t=a.deepClone(this.show),t[this.dim]&&a.isEmpty(t[this.dim])&&delete t[this.dim]),t},showEntity:function(t){var e=this,n=a.deepClone(this.show),i=this.getDimension(),r=void 0;r=a.isArray(t)?t:[t];var s=[];this.show[i]&&this.show[i].$in&&a.isArray(this.show[i].$in)&&(s=this.show[i].$in),a.forEach(r,function(t){var n=t[i];s=e.isShown(t)?s.filter(function(t){return t!==n}):s.concat(n)}),0===s.length?delete n[i]:n[i]={$in:s},this.show=n},isShown:function(t){var e=this.getDimension();return a.getProp(this.show,[e,"$in"],[]).includes(t[e])},clearShow:function(){var t=this.getDimension(),e=a.deepClone(this.show);delete e[t],this.show=e},getFilteredEntities:function(){var t=this.getDimension(),e=this.show[t]||{},n=e.$in;return(void 0===n?[]:n).map(function(e){return i({},t,e)})},isEntities:function(){return!0}});e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(i),a=n(36),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o=s.default.extend({getClassDefaults:function(){var t={use:null,which:null,merge:!1,manualSorting:null,scaleType:"ordinal"};return r.deepExtend(this._super(),t)},init:function(t,e,n,i){this._type="model",this._super(t,e,n,i)},validate:function(){this.scale&&(this.scale=null),"property"!=this.use&&"constant"!=this.use&&(r.warn("group model: use must be 'property' or 'constant'. Resetting to property..."),this.use="property")}});e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(i),a=n(36),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o=s.default.extend({getClassDefaults:function(){var t={use:null,which:null};return r.deepExtend(this._super(),t)},init:function(t,e,n,i){this._type="label",this._super(t,e,n,i)},autoconfigureModel:function(){if(!this.which&&this.autoconfig){var t=this.dataSource.getConcept(this.autoconfig)||this.dataSource.getConcept({type:"entity_domain"});t&&(this.which=t.concept),r.printAutoconfigResult(this)}}});e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(i),a=n(55),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o=["ar","ar-SA"],l=s.default.extend({getClassDefaults:function(){var t={id:"en",filePath:"assets/translation/"};return r.deepExtend(this._super(),t)},dataConnectedChildren:["id"],strings:{},init:function(t,e,n,i){this._type="locale",this._super(t,e,n,i)},_isLoading:function(){return!this._loadedOnce||this._loadCall},preloadData:function(){return this.loadData()},loadData:function(){var t=this;this.setReady(!1),this._loadCall=!0;var e=[];return r.forEach(this._root._data,function(t){"data"===t._type&&e.push(t.loadConceptProps())}),this.strings[this.id]||e.push(new Promise(function(e,n){d3.json(t.filePath+t.id+".json",function(i,r){if(i)return n(i);t._handleNewStrings(r),e()})})),Promise.all(e).then(function(){return t.trigger("translate")}).catch(function(){return t.handleLoadError()})},_handleNewStrings:function(t){this.strings[this.id]=this.strings[this.id]?r.extend(this.strings[this.id],t):t},getUIString:function(t){return this.strings&&this.strings[this.id]&&(this.strings[this.id][t]||""===this.strings[this.id][t])?this.strings[this.id][t]:(this.strings&&this.strings[this.id]||r.warn("Strings are not loaded for the "+this.id+" locale. Check if translation JSON is valid"),t)},getTFunction:function(){var t=this;return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(n).reduce(function(t,e){var i=new RegExp("{{"+e+"}}","g");return t.replace(i,n[e])},t.getUIString(e))}},isRTL:function(){return-1!==o.indexOf(this.id)}});e.default=l},function(t,e,n){"use strict";function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(r),s=n(49),o=function(t){return t&&t.__esModule?t:{default:t}}(s),l=o.default.extend({getClassDefaults:function(){var t={select:[],highlight:[],superHighlight:[],opacityHighlightDim:.1,opacitySelectDim:.3,opacityRegular:1,allowSelectMultiple:!0,skipFilter:!1};return a.deepExtend(this._super(),t)},init:function(t,e,n,i,r){var a=this;this._type="marker",this._visible=[],this._super(t,e,n,i,r),this.on("readyOnce",function(){var t={exceptType:"time"},e=a._getAllDimensions(t);a._multiDim=e.length>1})},setDataSourceForAllSubhooks:function(t){var e={};this.getSubhooks().forEach(function(n){e[n._name]={data:t}}),this.set(e,null,!1)},validate:function(){var t=this.getDimension(),e=this._visible.map(function(e){return e[t]});e.length&&(this.select=this.select.filter(function(n){return-1!==e.indexOf(n[t])}),this.setHighlight(this.highlight.filter(function(n){return-1!==e.indexOf(n[t])})))},setVisible:function(t){this._visible=t},getVisible:function(t){return this._visible},getSelected:function(t){return t?this.select.map(function(e){return e[t]}):this.select},selectMarker:function(t){var e=this,n=this._createValue(t);this.isSelected(t)?this.select=this.select.filter(function(t){return JSON.stringify(e._createValue(t))!==JSON.stringify(n)}):this.select=this.allowSelectMultiple?this.select.concat(n):[n]},selectAll:function(t,e){if(this.allowSelectMultiple){var n=void 0,i=this._getFirstDimension({exceptType:"time"});this.select=this._visible.map(function(t){return n={},n[i]=t[i],n})}},isSelected:function(t){var e=this,n=this._createValue(t);return-1!==this.select.map(function(t){return JSON.stringify(e._createValue(t))===JSON.stringify(n)}).indexOf(!0)},_createValue:function(t){return this._getAllDimensions({exceptType:"time"}).reduce(function(e,n){return e[n]=t[n],e},{})},getHighlighted:function(t){return t?this.highlight.map(function(e){return e[t]}):this.highlight},setHighlight:function(t){if(!a.isArray(t))return void this.setHighlight([].concat(t));this.getModelObject("highlight").set(t,!1,!1)},setSuperHighlight:function(t){this.getModelObject("superHighlight").set(a.isArray(t)?t:[t],!1,!1)},clearSuperHighlighted:function(){this.setSuperHighlight([])},isSuperHighlighted:function(t){var e=JSON.stringify(this._createValue(t));return~this.superHighlight.findIndex(function(t){return JSON.stringify(t)===e})},setSelect:function(t){if(!a.isArray(t))return void this.setSelect([].concat(t));this.getModelObject("select").set(t)},highlightMarker:function(t){var e=this._createValue(t);this.isHighlighted(t)||this.setHighlight(this.highlight.concat(e))},unhighlightEntity:function(t){var e=this._createValue(t);this.isHighlighted(t)&&this.setHighlight(this.highlight.filter(function(t){return t[dimension]!==e}))},isHighlighted:function(t){var e=this,n=this._createValue(t);return-1!==this.highlight.map(function(t){return JSON.stringify(e._createValue(t))===JSON.stringify(n)}).indexOf(!0)},clearHighlighted:function(){this.setHighlight([])},clearSelected:function(){this.select=[]},setLabelOffset:function(t,e){0===e[0]&&1===e[1]||(this.select.find(function(e){return a.comparePlainObjects(e,t)}).labelOffset=[Math.round(1e3*e[0])/1e3,Math.round(1e3*e[1])/1e3],this.set("select",this.select,!0))},getTimeLimits:function(){var t=this,e=this._parent.time,n=[],i=[],r=void 0,s=void 0,o={};this.cachedTimeLimits||(this.cachedTimeLimits={}),a.forEach(this.getSubhooks(),function(l){if("indicator"===l.use&&l._important&&l._dataId){var c=t.cachedTimeLimits[l._dataId+l.which];c?(r=c.min,s=c.max):(o=l.getValidItems().map(function(t){return t[e.getDimension()]}),0==o.length&&a.warn("getTimeLimits() was unable to work with an empty array of valid datapoints"),r=d3.min(o),s=d3.max(o)),t.cachedTimeLimits[l._dataId+l.which]={min:r,max:s},n.push(r),i.push(s)}});var l=d3.max(n),c=d3.min(i);return l>c&&(a.warn("getTimeLimits(): Availability of the indicator's data has no intersection. I give up and just return some valid time range where you'll find no data points. Enjoy!"),l=d3.min(n),c=d3.max(i)),!(!r&&!s)&&{min:l,max:c}},getImportantHooks:function(){var t=[];return a.forEach(this._dataCube||this.getSubhooks(!0),function(e,n){e._important&&t.push(n)}),t},getLabelHookNames:function(){var t=this;return a.unique(this._getAllDimensions({exceptType:"time"})).map(function(e){var n={};return a.forEach(t._dataCube||t.getSubhooks(!0),function(t,i){return"label"===t._type&&t.getEntity().dim===e&&(n.label=i),"label"!==t._type&&t.getEntity().dim===e&&(n.key=i),!n.label||!n.key}),n.label||n.key})},getKeysMD:function(){var t=[],e=a.unique(this._getAllDimensions({exceptType:"time"})),n=this._getFirstDimension({type:"time"});return a.forEach(this._dataCube||this.getSubhooks(!0),function(r,a){function s(e,n,r,a,o){var l=Object.keys(n);if(a<o)for(var c=a+1,u=0,h=l.length;u<h;u++){var d={};d[r[a]]=l[u],s(d,n[l[u]],r,c,o)}else t.push.apply(t,i(l.map(function(t){var n=Object.assign({},e);return n[r[a]]=t,n})))}if("constant"!==r.use&&"property"!==r.use&&r._important){s({},r.getNestedItems(e.concat(n)),e,0,e.length-1)}}),t},getKeys:function(t){var e=[];t=t||this._getFirstDimension();var n=this._getFirstDimension({type:"time"}),i=this._getGrouping();return a.forEach(this._dataCube||this.getSubhooks(!0),function(r,a){if("constant"!==r.use){var s=r.getNestedItems([t,n]),o=r.getHaveNoDataPointsPerKey();s.undefined&&delete s.undefined;var l=Object.keys(s),c=Object.keys(o||[]);if(l.length>0&&i&&i.key===t){var u=i.grouping;l=l.filter(function(t){return+t%u==0})}0==e.length&&(e=l),r._important&&(e=e.filter(function(t){return l.indexOf(t)>-1&&-1==c.indexOf(t)}))}}),e.map(function(e){var n={};return n[t]=e,n})},_getCachePath:function(t){var e=this._parent.time.getAllSteps(),n=this.getClosestModel("locale").id+" - "+e[0]+" - "+e[e.length-1];this._dataCube=this._dataCube||this.getSubhooks(!0);var i=!1,r=this._getGrouping();return a.forEach(this._dataCube,function(t,e){t._loadCall&&(i=!0),n=n+"_"+t._dataId+t.which}),i?null:(r&&(n=n+"_grouping_"+r.key+":"+r.grouping),t&&(n=n+"_"+t.join(",")),n)},_getGrouping:function(){var t=this._dataCube||this.getSubhooks(!0),e=t[Object.keys(t)[0]]._space,n={};return a.forEach(e,function(t){if(t.grouping)return n.grouping=t.grouping,n.key=t.dim,!1}),!!n.grouping&&n},_getAllDimensions:function(t){var e=[],n=this;a.forEach(this.space,function(t){e.push(n.getClosestModel(t))}),t=t||{};var i=[],r=void 0;return a.forEach(e,function(e){return!(!t.exceptType||e.getType()!==t.exceptType)||(!(!t.onlyType||e.getType()===t.onlyType)||void((r=e.getDimension())&&i.push(r)))}),i},_getFirstDimension:function(t){var e=[],n=this;a.forEach(this.space,function(t){e.push(n.getClosestModel(t))}),t=t||{};var i=!1;return a.forEach(e,function(e){return t.exceptType&&e.getType()!==t.exceptType?(i=e.getDimension(),!1):t.type&&e.getType()===t.type?(i=e.getDimension(),!1):t.exceptType||t.type?void 0:(i=e.getDimension(),!1)}),i},framesAreReady:function(){var t=this._getCachePath();return!!this.cachedFrames&&Object.keys(this.cachedFrames[t]).length==this._parent.time.getAllSteps().length},getFrame:function(t,e,n){var i=this;this.cachedFrames||(this.cachedFrames={});var r=this._parent.time.getAllSteps(),s=this._getCachePath();if(!s)return e(null,t);if(t&&i.cachedFrames[s]&&i.cachedFrames[s][t])return e(i.cachedFrames[s][t],t);if(!(s=this._getCachePath(n)))return e(null,t);if(t&&i.cachedFrames[s]&&i.cachedFrames[s][t])return e(i.cachedFrames[s][t],t);if(t&&r.length>1){var o=d3.bisectLeft(r,t);if(!r[o])return a.warn("The requested frame is out of range: "+t),e(null,t),null;if(r[o].toString()!=t.toString())return this._interpolateBetweenFrames(t,o,r,function(n){e(n,t)},n),null}i.getFrames(t,n).then(function(){return!t&&i.cachedFrames[s]?e(i.cachedFrames[s],t):i.cachedFrames[s]&&i.cachedFrames[s][t]?e(i.cachedFrames[s][t],t):(a.warn("marker.js getFrame: Data is not available for frame: "+t),e(null,t))})},_interpolateBetweenFrames:function(t,e,n,i,r){var s=this;if(0==e)this.getFrame(n[e],function(t){return i(t)},r);else{var o=n[e-1],l=n[e];this.getFrame(o,function(e){s.getFrame(l,function(n){function r(e,n,i,r,s,o,l){e[n]=r[n],a.isDate(o)?s[i]=t:a.isNumber(o)?s[i]=null==o||null==l?null:o+(l-o)*c:s[i]=o}var c=(t-o)/(l-o),u={};a.forEach(e,function(e,i){if(u[i]={},s._multiDim&&"indicator"==s[i].use&&s[i].which!==s._getFirstDimension({type:"time"})){var o=u[i],l=s[i].dataSource.getData(s[i]._dataId,"query"),h=l.animatable,d=l.select.key.slice(0);h&&-1!=d.indexOf(h)&&d.splice(d.indexOf(h),1);var f=d.length-1;!function t(e,n,i,a,s,l){for(var c=Object.keys(a),u=0,h=c.length;u<h;u++)if(0==l&&(i=c[u]),l==f)r(o,i,c[u],e,n,a[c[u]],s[c[u]]);else{0==l&&(n=e={});var d=l+1;n[c[u]]={},t(e,n[c[u]],i,a[c[u]],s[c[u]],d)}}(null,null,null,e,n[i],0)}else a.forEach(e,function(e,r){var s=n[i][r];a.isDate(e)?u[i][r]=t:a.isNumber(e)?u[i][r]=null==e||null==s?null:e+(s-e)*c:u[i][r]=e})}),i(u)},r)},r)}},getFrames:function(t,e){var n=this;this.cachedFrames||(this.cachedFrames={});var i=this._getFirstDimension(),r=this._getFirstDimension({type:"time"});this.frameQueues||(this.frameQueues={}),this.partialResult||(this.partialResult={});var s=this._parent.time.getAllSteps(),o=this._getCachePath(e);return o?(this.frameQueues[o]&&this.frameQueues[o]instanceof Promise||(this.frameQueues[o]=new Promise(function(t,l){n.partialResult[o]={},s.forEach(function(t){n.partialResult[o][t]={}});var c=n.getKeys(),u=[];if(a.forEach(n._dataCube,function(t,e){"constant"===t.use?s.forEach(function(r){n.partialResult[o][r][e]={},c.forEach(function(a){n.partialResult[o][r][e][a[i]]=t.which})}):t.which===i?s.forEach(function(t){n.partialResult[o][t][e]={},c.forEach(function(r){n.partialResult[o][t][e][r[i]]=r[i]})}):t.which===r?s.forEach(function(t){n.partialResult[o][t][e]={},c.forEach(function(r){n.partialResult[o][t][e][r[i]]=new Date(t)})}):u.push(t)}),u.length>0){var h=[];a.forEach(u,function(t){h.push(new Promise(function(i,r){var l={name:t._name,which:t.which};t.getFrames(s,e).then(function(t){a.forEach(t,function(t,e){n.partialResult[o][e][l.name]=t[l.which]}),i()})}))}),Promise.all(h).then(function(){n.cachedFrames[o]=n.partialResult[o],t()})}else n.cachedFrames[o]=n.partialResult[o],t()})),new Promise(function(l,c){if(s.length<2||!t)n.frameQueues[o].then(function(){l()});else{var u=[];a.forEach(n._dataCube,function(a,l){"constant"!==a.use&&a.which!==i&&a.which!==r&&function(i,r){u.push(new Promise(function(a,l){i.getFrame(s,t,e).then(function(e){n.partialResult[o][t][r]=e[t][i.which],a()})}))}(a,l)}),u.length>0?Promise.all(u).then(function(){n.cachedFrames[o]||(n.cachedFrames[o]={}),n.cachedFrames[o][t]=n.partialResult[o][t],l()}):l()}})):new Promise(function(t,e){t()})},listenFramesQueue:function(t,e){var n=this,i=this._getFirstDimension(),r=this._getFirstDimension({type:"time"}),s=this._parent.time.getAllSteps(),o={};this.getFrames();var l=[],c=s.length,u=!1;a.forEach(n._dataCube,function(a,h){"constant"!==a.use&&a.which!==i&&a.which!==r&&(l.includes(a._dataId)||(l.push(a._dataId),a.dataSource.listenFrame(a._dataId,s,t,function(t,i){var r=i.toString();void 0===o[r]&&(o[r]=[]),o[r].includes(t)||o[r].push(t),o[r].length===l.length&&(u||c!==Object.keys(o).length||(u=!0,n.trigger("dataLoaded")),e(i))})))})},getEntityLimits:function(t){var e=this,n=this._parent.time.getAllSteps(),i=[],r=[];a.forEach(e.getSubhooks(),function(t){"constant"!=t.use&&t._important&&r.push(t._name)});var s=function(e){if(!e)return!1;for(var n=0,i=r.length;n<i;n++)if(!e[r[n]][t]&&0!==e[r[n]][t])return!1;return!0},o=function t(i,r){var a=i();null!=a&&e.getFrame(n[a],function(e){s(e)?r(a):t(i,r)})},l=[];return l.push(new Promise(function(t,e){o(function(){var t=n.length,e=0;return function(){return e<t?e++:null}}(),function(e){i[0]=n[e],t()})})),l.push(new Promise(function(t,e){o(function(){var t=n.length-1;return function(){return t>=0?t--:null}}(),function(e){i[1]=n[e],t()})})),Promise.all(l).then(function(){return{min:i[0],max:i[1]}})},getSpace:function(){if(a.isArray(this.space))return this.space;a.error('ERROR: space not found.\n You must specify the objects this hook will use under the "space" attribute in the state.\n Example:\n space: ["entities", "time"]')}});e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(i),a=n(36),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o=s.default.extend({getClassDefaults:function(){var t={use:null,which:null};return r.deepExtend(this._super(),t)},init:function(t,e,n,i){this._type="side",i.readyOnce=this.readyOnce,this.state={left:{},right:{}},this._super(t,e,n,i)},readyOnce:function(){if(this.spaceRef){var t=this._space[this.spaceRef].dataConnectedChildren.slice(0);t.splice(t.indexOf("show"),1),this._space[this.spaceRef].dataConnectedChildren=t}},switchSideState:function(){var t=this.state.left;this.state.left=this.state.right,this.state.right=t},clearSideState:function(){this.state={left:{},right:{}}}});e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(105),r=function(t){return t&&t.__esModule?t:{default:t}}(i),a=n(1),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(a),o=r.default.extend({getClassDefaults:function(){var t={use:null,which:null,domainMin:null,domainMax:null,zoomedMin:null,zoomedMax:null,extent:[0,.85],scaleType:null,allow:{scales:["ordinal","linear","log","genericLog","pow"]}};return s.deepExtend(this._super(),t)},_type:"size",buildScale:function(){this._super(),"ordinal"!==this.scaleType&&this.scale.clamp(!0)},autoconfigureModel:function(){if(!this.which&&this.autoconfig){var t=this.dataSource.getConcept(this.autoconfig);t?(this.which=t.concept,this.use="indicator",this.scaleType="linear"):(this.which="_default",this.use="constant",this.scaleType="ordinal"),s.printAutoconfigResult(this)}}});e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(i),a=n(36),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o={ALL:"all",_default:"none"},l=s.default.extend({getClassDefaults:function(){var t={use:null,which:null,merge:!1};return r.deepExtend(this._super(),t)},init:function(t,e,n,i){this._type="model",this._super(t,e,n,i)},validate:function(){this.scale&&(this.scale=null),"indicator"===this.use&&(r.warn("stack model: use must not be 'indicator'. Resetting use to 'constant' and which to '"+o._default),this.use="constant",this.which=o._default),"constant"===this.use&&-1==r.values(o).indexOf(this.which)&&(r.warn("stack model: the requested value '"+this.which+"' is not allowed. resetting to '"+o._default),this.which)},getPalettes:function(){return o},buildScale:function(){}});e.default=l},function(t,e,n){"use strict";function i(){var t=function(t){return e(t)+"w"+n(t)};t.parse=function(t){var e=t.match(/^(\d{4})w(\d{2})$/);return e?i(e[1],e[2]):null};var e=function(t){var e=+t;return new Date(e+864e5*(4-(t.getUTCDay()||7))).getUTCFullYear()},n=function(t){var e=+t,n=new Date(e+864e5*(4-(t.getUTCDay()||7))),i=Math.ceil(((n.getTime()-n.setUTCMonth(0,1))/864e5+1)/7);return i<10?"0"+i:i},i=function(t,e){var n=parseInt(e),i=t,r=new Date;r.setUTCFullYear(i),r.setUTCMonth(0),r.setUTCDate(4);var a=r.getUTCDay()||7,s=7*n+1-(a+4),o=c.year.parse(i);return o=new Date(o.getTime()+24*s*60*60*1e3)};return t}function r(){var t=function(t){return c.year.data(t)+"q"+e(t)};t.parse=function(t){var e=t.match(/^(\d{4})q(\d)$/);return e?n(e[1],e[2]):null};var e=function(t){return t instanceof Date||(t=new Date(+t)),1+(t.getUTCMonth()/3|0)},n=function(t,e){var n=parseInt(e),i=3*n-2,r=t;return c.month.data.parse([r,(i<9?"0":"")+i].join("-"))};return t}Object.defineProperty(e,"__esModule",{value:!0});var a=n(1),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(a),o=n(55),l=function(t){return t&&t.__esModule?t:{default:t}}(o);Date.prototype.utc=Date.prototype.toUTCString;var c={year:{data:d3.time.format.utc("%Y"),ui:d3.time.format.utc("%Y")},month:{data:d3.time.format.utc("%Y-%m"),ui:d3.time.format.utc("%b %Y")},day:{data:d3.time.format.utc("%Y%m%d"),ui:d3.time.format.utc("%c")},hour:{data:d3.time.format.utc("%Y%m%dT%H"),ui:d3.time.format.utc("%b %d %Y, %H")},minute:{data:d3.time.format.utc("%Y%m%dT%H%M"),ui:d3.time.format.utc("%b %d %Y, %H:%M")},second:{data:d3.time.format.utc("%Y%m%dT%H%M%S"),ui:d3.time.format.utc("%b %d %Y, %H:%M:%S")},week:{data:i(),ui:i()},quarter:{data:r(),ui:r()}},u=l.default.extend({objectLeafs:["autoconfig"],getClassDefaults:function(){var t={dim:null,value:null,start:null,end:null,startOrigin:null,endOrigin:null,startSelected:null,endSelected:null,playable:!0,playing:!1,loop:!1,round:"round",delay:150,delayThresholdX2:90,delayThresholdX4:45,unit:"year",format:{data:null,ui:null},step:1,immediatePlay:!0,record:!1,offset:0};return s.deepExtend(this._super(),t)},dataConnectedChildren:["startOrigin","endOrigin","dim"],init:function(t,e,n,i){this._type="time",this._super(t,e,n,i);var r=this;this.initFormatters(),this.dragging=!1,this.postponePause=!1,this.allSteps={},this.delayAnimations=this.delay,this.on({"change:playing":function(){!0===r.playing?r._startPlaying():r._stopPlaying()},"change:format":function(){r.initFormatters()}})},initFormatters:function(){c[this.unit]&&(this.formatters=c[this.unit]),"string"==typeof this.format?this.formatters.data=this.formatters.ui=d3.time.format.utc(this.format):(this.format.data&&(this.formatters.data=d3.time.format.utc(this.format.data)),this.format.ui&&(this.formatters.ui=d3.time.format.utc(this.format.ui))),this.validateFormatting()},preloadData:function(){return this.dataSource=this.getClosestModel(this.data||"data"),this._super()},afterPreload:function(){this.autoconfigureModel()},autoconfigureModel:function(){if(!this.dim&&this.autoconfig){var t=this.dataSource.getConcept(this.autoconfig);t&&(this.dim=t.concept),s.printAutoconfigResult(this)}},_formatToDates:function(){for(var t=["value"],e=["value","start","end","startSelected","endSelected"],n=0;n<e.length;n++){var i=e[n];if(!s.isDate(this[i])){var r=this.parse(this[i]);this.set(i,r,null,-1!==t.indexOf(i))}}},formatDate:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data";return-1===["data","ui"].indexOf(e)&&(s.warn("Time.formatDate type parameter ("+e+') invalid. Using "data".'),e=data),null==t?null:this.formatters[e](t)},parse:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data";return null==t?null:this.formatters[e].parse(t.toString())},findFormat:function(t){for(var e=Object.keys(c),n=0;n<e.length;n++){var i=c[e[n]].data.parse(t);if(i)return{unit:e[n],time:i,type:"data"};if(i=c[e[n]].ui.parse(t))return{unit:e[n],time:i,type:"ui"}}return null},validate:function(){null==this.start&&this.startOrigin&&this.set("start",this.startOrigin,null,!1),null==this.end&&this.endOrigin&&this.set("end",this.endOrigin,null,!1),this.formatters&&this.validateFormatting(),c[this.unit]||(s.warn(this.unit+' is not a valid time unit, using "year" instead.'),this.unit="year"),this.step<1&&(this.step=1),this.end<this.start&&null!=this.start&&this.set("end",new Date(this.start),null,!1),this.value<this.startSelected&&null!=this.startSelected&&(this.value=new Date(this.startSelected)),this.value>this.endSelected&&null!=this.endSelected&&(this.value=new Date(this.endSelected)),!1===this.splash&&((!this.startSelected||this.startSelected<this.start)&&null!=this.start&&this.set({startSelected:new Date(this.start)},null,!1),(!this.endSelected||this.endSelected>this.end)&&null!=this.end&&this.set({endSelected:new Date(this.end)},null,!1)),this.value<this.start&&null!=this.start?this.value=new Date(this.start):this.value>this.end&&null!=this.end&&(this.value=new Date(this.end)),!1===this.playable&&!0===this.playing&&this.set("playing",!1,null,!1)},validateFormatting:function(){null==this.value&&this.set("value",this.parse(this.formatDate(new Date)),null,!1),s.isDate(this.start)&&s.isDate(this.end)&&s.isDate(this.value)&&s.isDate(this.startSelected)&&s.isDate(this.endSelected)||this._formatToDates()},play:function(){this._startPlaying()},pause:function(t){t?this.postponePause=!0:this.playing&&(this.set("playing",!1,null,!1),this.set("value",this.value,!0,!0))},dragStart:function(){this.dragging=!0},dragStop:function(){this.dragging=!1},getRange:function(){var t=this.getIntervalAndStep();return d3["utc"+t.interval].range(this.start,this.end,t.step)},getIntervalAndStep:function(){var t=void 0,e=void 0;switch(this.unit){case"week":t="monday",e=this.step;break;case"quarter":t="month",e=3*this.step;break;default:t=this.unit,e=this.step}return{interval:s.capitalize(t),step:e}},getFilter:function(t){var e=this.parse(this.startOrigin),n=this.parse(this.endOrigin),i=this.getDimension(),r=null;if(t)null!=this.value&&(r={},r[i]=this.formatters.data(this.value));else{var a=void 0,s=void 0;null!=e&&(a=this.formatters.data(e)),null!=n&&(s=this.formatters.data(n)),(a||s)&&(r={},r[i]={},a&&(r[i].$gte=a),s&&(r[i].$lte=s))}return r},getParser:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data";return this.formatters[t].parse},getFormatter:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data";return this.formatters[t]},getAllSteps:function(){if(!this.start||!this.end)return s.warn("getAllSteps(): invalid start/end time is detected: "+this.start+", "+this.end),[];var t=""+this.offset+this.start+this.end+this.step;if(this.allSteps[t])return this.allSteps[t];this.allSteps[t]=[];for(var e=this.getIntervalAndStep(),n=d3["utc"+e.interval].offset(this.start,this.offset);+n<=+this.end;){var i=this.getIntervalAndStep();this.allSteps[t].push(n),n=d3["utc"+i.interval].offset(n,i.step)}return this.allSteps[t]},snap:function(t){if(this.round){null==t&&(t="value");var e="round";"ceil"===this.round&&(e="ceil"),"floor"===this.round&&(e="floor");var n=this.getIntervalAndStep(),i=d3["utc"+n.interval][e](this[t]);this.value-i==0&&this.value-this.start!=0&&this.value-this.end!=0||this.set(t,i,!0)}},_startPlaying:function(){if(this.playable){var t=this;this.value>=this.endSelected&&t.getModelObject("value").set(t.startSelected,null,!1),this.set("playing",!0,null,!1),this.playInterval(this.immediatePlay),this.trigger("play")}},playInterval:function(t){if(this.playing){var e=this;this.delayAnimations=this.delay,this.delay<this.delayThresholdX2&&(this.delayAnimations*=2),this.delay<this.delayThresholdX4&&(this.delayAnimations*=2);var n=t?1:this.delayAnimations;this._intervals.setInterval("playInterval_"+this._id,function(){if(e.value>=e.endSelected)e.loop?e.getModelObject("value").set(e.startSelected,null,!1):e.set("playing",!1,null,!1);else if(e._intervals.clearInterval("playInterval_"+e._id),e.postponePause||!e.playing)e.set("playing",!1,null,!1),e.postponePause=!1,e.getModelObject("value").set(e.value,!0,!0);else{var t=e.getIntervalAndStep();e.delay<e.delayThresholdX2&&(t.step*=2),e.delay<e.delayThresholdX4&&(t.step*=2);var n=d3["utc"+t.interval].offset(e.value,t.step);n>=e.endSelected?e.getModelObject("value").set(e.endSelected,null,!0):e.getModelObject("value").set(n,null,!1),e.playInterval()}},n)}},incrementTime:function(t){var e=this.getIntervalAndStep();return d3["utc"+e.interval].offset(t,e.step)},decrementTime:function(t){var e=this.getIntervalAndStep();return d3["utc"+e.interval].offset(t,-e.step)},_stopPlaying:function(){this._intervals.clearInterval("playInterval_"+this._id),this.trigger("pause")}});e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(i),a=n(49),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o=s.default.extend({screen_profiles:{small:{min_width:0,min_height:0},medium:{min_width:600,min_height:400},large:{min_width:900,min_height:520}},getClassDefaults:function(){var t={presentation:!1,buttons:[],dialogs:{popup:[],sidebar:[],moreoptions:[]},splash:!1};return r.deepExtend(this._super(),t)},init:function(t,e,n,i){this._type="ui",this._container=null,this._curr_profile="small",this._prev_size={},this.resizeHandler=this.resizeHandler.bind(this),window.addEventListener("resize",this.resizeHandler),i["change:presentation"]=this.updatePresentation.bind(this),this._super(t,e,n,i);(function(){var t=/(?:iPad|iPhone|iPod).+OS\s+(\d+)_(\d+)/.exec(navigator.userAgent);return t&&+t[1]>=10&&+t[2]>2&&!window.MSStream})()&&(this.setSize=r.debounce(this.setSize,500))},resizeHandler:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._container&&this.setSize(t.force||!1)},setSize:function(t){var e=this,n=this._container.clientWidth,i=this._container.clientHeight;if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&navigator.userAgent.match(/iPhone/i)&&(this._container.style.top=0,this._container.clientWidth>this._container.clientHeight&&this._container.clientWidth<700)){var a=this._container.clientHeight,s=window.innerHeight;2<a-s&&a-s<=45&&(this._container.style.top="44px",document.body.scrollTop=44)}(t||!this._prev_size||this._prev_size.width!==n||this._prev_size.height!==i)&&n&&i&&(r.forEach(this.screen_profiles,function(t,a){r.removeClass(e._container,"vzb-"+a),n>=t.min_width&&i>=t.min_height&&(e._curr_profile=a)}),r.addClass(this._container,"vzb-"+this._curr_profile),r.classed(this._container,"vzb-portrait",n<i),r.classed(this._container,"vzb-landscape",!(n<i)),this._prev_size.width=n,this._prev_size.height=i,this.trigger("resize"))},setContainer:function(t){t.clientWidth&&t.clientHeight||r.warn("Vizabi is being initialised with a container of incorrect width or height. While this may be handled without a crash, it's not considered a healthy behavior. You should call Vizabi(placeholder,...) function when placeholder is not display:none and has some >0 !=auto width and height"),this._container=t,this.setSize(),this.updatePresentation()},updatePresentation:function(){r.classed(this._container,"vzb-presentation",this.presentation),this.trigger("resize")},getPresentationMode:function(){return this.presentation},setRTL:function(t){r.classed(this._container,"vzb-rtl",t)},currentProfile:function(){return this._curr_profile},clear:function(){window.removeEventListener("resize",this.resizeHandler)}});e.default=o},function(t,e,n){"use strict";function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function r(){return function t(e){function n(t){var e=b(t);return u?u(e.scale(t*e.sign)):e.scale(t*e.sign)}var r=[],a=[],s=.1,o=5,l=e.domain(),c=e.range(),u=null,h=void 0,d=void 0,f=function(t){return t instanceof Array?t.map(function(t){return Math.abs(t)}):Math.abs(t)},p=function(t,e){return{domain:t,sign:1,range:e,scale:d3.scaleLinear().domain(t).range(e)}},v=function(t,e,n){var i=t;return n&&(i=f(t)),{domain:t,sign:n?-1:1,range:e,scale:d3.scaleLog().domain(i).range(e)}},g=function(){h=c[0]<c[c.length-1];var t=h?1:-1;if(r=[],1==a.length)r=a[0][0]<=0&&a[0][1]>=0?[p(a[0],c)]:[v(a[0],c,a[0][0]<=0)];else{var n=d3.max(f(l)),i=f(d3.max(c)-d3.min(c)),u=1,g=0,m=0,b=0,_=0;e.domain([s,n]).range([0,i]);var y=o;0!=l[0]&&f(l[0])>s&&(g=e(f(l[0]))),0!=l[l.length-1]&&f(l.length-1)>s&&(m=e(f(l[l.length-1]))),f(l[0])>s&&(b=y),f(l[l.length-1])>s&&(_=y),i=i-b-_,0!=m&&(u=f(g/m));var M=void 0,w=void 0;2==a.length?0==l[0]||f(l[0])<=s?(M=c[0]+g*u*t+_*t,r=[p(a[0],[c[0],M]),v(a[1],[M,c[c.length-1]],!d)]):(0==l[l.length-1]||f(l[l.length-1])<=s)&&(M=c[c.length-1]-(b+_)*u*t,r=[v(a[0],[c[0],M],d),p(a[1],[M,c[c.length-1]])]):(M=c[0]+i/(1/u+1)*t,w=c[0]+(i/(1/u+1)+b+_)*t,r=[v(a[0],[c[0],M],d),p(a[1],[M,w]),v(a[2],[w,c[c.length-1]],!d)])}},m=function(){if(d=l[0]<l[l.length-1],a=[],d3.min(l)>0&&d3.max(l)>0||d3.min(l)<0&&d3.max(l)<0)a=[l];else{var t=void 0,e=void 0;d?(t=l[0],e=l[l.length-1]):(t=l[l.length-1],e=l[0]);for(var n=function(t,e){d?a.push([t,e]):a.unshift([e,t])};t!=e;)e<=-s||t>=-s&&e<=s||t>=s?(n(t,e),t=e):t<-s&&e>=-s?(n(t,-s),t=-s):t>=-s&&e>=s?(n(t,s),t=s):(console.warn("Something wrong while build subdomains: "+t+" "+e),t=e)}g()},b=function(t){if(d){if(t<l[0])return r[0];if(t>l[l.length-1])return r[r.length-1];for(var e=0;e<r.length;e++)if(t>=r[e].domain[0]&&t<=r[e].domain[r[e].domain.length-1])return r[e]}else{if(t>l[0])return r[0];if(t<l[l.length-1])return r[r.length-1];for(var n=0;n<r.length;n++)if(t<=r[n].domain[0]&&t>=r[n].domain[r[n].domain.length-1])return r[n]}},_=function(t){if(h){if(t<c[0])return r[0];if(t>c[c.length-1])return r[r.length-1];for(var e=0;e<r.length;e++)if(t>=r[e].range[0]&&t<=r[e].range[r[e].range.length-1])return r[e]}else{if(t>c[0])return r[0];if(t<c[c.length-1])return r[r.length-1];for(var n=0;n<r.length;n++)if(t<=r[n].range[0]&&t>=r[n].range[1])return r[n]}};return Math.sign=Math.sign||function(t){return t=+t,0===t||isNaN(t)?t:t>0?1:-1},n.eps=function(t){return arguments.length?(s=t,n.domain(l),n):s},n.delta=function(t){return arguments.length?(o=t,n.range(c),n):o},n.domain=function(t){if(!arguments.length)return l;switch(t.length){case 0:t=l;break;case 1:t=[t[0]/2,2*t[0]]}t[0]==t[t.length-1]&&(t[0]/=2,t[t.length-1]=2*t[t.length-1]),l=t;var e=d3.min(f(l).filter(function(t){return!!t}));return e&&(s=Math.min(s,e/100)),m(),n},n.range=function(t,e){if(!arguments.length)return u?u.range():c;switch(t.length){case 0:t=c;break;case 1:t=[t[0]-100,t[0]+100]}if(u&&!e)u.range(t);else{c=t;var i=d3.min(f(c).filter(function(t){return!!t}));i&&(o=Math.min(o,i/100)),g()}return n},n.interpolate=function(t){var e=l;if(a.length>1){var i=l,r=c,s=[l[0],l[l.length-1]];n.domain(s).range(s),e=i.map(function(t){return n(t)}),n.domain(i).range(r)}return u=d3.scaleLinear().domain(e).range(c).interpolate(t),n.range(u.domain(),!0),n},n.invert=function(t){var e=_(t);return e.scale.invert(t)*e.sign},n.ticks=function(t){for(var e=void 0,n=[],a=0;a<r.length;a++)e=-1==r[a].sign?r[a].scale.ticks().reverse().map(function(t){return-1*t}):r[a].scale.ticks(),n.length>0&&e.length>0&&n[n.length-1]==e[0]&&e.splice(0,1),n.push.apply(n,i(e));return n},n.copy=function(){return t(e).domain(l).range(c).delta(o).eps(s)},d3.rebind(n,e,"base","rangeRound","clamp","nice","tickFormat")}(d3.scaleLog().domain([.1,200]).range([0,1e3]))}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){"use strict";function i(t,e,n){var i,r,a,s=e?".onTap":".onLongTap";d3.select(t).on("touchstart"+s,function(t,e){i=d3.event.timeStamp,r=d3.event.changedTouches[0].screenX,a=d3.event.changedTouches[0].screenY}).on("touchend"+s,function(t,s){return r=Math.abs(r-d3.event.changedTouches[0].screenX),a=Math.abs(a-d3.event.changedTouches[0].screenY),r<5&&a<5?d3.event.timeStamp-i<500?e?e(t,s):void 0:n?n(t,s):void 0:void 0})}Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){return this.each(function(){i(this,t)})},a=function(t){return this.each(function(){i(this,null,t)})};e.default={onTap:r,onLongTap:a},e.onTap=r,e.onLongTap=a},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=n(395),o=i(s),l=n(75),c=i(l),u={},h=c.default.extend({_name:"csv",init:function(t){var e=this;this._data=[],this._lastModified=t.lastModified||"",this._basepath=t.path,this.delimiter=t.delimiter,this.keySize=t.keySize||1,this._parseStrategies=[].concat(r([",.",".,"].map(function(t){return e._createParseStrategy(t)})),[function(t){return t}]),Object.assign(this.ERRORS,{WRONG_TIME_COLUMN_OR_UNITS:"reader/error/wrongTimeUnitsOrColumn",NOT_ENOUGH_ROWS_IN_FILE:"reader/error/notEnoughRows",UNDEFINED_DELIMITER:"reader/error/undefinedDelimiter",EMPTY_HEADERS:"reader/error/emptyHeaders"})},ensureDataIsCorrect:function(t,e){var n=t.columns,i=t.rows,r=n[this.keySize],s=a(i,1),o=s[0],l=e[r],c=o[r].trim();if(l&&!l(c))throw this.error(this.ERRORS.WRONG_TIME_COLUMN_OR_UNITS,void 0,{currentYear:(new Date).getFullYear(),foundYear:c});if(!n.filter(Boolean).length)throw this.error(this.ERRORS.EMPTY_HEADERS)},getDatasetInfo:function(){return{name:this._basepath.split("/").pop()}},load:function(){var t=this,e=this._basepath,n=this._lastModified;return new Promise(function(i,r){var a=u[e+n];a?i(a):d3.text(e).get(function(a,s){if(!s)return r("No permissions or empty file: "+e+". "+a);if(a)return r("Error happened while loading csv file: "+e+". "+a);try{var o=t.delimiter,l=void 0===o?t._guessDelimiter(s):o,c=d3.dsvFormat(l),h=c.parse(s,function(t){return Object.keys(t).every(function(e){return!t[e]})?null:t}),d=h.columns,f={columns:d,rows:h};u[e+n]=f,i(f)}catch(t){return r(t)}})})},_guessDelimiter:function(t){var e=this._getRows(t.replace(/"[^\r]*?"/g,""),2);if(2!==e.length)throw this.error(this.ERRORS.NOT_ENOUGH_ROWS_IN_FILE);var n=a(e,2),i=n[0],r=n[1],s=this._countCharsInLine(i,","),o=this._countCharsInLine(i,";"),l=this._countCharsInLine(r,","),c=this._countCharsInLine(r,";");if(this._checkDelimiters(s,l,o,c))return",";if(this._checkDelimiters(o,c,s,l))return";";throw this.error(this.ERRORS.UNDEFINED_DELIMITER)},_checkDelimiters:function(t,e,n,i){return t===e&&t>1&&(n!==i||!n&&!i||t>n&&e>i)},_getRows:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=/([^\r\n]+)/g,i=[],r=0,a=!0;a&&r!==e;)(a=n.exec(t))&&a.length>1&&(++r,i.push(a[1]));return i},_countCharsInLine:function(t,e){var n=new RegExp(e,"g"),i=t.match(n);return i?i.length:0},_createParseStrategy:function(t){var e=this;return function(n){if(!new RegExp("[^-\\d"+t+"]").test(n)&&n){var i=(0,o.default)(n,t);return isFinite(i)&&!isNaN(i)||(e._isParseSuccessful=!1),i}return n}},_mapRows:function(t,e,n){var i=this._getRowMapper(e,n),r=!0,a=!1,s=void 0;try{for(var o,l=this._parseStrategies[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var c=o.value;this._parse=c,this._isParseSuccessful=!0;var u=[],h=!0,d=!1,f=void 0;try{for(var p,v=t[Symbol.iterator]();!(h=(p=v.next()).done);h=!0){var g=p.value,m=i(g);if(!this._isParseSuccessful)break;u.push(m)}}catch(t){d=!0,f=t}finally{try{!h&&v.return&&v.return()}finally{if(d)throw f}}if(this._isParseSuccessful)return u}}catch(t){a=!0,s=t}finally{try{!r&&l.return&&l.return()}finally{if(a)throw s}}},versionInfo:{version:"0.26.6",build:1509004488665}});e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(i),a=n(76),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o={TEXT_PARAMS:{TOP:11,LEFT:10,MAX_WIDTH:42,MAX_HEIGHT:16},THUMB_STROKE_WIDTH:4},l={small:{minRadiusPx:.5,maxRadiusEm:.05},medium:{minRadiusPx:1,maxRadiusEm:.05},large:{minRadiusPx:1,maxRadiusEm:.05}},c=s.default.extend({init:function(t,e){this.name="bubblesize";var n=r.extend({},o);this.options=r.extend(n,this.options||{});var i=r.extend({},l);this.profiles=r.extend(i,this.profiles||{}),this.model_expects=[{name:"submodel",type:"size"},{name:"locale",type:"locale"}];this.changeHandler=this.changeHandler.bind(this),this.readyHandler=this.readyHandler.bind(this),this.model_binds={"change:submodel.domainMin":this.changeHandler,"change:submodel.domainMax":this.changeHandler},this._setModel=r.throttle(this._setModel,50),this._super(t,e)},changeHandler:function(t,e){var n=this.model.submodel.extent||[this.options.EXTENT_MIN,this.options.EXTENT_MAX];this._updateLabels(n),this._super(t,e)},readyHandler:function(t){this._super(t),this.sizeScaleMinMax=this.model.submodel.getScale().domain(),this._setLabelsText()},readyOnce:function(){var t=this;this._super(),this.showArcs=!1!==t.model.submodel.showArcs,this.padding.bottom=this.options.BAR_WIDTH+this.options.TEXT_PARAMS.MAX_HEIGHT,t.showArcs&&this.sliderEl.selectAll(".vzb-bs-slider-thumb-arc").data([0,0]).enter().append("path").attr("class","vzb-bs-slider-thumb-arc"),this.sliderArcsEl=this.sliderEl.selectAll(".vzb-bs-slider-thumb-arc"),this.sliderLabelsWrapperEl=this.sliderEl.append("g"),this.sliderLabelsWrapperEl.selectAll("text").data([0,0]).enter().append("text").attr("class","vzb-bs-slider-thumb-label").attr("text-anchor",function(t,e){return e?"start":"end"}).attr("dy",function(t,e){return e?"-0.7em":"1.4em"}),this.sliderLabelsEl=this.sliderEl.selectAll("text.vzb-bs-slider-thumb-label"),this.sizeScaleMinMax=this.model.submodel.getScale().domain(),this.sizeScaleMinMax&&this._setLabelsText()},ready:function(){this._super(),this._updateLabels()},getMinMaxBubbleRadius:function(){var t=this.root.getVizWidthHeight(),e=r.hypotenuse(t.width,t.height),n=this.profiles[this.getLayoutProfile()].minRadiusPx,i=this.profiles[this.getLayoutProfile()].maxRadiusEm*e;return n>i&&(i=n),{min:n,max:i}},_updateSize:function(){var t=this;this._super(),this.sliderLabelsWrapperEl.attr("transform",this.isRTL?"scale(-1,1)":null),this.sliderLabelsEl.attr("text-anchor",function(e,n){return(t.isRTL?!n:n)?"start":"end"})},_resize:function(){var t=this.getMinMaxBubbleRadius(),e=this.element.node().offsetWidth-2*t.max;this.padding.top=t.max+this.options.BAR_WIDTH,this.padding.left=.5*e,this.padding.right=.5*e,this.rescaler.range([2*t.min,2*t.max]),this._super()},_getComponentWidth:function(){return 2*this.getMinMaxBubbleRadius().max},_updateThumbs:function(t){this._updateArcs(t),this._updateLabels(t)},_updateArcs:function(t){if(this.showArcs){var e=this,n=d3.arc().outerRadius(function(t){return.5*e.rescaler(t)}).innerRadius(function(t){return.5*e.rescaler(t)}).startAngle(.5*-Math.PI).endAngle(.5*Math.PI);this.sliderArcsEl.data(t).attr("d",n).attr("transform",function(t){return"translate("+.5*e.rescaler(t)+",0)"})}},_updateLabels:function(t){var e=this,n=this;t&&this.sliderLabelsEl.data(t),this.sliderLabelsEl.attr("transform",function(t,i){var r={v:e.options.TEXT_PARAMS.TOP,h:e.options.TEXT_PARAMS.LEFT},a=r.h*(i?.5:-1)+n.rescaler(t);return"translate("+(n.isRTL?-1:1)*a+",0)"})},_setLabelsText:function(){var t=this,e=[t.model.submodel.getTickFormatter()(t.sizeScaleMinMax[0]),t.model.submodel.getTickFormatter()(t.sizeScaleMinMax[1])];t.sliderLabelsEl.text(function(t,n){return e[n]})}});e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(i),a=n(76),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o={},l={small:{minLabelTextSize:7,maxLabelTextSize:21,defaultLabelTextSize:12},medium:{minLabelTextSize:7,maxLabelTextSize:30,defaultLabelTextSize:15},large:{minLabelTextSize:6,maxLabelTextSize:48,defaultLabelTextSize:20}},c=s.default.extend({init:function(t,e){this.name="sizeslider";var n=r.extend({},o);this.options=r.extend(n,this.options||{});var i=r.extend({},l);this.profiles=r.extend(i,this.profiles||{}),this.propertyName=t.propertyname,this.model_expects=[{name:"submodel",type:"size"},{name:"locale",type:"locale"}];this.changeHandler=this.changeHandler.bind(this),this.readyHandler=this.readyHandler.bind(this),this.model_binds={"change:submodel.domainMin":this.changeHandler,"change:submodel.domainMax":this.changeHandler},this._setModel=r.throttle(this._setModel,50),this._super(t,e)},changeHandler:function(t,e){var n=this.model.submodel.extent||[this.options.EXTENT_MIN,this.options.EXTENT_MAX];this._updateLabels(n),this._super(t,e)},readyHandler:function(t){this.modelUse=this.model.submodel.use;var e=this.model.submodel.extent||[this.options.EXTENT_MIN,this.options.EXTENT_MAX];if("constant"!=this.modelUse)this.sizeScaleMinMax=this.model.submodel.getScale().domain(),this.sliderEl.selectAll(".w").classed("vzb-hidden",!1),this.sliderEl.select(".selection").classed("vzb-hidden",!1),this.sliderEl.select(".overlay").classed("vzb-pointerevents-none",!1),this._setLabelsText();else if(this.sliderEl.selectAll(".w").classed("vzb-hidden",!0),this.sliderEl.select(".selection").classed("vzb-hidden",!0),this.sliderEl.select(".overlay").classed("vzb-pointerevents-none",!0),!this.model.submodel.which){var n=this.propertyActiveProfile;e[1]=(n.default-n.min)/(n.max-n.min),this.model.submodel.which="_default"}this._moveBrush(e)},readyOnce:function(){this._super();var t=this.options,e=t.BAR_WIDTH;this.propertyActiveProfile=this.getPropertyActiveProfile(),this.propertyScale=d3.scaleLinear().domain([t.EXTENT_MIN,t.EXTENT_MAX]).range([this.propertyActiveProfile.min,this.propertyActiveProfile.max]).clamp(!0),this.padding.top=this.propertyActiveProfile.max+1.25*e,this.translator=this.model.locale.getTFunction(),this.sliderLabelsWrapperEl=this.sliderEl.append("g"),this.sliderLabelsWrapperEl.selectAll("text").data([0,0]).enter().append("text").attr("class",function(t,e){return"vzb-szs-slider-thumb-label "+(e?"e":"w")}).attr("dy",1.25*-e+"px"),this.sliderLabelsEl=this.sliderEl.selectAll("text.vzb-szs-slider-thumb-label"),this.sizeScaleMinMax=this.model.submodel.getScale().domain(),this.sizeScaleMinMax&&this._setLabelsText(),this.model._ready&&this.readyHandler()},ready:function(){this._super(),this._updateLabels()},getPropertyActiveProfile:function(){var t=this.profiles[this.getLayoutProfile()];return{min:t["min"+this.propertyName],max:t["max"+this.propertyName],default:t["default"+this.propertyName]}},_updateSize:function(){var t=this;this._super(),this.sliderLabelsWrapperEl.attr("transform",this.isRTL?"scale(-1,1)":null),this.sliderLabelsEl.attr("text-anchor",function(e,n){return(t.isRTL?n:!n)?"start":"end"})},_resize:function(){this.propertyActiveProfile=this.getPropertyActiveProfile(),this.propertyScale.range([this.propertyActiveProfile.min,this.propertyActiveProfile.max]),this.padding.top=this.propertyActiveProfile.max+1.25*this.options.BAR_WIDTH,this._super()},_updateThumbs:function(t){this._updateLabels(t)},_updateLabels:function(t){var e=this;t&&this.sliderLabelsEl.data(t),this.sliderLabelsEl.attr("transform",function(t,n){var i=e.rescaler(n);return"translate("+(e.isRTL?-1:1)*i+",0)"}).attr("font-size",function(t,n){return e.propertyScale(t)}),"constant"===e.model.submodel.use&&this.sliderLabelsEl.text(function(t){return~~e.propertyScale(t)+(e.translator(e.ui.constantUnit)||"")})},_setLabelsText:function(){var t=this,e=[t.model.submodel.getTickFormatter()(t.sizeScaleMinMax[0]),t.model.submodel.getTickFormatter()(t.sizeScaleMinMax[1])];t.sliderLabelsEl.text(function(t,n){return e[n]})}});e.default=c},function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(){return!!window&&(void 0!==window.document.webkitIsFullScreen?window.document.webkitIsFullScreen:void 0!==window.document.mozFullScreen?window.document.mozFullScreen:void 0!==window.document.msFullscreenElement&&window.document.msFullscreenElement)}function a(t){r()||(o.call(this),this.resizeInExitHandler?this.root.ui.resizeHandler():t())}function s(t){if(window){var e=window.document;this.exitFullscreenHandler=a.bind(this,t),e.addEventListener("webkitfullscreenchange",this.exitFullscreenHandler,!1),e.addEventListener("mozfullscreenchange",this.exitFullscreenHandler,!1),e.addEventListener("fullscreenchange",this.exitFullscreenHandler,!1),e.addEventListener("MSFullscreenChange",this.exitFullscreenHandler,!1)}}function o(){var t=window.document;t.removeEventListener("webkitfullscreenchange",this.exitFullscreenHandler),t.removeEventListener("mozfullscreenchange",this.exitFullscreenHandler),t.removeEventListener("fullscreenchange",this.exitFullscreenHandler),t.removeEventListener("MSFullscreenChange",this.exitFullscreenHandler)}function l(t){t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&u()&&t.webkitRequestFullscreen()}function c(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&u()?document.webkitExitFullscreen():(o.call(this),this.resizeInExitHandler=!1)}function u(){return!(navigator.vendor&&navigator.vendor.indexOf("Apple")>-1&&navigator.userAgent&&!navigator.userAgent.match("CriOS"))}Object.defineProperty(e,"__esModule",{value:!0});var h=n(1),d=i(h),f=n(5),p=function(t){return t&&t.__esModule?t:{default:t}}(f),v=n(21),g=i(v),m=p.default.extend({init:function(t,e){var n=this;this.name=this.name||"gapminder-buttonlist",this.model_expects=[{name:"state",type:"model"},{name:"ui",type:"ui"},{name:"locale",type:"locale"}],this._available_buttons={find:{title:"buttons/find",icon:"search",required:!1},show:{title:"buttons/show",icon:"asterisk",required:!1},moreoptions:{title:"buttons/more_options",icon:"gear",required:!0},colors:{title:"buttons/colors",icon:"paintbrush",required:!1},mapcolors:{title:"buttons/mapcolors",icon:"paintbrush",required:!1},size:{title:"buttons/size",icon:"circle",required:!1},zoom:{title:"buttons/zoom",icon:"cursorPlus",required:!1},fullscreen:{title:"buttons/expand",icon:"expand",func:this.toggleFullScreen.bind(this),required:!0},trails:{title:"buttons/trails",icon:"trails",func:this.toggleBubbleTrails.bind(this),required:!1,statebind:"ui.chart.trails",statebindfunc:this.setBubbleTrails.bind(this)},lock:{title:"buttons/lock",icon:"lock",func:this.toggleBubbleLock.bind(this),required:!1,statebind:"ui.chart.lockNonSelected",statebindfunc:this.setBubbleLock.bind(this)},inpercent:{title:"buttons/inpercent",icon:"percent",func:this.toggleInpercent.bind(this),required:!1,statebind:"ui.chart.inpercent",statebindfunc:this.setInpercent.bind(this)},presentation:{title:"buttons/presentation",icon:"presentation",func:this.togglePresentationMode.bind(this),required:!1,statebind:"ui.presentation",statebindfunc:this.setPresentationMode.bind(this)},about:{title:"buttons/about",icon:"about",required:!1},axes:{title:"buttons/axes",icon:"axes",required:!1},axesmc:{title:"buttons/axesmc",icon:"axes",required:!1},stack:{title:"buttons/stack",icon:"stack",required:!1},side:{title:"buttons/side",icon:"side",required:!1},_default:{title:"Button",icon:"asterisk",required:!1}},this._active_comp=!1,this.model_binds={"change:state.marker.select":function(t){n._readyOnce&&(n.setBubbleTrails(),n.setBubbleLock(),n._toggleButtons())},"change:ui.chart":function(t,e){(e.indexOf("lockActive")>-1||e.indexOf("lockUnavailable")>-1)&&n.setBubbleLock()}},t.ui.buttons.forEach(function(t){var e=n._available_buttons[t];e&&e.statebind&&(n.model_binds["change:"+e.statebind]=function(n){e.statebindfunc(t,n.source.value)})}),this._super(t,e),this.validatePopupButtons(this.model.ui.buttons,this.model.ui.dialogs)},readyOnce:function(){var t=this;this.element=d3.select(this.placeholder),this.element.selectAll("div").remove(),this.root.findChildByName("gapminder-dialogs").on("close",function(e,n){t.setButtonActive(n.id,!1)});var e=(this.model.ui.dialogs||{}).sidebar||[],n=[].concat(this.model.ui.buttons);this.model.ui.buttons=n,this._addButtons(n,e),this._prev_body_overflow=document.body.style.overflow,this.setBubbleTrails(),this.setBubbleLock(),this.setInpercent(),this.setPresentationMode(),this._toggleButtons()},proceedClick:function(t){var e=this,n=e.element.selectAll(".vzb-buttonlist-btn[data-btn='"+t+"']"),i=n.attr("class"),r=e._available_buttons[t];if(r&&r.func)r.func(t);else{var a=-1===i.indexOf("vzb-active");n.classed("vzb-active",a);var s={};s.id=t,s.active=a,e.trigger("click",s)}},validatePopupButtons:function(t,e){for(var n=this,i=e.popup,r=t.filter(function(t){return n._available_buttons[t]&&!n._available_buttons[t].func}),a=0,s=r.length;a<s;a++)if(-1==i.indexOf(r[a]))return d.error('Buttonlist: bad buttons config: "'+r[a]+'" is missing in popups list');return!1},_showAllButtons:function(){this.element.selectAll(".vzb-buttonlist-btn").each(function(t,e){d3.select(this).style("display","")})},_toggleButtons:function(){var t=this,e=this.parent.element.node?this.parent.element:d3.select(this.parent.element),n=(this.model.ui.dialogs||{}).sidebar||[];t._showAllButtons();var i=this.element.selectAll(".vzb-buttonlist-btn"),r=(this.element.node().getBoundingClientRect(),[]),a=[],s=80,o=80,l=this.element.node().getBoundingClientRect().width,c=this.element.node().getBoundingClientRect().height,u=0,h=0;i.each(function(e,i){var l=e,c=d3.select(this),d=-1!==n.indexOf(l.id),f={top:parseInt(c.style("margin-top")),right:parseInt(c.style("margin-right")),left:parseInt(c.style("margin-left")),bottom:parseInt(c.style("margin-bottom"))};s=c.node().getBoundingClientRect().width+f.right+f.left,o=c.node().getBoundingClientRect().height+f.top+f.bottom,c.classed("vzb-hidden")||(d&&"large"===t.getLayoutProfile()?c.style("display","none"):(u+=s,h+=o,l.required?a.push(c):r.push(c)))});var d=u-l,f=h-c,p=1;e.classed("vzb-large")&&e.classed("vzb-dialog-expand-true")||e.classed("vzb-small")&&e.classed("vzb-portrait")?(d>0&&d<=10&&(l+=d),(p=Math.floor(l/s)-a.length)<0&&(p=0)):(f>0&&f<=10&&(c+=f),(p=Math.floor(c/o)-a.length)<0&&(p=0)),r.reverse();for(var v=[],g=0,m=r.length-p;g<m;g++)r[g].style("display","none"),v.push(r[g].attr("data-btn"));var b={};b.hiddenButtons=v,t.trigger("toggle",b)},_addButtons:function(t,e){var n=this;this._components_config=[];var i=[];if(t.length){for(var r=0;r<t.length;r++){var a=t[r],s=this._available_buttons[a],o=s?a:"_default",l=d.clone(this._available_buttons[o]);"_default"==o&&(l.title="buttons/"+a),l.id=a,l.icon=g[l.icon],i.push(l)}var c=this.getTranslationFunction(!0);this.element.selectAll("button").data(i).enter().append("button").attr("class",function(t){var n="vzb-buttonlist-btn";return e.length>0&&e.indexOf(t.id)>-1&&(n+=" vzb-dialog-side-btn"),n}).attr("data-btn",function(t){return t.id}).html(function(t){return"<span class='vzb-buttonlist-btn-icon fa'>"+t.icon+"</span><span class='vzb-buttonlist-btn-title'>"+c(t.title)+"</span>"});this.element.selectAll(".vzb-buttonlist-btn").on("click",function(){d3.event.preventDefault(),d3.event.stopPropagation();var t=d3.select(this).attr("data-btn");n.proceedClick(t)})}},scrollToEnd:function(){var t=0,e=d3.select(".vzb-tool");e.classed("vzb-portrait")&&e.classed("vzb-small")?(this.model.state.marker.select.length>0&&(t=this.element.node().scrollWidth),this.element.node().scrollLeft=t):(this.model.state.marker.select.length>0&&(t=this.element.node().scrollHeight),this.element.node().scrollTop=t)},resize:function(){if(!this.element.selectAll)return d.warn("buttonlist resize() aborted because element is not yet defined");"small"===this.getLayoutProfile()&&this.model.ui.presentation&&this.togglePresentationMode(),this._toggleButtons()},setButtonActive:function(t,e){this.element.selectAll(".vzb-buttonlist-btn[data-btn='"+t+"']").classed("vzb-active",e)},toggleBubbleTrails:function(){this.model.ui.chart.trails=!this.model.ui.chart.trails,this.setBubbleTrails()},setBubbleTrails:function(){var t=(this.model.ui.chart||{}).trails;if(t||!1===t){var e=this.element.selectAll(".vzb-buttonlist-btn[data-btn='trails']");if(!e.node())return d.warn("setBubbleTrails: no button 'trails' found in DOM. doing nothing");e.classed("vzb-active-locked",t),e.classed("vzb-hidden",0==this.model.state.marker.select.length)}},toggleBubbleLock:function(t){var e=(this.model.ui.chart||{}).lockActive;if(0!=this.model.state.marker.select.length||e){var n=this.model.ui.chart.lockNonSelected,i=this.model.state.time;n=n?0:i.formatDate(i.value),this.model.ui.chart.lockNonSelected=n,this.setBubbleLock()}},setBubbleLock:function(){var t=(this.model.ui.chart||{}).lockNonSelected,e=(this.model.ui.chart||{}).lockActive,n=(this.model.ui.chart||{}).lockUnavailable||!1;if(t||0===t){0===t||0!==this.model.state.marker.select.length||e||(t=this.model.ui.chart.lockNonSelected=0);var i=this.element.selectAll(".vzb-buttonlist-btn[data-btn='lock']");if(!i.node())return d.warn("setBubbleLock: no button 'lock' found in DOM. doing nothing");var r=this.model.locale.getTFunction();i.classed("vzb-unavailable",n),void 0===e?i.classed("vzb-hidden",0==this.model.state.marker.select.length):i.classed("vzb-hidden",!e),i.classed("vzb-active-locked",t),i.select(".vzb-buttonlist-btn-icon").html(g[t?"lock":"unlock"]),i.select(".vzb-buttonlist-btn-title>span").text(t||r("buttons/lock")).attr("data-vzb-translate",t?null:"buttons/lock")}},toggleInpercent:function(){this.model.ui.chart.inpercent=!this.model.ui.chart.inpercent,this.setInpercent()},setInpercent:function(){if(void 0!==(this.model.ui.chart||{}).inpercent){this.model.locale.getTFunction();this.element.selectAll(".vzb-buttonlist-btn[data-btn='inpercent']").classed("vzb-active-locked",this.model.ui.chart.inpercent)}},togglePresentationMode:function(){this.model.ui.presentation=!this.model.ui.presentation,this.setPresentationMode()},setPresentationMode:function(){this.model.locale.getTFunction();this.element.selectAll(".vzb-buttonlist-btn[data-btn='presentation']").classed("vzb-active-locked",this.model.ui.presentation)},toggleFullScreen:function(t,e){if(window){for(var n=this,i=n.placeholder,r=this.element.selectAll(".vzb-buttonlist-btn[data-btn='"+t+"']"),a=!this.model.ui.fullscreen,o=a?"hidden":this._prev_body_overflow;!d.hasClass(i,"vzb-placeholder");)n=n.parent,i=n.placeholder;a?(this.resizeInExitHandler=!1,l(i),s.call(this,this.toggleFullScreen.bind(this,t,!0))):(this.resizeInExitHandler=!e,c.call(this)),d.classed(i,"vzb-force-fullscreen",a),"undefined"!=typeof container&&d.classed(container,"vzb-container-fullscreen",a),this.model.ui.fullscreen=a;var u=this.model.locale.getTFunction();r.classed("vzb-active-locked",a),r.select(".vzb-buttonlist-btn-icon").html(g[a?"unexpand":"expand"]),r.select(".vzb-buttonlist-btn-title>span").text(u("buttons/"+(a?"unexpand":"expand"))).attr("data-vzb-translate","buttons/"+(a?"unexpand":"expand")),document.body.style.overflow=o,this.resizeInExitHandler||this.root.ui.resizeHandler()}}});e.default=m},function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=(i(r),n(160)),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o=n(21),l=(i(o),s.default.extend({init:function(t,e){this.name="gapminder-optionsbuttonlist",this._super(t,e)},readyOnce:function(){var t=this;Object.keys(this._available_buttons).forEach(function(e){var n=t._available_buttons[e];n.required=!n.required}),this.buttonListComp=this.root.findChildByName("gapminder-buttonlist"),this.buttonListComp.on("click",function(e,n){t.element.selectAll(".vzb-buttonlist-btn[data-btn='"+n.id+"']").classed("vzb-active",n.active)}),this.buttonListComp.on("toggle",function(e,n){var i=0;t.element.selectAll(".vzb-buttonlist-btn").each(function(t){var e=d3.select(this),r=-1==n.hiddenButtons.indexOf(t.id);e.style("display",r?"none":""),r||i++})}),this._super()},proceedClick:function(t){var e=this;this.buttonListComp.proceedClick(t),this.element.selectAll(".vzb-buttonlist-btn[data-btn='"+t+"']").datum().func&&setTimeout(function(){e.root.findChildByName("gapminder-dialogs").closeAllDialogs()},200)},_toggleButtons:function(){}}));e.default=l},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(r),s=n(5),o=i(s),l=n(163),c=i(l),u=n(108),h=i(u),d=n(21),f=o.default.extend({init:function(t,e){var n=this;this.template='<div class="vzb-cl-outer"></div>',this.name="colorlegend",this.model_expects=[{name:"time",type:"time"},{name:"entities",type:"entities"},{name:"marker",type:"marker"},{name:"color",type:"color"},{name:"locale",type:"locale"},{name:"ui",type:"ui"}],this.model_binds={"change:color.scaleType":function(t,e){n._readyOnce&&!n.colorModel.isDiscrete()&&n.updateView()},"change:color.palette":function(t,e){!n._readyOnce||n.colorModel.isDiscrete()&&!n.frame||n.updateView()},"change:marker.highlight":function(t,e){n.colorModel.isDiscrete()&&n.model.marker.getFrame(n.model.time.value,function(t){if(t){var e=n.model.marker.getHighlighted(n.KEY);n.updateGroupsOpacity(e.map(function(e){return t[n.colorModel._name][e]}))}else n.updateGroupsOpacity()})},"translate:locale":function(){n.colorPicker.translate(n.model.locale.getTFunction())}},this._super(t,e)},readyOnce:function(){var t=this;this.element=d3.select(this.element),d3.select(this.placeholder.parentNode).classed("vzb-dialog-scrollable",!0),this.colorModel=this.model.color,this.colorlegendMarker=this.colorModel.getColorlegendMarker(),this.colorlegendMarker&&this.colorlegendMarker.on("ready",function(){t.ready()}),this.listColorsEl=this.element.append("div").attr("class","vzb-cl-holder").append("div").attr("class","vzb-cl-colorlist"),this.rainbowEl=this.listColorsEl.append("div").attr("class","vzb-cl-rainbow"),this.rainbowCanvasEl=this.rainbowEl.append("canvas"),this.minimapEl=this.listColorsEl.append("div").attr("class","vzb-cl-minimap"),this.rainbowLegendEl=this.listColorsEl.append("div").attr("class","vzb-cl-rainbow-legend"),this.rainbowLegendSVG=this.rainbowLegendEl.append("svg"),this.rainbowLegendG=this.rainbowLegendSVG.append("g"),this.rainbowLegend=null,this.labelScaleEl=this.listColorsEl.append("div").attr("class","vzb-cl-labelscale"),this.labelScaleSVG=this.labelScaleEl.append("svg"),this.labelScaleG=this.labelScaleSVG.append("g"),this.unitDiv=this.listColorsEl.append("div").attr("class","vzb-cl-unit"),this.unitText=this.unitDiv.append("span").attr("class","vzb-cl-unit-text"),this.minimapSVG=this.minimapEl.append("svg"),this.minimapG=this.minimapSVG.append("g"),this.colorPicker=new c.default(a.isArray(this.root.element)?this.root.element:d3.select(this.root.element)),this.colorPicker.translate(this.model.locale.getTFunction()),this._initSelectDialog()},_initSelectDialog:function(){var t=this.model.locale.getTFunction();this.moreOptionsHint=this.listColorsEl.append("span").classed("vzb-cl-more-hint vzb-hidden",!0).text(t("hints/color/more")),this.selectDialog=this.listColorsEl.append("div").classed("vzb-cl-select-dialog vzb-hidden",!0),this._initSelectDialogItems()},_initSelectDialogItems:function(){var t=this,e=this.model.locale.getTFunction();this.selectDialogTitle=this.selectDialog.append("div").classed("vzb-cl-select-dialog-title",!0),this.selectDialog.append("div").classed("vzb-cl-select-dialog-close",!0).html(d.close).on("click",function(){return t._closeSelectDialog()}),this.selectAllButton=this.selectDialog.append("div").classed("vzb-cl-select-dialog-item",!0).text(" "+e("dialogs/color/select-all")),this.removeElseButton=this.selectDialog.append("div").classed("vzb-cl-select-dialog-item",!0).text(" "+e("dialogs/color/remove-else")),this.editColorButton=this.selectDialog.append("div").classed("vzb-cl-select-dialog-item vzb-cl-select-dialog-item-moreoptions",!0).text(" "+e("dialogs/color/edit-color")),this.editColorButtonTooltip=this.editColorButton.append("div").classed("vzb-cl-select-dialog-item-tooltip",!0).text("Dataset author doesn't want you to change this")},_closeSelectDialog:function(){this.selectDialog.classed("vzb-hidden",!0)},_bindSelectDialogItems:function(){for(var t=this,e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];var r=n[1],a=n[2];this.selectDialogTitle.text(a[r].textContent),this.selectAllButton.on("click",function(){var e;(e=t._interact()).clickToSelect.apply(e,n),t._closeSelectDialog()}),this.removeElseButton.on("click",function(){var e;(e=t._interact()).clickToShow.apply(e,n),t._closeSelectDialog()}),this.editColorButton.on("click",function(){var e;(e=t._interact()).clickToChangeColor.apply(e,n),t._closeSelectDialog()})},ready:function(){var t=this;if(this.KEY=this.model.entities.getDimension(),this.colorlegendDim=this.KEY,this.canShowMap=!1,this.colorModel.isDiscrete()&&"constant"!==this.colorModel.use&&this.colorlegendMarker){if(!this.colorlegendMarker._ready)return;return this.colorlegendDim=this.colorModel.getColorlegendEntities().getDimension(),void this.colorlegendMarker.getFrame(this.model.time.value,function(e){if(!e)return a.warn("colorlegend received empty frame in ready()");t.frame=e,t.canShowMap=a.keys((t.frame||{}).hook_geoshape||{}).length,t.colorlegendKeys=t.colorlegendMarker.getKeys(t.colorlegendDim),t.colorlegendKeys.forEach(function(e){((t.frame||{}).hook_geoshape||{})[e[t.colorlegendDim]]||(t.canShowMap=!1)}),t.updateView(),t.updateGroupsOpacity()})}t.updateView(),t.updateGroupsOpacity()},updateView:function(){var t=this;if(!this.element.selectAll)return a.warn("colorlegend resize() aborted because element is not yet defined");var e=this,n=(this.KEY,this.colorModel.getPalette()),i=this.canShowMap,r=this.colorlegendKeys||[],s=this.listColorsEl.selectAll(".vzb-cl-option"),o=i||"_default"==this.colorModel.which||this.colorlegendMarker&&this.colorlegendDim==this.KEY&&r.length>10&&a.comparePlainObjects(this.colorModel.getColorlegendEntities().getFilter(),this.model.entities.getFilter());s.classed("vzb-hidden",o),this._updateSelectDialog(),this.rainbowEl.classed("vzb-hidden",this.colorModel.isDiscrete()),this.labelScaleEl.classed("vzb-hidden",this.colorModel.isDiscrete()),this.rainbowLegendEl.classed("vzb-hidden",this.colorModel.isDiscrete()),this.minimapEl.classed("vzb-hidden",!i||!this.colorModel.isDiscrete()),this.unitDiv.classed("vzb-hidden",!0);var l=this.colorModel.getScale();if(this.colorModel.isDiscrete())if(i){var c=this.minimapEl.append("div").attr("class","vzb-temp");this.minimapSVG.attr("viewBox",null),this.minimapSVG.selectAll("g").remove(),this.minimapG=this.minimapSVG.append("g"),this.minimapG.selectAll("path").data(r,function(t){return t[e.colorlegendDim]}).enter().append("path").on("mouseover",e._interact().mouseover).on("mouseout",e._interact().mouseout).on("click",function(){t._bindSelectDialogItems.apply(t,arguments),t.selectDialog.classed("vzb-hidden",!1)}).each(function(t){var n=e.frame.hook_geoshape[t[e.colorlegendDim]].trim();"<svg"==n.slice(0,4)&&(c.html(n),n=c.select("svg").select("path").attr("d")),d3.select(this).attr("d",n).style("fill",l(t[e.colorlegendDim])).append("title").text(e.frame.label[t[e.colorlegendDim]]),c.html("")});var u=this.minimapG.node().getBBox();this.minimapSVG.attr("viewBox","0 0 "+1.05*u.width+" "+1.05*u.height),c.remove()}else s="_default"==this.colorModel.which?s.data([]):s.data(o?[]:r.length?r:Object.keys(this.colorModel.getPalette()).map(function(t){var n={};return n[e.colorlegendDim]=t,n}),function(t){return t[e.colorlegendDim]}),s.exit().remove(),s=s.enter().append("div").attr("class","vzb-cl-option").each(function(){var t=this;d3.select(this).append("div").attr("class","vzb-cl-color-sample").on("click",function(){t._bindSelectDialogItems.apply(t,arguments),t.selectDialog.classed("vzb-hidden",!1)}),d3.select(this).append("div").attr("class","vzb-cl-color-legend")}).on("mouseover",e._interact().mouseover).on("mouseout",e._interact().mouseout).on("click",function(){t._bindSelectDialogItems.apply(t,arguments),t.selectDialog.classed("vzb-hidden",!1)}).merge(s),s.each(function(t,n){d3.select(this).select(".vzb-cl-color-sample").style("background-color",l(t[e.colorlegendDim])).style("border","1px solid "+l(t[e.colorlegendDim]));var i=e.colorlegendMarker?e.frame.label[t[e.colorlegendDim]]:null;i||0===i||(i=t[e.colorlegendDim]),d3.select(this).select(".vzb-cl-color-legend").text(i)});else{var d=this.rainbowEl.node().getBoundingClientRect().width,f=Object.keys(n).map(parseFloat),p=void 0,v=void 0,g=this.colorModel.getTickFormatter(),m=null,b=this.colorModel.paletteLabels;if(b){m="optimistic",p=b.map(function(t){return parseFloat(t)});var _=d3.max(p);v=p.map(function(t){return t/_*d})}else{p=l.domain();var y=d3.max(f);v=f.map(function(t){return t/y*d})}var M=d3.min(p)<=0&&d3.max(p)>=0&&"log"===this.colorModel.scaleType?"genericLog":this.colorModel.scaleType,w=d3["scale"+a.capitalize("time"===M?"linear":M)]().domain(p).range(v),x=parseInt(this.rainbowEl.style("left"),10)||0,S=parseInt(this.rainbowEl.style("right"),10)||x;this.labelScaleSVG.style("width",x+d+S+"px"),this.labelScaleG.attr("transform","translate("+x+",0)"),this.rainbowLegendSVG.style("width",x+d+S+"px"),this.rainbowLegendG.attr("transform","translate("+x+", 7)");var z=(0,h.default)("bottom");z.scale(w).tickSizeOuter(0).tickPadding(6).tickSizeMinor(3,0).labelerOptions({scaleType:this.colorModel.scaleType,toolMargin:{right:S,left:x},showOuter:!0,formatter:g,bump:x,cssFontSize:"11px",fitIntoScale:m}),this.labelScaleG.call(z);var O=l.range(),E=v.map(function(t,e){return{val:t,color:O[e],paletteKey:f[e]}});this.rainbowLegend=this.rainbowLegendG.selectAll("circle").data(E),this.rainbowLegend.exit().remove(),this.rainbowLegend=this.rainbowLegend.enter().append("circle").attr("r","6px").attr("stroke","#000").on("click",e._interact().clickToChangeColor).merge(this.rainbowLegend),this.rainbowLegend.each(function(t,e){d3.select(this).attr("fill",t.color),d3.select(this).attr("cx",t.val)}),this.rainbowCanvasEl.attr("width",d).attr("height",1).style("width",d+"px").style("height","100%");for(var k,T=this.rainbowCanvasEl.node().getContext("2d"),P=T.createImageData(d,1),D=0,L=-1;D<d;++D)k=d3.rgb(l(w.invert(D))),P.data[++L]=k.r,P.data[++L]=k.g,P.data[++L]=k.b,P.data[++L]=255;T.putImageData(P,0,0);var C=this.colorModel.getConceptprops().unit||"";this.unitDiv.classed("vzb-hidden",""==C),this.unitText.text(C),s.classed("vzb-hidden",!0)}},_updateSelectDialog:function(){var t=this.colorModel.isUserSelectable();this.editColorButtonTooltip.classed("vzb-hidden",t),this.editColorButton.classed("vzb-cl-select-dialog-item-disabled",!t),this.selectDialog.classed("vzb-hidden",!0)},_highlight:function(t){a.getProp(this,["model","ui","chart","superhighlightOnMinimapHover"])?this.model.marker.setSuperHighlight(t):this.model.marker.setHighlight(t)},_unhighlight:function(){a.getProp(this,["model","ui","chart","superhighlightOnMinimapHover"])?this.model.marker.clearSuperHighlighted():this.model.marker.clearHighlighted()},_interact:function(){var t=this,e=this.KEY,n=this.colorlegendDim;return{mouseover:function(i,r){if(t.moreOptionsHint.classed("vzb-hidden",!1),t.colorModel.isDiscrete()){var s=(d3.select(this),i[n]),o=t.colorModel.getValidItems().filter(function(e){return e[t.colorModel.which]==s}).map(function(t){return a.clone(t,[e])});t._highlight(o)}},mouseout:function(e,n){t.moreOptionsHint.classed("vzb-hidden",!0),t.colorModel.isDiscrete()&&t._unhighlight()},clickToChangeColor:function(e,i){if(t.colorModel.isUserSelectable()){var r=t.colorModel.getPalette(),a=t.colorModel.getDefaultPalette(),s=(d3.select(this),t.colorModel.isDiscrete()?e[n]:e.paletteKey);t.colorPicker.colorOld(r[s]).colorDef(a[s]).callback(function(e,n){return t.colorModel.setColor(e,s,n)}).fitToScreen([d3.event.pageX,d3.event.pageY]).show(!0)}},clickToShow:function(e,i){if(t.colorModel.isDiscrete()){var r=(d3.select(this),e[n],t.model.entities.show[n]&&t.model.entities.show[n].$in?a.clone(t.model.entities.show[n].$in):[]),s=r.indexOf(e[n]);-1!==s?r.splice(s,1):r.push(e[n]);var o={};r.length>0&&(o[n]={$in:r}),t.model.entities.set({show:o})}},clickToSelect:function(i,r){if(t.colorModel.isDiscrete()){var s=(d3.select(this),i[n]),o=t.colorModel.getValidItems().filter(function(e){return e[t.colorModel.which]==s}).map(function(t){return a.clone(t,[e])});o.filter(function(e){return t.model.marker.isSelected(e)}).length==o.length?t.model.marker.clearSelected():t.model.marker.setSelect(o)}}}},resize:function(){this.frame&&this.updateView(),this.colorPicker.resize(d3.select(".vzb-colorpicker-svg"))},updateGroupsOpacity:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this,n=this.colorModel.getColorlegendMarker()||{},i=n.opacityRegular||.8,r=n.opacityHighlightDim||.5,a=e.canShowMap?".vzb-cl-minimap path":".vzb-cl-option .vzb-cl-color-sample";this.listColorsEl.selectAll(a).style("opacity",function(n){return t.length?t.indexOf(n[e.colorlegendDim])>-1?1:r:i})}});e.default=f},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(1),s={INVISIBLE:"vzb-invisible",COLOR_POINTER:"vzb-colorpicker-pointer",COLOR_BUTTON:"vzb-colorpicker-cell",COLOR_DEFAULT:"vzb-colorpicker-default",COLOR_SAMPLE:"vzb-colorpicker-sample",COLOR_PICKER:"vzb-colorpicker-svg",COLOR_CIRCLE:"vzb-colorpicker-circle",COLOR_CIRCLES:"vzb-colorpicker-circles",COLOR_SEGMENT:"vzb-colorpicker-segment",COLOR_BACKGR:"vzb-colorpicker-background"},o=function(){function t(e){i(this,t),this._container=e,this._wrapper=this._container.select("."+s.COLOR_PICKER),this._init()}return r(t,[{key:"_init",value:function(){this._initVariables(),this._initCircles(),this._style(),this.resize(this._svg)}},{key:"_initVariables",value:function(){this._maxWidth=280,this._maxHeight=323,this._colorOld="#000",this._colorDef="#000",this._colorWhite="#f8f8f8",this._margin={top:.1,bottom:.1,left:.1,right:.1},this._initSvg();var t=getComputedStyle(this._svg.node()),e=t.width,n=t.height;this._width=this.constructor.px2num(e),this._height=this.constructor.px2num(n),this._maxRadius=this._width/2*(1-this._margin.left-this._margin.right),this._nCellsH=15,this._minH=0,this._nCellsL=4,this._minL=.5,this._satConstant=.7,this._outerL_display=.4,this._outerL_meaning=.3,this._firstAngleSat=0,this._minRadius=15,this._arc=d3.arc(),this._pie=d3.pie().sort(null).value(function(t){return 1}),this._colorPointer=null,this._showColorPicker=!1,this._sampleRect=null,this._sampleText=null,this._callback=function(t){return console.info("Color picker callback example. Setting color to "+t)},this._colorData=this._generateColorData()}},{key:"_generateColorData",value:function(){for(var t=this._minL,e=this._minH,n=this._nCellsL,i=this._nCellsH,r=this._firstAngleSat,a=this._satConstant,s=this._outerL_display,o=this._outerL_meaning,l=[],c=0;c<n;c++){var u=t+(1-t)/n*c;l.push([]);for(var h=0;h<=i;h++){var d=e+(1-e)/i*h;l[c].push({display:this.constructor.hsl2rgb(d,0===h?r:a,0===c?s:u),meaning:this.constructor.hsl2rgb(d,0===h?r:a,0===c?o:u)})}}return l}},{key:"_initSvg",value:function(){var t=this;this._wrapper=this._container.append("div").style("position","absolute").style("top","0").style("left","0").style("width","100%").style("max-width",this._maxWidth+"px").style("height","100%").style("max-height",this._maxHeight+"px").style("z-index",9999).attr("class",s.COLOR_PICKER+" vzb-dialog-shadow").classed(s.INVISIBLE,!this._showColorPicker).on("mouseout",function(){return t._cellHover(t._colorOld)}),this._svg=this._wrapper.append("svg").style("width","100%").style("height","100%")}},{key:"_initCircles",value:function(){var t=this,e=this._svg,n=this._maxHeight,i=this._width,r=this._height,a=this._margin,o=this._colorData,l=this._nCellsL,c=this._minRadius,u=this._maxRadius,h=this._colorWhite;e.append("rect").attr("width",i).attr("height",n).attr("class",s.COLOR_BACKGR).on("mouseover",function(){return t._cellHover(t._colorOld)}).on("click",function(){d3.event.stopPropagation(),t._changeColor(t._colorOld),t.show(!1)});var d=u+i*a.left,f=u+r*a.top,p=e.append("g").attr("class",s.COLOR_CIRCLES).attr("transform","translate("+d+", "+f+")");e.append("rect").attr("class",s.COLOR_SAMPLE).attr("width",i/2).attr("height",r*a.top/2),this._sampleRect=e.append("rect").attr("class",s.COLOR_SAMPLE).attr("width",i/2).attr("x",i/2).attr("height",r*a.top/2),e.append("text").attr("x",i*a.left).attr("y",r*a.top/2).attr("dy","1.3em").attr("class",s.COLOR_SAMPLE).style("text-anchor","start"),this._sampleText=e.append("text").attr("x",i*(1-a.right)).attr("y",r*a.top/2).attr("dy","1.3em").attr("class",s.COLOR_SAMPLE).style("text-anchor","end"),e.append("text").attr("x",.1*i).attr("y",r*(1-a.bottom)).attr("dy","1.2em").attr("class","vzb-default-label").style("text-anchor","start").text("default"),e.append("circle").attr("class",s.COLOR_DEFAULT+" "+s.COLOR_BUTTON).attr("r",i*a.left/2).attr("cx",i*a.left*1.5).attr("cy",r*(1-1.5*a.bottom)).on("mouseover",function(){d3.select(this).style("stroke","#444"),v._cellHover(v._colorDef)}).on("mouseout",function(){d3.select(this).style("stroke","none")});var v=this;p.selectAll("."+s.COLOR_CIRCLE).data(o).enter().append("g").attr("class",s.COLOR_CIRCLE).each(function(t,e){v._arc.outerRadius(c+(u-c)/l*(l-e)).innerRadius(c+(u-c)/l*(l-e-1)),d3.select(this).selectAll("."+s.COLOR_SEGMENT).data(v._pie(t)).enter().append("g").attr("class",s.COLOR_SEGMENT).append("path").attr("class",s.COLOR_BUTTON).attr("d",v._arc).style("fill",function(t){return t.data.display}).style("stroke",function(t){return t.data.display}).on("mouseover",function(t){v._cellHover(t.data.meaning,this)}).on("mouseout",function(){return v._cellUnhover()})}),p.append("circle").attr("r",c).attr("fill",h).attr("class",s.COLOR_BUTTON).on("mouseover",function(){d3.select(this).style("stroke","#555"),v._cellHover(h)}).on("mouseout",function(){d3.select(this).style("stroke","none")}),this._colorPointer=p.append("path").attr("class",s.COLOR_POINTER+" "+s.INVISIBLE),e.selectAll("."+s.COLOR_BUTTON).on("click",function(e){d3.event.stopPropagation(),t._changeColor(e?e.data.meaning:t._colorDef,!0),t.show(!1)})}},{key:"_style",value:function(){var t=this._svg,e=this._colorWhite;t.select("."+s.COLOR_BACKGR).style("fill","white"),t.select("."+s.COLOR_POINTER).style("stroke-width",2).style("stroke",e).style("pointer-events","none").style("fill","none"),t.selectAll("."+s.COLOR_BUTTON).style("cursor","pointer"),t.selectAll("text").style("pointer-events","none").style("fill","#D9D9D9").style("font-size","0.7em").style("text-transform","uppercase"),t.selectAll("circle."+s.COLOR_BUTTON).style("stroke-width",2),t.selectAll("rect."+s.COLOR_SAMPLE).style("pointer-events","none")}},{key:"_cellHover",value:function(t,e){null!=e&&this._colorPointer.classed(s.INVISIBLE,!1).attr("d",d3.select(e).attr("d")),this._sampleRect.style("fill",t),this._sampleText.text(t);var n=(0,a.isTouchDevice)();this._changeColor(t,n),n&&this.show(!1)}},{key:"_changeColor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._callback(t,e)}},{key:"_cellUnhover",value:function(){this._colorPointer.classed(s.INVISIBLE,!0)}},{key:"resize",value:function(t){if(arguments.length){if(void 0!==t){var e=this._margin,n=t,i=getComputedStyle(n.node()),r=i.width,a=i.height,o=this.constructor.px2num(r),l=this.constructor.px2num(a),c=o/2*(1-e.left-e.right),u=n.select("."+s.COLOR_DEFAULT),h=n.select(".vzb-default-label"),d=n.select("."+s.COLOR_CIRCLES),f=c+l*e.top,p=(1+.5*e.top)*l*.5,v=c+o*e.left,g=f>p?p:f;d.attr("transform","translate("+v+", "+g+")"),u.attr("cx",o*e.left*1.5).attr("cy",l*(1-1.5*e.bottom)),h.attr("x",.1*o).attr("y",l*(1-e.bottom))}return this.fitToScreen()}}},{key:"fitToScreen",value:function(t){var e=this._container.node().getBoundingClientRect(),n=void 0,i=void 0,r=getComputedStyle(this._wrapper.node()),a=r.width,s=r.height,o=r.right,l=r.top,c=this.constructor.px2num(a),u=this.constructor.px2num(s);t?(n=t[0]-e.left,i=t[1]-e.top):(n=e.width-this.constructor.px2num(o)-c,i=this.constructor.px2num(l));var h={left:""};return.8*e.width<=c?h.right=.5*(e.width-c)+"px":n+c>e.width?h.right=Math.min(.1*e.width,20)+"px":h.right=e.width-n-c+"px",h.right&&this._wrapper.style("right",h.right),.8*e.height<=u?h.top=.5*(e.height-u)+"px":i+1.2*u>e.height?h.top=.9*e.height-u+"px":h.top=i+"px",h.top&&this._wrapper.style("top",h.top),this._wrapper.style("left",h.left),this}},{key:"show",value:function(t){if(!arguments.length)return this._showColorPicker;null==this._svg&&console.warn("Color picker is missing SVG element. Was init sequence performed?"),this._showColorPicker="toggle"==t?!this._showColorPicker:t,this._showColorPicker||(this._callback=function(){}),this._wrapper.classed(s.INVISIBLE,!this._showColorPicker)}},{key:"_getOrSet",value:function(t,e){return t="_"+t,arguments.length>1?(this[t]=e,this):this[t]}},{key:"nCellsH",value:function(){return this._getOrSet.apply(this,["nCellsH"].concat(Array.prototype.slice.call(arguments)))}},{key:"minH",value:function(){return this._getOrSet.apply(this,["minH"].concat(Array.prototype.slice.call(arguments)))}},{key:"nCellsL",value:function(){return this._getOrSet.apply(this,["nCellsL"].concat(Array.prototype.slice.call(arguments)))}},{key:"minL",value:function(){return this._getOrSet.apply(this,["minL"].concat(Array.prototype.slice.call(arguments)))}},{key:"outerL_display",value:function(){return this._getOrSet.apply(this,["outerL_display"].concat(Array.prototype.slice.call(arguments)))}},{key:"outerL_meaning",value:function(){return this._getOrSet.apply(this,["outerL_meaning"].concat(Array.prototype.slice.call(arguments)))}},{key:"satConstant",value:function(){return this._getOrSet.apply(this,["satConstant"].concat(Array.prototype.slice.call(arguments)))}},{key:"firstAngleSat",value:function(){return this._getOrSet.apply(this,["firstAngleSat"].concat(Array.prototype.slice.call(arguments)))}},{key:"minRadius",value:function(){return this._getOrSet.apply(this,["minRadius"].concat(Array.prototype.slice.call(arguments)))}},{key:"margin",value:function(){return this._getOrSet.apply(this,["margin"].concat(Array.prototype.slice.call(arguments)))}},{key:"callback",value:function(){return this._getOrSet.apply(this,["callback"].concat(Array.prototype.slice.call(arguments)))}},{key:"colorDef",value:function(t){return arguments.length?(void 0!==t&&(this._colorDef=t),null==this._svg&&console.warn("Color picker is missing SVG element. Was init sequence performed?"),this._svg.select("."+s.COLOR_DEFAULT).style("fill",this._colorDef),this):this._colorDef}},{key:"translate",value:function(t){return"function"==typeof t&&this._svg.select(".vzb-default-label").text(t("colorpicker/default")),this}},{key:"colorOld",value:function(t){return arguments.length?(this._colorOld=t,null==this._svg&&console.warn("Color picker is missing SVG element. Was init sequence performed?"),this._svg.select("rect."+s.COLOR_SAMPLE).style("fill",this._colorOld),this._svg.select("text."+s.COLOR_SAMPLE).text(this._colorOld),this):this._colorOld}}],[{key:"hsl2rgb",value:function(t,e,n){var i=void 0,r=void 0,a=void 0;if(0==e)i=r=a=n;else{var s=n<.5?n*(1+e):n+e-n*e,o=2*n-s;i=this.hue2rgb(o,s,t+1/3),r=this.hue2rgb(o,s,t),a=this.hue2rgb(o,s,t-1/3)}return"#"+Math.round(255*i).toString(16)+Math.round(255*r).toString(16)+Math.round(255*a).toString(16)}},{key:"hue2rgb",value:function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}},{key:"px2num",value:function(t){return parseFloat(t)||0}}]),t}();e.default=o},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}(r),n(11)),s=i(a),o=n(107),l=i(o),c=n(143),u=(i(c),n(106)),h=i(u),d=s.default.extend("about",{init:function(t,e){this.name="about",this._super(t,e)},readyOnce:function(){var t=l.default.version,e=new Date(parseInt(l.default.build));this.element=d3.select(this.element),this.element.select(".vzb-about-text0").html("This chart is made with Vizabi,"),this.element.select(".vzb-about-text1").html("a project by <a href='http://gapminder.org' target='_blank'>Gapminder Foundation</a>"),this.element.select(".vzb-about-version").html("<a href='https://github.com/Gapminder/vizabi/releases/tag/v"+t+"' target='_blank'>Version: "+t+"</a>"),this.element.select(".vzb-about-updated").html("Build: "+d3.time.format("%Y-%m-%d at %H:%M")(e)),this.element.select(".vzb-about-report").html("<a href='https://getsatisfaction.com/gapminder/' target='_blank'>Report a problem</a>"),this.element.select(".vzb-about-credits").html("<a href='https://github.com/Gapminder/vizabi/graphs/contributors' target='_blank'>Contributors</a>");var n=h.default,i={},r=this.root.versionInfo;i.version=r?r.version:"N/A",i.build=r?d3.time.format("%Y-%m-%d at %H:%M")(new Date(parseInt(r.build))):"N/A",i.name=this.root.name;var a=this.element.select(".vzb-about-tool");a.html(""),a.append("p").text("Tool: "+i.name),a.append("p").text("-version: "+i.version),a.append("p").text("-build: "+i.build);var s=n.instances.map(function(t){var e={},n=t.readerObject.versionInfo;return e.version=n?n.version:"N/A",e.build=n?d3.time.format("%Y-%m-%d at %H:%M")(new Date(parseInt(n.build))):"N/A",e.name=t.readerObject._name,e}),o=this.element.select(".vzb-about-readers").selectAll(".vzb-about-reader").data(s);o.exit().remove(),o=o.enter().append("p").attr("class","vzb-about-reader"),o.append("p").text(function(t){return t.name}),o.append("p").text(function(t){return"-version: "+t.version}),o.append("p").text(function(t){return"-build: "+t.build});var c=n.instances.map(function(t){return t.getDatasetName()}),u=this.element.select(".vzb-about-datasets").selectAll(".vzb-about-dataset").data(c);u.exit().remove(),u=u.enter().append("p").attr("class","vzb-about-dataset"),u.append("p").text(function(t){return t})}});e.default=d},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}(r),n(5)),s=(i(a),n(11)),o=i(s),l=n(37),c=i(l),u=n(166),h=i(u),d=o.default.extend("axes",{init:function(t,e){this.name="axes";this.components=[{component:c.default,placeholder:".vzb-xaxis-selector",model:["state.time","state.marker.axis_x","locale"]},{component:h.default,placeholder:".vzb-xaxis-minmax",model:["state.marker","state.time","locale"],markerID:"axis_x",ui:{selectDomainMinMax:!1,selectZoomedMinMax:!0}},{component:c.default,placeholder:".vzb-yaxis-selector",model:["state.time","state.marker.axis_y","locale"]},{component:h.default,placeholder:".vzb-yaxis-minmax",model:["state.marker","state.time","locale"],markerID:"axis_y",ui:{selectDomainMinMax:!1,selectZoomedMinMax:!0}}],this._super(t,e)}});e.default=d},function(t,e,n){"use strict";function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(r),s=n(5),o=function(t){return t&&t.__esModule?t:{default:t}}(s),l=o.default.extend({init:function(t,e){var r,s=this;this.name="gapminder-minmaxinputs",this.template=n(418),this.model_expects=[{name:"marker",type:"marker"},{name:"time",type:"time"},{name:"locale",type:"locale"}],this.markerID=t.markerID,t.markerID||a.warn("minmaxinputs.js complains on 'markerID' property: "+t.markerID),this.model_binds=(r={"translate:locale":function(){s.updateView()}},i(r,"change:marker."+this.markerID,function(){s.updateView()}),i(r,"ready",function(){s.updateView()}),r),this._super(t,e),this.ui=a.extend({selectDomainMinMax:!1,selectZoomedMinMax:!1},this.ui.getPlainObject())},ready:function(){this.updateView()},readyOnce:function(){var t=this;this.element=d3.select(this.element),this.el_domain_labelMin=this.element.select(".vzb-mmi-domainmin-label"),this.el_domain_labelMax=this.element.select(".vzb-mmi-domainmax-label"),this.el_domain_fieldMin=this.element.select(".vzb-mmi-domainmin"),this.el_domain_fieldMax=this.element.select(".vzb-mmi-domainmax"),this.el_break=this.element.select(".vzb-mmi-break"),this.el_zoomed_labelMin=this.element.select(".vzb-mmi-zoomedmin-label"),this.el_zoomed_labelMax=this.element.select(".vzb-mmi-zoomedmax-label"),this.el_zoomed_fieldMin=this.element.select(".vzb-mmi-zoomedmin"),this.el_zoomed_fieldMax=this.element.select(".vzb-mmi-zoomedmax"),t.el_domain_fieldMin.on("change",function(){t._setModel("domainMin",this.value)}),t.el_domain_fieldMax.on("change",function(){t._setModel("domainMax",this.value)}),t.el_zoomed_fieldMin.on("change",function(){t._setModel("zoomedMin",this.value)}),t.el_zoomed_fieldMax.on("change",function(){t._setModel("zoomedMax",this.value)}),this.element.selectAll("input").on("keypress",function(){13==d3.event.which&&document.activeElement.blur()})},updateView:function(){var t=this;this.translator=this.model.locale.getTFunction(),this.el_domain_labelMin.text(this.translator("hints/min")+":"),this.el_domain_labelMax.text(this.translator("hints/max")+":"),this.el_zoomed_labelMin.text(this.translator("hints/min")+":"),this.el_zoomed_labelMax.text(this.translator("hints/max")+":"),this.el_domain_labelMin.classed("vzb-hidden",!this.ui.selectDomainMinMax),this.el_domain_labelMax.classed("vzb-hidden",!this.ui.selectDomainMinMax),this.el_domain_fieldMin.classed("vzb-hidden",!this.ui.selectDomainMinMax),this.el_domain_fieldMax.classed("vzb-hidden",!this.ui.selectDomainMinMax),this.el_break.classed("vzb-hidden",!(this.ui.selectDomainMinMax&&this.ui.selectZoomedMinMax)),this.el_zoomed_labelMin.classed("vzb-hidden",!this.ui.selectZoomedMinMax),this.el_zoomed_labelMax.classed("vzb-hidden",!this.ui.selectZoomedMinMax),this.el_zoomed_fieldMin.classed("vzb-hidden",!this.ui.selectZoomedMinMax),this.el_zoomed_fieldMax.classed("vzb-hidden",!this.ui.selectZoomedMinMax);var e=function(e){return e||0===e?a.isDate(e)?t.model.time.formatDate(e):d3.format(".2r")(e):e},n=this.model.marker[this.markerID],i=n.getScale().domain();this.el_domain_fieldMin.property("value",e(d3.min(i))),this.el_domain_fieldMax.property("value",e(d3.max(i))),this.el_zoomed_fieldMin.property("value",e(n.getZoomedMin())),this.el_zoomed_fieldMax.property("value",e(n.getZoomedMax()))},_setModel:function(t,e){this.model.marker[this.markerID][t]=a.strToFloat(e)}});e.default=l},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}(r),n(5)),s=(i(a),n(11)),o=i(s),l=n(162),c=i(l),u=n(37),h=i(u),d=o.default.extend("colors",{init:function(t,e){this.name="colors",this.components=[{component:h.default,placeholder:".vzb-caxis-selector",model:["state.time","state.marker.color","locale"],showHoverValues:!0},{component:c.default,placeholder:".vzb-clegend-container",model:["state.time","state.entities","state.marker","state.marker.color","locale","ui"]}],this._super(t,e)}});e.default=d},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(11),a=i(r),s=n(1),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(s),l=n(5),c=i(l),u=c.default.extend({init:function(t,e){this.name="gapminder-dialogs",this._curr_dialog_index=20,this.model_expects=[{name:"state",type:"model"},{name:"ui",type:"ui"},{name:"locale",type:"locale"}];var n=a.default.getCollection();this._available_dialogs=Object.keys(n).reduce(function(t,e){var i=n[e];return i.prototype.isDialog&&!e.startsWith("_")&&(t[e]={dialog:i}),t},{}),this._super(t,e)},domReady:function(){var t=(this.model.ui.dialogs||{}).popup||[],e=(this.model.ui.dialogs||{}).sidebar||[];this.rootEl=this.root.element instanceof Array?this.root.element:d3.select(this.root.element),!0===e&&(e=t,(this.model.ui.dialogs||{}).sidebar=e),0!==e.length&&this.rootEl.classed("vzb-dialog-expand-true",!0),this.dialog_popup=t,this.dialog_sidebar=e},readyOnce:function(){var t=this;if(this.element=d3.select(this.placeholder),this.element.selectAll("div").remove(),o.isTouchDevice()&&this.element.classed("vzb-no-hover",!0),this._addDialogs(this.dialog_popup,this.dialog_sidebar),o.defer(function(){t.trigger("resize")}),0!==this.dialog_popup.length){this.root.findChildByName("gapminder-buttonlist").on("click",function(e,n){t._available_dialogs[n.id]&&(n.active?t.openDialog(n.id):t.closeDialog(n.id))});var e=this.element.selectAll(".vzb-top-dialog").filter(function(e){return t.dialog_popup.indexOf(e.id)>-1});e.select(".vzb-top-dialog>.vzb-dialog-modal>.vzb-dialog-buttons>[data-click='closeDialog']").on("click",function(e,n){t.closeDialog(e.id)});e.select(".vzb-top-dialog>.vzb-dialog-modal>[data-click='pinDialog']").on("click",function(e,n){t.pinDialog(e.id)}),this.rootEl.node().addEventListener("click",function(){t.closeAllDialogs()}),this.rootEl.on("mousedown",function(e){if(this._active_comp){for(var n=d3.event.target,i=!0;n;){if(n.classList.contains("vzb-dialog-modal")){i=!1;break}n=n.parentElement}i&&t.closeAllDialogs()}})}this.element.on("click",function(){d3.event.stopPropagation()})},resize:function(){if(!this.element.selectAll)return o.warn("dialogs resize() aborted because element is not yet defined");var t=this,e=this.getLayoutProfile();this.element.selectAll(".vzb-top-dialog").each(function(n){var i=d3.select(this),r=i.attr("class").replace(" vzb-popup","").replace(" vzb-sidebar","");"large"===e&&t.dialog_sidebar.indexOf(n.id)>-1?r+=" vzb-sidebar":t.dialog_popup.indexOf(n.id)>-1&&(r+=" vzb-popup"),i.attr("class",r)})},_addDialogs:function(t,e){var n=(this.getLayoutProfile(),[]);n=t?n.concat(t):n,n=e?n.concat(e):n,n=o.unique(n),this._components_config=[];var i=[];if(n.length){for(var r=0;r<n.length;r++){var a=n[r],s=this._available_dialogs[a];if(s&&s.dialog){var l=this._components_config;l.push({component:s.dialog,placeholder:'.vzb-dialogs-dialog[data-dlg="'+a+'"]',model:["state","ui","locale"]}),s.component=l.length-1}s.id=a,i.push(s)}this.element.selectAll("div").data(i).enter().append("div").attr("data-dlg",function(t){return t.id}).attr("class","vzb-top-dialog vzb-dialogs-dialog vzb-dialog-shadow"),this.loadSubComponents();var c=this;o.forEach(this.components,function(t){t.render(),c.on("resize",function(){t.trigger("resize")}),t.on("dragstart",function(){c.bringForward(t.name)}),t.on("close",function(){this.placeholderEl.each(function(t){var e={};e.id=t.id,c.trigger("close",e)})})})}},bringForward:function(t){this.element.select(".vzb-popup.vzb-dialogs-dialog[data-dlg='"+t+"']").style("z-index",this._curr_dialog_index),this._curr_dialog_index+=10},openDialog:function(t){var e="small"===this.getLayoutProfile();this.closeAllDialogs(e);var n=this.element.selectAll(".vzb-popup.vzb-dialogs-dialog[data-dlg='"+t+"']");this._active_comp=this.components[this._available_dialogs[t].component],this._active_comp.beforeOpen(),n.classed("vzb-active",!0),this.bringForward(t),this._active_comp.open()},pinDialog:function(t){var e=this.element.select(".vzb-popup.vzb-dialogs-dialog[data-dlg='"+t+"']");this._available_dialogs[t].ispin?(e.classed("pinned",!1),this._available_dialogs[t].ispin=!1):(e.classed("pinned",!0),this._available_dialogs[t].ispin=!0)},closeDialog:function(t){var e=this.element.selectAll(".vzb-popup.vzb-dialogs-dialog[data-dlg='"+t+"']");this._active_comp=this.components[this._available_dialogs[t].component],this._active_comp&&!this._active_comp.isOpen||(this._available_dialogs[t].ispin&&this.pinDialog(t),this._active_comp&&this._active_comp.beforeClose(),e.classed("vzb-active",!1),this._active_comp&&this._active_comp.close(),this._active_comp=!1)},closeAllDialogs:function(t){var e=this,n=t?".vzb-popup.vzb-dialogs-dialog.vzb-active":".vzb-popup.vzb-dialogs-dialog.vzb-active:not(.pinned)";this.element.selectAll(n).each(function(t){e.closeDialog(t.id)})}});e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(r),s=n(5),o=(i(s),n(11)),l=i(o),c=n(59),u=i(c),h=n(37),d=i(h),f=l.default.extend("find",{init:function(t,e){this.name="find";var n=this;this.components=[{component:u.default,placeholder:".vzb-dialog-bubbleopacity",model:["state.marker","locale"],arg:"opacitySelectDim"}],this.enablePicker=((t.ui.dialogs.dialog||{}).find||{}).enablePicker,this.enablePicker&&this.components.push({component:d.default,placeholder:".vzb-find-filter-selector",model:["state.time","state.entities","locale"]}),this.model_binds={"change:state.marker.select":function(t){n.items.order(),n.selectDataPoints(),n.showHideDeselect()},"change:state.time.playing":function(t){n.model.state.time.playing||(n.time=n.model.state.time.value,n.model.state.marker.getFrame(n.time,function(t,e){!t||n.time-e||n.redrawDataPoints(t)}))},"change:state.time.value":function(t){(n.placeholderEl.classed("vzb-active")||n.placeholderEl.classed("vzb-sidebar"))&&(n.time=n.model.state.time.value,n.model.state.marker.getFrame(n.time,function(t){t&&n.redrawDataPoints(t)}))},"translate:locale":function(){n.input_search.attr("placeholder",n.translator("placeholder/search")+"...")}},this._super(t,e)},readyOnce:function(){this._super(),this.list=this.element.select(".vzb-find-list"),this.input_search=this.element.select(".vzb-find-search"),this.deselect_all=this.element.select(".vzb-find-deselect"),this.opacity_nonselected=this.element.select(".vzb-dialog-bubbleopacity"),this.element.select(".vzb-find-filter-selector").classed("vzb-hidden",!this.enablePicker),this.element.select(".vzb-dialog-title").classed("vzb-title-two-rows",this.enablePicker),this.KEY=this.model.state.entities.getDimension();var t=this;this.input_search.on("keyup",function(){13==d3.event.keyCode&&"select all"==t.input_search.node().value&&(t.input_search.node().value="",a.isTouchDevice()||t.model.state.marker.clearHighlighted(),t.model.state.marker.selectAll())}),this.input_search.on("input",function(){t.showHideSearch()}),d3.select(this.input_search.node().parentNode).on("reset",function(){a.defer(function(){return t.showHideSearch()})}),this.deselect_all.on("click",function(){t.deselectMarkers()}),this.translator=this.model.locale.getTFunction(),this.input_search.attr("placeholder",this.translator("placeholder/search")+"..."),this.root.on("ready",function(){t.ready()})},open:function(){var t=this;this._super(),this.input_search.node().value="",this.showHideSearch(),this.time=this.model.state.time.value,this.model.state.marker.getFrame(this.time,function(e){e&&t.redrawDataPoints(e)})},ready:function(){this._super();var t=this,e=this.KEY=this.model.state.entities.getDimension(),n=this.KEYS=a.unique(this.model.state.marker._getAllDimensions({exceptType:"time"}));this.multiDim=n.length>1,this.importantHooks=t.model.state.marker.getImportantHooks();var i=t.model.state.marker.getLabelHookNames();this.time=this.model.state.time.value,this.model.state.marker.getFrame(this.time,function(r){if(r){var s=t.multiDim?t.model.state.marker.getKeysMD().map(function(t){return t.brokenData=!1,t.name=n.map(function(e,n){return r[i[n]][t[e]]}).join(", "),t}):t.model.state.marker.getKeys().map(function(t){var n={};return n[e]=t[e],n.brokenData=!1,n.name=r.label[t[e]],n});s.sort(function(t,e){return t.name<e.name?-1:1}),t.list.html(""),t.items=t.list.selectAll(".vzb-find-item").data(s).enter().append("div").attr("class","vzb-find-item vzb-dialog-checkbox"),t.items.append("input").attr("type","checkbox").attr("class","vzb-find-item").attr("id",function(e,n){return"-find-"+n+"-"+t._id}).on("change",function(e){a.isTouchDevice()||t.model.state.marker.clearHighlighted(),t.model.state.marker.selectMarker(e),a.isTouchDevice()||e.brokenData||t.model.state.marker.highlightMarker(e)}),t.items.append("label").attr("for",function(e,n){return"-find-"+n+"-"+t._id}).text(function(t){return t.name}).attr("title",function(t){return this.offsetWidth<this.scrollWidth?t.name:null}).on("mouseover",function(e){a.isTouchDevice()||e.brokenData||t.model.state.marker.highlightMarker(e)}).on("mouseout",function(e){a.isTouchDevice()||t.model.state.marker.clearHighlighted()}),a.preventAncestorScrolling(t.element.select(".vzb-dialog-scrollable")),t.redrawDataPoints(r),t.selectDataPoints(),t.showHideSearch(),t.showHideDeselect()}})},redrawDataPoints:function(t){var e=this,n=this.KEY,i=this.KEYS;this.multiDim?e.items.each(function(n){var r=d3.select(this).select("label");n.brokenData=!1,a.forEach(e.importantHooks,function(e){var r=t[e];if(r){var s=a.getValueMD(n,r,i)||!1;return s||0===s?void 0:(n.brokenData=!0,!1)}});var s=this.offsetWidth<this.scrollWidth?n.name:"";r.classed("vzb-find-item-brokendata",n.brokenData).attr("title",s+(n.brokenData?(s?" | ":"")+e.model.state.time.formatDate(e.time)+": "+e.translator("hints/nodata"):""))}):e.items.each(function(i){var r=d3.select(this).select("label");i.brokenData=!1,a.forEach(t,function(t,r){"color"===r||"size_label"===r||"constant"===e.model.state.marker[r].use||t[i[n]]||0===t[i[n]]||(i.brokenData=!0)});var s=this.offsetWidth<this.scrollWidth?i.name:"";r.classed("vzb-find-item-brokendata",i.brokenData).attr("title",s+(i.brokenData?(s?" | ":"")+e.model.state.time.formatDate(e.time)+": "+e.translator("hints/nodata"):""))})},selectDataPoints:function(){var t=(this.KEY,this.model.state.marker);this.items.selectAll("input").property("checked",function(e){var n=t.isSelected(e);return d3.select(this.parentNode).classed("vzb-checked",n),n});var e=this.list.selectAll(".vzb-checked").classed("vzb-separator",!1).lower().nodes()[0];d3.select(e).classed("vzb-separator",!0),this.contentEl.node().scrollTop=0},showHideSearch:function(){var t=this.input_search.node().value||"";t=t.toLowerCase(),this.list.selectAll(".vzb-find-item").classed("vzb-hidden",function(e){return-1===(e.name||"").toString().toLowerCase().indexOf(t)})},showHideDeselect:function(){var t=!!this.model.state.marker.select.length;this.deselect_all.classed("vzb-hidden",!t),this.opacity_nonselected.classed("vzb-hidden",!t),t&&this.components[0].trigger("resize")},deselectMarkers:function(){this.model.state.marker.clearSelected()},transitionEnd:function(t){this._super(t),a.isTouchDevice()||this.input_search.node().focus()}});e.default=f},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}(r),n(5)),s=(i(a),n(11)),o=i(s),l=n(59),c=i(l),u=o.default.extend("grouping",{init:function(t,e){this.name="grouping",this.groupStops=[1,5,10,15],this.components=[{component:c.default,placeholder:".vzb-dialog-placeholder",model:["state.entities_age","locale"],arg:"grouping",properties:{snapValue:!0,suppressInput:!0,domain:this.groupStops}}],this._super(t,e)},readyOnce:function(){this._super(),this.element.select(".vzb-dialog-groups").selectAll(".vzb-dialog-groups-title").data(this.groupStops).enter().append("span").attr("class",".vzb-dialog-groups-title").text(function(t){return t})}});e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}(r),n(5)),s=(i(a),n(11)),o=i(s),l=n(159),c=i(l),u=n(37),h=i(u),d=n(60),f=i(d),p=o.default.extend("label",{init:function(t,e){this.name="label",this.components=[{component:c.default,placeholder:".vzb-dialog-sizeslider",model:["state.marker.size_label","locale"],propertyname:"LabelTextSize",ui:{constantUnit:"unit/pixels"}},{component:h.default,placeholder:".vzb-saxis-selector",model:["state.time","state.marker.size_label","locale"],showHoverValues:!0},{component:f.default,placeholder:".vzb-removelabelbox-switch",model:["ui.chart","locale"],checkbox:"removeLabelBox",submodel:"labels"}],this._super(t,e)}});e.default=p},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(r),s=n(5),o=(i(s),n(11)),l=i(o),c=n(161),u=i(c),h=l.default.extend("moreoptions",{init:function(t,e){this.name="moreoptions",this.components=[{component:u.default,placeholder:".vzb-dialog-options-buttonlist",model:["state","ui","locale"]}],this._super(t,e)},readyOnce:function(){this._super();var t=this;this.accordionEl=this.contentEl.select(".vzb-accordion"),this.on("dragend",function(){t._setMaxHeight()});var e=(this.model.ui.dialogs||{}).popup||[],n=(this.model.ui.dialogs||{}).moreoptions||[];if(!0===n&&(n=e,(this.model.ui.dialogs||{}).moreoptions=n),this._addDialogs(n),this.accordionEl){this.accordionEl.selectAll(".vzb-accordion-section").select(".vzb-dialog-title>span:first-child").on("click",function(e){var n=(t.components[e.component].element,t.components[e.component].placeholderEl),i=t.accordionEl.select(".vzb-accordion-active");i&&i.classed("vzb-accordion-active",!1),n.node()!==i.node()&&(n.classed("vzb-accordion-active",!0),t.transitionEvents.forEach(function(i){n.on(i,function(){t.transitionEvents.forEach(function(t){n.on(t,null)}),t.components[e.component].trigger("resize")})}))})}},_addDialogs:function(t){this._components_config=[];var e=[];if(t.length){for(var n=0;n<t.length;n++)if("moreoptions"!==t[n]){var i=t[n],r=a.deepClone(this.parent._available_dialogs[i]);if(r&&r.dialog){var s=this._components_config;s.push({component:r.dialog,placeholder:'.vzb-dialogs-dialog[data-dlg="'+i+'"]',model:["state","ui","locale"]}),r.component=s.length-1,r.id=i,e.push(r)}}this.accordionEl.selectAll("div").data(e).enter().append("div").attr("class",function(t){return"vzb-dialogs-dialog vzb-moreoptions vzb-accordion-section"}).attr("data-dlg",function(t){return t.id}),this.loadSubComponents();var o=this;a.forEach(this.components,function(t){t.render(),o.on("resize",function(){t.trigger("resize")})})}}});e.default=h},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}(r),n(5)),s=(i(a),n(11)),o=i(s),l=n(59),c=i(l),u=o.default.extend("opacity",{init:function(t,e){this.name="opacity",this.components=[{component:c.default,placeholder:".vzb-dialog-bubbleopacity-regular",model:["state.marker","locale"],arg:"opacityRegular"},{component:c.default,placeholder:".vzb-dialog-bubbleopacity-selectdim",model:["state.marker","locale"],arg:"opacitySelectDim"}],this._super(t,e)}});e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}(r),n(5)),s=(i(a),n(11)),o=i(s),l=n(60),c=i(l),u=o.default.extend("presentation",{init:function(t,e){this.name="presentation",this.components=[{component:c.default,placeholder:".vzb-presentationmode-switch",model:["ui","locale"],checkbox:"presentation"}],this._super(t,e)}});e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(r),s=n(5),o=(i(s),n(11)),l=i(o),c=n(37),u=i(c),h=l.default.extend("show",{init:function(t,e){this.name="show";var n=this;this.model_binds={"change:state.entities.show":function(t){n.redraw()}},this.enablePicker=((t.ui.dialogs.dialog||{}).show||{}).enablePicker,this.enablePicker&&(this.components=[{component:u.default,placeholder:".vzb-show-filter-selector",model:["state.time","state.entities","locale"]}]),this._super(t,e)},readyOnce:function(){this._super(),this.resetFilter=a.deepExtend({},this.model.state.entities.show),this.element.select(".vzb-show-filter-selector").classed("vzb-hidden",!this.enablePicker),this.element.select(".vzb-dialog-title").classed("vzb-title-two-rows",this.enablePicker),this.list=this.element.select(".vzb-show-list"),this.input_search=this.element.select(".vzb-show-search"),this.deselect_all=this.element.select(".vzb-show-deselect"),this.KEY=this.model.state.entities.getDimension(),this.TIMEDIM=this.model.state.time.getDimension();var t=this;this.input_search.on("input",function(){t.showHideSearch()}),d3.select(this.input_search.node().parentNode).on("reset",function(){a.defer(function(){return t.showHideSearch()})}),this.deselect_all.on("click",function(){t.deselectEntities()}),this.root.on("ready",function(){t.KEY=t.model.state.entities.getDimension(),t.redraw()})},open:function(){this._super(),this.input_search.node().value="",this.showHideSearch()},ready:function(){this._super(),this.KEY=this.model.state.entities.getDimension(),this.redraw(),a.preventAncestorScrolling(this.element.select(".vzb-dialog-scrollable"))},redraw:function(){var t=this;if(this.translator=this.model.locale.getTFunction(),!this.KEY)return void t.list.html("");this.model.state.marker_allpossible.getFrame(this.model.state.time.value,function(e){if(e){var n=a.keys(e.label).map(function(n){var i={};return i[t.KEY]=n,i.label=e.label[n],i});n.sort(function(t,e){return t.label<e.label?-1:1}),t.list.html("");var i=t.list.selectAll(".vzb-show-item").data(n).enter().append("div").attr("class","vzb-show-item vzb-dialog-checkbox");i.append("input").attr("type","checkbox").attr("class","vzb-show-item").attr("id",function(e){return"-show-"+e[t.KEY]+"-"+t._id}).property("checked",function(e){var n=t.model.state.entities.isShown(e);return d3.select(this.parentNode).classed("vzb-checked",n),n}).on("change",function(e){t.model.state.marker.clearSelected(),t.model.state.entities.showEntity(e),t.showHideDeselect()}),i.append("label").attr("for",function(e){return"-show-"+e[t.KEY]+"-"+t._id}).text(function(t){return t.label}).attr("title",function(t){return this.offsetWidth<this.scrollWidth?t.label:null});var r=t.list.selectAll(".vzb-checked").classed("vzb-separator",!1).lower().nodes()[0];d3.select(r).classed("vzb-separator",!0),t.contentEl.node().scrollTop=0,t.input_search.attr("placeholder",t.translator("placeholder/search")+"..."),t.showHideSearch(),t.showHideDeselect()}})},showHideSearch:function(){var t=this.input_search.node().value||"";t=t.toLowerCase(),this.list.selectAll(".vzb-show-item").classed("vzb-hidden",function(e){return-1===(e.label||"").toString().toLowerCase().indexOf(t)})},showHideDeselect:function(){var t=this.model.state.entities.show[this.KEY];this.deselect_all.classed("vzb-hidden",!t||0==t.length)},deselectEntities:function(){var t=this.KEY;if(this.resetFilter[t]){var e=Object.assign({},this.model.state.entities.show);e[t]=this.resetFilter[t],this.model.state.entities.show=e}else this.model.state.entities.clearShow();this.showHideDeselect()},transitionEnd:function(t){this._super(t),a.isTouchDevice()||this.input_search.node().focus()}});e.default=h},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(r),s=n(5),o=(i(s),n(11)),l=i(o),c=n(37),u=i(c),h=n(60),d=(i(h),l.default.extend("side",{init:function(t,e){this.name="side";var n=this;this.model_binds={"change:state.marker.side.which":function(t){if(n.model.state.entities_allpossibleside){var e="constant"==n.model.state.marker.side.use?null:n.model.state.marker.side.which;n.model.state.entities_allpossibleside.set("dim",e)}},"change:state.entities_side.show":function(t){n._readyOnce&&(n.updateState(),n.redraw())},"change:ui.chart.flipSides":function(t){n._readyOnce&&(n.updateState(),n.redraw())}},this.components=[{component:u.default,placeholder:".vzb-side-selector",model:["state.time","state.marker.side","locale"],showHoverValues:!1}],this._super(t,e)},readyOnce:function(){this._super(),this.listLeft=this.element.select(".vzb-side-list-left"),this.listRight=this.element.select(".vzb-side-list-right"),this.switchSides=this.element.select(".vzb-side-switch-sides"),this.TIMEDIM=this.model.state.time.getDimension(),this.state={};var t=this;this.switchSides.on("click",function(){t.model.ui.chart.flipSides=!t.model.ui.chart.flipSides}),this.root.on("ready",function(){t.redraw()})},ready:function(){if(this._super(),this.KEY=this.model.state.entities_side.getDimension(),"constant"!==this.model.state.marker.side.use&&!(this.model.state.entities_side.show[this.KEY]||{}).$in){var t=this.model.state.entities_allpossibleside.dim,e=this.model.state.marker_allpossibleside.getKeys().map(function(e){return e[t]}),n=e.sort(d3.ascending).slice(0,2);if(n.length>0){var i=Object.assign({},this.model.state.entities_side.show);i[this.KEY]={$in:n},this.model.state.entities_side.set("show",i)}}this.updateState(),this.redraw(),a.preventAncestorScrolling(this.element.select(".vzb-dialog-scrollable"))},updateState:function(){var t=this,e=this.model.state.marker.side.getEntity().getDimension(),n=this.model.state.marker.side;if(this.state.right={},this.state.left={},n.state.left[e]&&n.state.right[e])this.state.left[e]=n.state.left[e],this.state.right[e]=n.state.right[e];else{var i=this.model.state.marker.getKeys(e),r=[],a=!!this.model.state.marker.side.getEntity().show[e];if(r=i.filter(function(e){return!a||t.model.state.marker.side.getEntity().isShown(e)}).map(function(t){return t[e]}),r.length>2&&(r.length=2),r.length>1){var s=this.ui.chart.flipSides?d3.ascending:d3.descending;r.sort(s)}this.state.right={},this.state.right[e]=r[0],this.state.left={},this.state.left[e]=r[1]?r[1]:r[0]}var o="constant"==this.model.state.marker.side.use;this.listLeft.classed("vzb-hidden",o),this.listRight.classed("vzb-hidden",o),this.switchSides.classed("vzb-hidden",o||this.state.left[e]==this.state.right[e])},redraw:function(){var t=this;this.translator=this.model.locale.getTFunction(),t.model.state.entities_allpossibleside.dim&&this.model.state.marker_allpossibleside.getFrame(this.model.state.time.value,function(e){if(e){var n=a.keys(e.label).map(function(n){var i={};return i[t.KEY]=n,i.label=e.label[n],i});n.sort(function(t,e){return t.label<e.label?-1:1}),t.listLeft.html(""),t.listRight.html(""),t.createList(t.listLeft,"left",n),t.createList(t.listRight,"right",n)}})},createList:function(t,e,n){var i=this,r=this.model.state.marker.side.getEntity().getDimension(),a=t.selectAll(".vzb-side-item").data(n).enter().append("div").attr("class","vzb-side-item vzb-dialog-radio");a.append("input").attr("type","radio").attr("name",e+"-"+i._id).attr("class","vzb-side-item").attr("id",function(t){return"-side-"+e+"-"+t[r]+"-"+i._id}).property("checked",function(t){return i.state[e][r]===t[r]}).on("change",function(t,n){var r=i.model.state.entities_side,a=r.getDimension(),s="left"==e?"right":"left",o=i.model.state.marker.side;o.state[e][a]=t[a],o.state[s][a]=i.state[s][a];var l=[];if(r.isShown(t)||l.push(t),t[a]===i.state[s][a]||r.isShown(i.state[s])||l.push(i.state[s]),i.state[e][a]!==i.state[s][a]&&r.isShown(i.state[e])&&l.push(i.state[e]),t[a]!==i.state[s][a]){var c=[t[a],i.state[s][a]],u=i.ui.chart.flipSides?d3.ascending:d3.descending;c.sort(u),c["left"==e?0:1]==t[a]&&(i.model.state.marker.side.switchSideState(),i.ui.chart.flipSides=!i.ui.chart.flipSides)}l.length&&r.showEntity(l)}),a.append("label").attr("for",function(t){return"-side-"+e+"-"+t[i.KEY]+"-"+i._id}).text(function(t){return t.label})}}));e.default=d},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}(r),n(5)),s=(i(a),n(11)),o=i(s),l=n(158),c=i(l),u=n(37),h=i(u),d=o.default.extend("size",{init:function(t,e){this.name="size",this.components=[{component:h.default,placeholder:".vzb-saxis-selector",model:["state.time","state.marker.size","locale"],showHoverValues:!0}],t.ui.chart&&0===t.ui.chart.sizeSelectorActive||this.components.push({component:c.default,placeholder:".vzb-dialog-bubblesize",model:["state.marker.size","locale"],ui:{show_button:!1}}),this._super(t,e)}});e.default=d},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}(r),n(5)),s=(i(a),n(11)),o=i(s),l=n(59),c=i(l),u=o.default.extend("speed",{init:function(t,e){this.name="speed",this.components=[{component:c.default,placeholder:".vzb-dialog-placeholder",model:["state.time","locale"],arg:"delay",properties:{domain:[1200,900,450,200,150,100],roundDigits:0}}],this._super(t,e)}});e.default=u},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}(r),n(5)),s=(i(a),n(11)),o=i(s),l=n(180),c=i(l),u=o.default.extend("stack",{init:function(t,e){this.name="stack";var n=this;this.components=[{component:c.default,placeholder:".vzb-dialog-draggablelist",model:["state.marker.group","state.marker.color","locale","ui.chart"],groupID:"manualSorting",isEnabled:"manualSortingEnabled",dataArrFn:n.manualSorting.bind(n),lang:""}],this.model_binds={"change:state.marker.group":function(t){n._ready&&n.updateView()}},this._super(t,e)},readyOnce:function(){this._super();var t=this;this.group=this.model.state.marker.group,this.stack=this.model.state.marker.stack,this.howToStackEl=this.element.select(".vzb-howtostack").selectAll("input").on("change",function(){t.setModel("stack",d3.select(this).node().value)}),this.howToMergeEl=this.element.select(".vzb-howtomerge").selectAll("input").on("change",function(){t.setModel("merge",d3.select(this).node().value)}),this.updateView()},ready:function(){if(this._super(),!this.model.state.marker.color.isDiscrete()){if("property"==this.stack.use)return void this.setModel("stack","none");if(this.group.merge)return void this.setModel("merge","none")}this.updateView()},updateView:function(){var t=this;this.howToStackEl.property("checked",function(){return"none"===d3.select(this).node().value?"none"===t.stack.which:"bycolor"===d3.select(this).node().value?t.stack.which===t.model.state.marker.color.which:"all"===d3.select(this).node().value?"all"===t.stack.which:void 0}).attr("disabled",function(){return"none"===d3.select(this).node().value?null:"all"===d3.select(this).node().value?null:"bycolor"===d3.select(this).node().value?"property"!==t.model.state.marker.color.use||null:void 0}),t.model.ui.chart.manualSortingEnabled="all"==t.stack.which,this.howToMergeEl.property("checked",function(){return"none"===d3.select(this).node().value?!t.group.merge&&!t.stack.merge:"grouped"===d3.select(this).node().value?t.group.merge:"stacked"===d3.select(this).node().value?t.stack.merge:void 0}).attr("disabled",function(){return"none"===d3.select(this).node().value?null:"grouped"===d3.select(this).node().value?"none"===t.stack.which||"property"!==t.model.state.marker.color.use||null:"stacked"===d3.select(this).node().value?"all"!==t.stack.which||null:void 0})},manualSorting:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(0===arguments.length)return this.model.state.marker.group.manualSorting;this.model.state.marker.group.set({manualSorting:t},!1,e)},setModel:function(t,e){var n={stack:{},group:{}};if("merge"===t)switch(e){case"none":n.group.merge=!1,n.stack.merge=!1;break;case"grouped":n.group.merge=!0,n.stack.merge=!1;break;case"stacked":n.group.merge=!1,n.stack.merge=!0}if("stack"===t){switch(e){case"all":n.stack.use="constant",n.stack.which="all";break;case"none":n.stack.use="constant",n.stack.which="none";break;case"bycolor":n.stack.use="property",n.stack.which=this.model.state.marker.color.which}"none"===e&&this.group.merge&&(n.group.merge=!1),"all"!==e&&this.stack.merge&&(n.stack.merge=!1)}this.model.state.marker.set(n)}});e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(i),a=n(5),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o=s.default.extend({init:function(t,e){this.template='<span class="vzb-dl-holder"><ul class="vzb-draggable list vzb-dialog-scrollable"></ul></span>';var n=this;this.name="draggableList",this.dataArrFn=t.dataArrFn,this.lang=t.lang,this.model_expects=[{name:"group",type:"model"},{name:"color",type:"color"},{name:"locale",type:"locale"},{name:"chart",type:"model"}],this.groupID=t.groupID,this.isEnabled=t.isEnabled,this.draggable=!0,t.groupID||r.warn("draggablelist.js complains on 'groupID' property: "+t.groupID),this.model_binds={"translate:locale":function(t){n.updateView()},"change:group.which":function(t){n.updateView()}},this.model_binds["change:group."+this.groupID]=function(t){n.updateView()},this.model_binds["change:chart."+this.isEnabled]=function(t){n.draggable=n.model.chart[n.isEnabled],n.updateView()},this._super(t,e),this.updateData=r.debounce(this.updateData,1e3),this.itemDragger=d3.drag().on("start",function(t,e){!n.dataUpdateFlag&&n.draggable&&(d3.event.sourceEvent.stopPropagation(),n.parentBoundRect=n.element.node().getBoundingClientRect(),n.element.selectAll("div").each(function(e,i){var r=this.getBoundingClientRect();e._y=r.top,e._top=0,t.data===e.data&&(e._height=r.height,n.selectedNode=this)}),d3.select(n.selectedNode).classed("dragged",!0))}).on("drag",function(t,e){if(!n.dataUpdateFlag&&n.draggable){t._top+=d3.event.dy;var i=t._y+t._top;i>n.parentBoundRect.top&&i+t._height<n.parentBoundRect.top+n.parentBoundRect.height&&n.itemsEl.style("top",function(n,r){var a=0;return r<e&&n._y+.5*t._height>i?a=t._height:r>e&&n._y-.5*t._height<i&&(a=-t._height),r!=e&&(n._top=a),n._top+"px"})}}).on("end",function(t,e){!n.dataUpdateFlag&&n.draggable&&n.getData()})},ready:function(){var t=this;this.updateView(),this.itemsEl=this.element.selectAll("div"),this.itemsEl.call(t.itemDragger);this.itemsEl.select("li").on("mouseover",function(){d3.select(this).classed("hover",!0)}).on("mouseout",function(){d3.select(this).classed("hover",!1)}).on("touchstart",function(){d3.event.preventDefault()})},updateView:function(){var t=this,e=t.model.color.getColorlegendMarker().label.getItems(),n=r.keys(e),i=n.slice().sort(),a=(this.dataArrFn()||[]).slice().sort();!1===r.arrayEquals(i,a)&&this.dataArrFn(n),this.items=this.element.selectAll("div").data(function(){return(t.dataArrFn()||[]).map(function(t){return{data:t}})}),this.items.exit().remove(),this.items=this.items.enter().append("div").append("li").each(function(){var t=d3.select(this);t.append("span").classed("label-circle",!0),t.append("span").classed("label-text",!0)}).merge(this.items);var s=this.model.color.getScale();this.items.select("li").each(function(t){var n=t.data,i=d3.select(this);i.classed("hover",!1).attr("data",n),i.select(".label-circle").style("background",s(n)),i.select(".label-text").text(e[n])});var o=!!t.draggable||null;this.element.selectAll("div").style("top","").attr("draggable",o).classed("dragged",!1),this.dataUpdateFlag=!1},getData:function(){var t=[];t=this.element.selectAll("div").data().sort(function(t,e){return t._y+t._top-(e._y+e._top)}).map(function(t){return t.data}),r.arrayEquals(this.dataArrFn(),t)?this.updateView():(this.dataUpdateFlag=!0,this.updateData(t,!0))},updateData:function(t,e){this.dataArrFn(t,e)},readyOnce:function(){this.element=d3.select(this.element).select(".list")}});e.default=o},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(11),a=i(r),s=n(182),o=i(s),l=a.default.extend("timedisplay",{init:function(t,e){var n=this;this.name="timedisplay",this.model_binds={"change:state.time.value":function(){n.updateTime()}},this._super(t,e)},ready:function(){this.updateTime()},readyOnce:function(){this._super(),this.timeLabel=new o.default(this.element.select(".vzb-timedisplay")),this.timeLabel.setConditions({widthRatio:1,heightRatio:1}),this.resize()},resize:function(){this.timeLabel&&this.timeLabel.resize(this.contentEl.style("width"),this.contentEl.style("height"))},updateTime:function(){var t=this.model.state.time;this.time_1=null==this.time?t.value:this.time,this.time=t.value;var e=t.playing&&this.time-this.time_1>0?t.delayAnimations:0;this.timeLabel.setText(t.formatDate(this.time,"ui"),e)}});e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(31),r=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default=r.default.extend({init:function(t,e){this.context=t,this.context.classed("vzb-dynamic-background",!0),this.width=0,this.height=0,this.topOffset=0,this.leftOffset=0,this.bottomOffset=0,this.rightOffset=0,this.textWidth=0,this.textHeight=0,this.widthRatio=.9,this.heightRatio=.9,this.xAlign="center",this.yAlign="center",this.element=this.context.append("text").style("font-size","20px"),this._sample=this.context.append("text").style("font-size","20px").style("opacity",0),e&&this.setConditions(e)},setConditions:function(t){return!isNaN(parseFloat(t.rightOffset))&&isFinite(t.rightOffset)&&(this.rightOffset=t.rightOffset),!isNaN(parseFloat(t.leftOffset))&&isFinite(t.leftOffset)&&(this.leftOffset=t.leftOffset),!isNaN(parseFloat(t.topOffset))&&isFinite(t.topOffset)&&(this.topOffset=t.topOffset),!isNaN(parseFloat(t.bottomOffset))&&isFinite(t.bottomOffset)&&(this.bottomOffset=t.bottomOffset),t.xAlign&&(this.xAlign=t.xAlign),t.yAlign&&(this.yAlign=t.yAlign),!isNaN(parseFloat(t.widthRatio))&&t.widthRatio>0&&t.widthRatio<=1&&(this.widthRatio=t.widthRatio),!isNaN(parseFloat(t.heightRatio))&&t.heightRatio>0&&t.heightRatio<=1&&(this.heightRatio=t.heightRatio),this},resize:function(t,e,n,i){this.width=parseInt(t,10)||0,this.height=parseInt(e,10)||0,n&&(this.topOffset=n),i&&(this.leftOffset=i),this._resizeText()},setText:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=function(){e._sample.text(t),e._resizeText(),e.element.text(t)},r=function(){clearTimeout(e._text.timeout),delete e._text};return n?(this._text&&(this._text.callback(),r()),this._text={callback:i,timeout:setTimeout(function(){i(),r()},n)}):(this._text&&r(),i()),this},_resizeText:function(){var t=this._sample.node().getBBox();if(!(t.width&&t.height&&this.width&&this.height))return this;var e=this.width*this.widthRatio/t.width,n=this.height*this.heightRatio/t.height;switch(this.scalar=Math.min(e,n),this.element.attr("transform","scale("+this.scalar+")"),this.textHeight=t.height*this.scalar,this.textWidth=t.width*this.scalar,this.yAlign){case"bottom":case"center":this.context.select("text").attr("dy",".325em");break;case"top":this.context.select("text").attr("dy","0")}return this.context.attr("transform","translate("+this._getLeftOffset()+","+this._getTopOffset()+")"),this},_getLeftOffset:function(){switch(this.xAlign){case"right":return this.width-this.textWidth/2-this.rightOffset;case"left":return this.textWidth/2+this.leftOffset;default:return this.width/2}},_getTopOffset:function(){switch(this.yAlign){case"top":return this.textHeight/2+this.topOffset;case"bottom":return this.height-this.textHeight/2-this.bottomOffset;default:return this.height/2}}})},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}(r),n(5)),s=(i(a),n(11)),o=i(s),l=n(184),c=i(l),u=n(60),h=i(u),d=o.default.extend("zoom",{init:function(t,e){this.name="zoom",this.components=[{component:c.default,placeholder:".vzb-dialog-zoom-buttonlist",model:["state","ui","locale"]},{component:h.default,placeholder:".vzb-panwitharrow-switch",model:["ui","locale"],checkbox:"panWithArrow"},{component:h.default,placeholder:".vzb-zoomonscrolling-switch",model:["ui","locale"],checkbox:"zoomOnScrolling"},{component:h.default,placeholder:".vzb-adaptminmaxzoom-switch",model:["ui","locale"],checkbox:"adaptMinMaxZoom"}],this._super(t,e)}});e.default=d},function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=i(r),s=n(5),o=function(t){return t&&t.__esModule?t:{default:t}}(s),l=n(21),c=i(l),u=o.default.extend({init:function(t,e){var n=this;this.name="gapminder-zoombuttonlist",this.model_expects=[{name:"state",type:"model"},{name:"ui",type:"ui"},{name:"locale",type:"locale"}],this._available_buttons={arrow:{title:"buttons/cursorarrow",icon:"cursorArrow",func:this.toggleCursorMode.bind(this),required:!0,statebind:"ui.cursorMode",statebindfunc:this.setCursorMode.bind(this)},plus:{title:"buttons/cursorplus",icon:"cursorPlus",func:this.toggleCursorMode.bind(this),required:!0,statebind:"ui.cursorMode",statebindfunc:this.setCursorMode.bind(this)},minus:{title:"buttons/cursorminus",icon:"cursorMinus",func:this.toggleCursorMode.bind(this),required:!0,statebind:"ui.cursorMode",statebindfunc:this.setCursorMode.bind(this)},hand:{title:"buttons/cursorhand",icon:"cursorHand",func:this.toggleCursorMode.bind(this),required:!0,statebind:"ui.cursorMode",statebindfunc:this.setCursorMode.bind(this)},hundredpercent:{title:"buttons/hundredpercent",icon:"hundredPercent",func:this.toggleHundredPercent.bind(this),required:!0}},this.model_binds={},Object.keys(this._available_buttons).forEach(function(t){var e=n._available_buttons[t];e&&e.statebind&&(n.model_binds["change:"+e.statebind]=function(n){e.statebindfunc(t,n.source.value)})}),this._super(t,e)},readyOnce:function(){this.element=d3.select(this.placeholder),this.element.selectAll("div").remove(),this._addButtons(Object.keys(this._available_buttons),[]),this.setCursorMode("arrow")},_addButtons:function(t,e){var n=this;this._components_config=[];var i=[];if(t.length){for(var r=0;r<t.length;r++){var s=t[r],o=this._available_buttons[s],l=o?s:"_default",u=a.clone(this._available_buttons[l]);u.id=s,u.icon=c[u.icon],i.push(u)}var h=this.getTranslationFunction(!0);this.element.selectAll("button").data(i).enter().append("button").attr("class",function(t){var n="vzb-buttonlist-btn";return e.length>0&&e.indexOf(t.id)>-1&&(n+=" vzb-dialog-side-btn"),n}).attr("data-btn",function(t){return t.id}).html(function(t){return"<span class='vzb-buttonlist-btn-icon fa'>"+t.icon+"</span><span class='vzb-buttonlist-btn-title'>"+h(t.title)+"</span>"});this.element.selectAll(".vzb-buttonlist-btn").on("click",function(){d3.event.preventDefault(),d3.event.stopPropagation();var t=d3.select(this).attr("data-btn");n.proceedClick(t)})}},proceedClick:function(t){var e=this,n=e.element.selectAll(".vzb-buttonlist-btn[data-btn='"+t+"']"),i=n.attr("class"),r=e._available_buttons[t];if(r&&r.func)r.func(t);else{var a=-1===i.indexOf("vzb-active");n.classed("vzb-active",a);var s={};s.id=t,s.active=a,e.trigger("click",s)}},setButtonActive:function(t,e){this.element.selectAll(".vzb-buttonlist-btn[data-btn='"+t+"']").classed("vzb-active",e)},toggleCursorMode:function(t){var e=t;this.model.ui.set("cursorMode",e,!1,!1)},setCursorMode:function(t){var e=this.model.ui.cursorMode?this.model.ui.cursorMode:"arrow";this.element.selectAll(".vzb-buttonlist-btn").classed("vzb-active",function(t){return t.id==e})},toggleHundredPercent:function(t){this.root.trigger("resetZoom")}});e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(186);var i=n(388),r=function(t){return t&&t.__esModule?t:{default:t}}(i);n(433),e.default=r.default,t.exports=r.default},function(t,e,n){"use strict";(function(t){function e(t,e,n){t[e]||Object[i](t,e,{writable:!0,configurable:!0,value:n})}if(n(187),n(384),n(385),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var i="defineProperty";e(String.prototype,"padLeft","".padStart),e(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&e(Array,t,Function.call.bind([][t]))})}).call(e,n(77))},function(t,e,n){n(188),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(199),n(200),n(201),n(202),n(203),n(204),n(206),n(207),n(208),n(209),n(210),n(211),n(212),n(213),n(214),n(215),n(216),n(217),n(218),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228),n(229),n(230),n(231),n(232),n(233),n(234),n(235),n(236),n(237),n(238),n(239),n(240),n(241),n(242),n(243),n(244),n(245),n(246),n(247),n(248),n(249),n(250),n(251),n(252),n(253),n(254),n(255),n(256),n(257),n(258),n(259),n(260),n(261),n(262),n(263),n(264),n(265),n(266),n(268),n(269),n(271),n(272),n(273),n(274),n(275),n(276),n(277),n(279),n(280),n(281),n(282),n(283),n(284),n(285),n(286),n(287),n(288),n(289),n(290),n(291),n(99),n(292),n(293),n(127),n(294),n(295),n(296),n(297),n(298),n(130),n(132),n(133),n(299),n(300),n(301),n(302),n(303),n(304),n(305),n(306),n(307),n(308),n(309),n(310),n(311),n(312),n(313),n(314),n(315),n(316),n(317),n(318),n(319),n(320),n(321),n(322),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(340),n(341),n(342),n(343),n(344),n(345),n(346),n(347),n(348),n(349),n(350),n(351),n(352),n(353),n(354),n(355),n(356),n(357),n(358),n(359),n(360),n(361),n(362),n(363),n(364),n(365),n(366),n(367),n(368),n(369),n(370),n(371),n(372),n(373),n(374),n(375),n(376),n(377),n(378),n(379),n(380),n(381),n(382),n(383),t.exports=n(25)},function(t,e,n){"use strict";var i=n(3),r=n(14),a=n(8),s=n(0),o=n(16),l=n(34).KEY,c=n(4),u=n(61),h=n(51),d=n(39),f=n(7),p=n(110),v=n(79),g=n(189),m=n(64),b=n(2),_=n(18),y=n(26),M=n(38),w=n(43),x=n(113),S=n(19),z=n(9),O=n(41),E=S.f,k=z.f,T=x.f,P=i.Symbol,D=i.JSON,L=D&&D.stringify,C=f("_hidden"),A=f("toPrimitive"),I={}.propertyIsEnumerable,R=u("symbol-registry"),j=u("symbols"),N=u("op-symbols"),q=Object.prototype,F="function"==typeof P,H=i.QObject,B=!H||!H.prototype||!H.prototype.findChild,V=a&&c(function(){return 7!=w(k({},"a",{get:function(){return k(this,"a",{value:7}).a}})).a})?function(t,e,n){var i=E(q,e);i&&delete q[e],k(t,e,n),i&&t!==q&&k(q,e,i)}:k,W=function(t){var e=j[t]=w(P.prototype);return e._k=t,e},Y=F&&"symbol"==typeof P.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof P},U=function(t,e,n){return t===q&&U(N,e,n),b(t),e=y(e,!0),b(n),r(j,e)?(n.enumerable?(r(t,C)&&t[C][e]&&(t[C][e]=!1),n=w(n,{enumerable:M(0,!1)})):(r(t,C)||k(t,C,M(1,{})),t[C][e]=!0),V(t,e,n)):k(t,e,n)},G=function(t,e){b(t);for(var n,i=g(e=_(e)),r=0,a=i.length;a>r;)U(t,n=i[r++],e[n]);return t},X=function(t,e){return void 0===e?w(t):G(w(t),e)},K=function(t){var e=I.call(this,t=y(t,!0));return!(this===q&&r(j,t)&&!r(N,t))&&(!(e||!r(this,t)||!r(j,t)||r(this,C)&&this[C][t])||e)},Q=function(t,e){if(t=_(t),e=y(e,!0),t!==q||!r(j,e)||r(N,e)){var n=E(t,e);return!n||!r(j,e)||r(t,C)&&t[C][e]||(n.enumerable=!0),n}},$=function(t){for(var e,n=T(_(t)),i=[],a=0;n.length>a;)r(j,e=n[a++])||e==C||e==l||i.push(e);return i},J=function(t){for(var e,n=t===q,i=T(n?N:_(t)),a=[],s=0;i.length>s;)!r(j,e=i[s++])||n&&!r(q,e)||a.push(j[e]);return a};F||(P=function(){if(this instanceof P)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(n){this===q&&e.call(N,n),r(this,C)&&r(this[C],t)&&(this[C][t]=!1),V(this,t,M(1,n))};return a&&B&&V(q,t,{configurable:!0,set:e}),W(t)},o(P.prototype,"toString",function(){return this._k}),S.f=Q,z.f=U,n(44).f=x.f=$,n(57).f=K,n(63).f=J,a&&!n(40)&&o(q,"propertyIsEnumerable",K,!0),p.f=function(t){return W(f(t))}),s(s.G+s.W+s.F*!F,{Symbol:P});for(var Z="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),tt=0;Z.length>tt;)f(Z[tt++]);for(var et=O(f.store),nt=0;et.length>nt;)v(et[nt++]);s(s.S+s.F*!F,"Symbol",{for:function(t){return r(R,t+="")?R[t]:R[t]=P(t)},keyFor:function(t){if(!Y(t))throw TypeError(t+" is not a symbol!");for(var e in R)if(R[e]===t)return e},useSetter:function(){B=!0},useSimple:function(){B=!1}}),s(s.S+s.F*!F,"Object",{create:X,defineProperty:U,defineProperties:G,getOwnPropertyDescriptor:Q,getOwnPropertyNames:$,getOwnPropertySymbols:J}),D&&s(s.S+s.F*(!F||c(function(){var t=P();return"[null]"!=L([t])||"{}"!=L({a:t})||"{}"!=L(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!Y(t)){for(var e,n,i=[t],r=1;arguments.length>r;)i.push(arguments[r++]);return e=i[1],"function"==typeof e&&(n=e),!n&&m(e)||(e=function(t,e){if(n&&(e=n.call(this,t,e)),!Y(e))return e}),i[1]=e,L.apply(D,i)}}}),P.prototype[A]||n(15)(P.prototype,A,P.prototype.valueOf),h(P,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},function(t,e,n){var i=n(41),r=n(63),a=n(57);t.exports=function(t){var e=i(t),n=r.f;if(n)for(var s,o=n(t),l=a.f,c=0;o.length>c;)l.call(t,s=o[c++])&&e.push(s);return e}},function(t,e,n){var i=n(0);i(i.S,"Object",{create:n(43)})},function(t,e,n){var i=n(0);i(i.S+i.F*!n(8),"Object",{defineProperty:n(9).f})},function(t,e,n){var i=n(0);i(i.S+i.F*!n(8),"Object",{defineProperties:n(112)})},function(t,e,n){var i=n(18),r=n(19).f;n(29)("getOwnPropertyDescriptor",function(){return function(t,e){return r(i(t),e)}})},function(t,e,n){var i=n(12),r=n(20);n(29)("getPrototypeOf",function(){return function(t){return r(i(t))}})},function(t,e,n){var i=n(12),r=n(41);n(29)("keys",function(){return function(t){return r(i(t))}})},function(t,e,n){n(29)("getOwnPropertyNames",function(){return n(113).f})},function(t,e,n){var i=n(6),r=n(34).onFreeze;n(29)("freeze",function(t){return function(e){return t&&i(e)?t(r(e)):e}})},function(t,e,n){var i=n(6),r=n(34).onFreeze;n(29)("seal",function(t){return function(e){return t&&i(e)?t(r(e)):e}})},function(t,e,n){var i=n(6),r=n(34).onFreeze;n(29)("preventExtensions",function(t){return function(e){return t&&i(e)?t(r(e)):e}})},function(t,e,n){var i=n(6);n(29)("isFrozen",function(t){return function(e){return!i(e)||!!t&&t(e)}})},function(t,e,n){var i=n(6);n(29)("isSealed",function(t){return function(e){return!i(e)||!!t&&t(e)}})},function(t,e,n){var i=n(6);n(29)("isExtensible",function(t){return function(e){return!!i(e)&&(!t||t(e))}})},function(t,e,n){var i=n(0);i(i.S+i.F,"Object",{assign:n(114)})},function(t,e,n){var i=n(0);i(i.S,"Object",{is:n(205)})},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){var i=n(0);i(i.S,"Object",{setPrototypeOf:n(83).set})},function(t,e,n){"use strict";var i=n(58),r={};r[n(7)("toStringTag")]="z",r+""!="[object z]"&&n(16)(Object.prototype,"toString",function(){return"[object "+i(this)+"]"},!0)},function(t,e,n){var i=n(0);i(i.P,"Function",{bind:n(115)})},function(t,e,n){var i=n(9).f,r=Function.prototype,a=/^\s*function ([^ (]*)/;"name"in r||n(8)&&i(r,"name",{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(t){return""}}})},function(t,e,n){"use strict";var i=n(6),r=n(20),a=n(7)("hasInstance"),s=Function.prototype;a in s||n(9).f(s,a,{value:function(t){if("function"!=typeof this||!i(t))return!1;if(!i(this.prototype))return t instanceof this;for(;t=r(t);)if(this.prototype===t)return!0;return!1}})},function(t,e,n){var i=n(0),r=n(117);i(i.G+i.F*(parseInt!=r),{parseInt:r})},function(t,e,n){var i=n(0),r=n(118);i(i.G+i.F*(parseFloat!=r),{parseFloat:r})},function(t,e,n){"use strict";var i=n(3),r=n(14),a=n(23),s=n(85),o=n(26),l=n(4),c=n(44).f,u=n(19).f,h=n(9).f,d=n(52).trim,f=i.Number,p=f,v=f.prototype,g="Number"==a(n(43)(v)),m="trim"in String.prototype,b=function(t){var e=o(t,!1);if("string"==typeof e&&e.length>2){e=m?e.trim():d(e,3);var n,i,r,a=e.charCodeAt(0);if(43===a||45===a){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===a){switch(e.charCodeAt(1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+e}for(var s,l=e.slice(2),c=0,u=l.length;c<u;c++)if((s=l.charCodeAt(c))<48||s>r)return NaN;return parseInt(l,i)}}return+e};if(!f(" 0o1")||!f("0b1")||f("+0x1")){f=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof f&&(g?l(function(){v.valueOf.call(n)}):"Number"!=a(n))?s(new p(b(e)),n,f):b(e)};for(var _,y=n(8)?c(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),M=0;y.length>M;M++)r(p,_=y[M])&&!r(f,_)&&h(f,_,u(p,_));f.prototype=v,v.constructor=f,n(16)(i,"Number",f)}},function(t,e,n){"use strict";var i=n(0),r=n(28),a=n(119),s=n(86),o=1..toFixed,l=Math.floor,c=[0,0,0,0,0,0],u="Number.toFixed: incorrect invocation!",h=function(t,e){for(var n=-1,i=e;++n<6;)i+=t*c[n],c[n]=i%1e7,i=l(i/1e7)},d=function(t){for(var e=6,n=0;--e>=0;)n+=c[e],c[e]=l(n/t),n=n%t*1e7},f=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==c[t]){var n=String(c[t]);e=""===e?n:e+s.call("0",7-n.length)+n}return e},p=function(t,e,n){return 0===e?n:e%2==1?p(t,e-1,n*t):p(t*t,e/2,n)},v=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e};i(i.P+i.F*(!!o&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(4)(function(){o.call({})})),"Number",{toFixed:function(t){var e,n,i,o,l=a(this,u),c=r(t),g="",m="0";if(c<0||c>20)throw RangeError(u);if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(g="-",l=-l),l>1e-21)if(e=v(l*p(2,69,1))-69,n=e<0?l*p(2,-e,1):l/p(2,e,1),n*=4503599627370496,(e=52-e)>0){for(h(0,n),i=c;i>=7;)h(1e7,0),i-=7;for(h(p(10,i,1),0),i=e-1;i>=23;)d(1<<23),i-=23;d(1<<i),h(1,1),d(2),m=f()}else h(0,n),h(1<<-e,0),m=f()+s.call("0",c);return c>0?(o=m.length,m=g+(o<=c?"0."+s.call("0",c-o)+m:m.slice(0,o-c)+"."+m.slice(o-c))):m=g+m,m}})},function(t,e,n){"use strict";var i=n(0),r=n(4),a=n(119),s=1..toPrecision;i(i.P+i.F*(r(function(){return"1"!==s.call(1,void 0)})||!r(function(){s.call({})})),"Number",{toPrecision:function(t){var e=a(this,"Number#toPrecision: incorrect invocation!");return void 0===t?s.call(e):s.call(e,t)}})},function(t,e,n){var i=n(0);i(i.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){var i=n(0),r=n(3).isFinite;i(i.S,"Number",{isFinite:function(t){return"number"==typeof t&&r(t)}})},function(t,e,n){var i=n(0);i(i.S,"Number",{isInteger:n(120)})},function(t,e,n){var i=n(0);i(i.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,n){var i=n(0),r=n(120),a=Math.abs;i(i.S,"Number",{isSafeInteger:function(t){return r(t)&&a(t)<=9007199254740991}})},function(t,e,n){var i=n(0);i(i.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,n){var i=n(0);i(i.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,n){var i=n(0),r=n(118);i(i.S+i.F*(Number.parseFloat!=r),"Number",{parseFloat:r})},function(t,e,n){var i=n(0),r=n(117);i(i.S+i.F*(Number.parseInt!=r),"Number",{parseInt:r})},function(t,e,n){var i=n(0),r=n(121),a=Math.sqrt,s=Math.acosh;i(i.S+i.F*!(s&&710==Math.floor(s(Number.MAX_VALUE))&&s(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:r(t-1+a(t-1)*a(t+1))}})},function(t,e,n){function i(t){return isFinite(t=+t)&&0!=t?t<0?-i(-t):Math.log(t+Math.sqrt(t*t+1)):t}var r=n(0),a=Math.asinh;r(r.S+r.F*!(a&&1/a(0)>0),"Math",{asinh:i})},function(t,e,n){var i=n(0),r=Math.atanh;i(i.S+i.F*!(r&&1/r(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,e,n){var i=n(0),r=n(87);i(i.S,"Math",{cbrt:function(t){return r(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,e,n){var i=n(0);i(i.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,e,n){var i=n(0),r=Math.exp;i(i.S,"Math",{cosh:function(t){return(r(t=+t)+r(-t))/2}})},function(t,e,n){var i=n(0),r=n(88);i(i.S+i.F*(r!=Math.expm1),"Math",{expm1:r})},function(t,e,n){var i=n(0);i(i.S,"Math",{fround:n(122)})},function(t,e,n){var i=n(0),r=Math.abs;i(i.S,"Math",{hypot:function(t,e){for(var n,i,a=0,s=0,o=arguments.length,l=0;s<o;)n=r(arguments[s++]),l<n?(i=l/n,a=a*i*i+1,l=n):n>0?(i=n/l,a+=i*i):a+=n;return l===1/0?1/0:l*Math.sqrt(a)}})},function(t,e,n){var i=n(0),r=Math.imul;i(i.S+i.F*n(4)(function(){return-5!=r(4294967295,5)||2!=r.length}),"Math",{imul:function(t,e){var n=+t,i=+e,r=65535&n,a=65535&i;return 0|r*a+((65535&n>>>16)*a+r*(65535&i>>>16)<<16>>>0)}})},function(t,e,n){var i=n(0);i(i.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},function(t,e,n){var i=n(0);i(i.S,"Math",{log1p:n(121)})},function(t,e,n){var i=n(0);i(i.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,n){var i=n(0);i(i.S,"Math",{sign:n(87)})},function(t,e,n){var i=n(0),r=n(88),a=Math.exp;i(i.S+i.F*n(4)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(r(t)-r(-t))/2:(a(t-1)-a(-t-1))*(Math.E/2)}})},function(t,e,n){var i=n(0),r=n(88),a=Math.exp;i(i.S,"Math",{tanh:function(t){var e=r(t=+t),n=r(-t);return e==1/0?1:n==1/0?-1:(e-n)/(a(t)+a(-t))}})},function(t,e,n){var i=n(0);i(i.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,e,n){var i=n(0),r=n(42),a=String.fromCharCode,s=String.fromCodePoint;i(i.S+i.F*(!!s&&1!=s.length),"String",{fromCodePoint:function(t){for(var e,n=[],i=arguments.length,s=0;i>s;){if(e=+arguments[s++],r(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(e<65536?a(e):a(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}})},function(t,e,n){var i=n(0),r=n(18),a=n(10);i(i.S,"String",{raw:function(t){for(var e=r(t.raw),n=a(e.length),i=arguments.length,s=[],o=0;n>o;)s.push(String(e[o++])),o<i&&s.push(String(arguments[o]));return s.join("")}})},function(t,e,n){"use strict";n(52)("trim",function(t){return function(){return t(this,3)}})},function(t,e,n){"use strict";var i=n(89)(!0);n(90)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){"use strict";var i=n(0),r=n(89)(!1);i(i.P,"String",{codePointAt:function(t){return r(this,t)}})},function(t,e,n){"use strict";var i=n(0),r=n(10),a=n(92),s="".endsWith;i(i.P+i.F*n(93)("endsWith"),"String",{endsWith:function(t){var e=a(this,t,"endsWith"),n=arguments.length>1?arguments[1]:void 0,i=r(e.length),o=void 0===n?i:Math.min(r(n),i),l=String(t);return s?s.call(e,l,o):e.slice(o-l.length,o)===l}})},function(t,e,n){"use strict";var i=n(0),r=n(92);i(i.P+i.F*n(93)("includes"),"String",{includes:function(t){return!!~r(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var i=n(0);i(i.P,"String",{repeat:n(86)})},function(t,e,n){"use strict";var i=n(0),r=n(10),a=n(92),s="".startsWith;i(i.P+i.F*n(93)("startsWith"),"String",{startsWith:function(t){var e=a(this,t,"startsWith"),n=r(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),i=String(t);return s?s.call(e,i,n):e.slice(n,n+i.length)===i}})},function(t,e,n){"use strict";n(17)("anchor",function(t){return function(e){return t(this,"a","name",e)}})},function(t,e,n){"use strict";n(17)("big",function(t){return function(){return t(this,"big","","")}})},function(t,e,n){"use strict";n(17)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,e,n){"use strict";n(17)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,e,n){"use strict";n(17)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,e,n){"use strict";n(17)("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},function(t,e,n){"use strict";n(17)("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},function(t,e,n){"use strict";n(17)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,e,n){"use strict";n(17)("link",function(t){return function(e){return t(this,"a","href",e)}})},function(t,e,n){"use strict";n(17)("small",function(t){return function(){return t(this,"small","","")}})},function(t,e,n){"use strict";n(17)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,e,n){"use strict";n(17)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,e,n){"use strict";n(17)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,e,n){var i=n(0);i(i.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,e,n){"use strict";var i=n(0),r=n(12),a=n(26);i(i.P+i.F*n(4)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var e=r(this),n=a(e);return"number"!=typeof n||isFinite(n)?e.toISOString():null}})},function(t,e,n){var i=n(0),r=n(267);i(i.P+i.F*(Date.prototype.toISOString!==r),"Date",{toISOString:r})},function(t,e,n){"use strict";var i=n(4),r=Date.prototype.getTime,a=Date.prototype.toISOString,s=function(t){return t>9?t:"0"+t};t.exports=i(function(){return"0385-07-25T07:06:39.999Z"!=a.call(new Date(-5e13-1))})||!i(function(){a.call(new Date(NaN))})?function(){if(!isFinite(r.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),n=t.getUTCMilliseconds(),i=e<0?"-":e>9999?"+":"";return i+("00000"+Math.abs(e)).slice(i?-6:-4)+"-"+s(t.getUTCMonth()+1)+"-"+s(t.getUTCDate())+"T"+s(t.getUTCHours())+":"+s(t.getUTCMinutes())+":"+s(t.getUTCSeconds())+"."+(n>99?n:"0"+s(n))+"Z"}:a},function(t,e,n){var i=Date.prototype,r=i.toString,a=i.getTime;new Date(NaN)+""!="Invalid Date"&&n(16)(i,"toString",function(){var t=a.call(this);return t===t?r.call(this):"Invalid Date"})},function(t,e,n){var i=n(7)("toPrimitive"),r=Date.prototype;i in r||n(15)(r,i,n(270))},function(t,e,n){"use strict";var i=n(2),r=n(26);t.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return r(i(this),"number"!=t)}},function(t,e,n){var i=n(0);i(i.S,"Array",{isArray:n(64)})},function(t,e,n){"use strict";var i=n(22),r=n(0),a=n(12),s=n(123),o=n(94),l=n(10),c=n(95),u=n(96);r(r.S+r.F*!n(66)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,r,h,d=a(t),f="function"==typeof this?this:Array,p=arguments.length,v=p>1?arguments[1]:void 0,g=void 0!==v,m=0,b=u(d);if(g&&(v=i(v,p>2?arguments[2]:void 0,2)),void 0==b||f==Array&&o(b))for(e=l(d.length),n=new f(e);e>m;m++)c(n,m,g?v(d[m],m):d[m]);else for(h=b.call(d),n=new f;!(r=h.next()).done;m++)c(n,m,g?s(h,v,[r.value,m],!0):r.value);return n.length=m,n}})},function(t,e,n){"use strict";var i=n(0),r=n(95);i(i.S+i.F*n(4)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,n=new("function"==typeof this?this:Array)(e);e>t;)r(n,t,arguments[t++]);return n.length=e,n}})},function(t,e,n){"use strict";var i=n(0),r=n(18),a=[].join;i(i.P+i.F*(n(56)!=Object||!n(24)(a)),"Array",{join:function(t){return a.call(r(this),void 0===t?",":t)}})},function(t,e,n){"use strict";var i=n(0),r=n(82),a=n(23),s=n(42),o=n(10),l=[].slice;i(i.P+i.F*n(4)(function(){r&&l.call(r)}),"Array",{slice:function(t,e){var n=o(this.length),i=a(this);if(e=void 0===e?n:e,"Array"==i)return l.call(this,t,e);for(var r=s(t,n),c=s(e,n),u=o(c-r),h=Array(u),d=0;d<u;d++)h[d]="String"==i?this.charAt(r+d):this[r+d];return h}})},function(t,e,n){"use strict";var i=n(0),r=n(13),a=n(12),s=n(4),o=[].sort,l=[1,2,3];i(i.P+i.F*(s(function(){l.sort(void 0)})||!s(function(){l.sort(null)})||!n(24)(o)),"Array",{sort:function(t){return void 0===t?o.call(a(this)):o.call(a(this),r(t))}})},function(t,e,n){"use strict";var i=n(0),r=n(30)(0),a=n(24)([].forEach,!0);i(i.P+i.F*!a,"Array",{forEach:function(t){return r(this,t,arguments[1])}})},function(t,e,n){var i=n(6),r=n(64),a=n(7)("species");t.exports=function(t){var e;return r(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!r(e.prototype)||(e=void 0),i(e)&&null===(e=e[a])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){"use strict";var i=n(0),r=n(30)(1);i(i.P+i.F*!n(24)([].map,!0),"Array",{map:function(t){return r(this,t,arguments[1])}})},function(t,e,n){"use strict";var i=n(0),r=n(30)(2);i(i.P+i.F*!n(24)([].filter,!0),"Array",{filter:function(t){return r(this,t,arguments[1])}})},function(t,e,n){"use strict";var i=n(0),r=n(30)(3);i(i.P+i.F*!n(24)([].some,!0),"Array",{some:function(t){return r(this,t,arguments[1])}})},function(t,e,n){"use strict";var i=n(0),r=n(30)(4);i(i.P+i.F*!n(24)([].every,!0),"Array",{every:function(t){return r(this,t,arguments[1])}})},function(t,e,n){"use strict";var i=n(0),r=n(124);i(i.P+i.F*!n(24)([].reduce,!0),"Array",{reduce:function(t){return r(this,t,arguments.length,arguments[1],!1)}})},function(t,e,n){"use strict";var i=n(0),r=n(124);i(i.P+i.F*!n(24)([].reduceRight,!0),"Array",{reduceRight:function(t){return r(this,t,arguments.length,arguments[1],!0)}})},function(t,e,n){"use strict";var i=n(0),r=n(62)(!1),a=[].indexOf,s=!!a&&1/[1].indexOf(1,-0)<0;i(i.P+i.F*(s||!n(24)(a)),"Array",{indexOf:function(t){return s?a.apply(this,arguments)||0:r(this,t,arguments[1])}})},function(t,e,n){"use strict";var i=n(0),r=n(18),a=n(28),s=n(10),o=[].lastIndexOf,l=!!o&&1/[1].lastIndexOf(1,-0)<0;i(i.P+i.F*(l||!n(24)(o)),"Array",{lastIndexOf:function(t){if(l)return o.apply(this,arguments)||0;var e=r(this),n=s(e.length),i=n-1;for(arguments.length>1&&(i=Math.min(i,a(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in e&&e[i]===t)return i||0;return-1}})},function(t,e,n){var i=n(0);i(i.P,"Array",{copyWithin:n(125)}),n(35)("copyWithin")},function(t,e,n){var i=n(0);i(i.P,"Array",{fill:n(98)}),n(35)("fill")},function(t,e,n){"use strict";var i=n(0),r=n(30)(5),a=!0;"find"in[]&&Array(1).find(function(){a=!1}),i(i.P+i.F*a,"Array",{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(35)("find")},function(t,e,n){"use strict";var i=n(0),r=n(30)(6),a="findIndex",s=!0;a in[]&&Array(1)[a](function(){s=!1}),i(i.P+i.F*s,"Array",{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(35)(a)},function(t,e,n){n(45)("Array")},function(t,e,n){var i=n(3),r=n(85),a=n(9).f,s=n(44).f,o=n(65),l=n(67),c=i.RegExp,u=c,h=c.prototype,d=/a/g,f=/a/g,p=new c(d)!==d;if(n(8)&&(!p||n(4)(function(){return f[n(7)("match")]=!1,c(d)!=d||c(f)==f||"/a/i"!=c(d,"i")}))){c=function(t,e){var n=this instanceof c,i=o(t),a=void 0===e;return!n&&i&&t.constructor===c&&a?t:r(p?new u(i&&!a?t.source:t,e):u((i=t instanceof c)?t.source:t,i&&a?l.call(t):e),n?this:h,c)};for(var v=s(u),g=0;v.length>g;)!function(t){t in c||a(c,t,{configurable:!0,get:function(){return u[t]},set:function(e){u[t]=e}})}(v[g++]);h.constructor=c,c.prototype=h,n(16)(i,"RegExp",c)}n(45)("RegExp")},function(t,e,n){"use strict";n(127);var i=n(2),r=n(67),a=n(8),s=/./.toString,o=function(t){n(16)(RegExp.prototype,"toString",t,!0)};n(4)(function(){return"/a/b"!=s.call({source:"a",flags:"b"})})?o(function(){var t=i(this);return"/".concat(t.source,"/","flags"in t?t.flags:!a&&t instanceof RegExp?r.call(t):void 0)}):"toString"!=s.name&&o(function(){return s.call(this)})},function(t,e,n){n(68)("match",1,function(t,e,n){return[function(n){"use strict";var i=t(this),r=void 0==n?void 0:n[e];return void 0!==r?r.call(n,i):new RegExp(n)[e](String(i))},n]})},function(t,e,n){n(68)("replace",2,function(t,e,n){return[function(i,r){"use strict";var a=t(this),s=void 0==i?void 0:i[e];return void 0!==s?s.call(i,a,r):n.call(String(a),i,r)},n]})},function(t,e,n){n(68)("search",1,function(t,e,n){return[function(n){"use strict";var i=t(this),r=void 0==n?void 0:n[e];return void 0!==r?r.call(n,i):new RegExp(n)[e](String(i))},n]})},function(t,e,n){n(68)("split",2,function(t,e,i){"use strict";var r=n(65),a=i,s=[].push,o="length";if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[o]||2!="ab".split(/(?:ab)*/)[o]||4!=".".split(/(.?)(.?)/)[o]||".".split(/()()/)[o]>1||"".split(/.?/)[o]){var l=void 0===/()??/.exec("")[1];i=function(t,e){var n=String(this);if(void 0===t&&0===e)return[];if(!r(t))return a.call(n,t,e);var i,c,u,h,d,f=[],p=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),v=0,g=void 0===e?4294967295:e>>>0,m=new RegExp(t.source,p+"g");for(l||(i=new RegExp("^"+m.source+"$(?!\\s)",p));(c=m.exec(n))&&!((u=c.index+c[0][o])>v&&(f.push(n.slice(v,c.index)),!l&&c[o]>1&&c[0].replace(i,function(){for(d=1;d<arguments[o]-2;d++)void 0===arguments[d]&&(c[d]=void 0)}),c[o]>1&&c.index<n[o]&&s.apply(f,c.slice(1)),h=c[0][o],v=u,f[o]>=g));)m.lastIndex===c.index&&m.lastIndex++;return v===n[o]?!h&&m.test("")||f.push(""):f.push(n.slice(v)),f[o]>g?f.slice(0,g):f}}else"0".split(void 0,0)[o]&&(i=function(t,e){return void 0===t&&0===e?[]:a.call(this,t,e)});return[function(n,r){var a=t(this),s=void 0==n?void 0:n[e];return void 0!==s?s.call(n,a,r):i.call(String(a),n,r)},i]})},function(t,e,n){"use strict";var i,r,a,s,o=n(40),l=n(3),c=n(22),u=n(58),h=n(0),d=n(6),f=n(13),p=n(46),v=n(47),g=n(69),m=n(100).set,b=n(101)(),_=n(102),y=n(128),M=n(129),w=l.TypeError,x=l.process,S=l.Promise,z="process"==u(x),O=function(){},E=r=_.f,k=!!function(){try{var t=S.resolve(1),e=(t.constructor={})[n(7)("species")]=function(t){t(O,O)};return(z||"function"==typeof PromiseRejectionEvent)&&t.then(O)instanceof e}catch(t){}}(),T=function(t){var e;return!(!d(t)||"function"!=typeof(e=t.then))&&e},P=function(t,e){if(!t._n){t._n=!0;var n=t._c;b(function(){for(var i=t._v,r=1==t._s,a=0;n.length>a;)!function(e){var n,a,s=r?e.ok:e.fail,o=e.resolve,l=e.reject,c=e.domain;try{s?(r||(2==t._h&&C(t),t._h=1),!0===s?n=i:(c&&c.enter(),n=s(i),c&&c.exit()),n===e.promise?l(w("Promise-chain cycle")):(a=T(n))?a.call(n,o,l):o(n)):l(i)}catch(t){l(t)}}(n[a++]);t._c=[],t._n=!1,e&&!t._h&&D(t)})}},D=function(t){m.call(l,function(){var e,n,i,r=t._v,a=L(t);if(a&&(e=y(function(){z?x.emit("unhandledRejection",r,t):(n=l.onunhandledrejection)?n({promise:t,reason:r}):(i=l.console)&&i.error&&i.error("Unhandled promise rejection",r)}),t._h=z||L(t)?2:1),t._a=void 0,a&&e.e)throw e.v})},L=function(t){if(1==t._h)return!1;for(var e,n=t._a||t._c,i=0;n.length>i;)if(e=n[i++],e.fail||!L(e.promise))return!1;return!0},C=function(t){m.call(l,function(){var e;z?x.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})})},A=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),P(e,!0))},I=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw w("Promise can't be resolved itself");(e=T(t))?b(function(){var i={_w:n,_d:!1};try{e.call(t,c(I,i,1),c(A,i,1))}catch(t){A.call(i,t)}}):(n._v=t,n._s=1,P(n,!1))}catch(t){A.call({_w:n,_d:!1},t)}}};k||(S=function(t){p(this,S,"Promise","_h"),f(t),i.call(this);try{t(c(I,this,1),c(A,this,1))}catch(t){A.call(this,t)}},i=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},i.prototype=n(48)(S.prototype,{then:function(t,e){var n=E(g(this,S));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=z?x.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&P(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),a=function(){var t=new i;this.promise=t,this.resolve=c(I,t,1),this.reject=c(A,t,1)},_.f=E=function(t){return t===S||t===s?new a(t):r(t)}),h(h.G+h.W+h.F*!k,{Promise:S}),n(51)(S,"Promise"),n(45)("Promise"),s=n(25).Promise,h(h.S+h.F*!k,"Promise",{reject:function(t){var e=E(this);return(0,e.reject)(t),e.promise}}),h(h.S+h.F*(o||!k),"Promise",{resolve:function(t){return M(o&&this===s?S:this,t)}}),h(h.S+h.F*!(k&&n(66)(function(t){S.all(t).catch(O)})),"Promise",{all:function(t){var e=this,n=E(e),i=n.resolve,r=n.reject,a=y(function(){var n=[],a=0,s=1;v(t,!1,function(t){var o=a++,l=!1;n.push(void 0),s++,e.resolve(t).then(function(t){l||(l=!0,n[o]=t,--s||i(n))},r)}),--s||i(n)});return a.e&&r(a.v),n.promise},race:function(t){var e=this,n=E(e),i=n.reject,r=y(function(){v(t,!1,function(t){e.resolve(t).then(n.resolve,i)})});return r.e&&i(r.v),n.promise}})},function(t,e,n){"use strict";var i=n(134),r=n(54);n(70)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return i.def(r(this,"WeakSet"),t,!0)}},i,!1,!0)},function(t,e,n){"use strict";var i=n(0),r=n(71),a=n(103),s=n(2),o=n(42),l=n(10),c=n(6),u=n(3).ArrayBuffer,h=n(69),d=a.ArrayBuffer,f=a.DataView,p=r.ABV&&u.isView,v=d.prototype.slice,g=r.VIEW;i(i.G+i.W+i.F*(u!==d),{ArrayBuffer:d}),i(i.S+i.F*!r.CONSTR,"ArrayBuffer",{isView:function(t){return p&&p(t)||c(t)&&g in t}}),i(i.P+i.U+i.F*n(4)(function(){return!new d(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(t,e){if(void 0!==v&&void 0===e)return v.call(s(this),t);for(var n=s(this).byteLength,i=o(t,n),r=o(void 0===e?n:e,n),a=new(h(this,d))(l(r-i)),c=new f(this),u=new f(a),p=0;i<r;)u.setUint8(p++,c.getUint8(i++));return a}}),n(45)("ArrayBuffer")},function(t,e,n){var i=n(0);i(i.G+i.W+i.F*!n(71).ABV,{DataView:n(103).DataView})},function(t,e,n){n(32)("Int8",1,function(t){return function(e,n,i){return t(this,e,n,i)}})},function(t,e,n){n(32)("Uint8",1,function(t){return function(e,n,i){return t(this,e,n,i)}})},function(t,e,n){n(32)("Uint8",1,function(t){return function(e,n,i){return t(this,e,n,i)}},!0)},function(t,e,n){n(32)("Int16",2,function(t){return function(e,n,i){return t(this,e,n,i)}})},function(t,e,n){n(32)("Uint16",2,function(t){return function(e,n,i){return t(this,e,n,i)}})},function(t,e,n){n(32)("Int32",4,function(t){return function(e,n,i){return t(this,e,n,i)}})},function(t,e,n){n(32)("Uint32",4,function(t){return function(e,n,i){return t(this,e,n,i)}})},function(t,e,n){n(32)("Float32",4,function(t){return function(e,n,i){return t(this,e,n,i)}})},function(t,e,n){n(32)("Float64",8,function(t){return function(e,n,i){return t(this,e,n,i)}})},function(t,e,n){var i=n(0),r=n(13),a=n(2),s=(n(3).Reflect||{}).apply,o=Function.apply;i(i.S+i.F*!n(4)(function(){s(function(){})}),"Reflect",{apply:function(t,e,n){var i=r(t),l=a(n);return s?s(i,e,l):o.call(i,e,l)}})},function(t,e,n){var i=n(0),r=n(43),a=n(13),s=n(2),o=n(6),l=n(4),c=n(115),u=(n(3).Reflect||{}).construct,h=l(function(){function t(){}return!(u(function(){},[],t)instanceof t)}),d=!l(function(){u(function(){})});i(i.S+i.F*(h||d),"Reflect",{construct:function(t,e){a(t),s(e);var n=arguments.length<3?t:a(arguments[2]);if(d&&!h)return u(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var i=[null];return i.push.apply(i,e),new(c.apply(t,i))}var l=n.prototype,f=r(o(l)?l:Object.prototype),p=Function.apply.call(t,f,e);return o(p)?p:f}})},function(t,e,n){var i=n(9),r=n(0),a=n(2),s=n(26);r(r.S+r.F*n(4)(function(){Reflect.defineProperty(i.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,e,n){a(t),e=s(e,!0),a(n);try{return i.f(t,e,n),!0}catch(t){return!1}}})},function(t,e,n){var i=n(0),r=n(19).f,a=n(2);i(i.S,"Reflect",{deleteProperty:function(t,e){var n=r(a(t),e);return!(n&&!n.configurable)&&delete t[e]}})},function(t,e,n){"use strict";var i=n(0),r=n(2),a=function(t){this._t=r(t),this._i=0;var e,n=this._k=[];for(e in t)n.push(e)};n(91)(a,"Object",function(){var t,e=this,n=e._k;do{if(e._i>=n.length)return{value:void 0,done:!0}}while(!((t=n[e._i++])in e._t));return{value:t,done:!1}}),i(i.S,"Reflect",{enumerate:function(t){return new a(t)}})},function(t,e,n){function i(t,e){var n,o,u=arguments.length<3?t:arguments[2];return c(t)===u?t[e]:(n=r.f(t,e))?s(n,"value")?n.value:void 0!==n.get?n.get.call(u):void 0:l(o=a(t))?i(o,e,u):void 0}var r=n(19),a=n(20),s=n(14),o=n(0),l=n(6),c=n(2);o(o.S,"Reflect",{get:i})},function(t,e,n){var i=n(19),r=n(0),a=n(2);r(r.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return i.f(a(t),e)}})},function(t,e,n){var i=n(0),r=n(20),a=n(2);i(i.S,"Reflect",{getPrototypeOf:function(t){return r(a(t))}})},function(t,e,n){var i=n(0);i(i.S,"Reflect",{has:function(t,e){return e in t}})},function(t,e,n){var i=n(0),r=n(2),a=Object.isExtensible;i(i.S,"Reflect",{isExtensible:function(t){return r(t),!a||a(t)}})},function(t,e,n){var i=n(0);i(i.S,"Reflect",{ownKeys:n(136)})},function(t,e,n){var i=n(0),r=n(2),a=Object.preventExtensions;i(i.S,"Reflect",{preventExtensions:function(t){r(t);try{return a&&a(t),!0}catch(t){return!1}}})},function(t,e,n){function i(t,e,n){var l,d,f=arguments.length<4?t:arguments[3],p=a.f(u(t),e);if(!p){if(h(d=s(t)))return i(d,e,n,f);p=c(0)}return o(p,"value")?!(!1===p.writable||!h(f))&&(l=a.f(f,e)||c(0),l.value=n,r.f(f,e,l),!0):void 0!==p.set&&(p.set.call(f,n),!0)}var r=n(9),a=n(19),s=n(20),o=n(14),l=n(0),c=n(38),u=n(2),h=n(6);l(l.S,"Reflect",{set:i})},function(t,e,n){var i=n(0),r=n(83);r&&i(i.S,"Reflect",{setPrototypeOf:function(t,e){r.check(t,e);try{return r.set(t,e),!0}catch(t){return!1}}})},function(t,e,n){"use strict";var i=n(0),r=n(62)(!0);i(i.P,"Array",{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(35)("includes")},function(t,e,n){"use strict";var i=n(0),r=n(137),a=n(12),s=n(10),o=n(13),l=n(97);i(i.P,"Array",{flatMap:function(t){var e,n,i=a(this);return o(t),e=s(i.length),n=l(i,0),r(n,i,i,e,0,1,t,arguments[1]),n}}),n(35)("flatMap")},function(t,e,n){"use strict";var i=n(0),r=n(137),a=n(12),s=n(10),o=n(28),l=n(97);i(i.P,"Array",{flatten:function(){var t=arguments[0],e=a(this),n=s(e.length),i=l(e,0);return r(i,e,e,n,0,void 0===t?1:o(t)),i}}),n(35)("flatten")},function(t,e,n){"use strict";var i=n(0),r=n(89)(!0);i(i.P,"String",{at:function(t){return r(this,t)}})},function(t,e,n){"use strict";var i=n(0),r=n(138);i(i.P,"String",{padStart:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,n){"use strict";var i=n(0),r=n(138);i(i.P,"String",{padEnd:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,e,n){"use strict";n(52)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,e,n){"use strict";n(52)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,e,n){"use strict";var i=n(0),r=n(27),a=n(10),s=n(65),o=n(67),l=RegExp.prototype,c=function(t,e){this._r=t,this._s=e};n(91)(c,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),i(i.P,"String",{matchAll:function(t){if(r(this),!s(t))throw TypeError(t+" is not a regexp!");var e=String(this),n="flags"in l?String(t.flags):o.call(t),i=new RegExp(t.source,~n.indexOf("g")?n:"g"+n);return i.lastIndex=a(t.lastIndex),new c(i,e)}})},function(t,e,n){n(79)("asyncIterator")},function(t,e,n){n(79)("observable")},function(t,e,n){var i=n(0),r=n(136),a=n(18),s=n(19),o=n(95);i(i.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,i=a(t),l=s.f,c=r(i),u={},h=0;c.length>h;)void 0!==(n=l(i,e=c[h++]))&&o(u,e,n);return u}})},function(t,e,n){var i=n(0),r=n(139)(!1);i(i.S,"Object",{values:function(t){return r(t)}})},function(t,e,n){var i=n(0),r=n(139)(!0);i(i.S,"Object",{entries:function(t){return r(t)}})},function(t,e,n){"use strict";var i=n(0),r=n(12),a=n(13),s=n(9);n(8)&&i(i.P+n(72),"Object",{__defineGetter__:function(t,e){s.f(r(this),t,{get:a(e),enumerable:!0,configurable:!0})}})},function(t,e,n){"use strict";var i=n(0),r=n(12),a=n(13),s=n(9);n(8)&&i(i.P+n(72),"Object",{__defineSetter__:function(t,e){s.f(r(this),t,{set:a(e),enumerable:!0,configurable:!0})}})},function(t,e,n){"use strict";var i=n(0),r=n(12),a=n(26),s=n(20),o=n(19).f;n(8)&&i(i.P+n(72),"Object",{__lookupGetter__:function(t){var e,n=r(this),i=a(t,!0);do{if(e=o(n,i))return e.get}while(n=s(n))}})},function(t,e,n){"use strict";var i=n(0),r=n(12),a=n(26),s=n(20),o=n(19).f;n(8)&&i(i.P+n(72),"Object",{__lookupSetter__:function(t){var e,n=r(this),i=a(t,!0);do{if(e=o(n,i))return e.set}while(n=s(n))}})},function(t,e,n){var i=n(0);i(i.P+i.R,"Map",{toJSON:n(140)("Map")})},function(t,e,n){var i=n(0);i(i.P+i.R,"Set",{toJSON:n(140)("Set")})},function(t,e,n){n(73)("Map")},function(t,e,n){n(73)("Set")},function(t,e,n){n(73)("WeakMap")},function(t,e,n){n(73)("WeakSet")},function(t,e,n){n(74)("Map")},function(t,e,n){n(74)("Set")},function(t,e,n){n(74)("WeakMap")},function(t,e,n){n(74)("WeakSet")},function(t,e,n){var i=n(0);i(i.G,{global:n(3)})},function(t,e,n){var i=n(0);i(i.S,"System",{global:n(3)})},function(t,e,n){var i=n(0),r=n(23);i(i.S,"Error",{isError:function(t){return"Error"===r(t)}})},function(t,e,n){var i=n(0);i(i.S,"Math",{clamp:function(t,e,n){return Math.min(n,Math.max(e,t))}})},function(t,e,n){var i=n(0);i(i.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(t,e,n){var i=n(0),r=180/Math.PI;i(i.S,"Math",{degrees:function(t){return t*r}})},function(t,e,n){var i=n(0),r=n(142),a=n(122);i(i.S,"Math",{fscale:function(t,e,n,i,s){return a(r(t,e,n,i,s))}})},function(t,e,n){var i=n(0);i(i.S,"Math",{iaddh:function(t,e,n,i){var r=t>>>0,a=e>>>0,s=n>>>0;return a+(i>>>0)+((r&s|(r|s)&~(r+s>>>0))>>>31)|0}})},function(t,e,n){var i=n(0);i(i.S,"Math",{isubh:function(t,e,n,i){var r=t>>>0,a=e>>>0,s=n>>>0;return a-(i>>>0)-((~r&s|~(r^s)&r-s>>>0)>>>31)|0}})},function(t,e,n){var i=n(0);i(i.S,"Math",{imulh:function(t,e){var n=+t,i=+e,r=65535&n,a=65535&i,s=n>>16,o=i>>16,l=(s*a>>>0)+(r*a>>>16);return s*o+(l>>16)+((r*o>>>0)+(65535&l)>>16)}})},function(t,e,n){var i=n(0);i(i.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(t,e,n){var i=n(0),r=Math.PI/180;i(i.S,"Math",{radians:function(t){return t*r}})},function(t,e,n){var i=n(0);i(i.S,"Math",{scale:n(142)})},function(t,e,n){var i=n(0);i(i.S,"Math",{umulh:function(t,e){var n=+t,i=+e,r=65535&n,a=65535&i,s=n>>>16,o=i>>>16,l=(s*a>>>0)+(r*a>>>16);return s*o+(l>>>16)+((r*o>>>0)+(65535&l)>>>16)}})},function(t,e,n){var i=n(0);i(i.S,"Math",{signbit:function(t){return(t=+t)!=t?t:0==t?1/t==1/0:t>0}})},function(t,e,n){"use strict";var i=n(0),r=n(25),a=n(3),s=n(69),o=n(129);i(i.P+i.R,"Promise",{finally:function(t){var e=s(this,r.Promise||a.Promise),n="function"==typeof t;return this.then(n?function(n){return o(e,t()).then(function(){return n})}:t,n?function(n){return o(e,t()).then(function(){throw n})}:t)}})},function(t,e,n){"use strict";var i=n(0),r=n(102),a=n(128);i(i.S,"Promise",{try:function(t){var e=r.f(this),n=a(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},function(t,e,n){var i=n(33),r=n(2),a=i.key,s=i.set;i.exp({defineMetadata:function(t,e,n,i){s(t,e,r(n),a(i))}})},function(t,e,n){var i=n(33),r=n(2),a=i.key,s=i.map,o=i.store;i.exp({deleteMetadata:function(t,e){var n=arguments.length<3?void 0:a(arguments[2]),i=s(r(e),n,!1);if(void 0===i||!i.delete(t))return!1;if(i.size)return!0;var l=o.get(e);return l.delete(n),!!l.size||o.delete(e)}})},function(t,e,n){var i=n(33),r=n(2),a=n(20),s=i.has,o=i.get,l=i.key,c=function(t,e,n){if(s(t,e,n))return o(t,e,n);var i=a(e);return null!==i?c(t,i,n):void 0};i.exp({getMetadata:function(t,e){return c(t,r(e),arguments.length<3?void 0:l(arguments[2]))}})},function(t,e,n){var i=n(132),r=n(141),a=n(33),s=n(2),o=n(20),l=a.keys,c=a.key,u=function(t,e){var n=l(t,e),a=o(t);if(null===a)return n;var s=u(a,e);return s.length?n.length?r(new i(n.concat(s))):s:n};a.exp({getMetadataKeys:function(t){return u(s(t),arguments.length<2?void 0:c(arguments[1]))}})},function(t,e,n){var i=n(33),r=n(2),a=i.get,s=i.key;i.exp({getOwnMetadata:function(t,e){return a(t,r(e),arguments.length<3?void 0:s(arguments[2]))}})},function(t,e,n){var i=n(33),r=n(2),a=i.keys,s=i.key;i.exp({getOwnMetadataKeys:function(t){return a(r(t),arguments.length<2?void 0:s(arguments[1]))}})},function(t,e,n){var i=n(33),r=n(2),a=n(20),s=i.has,o=i.key,l=function(t,e,n){if(s(t,e,n))return!0;var i=a(e);return null!==i&&l(t,i,n)};i.exp({hasMetadata:function(t,e){return l(t,r(e),arguments.length<3?void 0:o(arguments[2]))}})},function(t,e,n){var i=n(33),r=n(2),a=i.has,s=i.key;i.exp({hasOwnMetadata:function(t,e){return a(t,r(e),arguments.length<3?void 0:s(arguments[2]))}})},function(t,e,n){var i=n(33),r=n(2),a=n(13),s=i.key,o=i.set;i.exp({metadata:function(t,e){return function(n,i){o(t,e,(void 0!==i?r:a)(n),s(i))}}})},function(t,e,n){var i=n(0),r=n(101)(),a=n(3).process,s="process"==n(23)(a);i(i.G,{asap:function(t){var e=s&&a.domain;r(e?e.bind(t):t)}})},function(t,e,n){"use strict";var i=n(0),r=n(3),a=n(25),s=n(101)(),o=n(7)("observable"),l=n(13),c=n(2),u=n(46),h=n(48),d=n(15),f=n(47),p=f.RETURN,v=function(t){return null==t?void 0:l(t)},g=function(t){var e=t._c;e&&(t._c=void 0,e())},m=function(t){return void 0===t._o},b=function(t){m(t)||(t._o=void 0,g(t))},_=function(t,e){c(t),this._c=void 0,this._o=t,t=new y(this);try{var n=e(t),i=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){i.unsubscribe()}:l(n),this._c=n)}catch(e){return void t.error(e)}m(this)&&g(this)};_.prototype=h({},{unsubscribe:function(){b(this)}});var y=function(t){this._s=t};y.prototype=h({},{next:function(t){var e=this._s;if(!m(e)){var n=e._o;try{var i=v(n.next);if(i)return i.call(n,t)}catch(t){try{b(e)}finally{throw t}}}},error:function(t){var e=this._s;if(m(e))throw t;var n=e._o;e._o=void 0;try{var i=v(n.error);if(!i)throw t;t=i.call(n,t)}catch(t){try{g(e)}finally{throw t}}return g(e),t},complete:function(t){var e=this._s;if(!m(e)){var n=e._o;e._o=void 0;try{var i=v(n.complete);t=i?i.call(n,t):void 0}catch(t){try{g(e)}finally{throw t}}return g(e),t}}});var M=function(t){u(this,M,"Observable","_f")._f=l(t)};h(M.prototype,{subscribe:function(t){return new _(t,this._f)},forEach:function(t){var e=this;return new(a.Promise||r.Promise)(function(n,i){l(t);var r=e.subscribe({next:function(e){try{return t(e)}catch(t){i(t),r.unsubscribe()}},error:i,complete:n})})}}),h(M,{from:function(t){var e="function"==typeof this?this:M,n=v(c(t)[o]);if(n){var i=c(n.call(t));return i.constructor===e?i:new e(function(t){return i.subscribe(t)})}return new e(function(e){var n=!1;return s(function(){if(!n){try{if(f(t,!1,function(t){if(e.next(t),n)return p})===p)return}catch(t){if(n)throw t;return void e.error(t)}e.complete()}}),function(){n=!0}})},of:function(){for(var t=0,e=arguments.length,n=Array(e);t<e;)n[t]=arguments[t++];return new("function"==typeof this?this:M)(function(t){var e=!1;return s(function(){if(!e){for(var i=0;i<n.length;++i)if(t.next(n[i]),e)return;t.complete()}}),function(){e=!0}})}}),d(M.prototype,o,function(){return this}),i(i.G,{Observable:M}),n(45)("Observable")},function(t,e,n){var i=n(3),r=n(0),a=i.navigator,s=[].slice,o=!!a&&/MSIE .\./.test(a.userAgent),l=function(t){return function(e,n){var i=arguments.length>2,r=!!i&&s.call(arguments,2);return t(i?function(){("function"==typeof e?e:Function(e)).apply(this,r)}:e,n)}};r(r.G+r.B+r.F*o,{setTimeout:l(i.setTimeout),setInterval:l(i.setInterval)})},function(t,e,n){var i=n(0),r=n(100);i(i.G+i.B,{setImmediate:r.set,clearImmediate:r.clear})},function(t,e,n){for(var i=n(99),r=n(41),a=n(16),s=n(3),o=n(15),l=n(53),c=n(7),u=c("iterator"),h=c("toStringTag"),d=l.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=r(f),v=0;v<p.length;v++){var g,m=p[v],b=f[m],_=s[m],y=_&&_.prototype;if(y&&(y[u]||o(y,u,d),y[h]||o(y,h,m),l[m]=d,b))for(g in i)y[g]||a(y,g,i[g],!0)}},function(t,e,n){(function(e){!function(e){"use strict";function n(t,e,n,i){var a=e&&e.prototype instanceof r?e:r,s=Object.create(a.prototype),o=new f(i||[]);return s._invoke=c(t,n,o),s}function i(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function r(){}function a(){}function s(){}function o(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function l(t){function n(e,r,a,s){var o=i(t[e],t,r);if("throw"!==o.type){var l=o.arg,c=l.value;return c&&"object"==typeof c&&b.call(c,"__await")?Promise.resolve(c.__await).then(function(t){n("next",t,a,s)},function(t){n("throw",t,a,s)}):Promise.resolve(c).then(function(t){l.value=t,a(l)},s)}s(o.arg)}function r(t,e){function i(){return new Promise(function(i,r){n(t,e,i,r)})}return a=a?a.then(i,i):i()}"object"==typeof e.process&&e.process.domain&&(n=e.process.domain.bind(n));var a;this._invoke=r}function c(t,e,n){var r=z;return function(a,s){if(r===E)throw new Error("Generator is already running");if(r===k){if("throw"===a)throw s;return v()}for(n.method=a,n.arg=s;;){var o=n.delegate;if(o){var l=u(o,n);if(l){if(l===T)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===z)throw r=k,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=E;var c=i(t,e,n);if("normal"===c.type){if(r=n.done?k:O,c.arg===T)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=k,n.method="throw",n.arg=c.arg)}}}function u(t,e){var n=t.iterator[e.method];if(n===g){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=g,u(t,e),"throw"===e.method))return T;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return T}var r=i(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,T;var a=r.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=g),e.delegate=null,T):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,T)}function h(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function d(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function f(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(h,this),this.reset(!0)}function p(t){if(t){var e=t[y];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(b.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=g,e.done=!0,e};return i.next=i}}return{next:v}}function v(){return{value:g,done:!0}}var g,m=Object.prototype,b=m.hasOwnProperty,_="function"==typeof Symbol?Symbol:{},y=_.iterator||"@@iterator",M=_.asyncIterator||"@@asyncIterator",w=_.toStringTag||"@@toStringTag",x="object"==typeof t,S=e.regeneratorRuntime;if(S)return void(x&&(t.exports=S));S=e.regeneratorRuntime=x?t.exports:{},S.wrap=n;var z="suspendedStart",O="suspendedYield",E="executing",k="completed",T={},P={};P[y]=function(){return this};var D=Object.getPrototypeOf,L=D&&D(D(p([])));L&&L!==m&&b.call(L,y)&&(P=L);var C=s.prototype=r.prototype=Object.create(P);a.prototype=C.constructor=s,s.constructor=a,s[w]=a.displayName="GeneratorFunction",S.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===a||"GeneratorFunction"===(e.displayName||e.name))},S.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,w in t||(t[w]="GeneratorFunction")),t.prototype=Object.create(C),t},S.awrap=function(t){return{__await:t}},o(l.prototype),l.prototype[M]=function(){return this},S.AsyncIterator=l,S.async=function(t,e,i,r){var a=new l(n(t,e,i,r));return S.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},o(C),C[w]="Generator",C[y]=function(){return this},C.toString=function(){return"[object Generator]"},S.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},S.values=p,f.prototype={constructor:f,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(d),!t)for(var e in this)"t"===e.charAt(0)&&b.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=g)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){function e(e,i){return a.type="throw",a.arg=t,n.next=e,i&&(n.method="next",n.arg=g),!!i}if(this.done)throw t;for(var n=this,i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],a=r.completion;if("root"===r.tryLoc)return e("end");if(r.tryLoc<=this.prev){var s=b.call(r,"catchLoc"),o=b.call(r,"finallyLoc");if(s&&o){if(this.prev<r.catchLoc)return e(r.catchLoc,!0);if(this.prev<r.finallyLoc)return e(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return e(r.catchLoc,!0)}else{if(!o)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return e(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&b.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=t,a.arg=e,r?(this.method="next",this.next=r.finallyLoc,T):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),T},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),d(n),T}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;d(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:p(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=g),T}}}("object"==typeof e?e:"object"==typeof window?window:"object"==typeof self?self:this)}).call(e,n(77))},function(t,e,n){n(386),t.exports=n(25).RegExp.escape},function(t,e,n){var i=n(0),r=n(387)(/[\\^$*+?.()|[\]{}]/g,"\\$&");i(i.S,"RegExp",{escape:function(t){return r(t)}})},function(t,e){t.exports=function(t,e){var n=e===Object(e)?function(t){return e[t]}:e;return function(e){return String(e).replace(t,n)}}},function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function a(t,e,n){return function(){var i=n.apply(e,arguments);return i===e?t:i}}Object.defineProperty(e,"__esModule",{value:!0});var s=n(104),o=r(s),l=n(1),c=i(l),u=n(143),h=r(u),d=n(31),f=r(d),p=n(5),v=r(p),g=n(49),m=r(g),b=n(75),_=r(b),y=n(50),M=r(y),w=n(107),x=r(w),S=n(21),z=i(S),O=n(155),E=r(O),k=n(156),T=function t(e,n,i){var r=h.default.get(e);if(r){var a=new r(n,i);return t._instances[a._id]=a,a}c.error('Tool "'+e+'" was not found.')};T._instances={},T._globals=x.default,T.clearInstances=function(t){if(t)T._instances[t]=void 0;else{for(var e in T._instances)T._instances[e].clear();T._instances={}}};var P=(0,o.default)(n(393));c.forEach(P,function(t,e){_.default.register(e,t)});var D=(0,o.default)(n(397),1);c.forEach(D,function(t,e){v.default.register(e,t)}),(0,o.default)(n(424)),T.helpers=(0,o.default)(n(425)),T.iconset=z,d3.rebind=function(t,e){for(var n=1,i=void 0,r=arguments.length;++n<r;)t[i=arguments[n]]=a(t,e,e[i]);return t},d3.time={},d3.time.scale=d3.scaleTime,d3.time.scale.utc=d3.scaleUtc,d3.time.format=function(t){var e=d3.timeFormat(t);return e.parse=d3.timeParse(t),e},d3.time.format.utc=function(t){var e=d3.utcFormat(t);return e.parse=d3.utcParse(t),e},d3.time.format.iso=function(t){var e=d3.isoFormat(t);return e.parse=d3.isoParse(t),e},d3.scaleGenericlog=E.default,d3.selection.prototype.onTap=k.onTap,d3.selection.prototype.onLongTap=k.onLongTap,T.Class=f.default,T.Tool=h.default,T.Component=v.default,T.Model=m.default,T.Reader=_.default,T.Events=M.default,T.utils=c,e.default=T},function(t,e){t.exports={linear:function(t,e,n,i,r){return+n+(r-t)/(e-t)*(i-n)},exp:function(t,e,n,i,r){return Math.exp((Math.log(n)*(e-r)-Math.log(i)*(t-r))/(e-t))},stepBefore:function(t,e,n,i,r){return i},stepAfter:function(t,e,n,i,r){return n},stepMiddle:function(t,e,n,i,r){return r<(t+e)/2?n:i}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(31),r=function(t){return t&&t.__esModule?t:{default:t}}(i),a=r.default.extend({init:function(){this.intervals={}},setInterval:function(t){function e(e,n,i){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t,e,n){this.clearInterval(t),this.intervals[t]=setInterval(e,n)}),clearInterval:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){t?this.intervals[t]&&(clearInterval(this.intervals[t]),delete this.intervals[t]):this.clearAllIntervals()}),clearAllIntervals:function(){for(var t in this.intervals)this.clearInterval(t)}});e.default=a},function(t,e,n){function i(t){return n(r(t))}function r(t){var e=a[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var a={"./axis":105,"./axis.js":105,"./color":144,"./color.js":144,"./data":106,"./data.js":106,"./dataconnected":55,"./dataconnected.js":55,"./entities":145,"./entities.js":145,"./group":146,"./group.js":146,"./hook":36,"./hook.js":36,"./label":147,"./label.js":147,"./locale":148,"./locale.js":148,"./marker":149,"./marker.js":149,"./side":150,"./side.js":150,"./size":151,"./size.js":151,"./stack":152,"./stack.js":152,"./time":153,"./time.js":153,"./ui":154,"./ui.js":154};i.keys=function(){return Object.keys(a)},i.resolve=r,t.exports=i,i.id=391},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e,n,i){return l.hashCode([t.select.key,t.where,t.join,t.dataset,t.version,t.language,e,n,i])}Object.defineProperty(e,"__esModule",{value:!0}),e.DataStorage=e.Storage=void 0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(1),l=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(o),c=n(31),u=(function(t){t&&t.__esModule}(c),e.Storage=function(){function t(){i(this,t),this.queryIds={},this.queries={},this._collection={},this._collectionPromises={}}return s(t,[{key:"loadFromReader",value:function(t,e,n){var i=r(t,n._basepath,n._lastModified,n._name);return this.queries[i]||(this.queries[i]=this.queryQueue(n,i)),this.queries[i].getPromise(t,e)}},{key:"getDataId",value:function(t,e,n){var i=r(t,e._basepath,e._lastModified,e._name);return!!this.queries[i]&&this.queries[i].getDataId(t,n)}},{key:"queryQueue",value:function(t,e){var n=this,i=function(t,e){return 0==Object.keys(e).filter(function(n){return e[n]!==t[n]}).length&&(0==Object.keys(t).length||0!=Object.keys(e).length)};return new function(){this.readerObject=t,this.queries=[],this.query=null,this.parsers=null,this.defer={},this.getPromise=function(t,e){var n=this,r=!0,s=!1,o=void 0;try{for(var c,u=this.queries[Symbol.iterator]();!(r=(c=u.next()).done);r=!0){var h=function(){var n=c.value;if(0==t.select.value.filter(function(t){return-1==n.query.select.value.indexOf(t)}).length&&i(n.parsers,e))return{v:n.defer.promise}}();if("object"===(void 0===h?"undefined":a(h)))return h.v}}catch(t){s=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(s)throw o}}return this.query?(this.query.select.value=l.unique(this.query.select.value.concat(t.select.value)),l.extend(this.parsers,e)):(this.query=t,this.parsers=e),l.debounce(function(){n.runQuery()},10)(),this.defer.promise&&this.defer.promise instanceof Promise||(this.defer.promise=new Promise(function(t,e){n.defer.resolve=t,n.defer.reject=e})),this.defer.promise},this.runQuery=function(){this.query&&(this.queries.push(this.reader(this.query,this.parsers,this.defer)),this.query=null,this.parsers=null,this.defer={})},this.getDataId=function(t,e){var n=!0,r=!1,s=void 0;try{for(var o,l=this.queries[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var c=function(){var n=o.value;if(0==t.select.value.filter(function(t){return-1==n.query.select.value.indexOf(t)}).length&&i(n.parsers,e)&&n.dataId)return{v:n.dataId}}();if("object"===(void 0===c?"undefined":a(c)))return c.v}}catch(t){r=!0,s=t}finally{try{!n&&l.return&&l.return()}finally{if(r)throw s}}return!1},this.reader=function(t,e,i){var r=this;return new function(){var a=this;this.defer=i,this.query=t,this.parsers=e,this.dataId=null,r.readerObject.read(this.query,this.parsers).then(function(e){a.checkQueryResponse(t,e),a.dataId=l.hashCode([t,r.readerObject._basepath]),n._collection[a.dataId]={},n._collectionPromises[a.dataId]={};var i=n._collection[a.dataId];i.data=e,i.valid={},i.nested={},i.unique={},i.limits={},i.frames={},i.haveNoDataPointsPerKey={},i.query=t,a.defer.resolve(a.dataId)}).catch(function(t){a.defer.reject(t)}),this.checkQueryResponse=function(t,e){if(0==e.length&&l.warn("Reader for data source '"+this._name+"' returned empty array for query:",JSON.stringify(t,null,2)),e.length>0){for(var n=(t.select.key||[]).concat(t.select.value||[]),i=e.length-1;i>=0;i--){for(var r=n.length-1;r>=0;r--)(e[i][n[r]]||0===e[i][n[r]])&&n.splice(r,1);if(!n.length)break}n.forEach(function(n){-1==t.select.key.indexOf(n)?l.warn('Reader result: Column "'+n+'" is missing from "'+t.from+'" data, but it might be ok'):(l.error('Reader result: Key column "'+n+'" is missing from "'+t.from+'" data for query:',JSON.stringify(t)),console.log(e))})}}}}}}},{key:"setGrouping",value:function(t,e){this._collection[t].grouping=e}},{key:"getData",value:function(t,e,n,i){if(!e||"data"==e)return this._collection[t].data;if("query"==e)return this._collection[t].query;if(!n)return this._collection[t][e];var r="string"==typeof n?n:JSON.stringify(n);if(this._collection[t][e][r])return this._collection[t][e][r];switch(e){case"unique":this._collection[t][e][r]=this._getUnique(t,n);break;case"valid":this._collection[t][e][r]=this._getValid(t,n);break;case"limits":this._collection[t][e][r]=this._getLimits(t,n);break;case"nested":this._collection[t][e][r]=this._getNested(t,n)}return this._collection[t][e][r]}},{key:"_getValid",value:function(t,e){return this._collection[t].data.filter(function(t){return t[e]||0===t[e]})}},{key:"_getLimits",value:function(t,e){for(var n=this._collection[t].data,i=n.reduce(function(t,n){var i=l.isDate(n[e])?n[e]:parseFloat(n[e]);return isNaN(i)||t.push(i),t},[]),r=void 0,a=void 0,s={},o=0;o<i.length;o+=1){var c=i[o];(void 0===r||c<r)&&(r=c),(void 0===a||c>a)&&(a=c)}return s.min=r||0,s.max=a||100,s}},{key:"_getUnique",value:function(t,e){var n=void 0,i=this._collection[t].data;if(l.isArray(e)){var r=i.map(function(t){return l.clone(t,e)});n=l.unique(r,function(t){return JSON.stringify(t)})}else{var a=i.map(function(t){return t[e]});n=l.unique(a)}return n}},{key:"_getNested",value:function(t,e){for(var n=d3.nest(),i=0;i<e.length;i++)n=n.key(function(t){return function(e){return e[t]}}(e[i]));return l.nestArrayToObj(n.entries(this._collection[t].data))}},{key:"getFrames",value:function(t,e,n,i){var r=this,a=this._getCacheKey(t,e,n);return this._collectionPromises[t][a]||(this._collectionPromises[t][a]={queue:this.framesQueue(e,a),promise:null}),this._collectionPromises[t][a]&&this._collectionPromises[t][a].promise instanceof Promise?this._collectionPromises[t][a].promise:(this._collectionPromises[t][a].promise=new Promise(function(s,o){t||o(l.warn("Data.js 'get' method doesn't like the dataId you gave it: "+t)),r._getFrames(t,a,e,n,i).then(function(e){r._collection[t].frames[a]=e,s(r._collection[t].frames[a])})}),this._collectionPromises[t][a].promise)}},{key:"getFrame",value:function(t,e,n,i){var r=this,a=this._getCacheKey(t,e,i);return new Promise(function(e,i){r._collection[t].frames[a]&&r._collection[t].frames[a][n]?e(r._collection[t].frames[a]):r._collectionPromises[t][a].queue.forceFrame(n,function(){e(r._collection[t].frames[a])})})}},{key:"listenFrame",value:function(t,e,n,i){var r=this._getCacheKey(t,e,n);this._collectionPromises[t][r].queue.defaultCallbacks.push(function(e){i(t,e)}),this._collection[t].frames[r]&&l.forEach(this._collection[t].frames[r],function(e,n){i(t,new Date(n))})}},{key:"_muteAllQueues",value:function(t){l.forEach(this._collectionPromises,function(e,n){l.forEach(e,function(e,n){1==e.queue.isActive&&e.queue.whatId!=t&&e.queue.mute()})})}},{key:"_checkForcedQueuesExists",value:function(){l.forEach(this._collectionPromises,function(t,e){l.forEach(t,function(t,e){t.queue.forcedQueue.length>0&&t.queue.unMute()})})}},{key:"_unmuteQueue",value:function(){l.forEach(this._collectionPromises,function(t,e){l.forEach(t,function(t,e){0==t.queue.isActive&&t.queue.unMute()})})}},{key:"framesQueue",value:function(t,e){var n=this;return new function(){this.defaultCallbacks=[],this.callbacks={},this.forcedQueue=[],this.isActive=!0,this.delayedAction=null,this.whatId=e,this.queue=t.slice(0);var i=this;this.queue.splice(0,0,this.queue.splice(this.queue.length-1,1)[0]),this.key=0,this.mute=function(){this.isActive=!1,this.delayedAction=Promise.resolve.bind(Promise)},this.unMute=function(){this.isActive=!0,"function"==typeof this.delayedAction&&this.delayedAction(),this.delayedAction=null,0==this.forcedQueue.length&&0==this.queue.length&&n._unmuteQueue()},this.frameComplete=function(t){var e=void 0;if(i.defaultCallbacks.length>0)for(e=0;e<i.defaultCallbacks.length;e++)i.defaultCallbacks[e](t);if(i.callbacks[t]&&i.callbacks[t].length>0)for(e=0;e<i.callbacks[t].length;e++)i.callbacks[t][e]()},this._waitingForActivation=function(){var t=this;return new Promise(function(e,n){if(t.isActive)return e();t.delayedAction=e})},this._getNextFrameName=function(){var t=null;return this.forcedQueue.length>0||this.queue.length>0?this.forcedQueue.length>0?t=this.forcedQueue.shift():(0==this.forcedQueue.length&&this.key>=this.queue.length-1&&(this.key=0),t=this.queue.splice(this.key,1).pop()):n._unmuteQueue(),t},this.checkForcedFrames=function(){this.forcedQueue.length>0||n._checkForcedQueuesExists()},this.getNext=function(){var t=this;return new Promise(function(e,n){t.checkForcedFrames(),t.isActive?e(t._getNextFrameName()):t._waitingForActivation().then(function(){e(t._getNextFrameName())})})},this.forceFrame=function(t,e){if(this.callbacks[t])this.callbacks[t].push(e);else{var i=function(t,e){for(var n=e.toString(),i=-1,r=0,a=t.length;r<a;r++)if(t[r].toString()==n){i=r;break}return i}(this.queue,t);-1!==i?(this.forcedQueue.unshift(this.queue.splice(i,1).pop()),n._muteAllQueues(this.whatId),this.unMute(),"function"==typeof e&&("object"!==a(this.callbacks[t])&&(this.callbacks[t]=[]),this.callbacks[t].push(e)),this.key=i):"object"===a(this.callbacks[t])?this.callbacks[t].push(e):this.callbacks[t]=[e]}}}}},{key:"_getFrames",value:function(t,e,n,i,r){var a=this;return a._collection[t].frames[e]||(a._collection[t].frames[e]={}),new Promise(function(s,o){function c(t,e){for(var n=y[h[e]],i=0,r=n.length;i<r;i++)if(t[n[i]]={},e==E)for(O=0;O<z;O++)t[n[i]][S[O]]=null;else{var a=e+1;c(t[n[i]],a)}}r||l.warn("_getFrames in data.js is missing indicatorsDB, it's needed for gap filling"),n||l.warn("_getFrames in data.js is missing framesArray, it's needed so much");var u=a._collection[t].query.animatable,h=a._collection[t].query.select.key.slice(0);u&&-1!=h.indexOf(u)&&h.splice(h.indexOf(u),1);var d={},f=void 0,p=void 0,v=void 0,g=void 0,m=void 0,b=void 0,_=void 0,y={};if(h.length>1)for(f=1;f<h.length;f++){var M=a.getData(t,"nested",[h[f]].concat([u]));y[h[f]]=Object.keys(M)}var w=a.getData(t,"nested",h.concat([u]));i=i||Object.keys(w),y[h[0]]=i;var x=a._collection[t].query,S=x.select.value.filter(function(t){return"_default"!==t}),z=S.length,O=void 0,E=h.length-1;for(c(d,0),O=0;O<z;O++)a._collection[t].haveNoDataPointsPerKey[S[O]]={};var k=a._collection[t].grouping||{},T=k.key,P=k.grouping,D=function t(n,i,o,c,h){var f={};if("datapoints"!==x.from){var y=a._collection[c].data;for(O=0;O<z;O++)f[S[O]]={};for(var M=0;M<y.length;M++){var k=y[M];for(O=0;O<z;O++)f[S[O]][k[o[0]]]=k[S[O]],null==k[S[O]]&&(a._collection[c].haveNoDataPointsPerKey[S[O]][k[o[0]]]=y.length)}}else{var D=function(t,e,i){if(m=r[t]?r[t].interpolation:null,b=r[t]?r[t].use:"indicator",e&&e[n]&&(e[n][0][t]||0===e[n][0][t]))return e[n][0][t];if("none"===m)return null;if(null===(p=i[t])){var s=Object.keys(e);p=new Array(s.length),v=0;for(var o=0,h=s.length;o<h;o++)g=e[s[o]],(g[0][t]||0===g[0][t])&&(p[v++]=g[0]);p.length=v,i[t]=0===v?[]:p,0==p.length&&(a._collection[c].haveNoDataPointsPerKey[t][void 0]=p.length)}return p&&p.length>0?(_=null,l.interpolatePoint(p,b,t,_,u,n,m)):void 0},L={};for(O=0;O<z;O++)L[O]=f[S[O]]={};T?function t(e,n,r,a){for(var s,l,c={},u=i[o[a]],h=o[a]===T,d=0,f=u.length;d<f;d++)if(s=u[d],l=h?~~(+s/P)*P:s,a==E){var p=void 0;for(O=0;O<z;O++)p=D(S[O],n[s],r[s]),null!==p?e[O][l]=(e[O][l]||0)+p:void 0===e[O][l]&&(e[O][l]=p)}else{for(O=0;O<z;O++)c[O]=e[O][l]=e[O][l]||{};t(c,n[s],r[s],a+1)}}(L,w,d,0):function t(e,n,r,a){for(var s,l={},c=i[o[a]],u=0,h=c.length;u<h;u++)if(s=c[u],n[s])if(a==E)for(O=0;O<z;O++)e[O][s]=D(S[O],n[s],r[s]);else{for(O=0;O<z;O++)l[O]=e[O][s]={};t(l,n[s],r[s],a+1)}}(L,w,d,0)}a._collection[c].frames[e][n]=f,"function"==typeof h&&h(n),a._collectionPromises[c][e].queue.getNext().then(function(n){n?l.defer(function(){t(n,i,o,c,a._collectionPromises[c][e].queue.frameComplete)}):s(a._collection[c].frames[e])})};a._collectionPromises[t][e].queue.getNext().then(function(n){n&&D(n,y,h,t,a._collectionPromises[t][e].queue.frameComplete)})})}},{key:"_getCacheKey",value:function(t,e,n){var i=e[0]+" - "+e[e.length-1],r=this._collection[t].grouping;return r&&(i=i+"_grouping("+r.key+":"+r.grouping+")"),n&&(i=i+"_"+n.join()),i}}]),t}());e.DataStorage=new u},function(t,e,n){function i(t){return n(r(t))}function r(t){var e=a[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var a={"./csv-time_in_columns/csv-time_in_columns.js":394,"./csv/csv.js":157,"./inline/inline.js":396};i.keys=function(){return Object.keys(a)},i.resolve=r,t.exports=i,i.id=393},function(t,e,n){"use strict";function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{!i&&o.return&&o.return()}finally{if(r)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=n(157),s=function(t){return t&&t.__esModule?t:{default:t}}(a),o=n(1),l=s.default.extend({MISSED_INDICATOR_NAME:"indicator",_name:"csv-time_in_columns",init:function(t){this._super(t),this.timeKey="time",Object.assign(this.ERRORS,{REPEATED_KEYS:"reader/error/repeatedKeys"})},load:function(t){var e=this;return this._super().then(function(n){var a=n.rows,s=n.columns,l=t[e.timeKey]&&!!t[e.timeKey](s[e.keySize]);l&&(0,o.warn)("Indicator column is missed.");var c=l?e.MISSED_INDICATOR_NAME:s[e.keySize],u=s.slice(0,e.keySize).concat(l?(0,o.capitalize)(e.MISSED_INDICATOR_NAME):a.reduce(function(t,e){var n=e[c];return!t.includes(n)&&n&&t.push(n),t},[]));u.splice(e.keySize,0,e.timeKey);var h=u.slice(e.keySize+1),d=r(u,1),f=d[0];return{columns:u,rows:a.reduce(function(t,n){var r=t.filter(function(t){return t[f]===n[f]});if(r.length){if(null!==r[0][n[c]])throw e.error(e.ERRORS.REPEATED_KEYS,void 0,{indicator:n[c],key:n[f]});r.forEach(function(t){t[n[c]]=n[t[e.timeKey]]})}else Object.keys(n).forEach(function(r){if(![f,c].includes(r)){var a,s=(a={},i(a,f,n[f]),i(a,e.timeKey,r),a),o=h.reduce(function(t,e){return t[e]=l||n[c]===e?n[r]:null,t},{});t.push(Object.assign(s,o))}});return t},[])}})},versionInfo:{version:"0.26.6",build:1509004488665}});e.default=l},function(t,e){(function(){var e,n,i;i=[],e={},t.exports=n=function(t,n,r){var a,s,o,l,c,u,h,d;if(null==r&&(r=!0),"string"==typeof n){if(2!==n.length)throw{name:"ArgumentException",message:"The format for string options is '<thousands><decimal>' (exactly two characters)"};d=n[0],a=n[1]}else if(Array.isArray(n)){if(2!==n.length)throw{name:"ArgumentException",message:"The format for array options is ['<thousands>','[<decimal>'] (exactly two elements)"};d=n[0],a=n[1]}else d=(null!=n?n.thousands:void 0)||(null!=n?n.group:void 0)||e.thousands,a=(null!=n?n.decimal:void 0)||e.decimal;return u=""+d+a+r,c=i[u],null==c&&(o=r?3:1,c=i[u]=new RegExp("^\\s*([+-]?(?:(?:\\d{1,3}(?:\\"+d+"\\d{"+o+",3})+)|\\d*))(?:\\"+a+"(\\d*))?\\s*$")),null==(h=t.match(c))||3!==h.length?NaN:(l=h[1].replace(new RegExp("\\"+d,"g"),""),s=h[2],parseFloat(l+"."+s))},t.exports.setOptions=function(t){var n,i;for(n in t)i=t[n],e[n]=i},t.exports.factoryReset=function(){e={thousands:",",decimal:"."}},t.exports.withOptions=function(t,e){return null==e&&(e=!0),function(i){return n(i,t,e)}},t.exports.factoryReset()}).call(this)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(75),r=function(t){return t&&t.__esModule?t:{default:t}}(i),a=r.default.extend({_name:"inline",init:function(t){this._data=t.data||[{}]},load:function(){return Promise.resolve({columns:Object.keys(this._data[0]),rows:this._data})},versionInfo:{version:"0.26.6",build:1509004488665}});e.default=a},function(t,e,n){function i(t){return n(r(t))}function r(t){var e=a[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var a={"./brushslider/brushslider.js":76,"./brushslider/bubblesize/bubblesize.js":158,"./brushslider/singlehandleslider/singlehandleslider.js":59,"./brushslider/sizeslider/sizeslider.js":159,"./buttonlist/buttonlist.js":160,"./buttonlist/optionsbuttonlist/optionsbuttonlist.js":161,"./colorlegend/colorlegend.js":162,"./datanotes/datanotes.js":399,"./datawarning/datawarning.js":400,"./dialogs/_dialog.js":11,"./dialogs/about/about.js":164,"./dialogs/axes/axes.js":165,"./dialogs/colors/colors.js":167,"./dialogs/dialogs.js":168,"./dialogs/find/find.js":169,"./dialogs/grouping/grouping.js":170,"./dialogs/label/label.js":171,"./dialogs/moreoptions/moreoptions.js":172,"./dialogs/opacity/opacity.js":173,"./dialogs/presentation/presentation.js":174,"./dialogs/show/show.js":175,"./dialogs/side/side.js":176,"./dialogs/size/size.js":177,"./dialogs/speed/speed.js":178,"./dialogs/stack/stack.js":179,"./dialogs/timedisplay/timedisplay.js":181,"./dialogs/zoom/zoom.js":183,"./draggablelist/draggablelist.js":180,"./indicatorpicker/indicatorpicker.js":37,"./minmaxinputs/minmaxinputs.js":166,"./simplecheckbox/simplecheckbox.js":60,"./steppedspeedslider/steppedspeedslider.js":419,"./timeslider/timeslider.js":421,"./treemenu/treemenu.js":423,"./zoombuttonlist/zoombuttonlist.js":184};i.keys=function(){return Object.keys(a)},i.resolve=r,t.exports=i,i.id=397},function(t,e){t.exports='<div class="vzb-slider-holder">\n\t<svg class="vzb-slider-svg">\n\t\t<g class="vzb-slider-wrap">\n\t\t\t<g class="vzb-slider">\n\t\t\t</g>\n\t\t</g>\n\t</svg>\n</div>\n'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}(i),n(5)),a=function(t){return t&&t.__esModule?t:{default:t}}(r),s=n(21),o=a.default.extend({init:function(t,e){var n=this;this.name="gapminder-datanotes",this.model_expects=[{name:"marker",type:"marker"},{name:"locale",type:"locale"}],this.context=e,this.model_binds={"translate:locale":function(t){n._ready&&n._readyOnce&&n.ready()}},this._super(t,e),this.close=this.close.bind(this),this.hidden=!0,this.showNotes=!1,this.pinned=!1,this.left=0,this.top=0,this.hookName=null,this.newHookName=null},ready:function(){this.setValues()},readyOnce:function(){var t=this;this.translator=this.model.locale.getTFunction(),this.element=d3.select(this.placeholder),this.element.selectAll("div").remove();var e=this.element;e.append("div").html(s.close).on("click",function(){d3.event.stopPropagation(),t.close()}).select("svg").attr("width","0px").attr("height","0px").attr("class","vzb-data-notes-close").classed("vzb-hidden",!0),e.append("div").attr("class","vzb-data-notes-body vzb-dialog-scrollable"),e.append("div").attr("class","vzb-data-notes-link")},resize:function(){this.close()},close:function(){this.hidden||this.pin(!1).hide()},setHook:function(t){return this._readyOnce?this.pinned?(this.newHookName=t,this):(this.hookName&&this.model.marker[this.hookName].off("change:which",this.close),this.hookName=this.newHookName=t,this.model.marker[this.hookName].on("change:which",this.close),this.setValues(),this):this},setValues:function(){if(this.hookName){var t=this.model.marker[this.hookName],e=t.getConceptprops();if(this.element.select(".vzb-data-notes-body").classed("vzb-hidden",!e.description).text(e.description||""),this.element.select(".vzb-data-notes-link").classed("vzb-hidden",!e.sourceLink),e.sourceLink){var n=this.translator("hints/source"),i=e.sourceName||"";this.element.select(".vzb-data-notes-link").html("<span>"+(i?n+":":"")+'<a href="'+e.sourceLink+'" target="_blank">'+(i||n)+"</a></span>")}this.showNotes=e.sourceLink||e.description}},setPos:function(t,e,n){if(this.left=t,this.top=e,this.pinned&&!n)return this;var i=this.parent.element.offsetHeight,r=this.element.node().offsetWidth,a=this.element.node().offsetHeight,s=void 0,o=void 0,l=this.left-r,c=this.top;return l<10&&(l=10,s=!0),c+a+10>i&&(c=i-a-10,o=!0),s&&o&&(c=this.top-a-30),this.element.style("top",c+"px"),this.element.style("left",l+"px"),this},pin:function(t){return this.hidden?this:(this.pinned=!this.pinned,null!=t&&(this.pinned=t),this.element.select(".vzb-data-notes-close").classed("vzb-hidden",!this.pinned),this.element.classed("vzb-data-notes-pinned",this.pinned),this.hookName!=this.newHookName&&this.setHook(this.newHookName),this.element.select(".vzb-data-notes-body").node().scrollTop=0,this.showNotes?this.setPos(this.left,this.top,!0):this.hide())},toggle:function(t){return this.pinned||!this.hookName?this:(null==t&&(t=!this.hidden),this.hidden=t,this.element.classed("vzb-hidden",this.hidden||!this.showNotes),this)},show:function(){return this.toggle(!1)},hide:function(){return this.toggle(!0)}});e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),r=(function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);e.default=t}(i),n(5)),a=function(t){return t&&t.__esModule?t:{default:t}}(r),s=n(21),o=!0,l=a.default.extend({init:function(t,e){var n=this;this.name="gapminder-datawarning",this.model_expects=[{name:"locale",type:"locale"}],this.context=e,this.model_binds={"translate:locale":function(t){n._ready&&n.redraw()}},this._super(t,e)},ready:function(){this.redraw()},readyOnce:function(){var t=this;this.element=d3.select(this.placeholder),this.element.selectAll("div").remove(),this.element.append("div").attr("class","vzb-data-warning-background").on("click",function(){t.toggle(!0)}),this.container=this.element.append("div").attr("class","vzb-data-warning-box"),this.container.append("div").html(s.close).on("click",function(){t.toggle()}).select("svg").attr("width","0px").attr("height","0px").attr("class","vzb-data-warning-close"),this.container.append("div").attr("class","vzb-data-warning-link").html(s.warn).append("div"),this.container.append("div").attr("class","vzb-data-warning-title"),this.container.append("div").attr("class","vzb-data-warning-body vzb-dialog-scrollable")},redraw:function(){this.translator=this.model.locale.getTFunction(),this.container.select(".vzb-data-warning-link div").text(this.translator("hints/dataWarning"));var t=this.translator("datawarning/title/"+this.parent.name);this.container.select(".vzb-data-warning-title").html(t).classed("vzb-hidden",!t||t=="datawarning/title/"+this.parent.name),this.container.select(".vzb-data-warning-body").html(this.translator("datawarning/body/"+this.parent.name))},toggle:function(t){null==t&&(t=!o),o=t,this.element.classed("vzb-hidden",o);var e=this;this.parent.components.forEach(function(t){t.element.classed("vzb-blur",t!=e&&!o)})}});e.default=l},function(t,e,n){function i(t){return n(r(t))}function r(t){var e=a[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var a={"./about/about.html":402,"./axes/axes.html":403,"./colors/colors.html":404,"./find/find.html":405,"./grouping/grouping.html":406,"./label/label.html":407,"./moreoptions/moreoptions.html":408,"./opacity/opacity.html":409,"./presentation/presentation.html":410,"./show/show.html":411,"./side/side.html":412,"./size/size.html":413,"./speed/speed.html":414,"./stack/stack.html":415,"./timedisplay/timedisplay.html":416,"./zoom/zoom.html":417};i.keys=function(){return Object.keys(a)},i.resolve=r,t.exports=i,i.id=401},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <div class="vzb-dialog-title"> \n      <%=t ("buttons/about") %>\n  </div>\n      \n  <div class="vzb-dialog-content">\n      <p class="vzb-about-text0"></p>\n      <p class="vzb-about-text1"></p>\n      <br/>\n      <p class="vzb-about-version"></p>\n      <p class="vzb-about-updated"></p>\n      <br/>\n      <p class="vzb-about-report"></p>\n      <br/>\n      <p class="vzb-about-credits"></p>\n      <br/>\n      <p class="vzb-about-tool"></p>\n      <br/>\n      <p class="vzb-about-datasets"><span>Datasets:</span></p>\n      <br/>\n      <p class="vzb-about-readers"><span>Readers:</span></p>\n  </div>\n      \n  <div class="vzb-dialog-buttons">\n    <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary">\n      <%=t ("buttons/ok") %>\n    </div>\n  </div>\n      \n\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n    <span class="thumb-tack-class thumb-tack-class-ico-pin fa" data-dialogtype="axes" data-click="pinDialog"></span>\n    <span class="thumb-tack-class thumb-tack-class-ico-drag fa" data-dialogtype="axes" data-click="dragDialog"></span>\n    <div class="vzb-dialog-title"><%=t ("buttons/axes") %></div>\n    <div class="vzb-dialog-content">\n      <p class="vzb-dialog-sublabel"> <%=t ("buttons/axis_x") %> <span class="vzb-xaxis-selector"></span> </p>\n      <div class="vzb-xaxis-minmax vzb-dialog-paragraph"></div>\n      <p class="vzb-dialog-sublabel"> <%=t ("buttons/axis_y") %> <span class="vzb-yaxis-selector"></span> </p>\n      <div class="vzb-yaxis-minmax vzb-dialog-paragraph"></div>\n    </div>\n    <div class="vzb-dialog-buttons">\n      <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary"><%=t ( "buttons/ok") %></div>\n    </div>\n</div>'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <span class="thumb-tack-class thumb-tack-class-ico-pin fa" data-dialogtype="colors" data-click="pinDialog"></span>\n  <span class="thumb-tack-class thumb-tack-class-ico-drag fa" data-dialogtype="colors" data-click="dragDialog"></span>\n  \n  <div class="vzb-dialog-title">\n      <%=t ("buttons/colors") %>\n      <span class="vzb-caxis-selector"></span>\n  </div>\n  \n  \n  \n  <div class="vzb-dialog-content vzb-dialog-scrollable">\n    <div class="vzb-clegend-container"></div>\n  </div>\n\n  <div class="vzb-dialog-buttons">\n    <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary">\n      <%=t ("buttons/ok") %>\n    </div>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <span class="thumb-tack-class thumb-tack-class-ico-pin fa" data-dialogtype="find" data-click="pinDialog"></span>\n  <span class="thumb-tack-class thumb-tack-class-ico-drag fa" data-dialogtype="find" data-click="dragDialog"></span>\n  <div class="vzb-dialog-title">\n    <%=t ("dialogs/find") %>\n    <span class="vzb-find-filter-selector"></span>\n    <span class="vzb-dialog-content vzb-find-filter">\n      <form>\n        <input class="vzb-find-search" type="search" required/>\n        <button class="vzb-cancel-button" type="reset"/>\n      </form>\n    </span>\n  </div>\n  \n  <div class="vzb-dialog-content vzb-dialog-content-fixed vzb-dialog-scrollable">\n    <div class="vzb-find-list">\n      \x3c!-- list will be placed here --\x3e\n    </div>\n  </div>\n\n  <div class="vzb-dialog-buttons">\n    <div class="vzb-dialog-bubbleopacity vzb-dialog-control"></div>\n    <div class="vzb-dialog-button vzb-find-deselect">\n      <%=t ("buttons/deselect") %>\n    </div>\n\n    <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary">\n      <%=t ("buttons/ok") %>\n    </div>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <div class="vzb-dialog-title"> \n      <%=t ("buttons/grouping") %>\n  </div>\n      \n  <div class="vzb-dialog-content">\n    <div class="vzb-dialog-groups"></div>\n    <div class="vzb-dialog-placeholder"></div>\n  </div>\n\n  <div class="vzb-dialog-buttons">\n    <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary">\n      <%=t ("buttons/ok") %>\n    </div>\n  </div>\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <span class="thumb-tack-class thumb-tack-class-ico-pin fa" data-dialogtype="label" data-click="pinDialog"></span>\n  <span class="thumb-tack-class thumb-tack-class-ico-drag fa" data-dialogtype="label" data-click="dragDialog"></span>\n  <div class="vzb-dialog-title"> \n      <%=t ("buttons/label") %>\n  </div>\n      \n      \n  <div class="vzb-dialog-content">\n    <span class="vzb-saxis-selector"></span>\n    <div class="vzb-dialog-sizeslider"></div>\n    <div class="vzb-removelabelbox-switch"></div>\n  </div>\n\n  <div class="vzb-dialog-buttons">\n    <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary">\n      <%=t ("buttons/ok") %>\n    </div>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <span class="thumb-tack-class thumb-tack-class-ico-pin fa" data-dialogtype="moreoptions" data-click="pinDialog"></span>\n  <span class="thumb-tack-class thumb-tack-class-ico-drag fa" data-dialogtype="moreoptions" data-click="dragDialog"></span>\n\n\n  <div class="vzb-dialog-title">\n    <%=t ("buttons/more_options") %>\n  </div>\n\n  <div class="vzb-dialog-content vzb-dialog-scrollable">\n    <div class=\'vzb-dialog-options-buttonlist\'>\n    </div>\n    <div class="vzb-accordion">\n    </div>\n  </div>\n\n  <div class="vzb-dialog-buttons">\n    <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary">\n      <%=t ("buttons/ok") %>\n    </div>\n  </div>\n\n</div>'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <div class="vzb-dialog-title"> \n      <%=t ("buttons/opacity") %>\n  </div>\n      \n  <div class="vzb-dialog-content">\n      <p class="vzb-dialog-sublabel">\n        <%=t ("buttons/opacityRegular") %>\n      </p>\n      <div class="vzb-dialog-bubbleopacity-regular"></div>\n\n      <p class="vzb-dialog-sublabel">\n        <%=t ("buttons/opacityNonselect") %>\n      </p>\n      <div class="vzb-dialog-bubbleopacity-selectdim"></div>\n    </div>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <div class="vzb-dialog-title"> \n      <%=t ("dialogs/presentation") %>\n  </div>\n      \n  <div class="vzb-dialog-content">\n      <div class="vzb-presentationmode-switch"></div>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <span class="thumb-tack-class thumb-tack-class-ico-pin fa" data-dialogtype="show" data-click="pinDialog"></span>\n  <span class="thumb-tack-class thumb-tack-class-ico-drag fa" data-dialogtype="show" data-click="dragDialog"></span>\n  <div class="vzb-dialog-title">\n    <%=t ("buttons/show") %>\n    <span class="vzb-show-filter-selector"></span>\n    <span class="vzb-dialog-content vzb-show-filter">\n      <form>\n        <input class="vzb-show-search" type="search" required/>\n        <button class="vzb-cancel-button" type="reset"/>\n      </form>\n    </span>\n  </div>\n  \n  <div class="vzb-dialog-content vzb-dialog-content-fixed vzb-dialog-scrollable">\n    <p class="vzb-dialog-sublabel"> <%=t ("hints/mount/onlyshowthefollowing") %> </p>\n    <div class="vzb-show-list">\n      \x3c!-- list will be placed here --\x3e\n    </div>\n  </div>\n\n  <div class="vzb-dialog-buttons">\n    <div class="vzb-dialog-button vzb-show-deselect">\n      <%=t ("buttons/reset") %>\n    </div>\n\n    <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary">\n      <%=t ("buttons/ok") %>\n    </div>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <span class="thumb-tack-class thumb-tack-class-ico-pin fa" data-dialogtype="side" data-click="pinDialog"></span>\n  <span class="thumb-tack-class thumb-tack-class-ico-drag fa" data-dialogtype="side" data-click="dragDialog"></span>\n  <div class="vzb-dialog-title">\n    <%=t ("buttons/side") %>\n    <span class="vzb-side-selector"></span>\n  </div>\n  \n  <div class="vzb-dialog-content vzb-dialog-scrollable">\n    <div class="vzb-side-list vzb-side-list-left">\n      \x3c!-- list will be placed here --\x3e\n    </div>\n    <div class="vzb-side-list vzb-side-list-right">\n      \x3c!-- list will be placed here --\x3e\n    </div>\n  </div>\n\n  <div class="vzb-dialog-buttons">\n    <div class="vzb-dialog-button vzb-label-primary vzb-side-switch-sides">\n      <%=t ("buttons/leftright") %>\n    </div>\n\n    <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary">\n      <%=t ("buttons/ok") %>\n    </div>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <span class="thumb-tack-class thumb-tack-class-ico-pin fa" data-dialogtype="size" data-click="pinDialog"></span>\n  <span class="thumb-tack-class thumb-tack-class-ico-drag fa" data-dialogtype="size" data-click="dragDialog"></span>\n  <div class="vzb-dialog-title"> \n      <%=t ("buttons/size") %>\n      <span class="vzb-saxis-selector"></span>\n  </div>\n      \n      \n  <div class="vzb-dialog-content">\n    <div class="vzb-dialog-bubblesize"></div>\n  </div>\n\n  <div class="vzb-dialog-buttons">\n    <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary">\n      <%=t ("buttons/ok") %>\n    </div>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <div class="vzb-dialog-title"> \n      <%=t ("buttons/speed") %>\n  </div>\n      \n  <div class="vzb-dialog-content">\n    <div class="vzb-dialog-placeholder"></div>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n    <span class="thumb-tack-class thumb-tack-class-ico-pin fa" data-dialogtype="stack" data-click="pinDialog"></span>\n    <span class="thumb-tack-class thumb-tack-class-ico-drag fa" data-dialogtype="stack" data-click="dragDialog"></span>\n    <div class="vzb-dialog-title"><%=t ("buttons/stack") %></div>\n        \n    <div class="vzb-dialog-content vzb-dialog-scrollable">\n        \n        \x3c!--p class="vzb-dialog-sublabel"> <%=t ( "hints/mount/howtostack") %></p--\x3e\n        <form class="vzb-howtostack vzb-dialog-paragraph">\n            <label> <input type="radio" name="stack" value="none"> <%=t ("mount/stacking/none") %> </label>\n            <label> <input type="radio" name="stack" value="bycolor"> <%=t ("mount/stacking/color") %> </label>\n            <label> <input type="radio" name="stack" value="all"> <%=t ("mount/stacking/world") %> </label>\n        </form>\n        \n        <form class="vzb-howtomerge vzb-dialog-paragraph">\n            <p class="vzb-dialog-sublabel"> <%=t ("hints/mount/howtomerge") %> </p>\n            <label> <input type="radio" name="merge" value="none"> <%=t ("mount/merging/none") %> </label>\n            <label> <input type="radio" name="merge" value="grouped"> <%=t ("mount/merging/color") %> </label>\n            <label> <input type="radio" name="merge" value="stacked"> <%=t ("mount/merging/world") %> </label>\n        </form>\n        \n        <form class="vzb-manual-sorting">\n            <p class="vzb-dialog-sublabel"> <%=t ("mount/manualSorting") %> </p>\n            <div class="vzb-dialog-draggablelist vzb-dialog-control"></div>\n        </form>\n                \n    </div>\n\n    <div class="vzb-dialog-buttons">\n        <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary"><%=t ("buttons/ok") %></div>\n    </div>\n\n</div>'},function(t,e){t.exports='<div class="vzb-dialog-modal">\n  <div class="vzb-dialog-content vzb-dialog-content-fixed">\n    <svg>\n      <g class="vzb-timedisplay"></g>\n    </svg>\n  </div>\n  <div class="vzb-dialog-buttons"></div>\n</div>\n'},function(t,e){t.exports='<div class=\'vzb-dialog-modal\'>\n  <span class="thumb-tack-class thumb-tack-class-ico-pin fa" data-dialogtype="label" data-click="pinDialog"></span>\n  <span class="thumb-tack-class thumb-tack-class-ico-drag fa" data-dialogtype="label" data-click="dragDialog"></span>\n  <div class="vzb-dialog-title"> \n    <%=t ("buttons/zoom") %>\n    <div class="vzb-dialog-zoom-buttonlist"></div>\n  </div>\n      \n      \n  <div class="vzb-dialog-content">\n    <div class="vzb-panwitharrow-switch"></div>\n    <div class="vzb-zoomonscrolling-switch"></div>\n    <div class="vzb-adaptminmaxzoom-switch"></div>\n  </div>\n\n  <div class="vzb-dialog-buttons">\n    <div data-click="closeDialog" class="vzb-dialog-button vzb-label-primary">\n      <%=t ("buttons/ok") %>\n    </div>\n  </div>\n\n</div>\n'},function(t,e){t.exports='<div class="vzb-mmi-holder">\n\n    <span class="vzb-mmi-domainmin-label"></span>\n    <input type="text" class="vzb-mmi-domainmin" name="min">\n    <span class="vzb-mmi-domainmax-label"></span>\n    <input type="text" class="vzb-mmi-domainmax" name="max">\n\n    <br class="vzb-mmi-break"/>\n\n    <span class="vzb-mmi-zoomedmin-label"></span>\n    <input type="text" class="vzb-mmi-zoomedmin" name="min">\n    <span class="vzb-mmi-zoomedmax-label"></span>\n    <input type="text" class="vzb-mmi-zoomedmax" name="max">\n    \n</div>'},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(5),r=function(t){return t&&t.__esModule?t:{default:t}}(i),a=n(1),s=r.default.extend({init:function(t,e){var i=this;this.name="steppedSpeedSlider",this.template=n(420),this.config=Object.assign({triangleWidth:10,triangleHeight:10,height:31,lineWidth:10,domain:[1,2,3,4,5,6],range:[1200,900,450,200,150,100]},t),this.config.height-=this.config.triangleHeight/2,this.model_expects=[{name:"time",type:"time"},{name:"locale",type:"locale"}],this.model_binds={"change:time.delay":function(){i.redraw()}},this.setDelay=(0,a.throttle)(this.setDelay,50),this._super(t,e)},readyOnce:function(){var t=this.config,e=t.domain,n=t.range,i=t.height;this.element=d3.select(this.element),this.svg=this.element.select("svg"),this.axisScale=d3.scaleLog().domain(d3.extent(e)).range([i,0]),this.delayScale=d3.scaleLinear().domain(e).range(n),this.initTriangle(),this.initAxis(),this.redraw()},initAxis:function(){var t=this,e=this.config,n=e.lineWidth,i=e.triangleWidth,r=e.triangleHeight,s=e.height,o=d3.axisLeft().scale(this.axisScale).tickFormat(function(){return""}).tickSizeInner(n).tickSizeOuter(0),l=i+n/2,c=r/2;this.svg.on("mousedown",function(){var e=d3.event.offsetY,n=Math.max(0,Math.min(e-c,s));t.setDelay(Math.round(t.delayScale(t.axisScale.invert(n))),!0,!0)}).select(".vzb-stepped-speed-slider-axis").attr("transform","translate("+l+", "+c+")").call(o),this.drag=d3.drag().on("drag",function(){var e=d3.event.dy,n=(0,a.transform)(t.slide.node()),i=n.translateY,r=Math.max(0,Math.min(e+i,s));t.setDelay(Math.round(t.delayScale(t.axisScale.invert(r)))),t.redraw(r)}).on("end",function(){t.setDelay(t.model.time.delay,!0,!0)}),this.svg.call(this.drag)},initTriangle:function(){var t=this.config;t.triangleWidth,t.triangleHeight,t.lineWidth;this.slide=this.svg.select(".vzb-stepped-speed-slider-triangle"),this.slide.append("g").append("path").attr("d",this.getTrianglePath())},getTrianglePath:function(){var t=this.config,e=t.triangleHeight;return"M "+t.triangleWidth+","+e/2+" 0,"+e+" 0,0 z"},setDelay:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.model.time.set("delay",t,e,n)},redraw:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.axisScale(this.delayScale.invert(this.model.time.delay));this.slide.attr("transform","translate(0, "+t+")")}});e.default=s},function(t,e){t.exports='<div class="vzb-stepped-speed-slider">\n  <svg>\n    <g class="vzb-stepped-speed-slider-triangle"></g>\n    <g class="vzb-stepped-speed-slider-axis"></g>\n  </svg>\n</div>\n'},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(r),s=n(5),o=i(s),l=n(108),c=i(l),u={small:{margin:{top:7,right:15,bottom:10,left:60},radius:8,label_spacing:5},medium:{margin:{top:10,right:15,bottom:10,left:50},radius:9,label_spacing:5},large:{margin:{top:5,right:15,bottom:10,left:75},radius:11,label_spacing:8}},h={medium:{margin:{top:9}},large:{margin:{}}},d=o.default.extend({init:function(t,e){this.name="gapminder-timeslider",this.template=this.template||n(422),this.prevPosition=null,this.model_expects=[{name:"time",type:"time"},{name:"entities",type:"entities"},{name:"marker",type:"marker"},{name:"ui",type:"ui"}];var i=this;this.model_binds={"change:time":function(t,e){if(i.slide){if(-1!==["time.start","time.end"].indexOf(e)){if(!i.xScale)return;i.changeLimits()}i._optionClasses(),i.model.time.dragging||i._setHandle(i.model.time.playing)}},"change:time.start":function(t,e){i.slide&&(i.model.time.dragging||i._setHandle(i.model.time.playing))},"change:time.end":function(t,e){i.slide&&(i.model.time.dragging||i._setHandle(i.model.time.playing))},"change:time.offset":function(t,e){i.slide&&(i._updateProgressBar(),i.model.marker.listenFramesQueue(null,function(t){i._updateProgressBar(t)}))},"change:time.startSelected":function(t,e){i.slide&&i.updateSelectedStartLimiter()},"change:time.endSelected":function(t,e){i.slide&&i.updateSelectedEndLimiter()},"change:marker.select":function(t,e){i.setSelectedLimits()}},this._super(t,e),(this.model.ui.chart||{}).margin&&this.model.on("change:ui.chart.margin",function(t,e){var n=i.getLayoutProfile();if("small"!==n){u[n].margin.left=i.model.ui.chart.margin.left}i.slide&&i.updateSize()}),this.ui=a.extend({show_ticks:!1,show_value:!1,show_value_when_drag_play:!0,show_button:!0,axis_aligned:!1},t.ui.getPlainObject(),this.ui),this.width=0,this.height=0,this.availableTimeFrames=[],this.completedTimeFrames=[],this.getValueWidth=a.memoize(this.getValueWidth),this._setTime=a.throttle(this._setTime,50)},readyOnce:function(){var t=this;this.element=a.isArray(this.element)?this.element:d3.select(this.element),this.slider_outer=this.element.select(".vzb-ts-slider"),this.slider=this.slider_outer.select("g"),this.axis=this.element.select(".vzb-ts-slider-axis"),this.select=this.element.select(".vzb-ts-slider-select"),this.progressBar=this.element.select(".vzb-ts-slider-progress"),this.slide=this.element.select(".vzb-ts-slider-slide"),this.handle=this.element.select(".vzb-ts-slider-handle"),this.valueText=this.element.select(".vzb-ts-slider-value"),this.playButtons=this.element.select(".vzb-ts-btns"),this.xScale=d3.scaleUtc().clamp(!0),this.xAxis=(0,c.default)("bottom"),this.valueText.classed("stroke",!0),this.slider.style("paint-order").length||(this.slider.insert("text",".vzb-ts-slider-value").attr("class","vzb-ts-slider-value stroke"),this.valueText.classed("stroke",!1)),this.valueText=this.element.selectAll(".vzb-ts-slider-value"),this.valueText.attr("text-anchor","middle").attr("dy","-0.7em");var e=t._getBrushed(),n=t._getBrushedEnd();this.brush=d3.drag().on("start drag",function(){e.call(this)}).on("end",function(){n.call(this)}),this.slide.call(this.brush),this.slider_outer.on("mousewheel",function(){if(t.model.time.dragging)return d3.event.stopPropagation(),d3.event.preventDefault(),d3.event.returnValue=!1,!1}),this._setSelectedLimitsId=0,this.model.time.startSelected>this.model.time.start&&t.updateSelectedStartLimiter(),this.model.time.endSelected<this.model.time.end&&t.updateSelectedEndLimiter(),this.parent.on("myEvent",function(e,n){var i=t.getLayoutProfile(),r=u[i];n.profile&&n.profile.margin&&(r.margin=n.profile.margin),t.element.select(".vzb-ts-slider-wrapper").style("right",n.mRight-r.margin.right+"px"),t.updateSize([0,n.rangeMax])}),this.on("resize",function(){t.updateSize()})},ready:function(){if(!this.model.time.splash){this.element.classed("vzb-ts-loading",!1);var t=this.element.select(".vzb-ts-btn-play"),e=this.element.select(".vzb-ts-btn-pause"),n=this;this.model.time;t.on("click",function(){n.model.time.play()}),e.on("click",function(){n.model.time.pause("soft")}),this.changeLimits(),this.changeTime(),this.updateSize(),n._updateProgressBar(),n.model.marker.listenFramesQueue(null,function(t){n._updateProgressBar(t)}),n.setSelectedLimits(!0)}},changeLimits:function(){var t=this.model.time.start,e=this.model.time.end;this.xScale.domain([t,e]),this.xAxis.tickValues([t,e]).tickFormat(this.model.time.getFormatter())},changeTime:function(){this.model.time.value;this._optionClasses()},updateSize:function(t){if(!this.model.time.splash){this.model.time.pause(),this.profile=this.getActiveProfile(u,h);var e=parseInt(this.slider_outer.style("width"),10)||0,n=parseInt(this.slider_outer.style("height"),10)||0;if(!n||!e)return a.warn("time slider resize() aborted because element is too small or has display:none");this.width=e-this.profile.margin.left-this.profile.margin.right,this.height=n-this.profile.margin.bottom-this.profile.margin.top;var i=this;this.slider.attr("transform","translate("+this.profile.margin.left+","+this.profile.margin.top+")"),this.xScale.range(t||[0,this.width]),this.slide.attr("transform","translate(0,"+this.height/2+")").attr("x1",this.xScale.range()[0]).attr("x2",this.xScale.range()[1]).style("stroke-width",2*this.profile.radius+"px"),this.xAxis=this.xAxis.scale(this.xScale).tickSizeInner(0).tickSizeOuter(0).tickPadding(this.profile.label_spacing).tickSizeMinor(0,0),this.axis.attr("transform","translate(0,"+this.height/2+")").call(this.xAxis),this.select.attr("transform","translate(0,"+this.height/2+")"),this.progressBar.attr("transform","translate(0,"+this.height/2+")"),this.slide.select(".background").attr("height",this.height),this.handle.attr("transform","translate(0,"+this.height/2+")").attr("r",this.profile.radius),this.sliderWidth=i.slider.node().getBoundingClientRect().width,this.resizeSelectedLimiters(),this._resizeProgressBar(),this._setHandle(),this.playButtons.style("width",this.profile.margin.left+"px")}},setSelectedLimits:function(t){var e=this;this._setSelectedLimitsId++;var n=this._setSelectedLimitsId,i=e.model.marker.select;if(0==i.length)return void e.model.time.set({startSelected:new Date(e.model.time.start),endSelected:new Date(e.model.time.end)},null,!1);var r=e.model.entities.getDimension(),s=[];a.forEach(i,function(t){s.push(e.model.marker.getEntityLimits(t[r]))}),Promise.all(s).then(function(i){if(n==e._setSelectedLimitsId){var r=i.shift(),s=r.min,o=r.max;a.forEach(i,function(t){s-t.min>0&&(s=t.min),o-t.max<0&&(o=t.max)}),e.model.time.set({startSelected:d3.max([s,new Date(e.model.time.start)]),endSelected:d3.min([o,new Date(e.model.time.end)])},t,!1)}})},updateSelectedStartLimiter:function(){var t=this;this.select.select("#clip-start-"+t._id).remove(),this.select.select(".selected-start").remove(),this.model.time.startSelected&&this.model.time.startSelected>this.model.time.start&&(this.select.append("clipPath").attr("id","clip-start-"+t._id).append("rect"),this.select.append("path").attr("clip-path","url("+location.pathname+"#clip-start-"+t._id+")").classed("selected-start",!0),this.resizeSelectedLimiters())},updateSelectedEndLimiter:function(){var t=this;this.select.select("#clip-end-"+t._id).remove(),this.select.select(".selected-end").remove(),this.model.time.endSelected&&this.model.time.endSelected<this.model.time.end&&(this.select.append("clipPath").attr("id","clip-end-"+t._id).append("rect"),this.select.append("path").attr("clip-path","url("+location.pathname+"#clip-end-"+t._id+")").classed("selected-end",!0),this.resizeSelectedLimiters())},resizeSelectedLimiters:function(){var t=this;this.select.select(".selected-start").attr("d","M0,0H"+this.xScale(this.model.time.startSelected)),this.select.select("#clip-start-"+t._id).select("rect").attr("x",-this.height/2).attr("y",-this.height/2).attr("height",this.height).attr("width",this.xScale(this.model.time.startSelected)+this.height/2),this.select.select(".selected-end").attr("d","M"+this.xScale(this.model.time.endSelected)+",0H"+this.xScale(this.model.time.end)),this.select.select("#clip-end-"+t._id).select("rect").attr("x",this.xScale(this.model.time.endSelected)).attr("y",-this.height/2).attr("height",this.height).attr("width",this.xScale(this.model.time.end)-this.xScale(this.model.time.endSelected)+this.height/2)},_resizeProgressBar:function(){var t=this;this.progressBar.selectAll("path").each(function(e){d3.select(this).attr("d","M"+t.xScale(e[0])+",0H"+t.xScale(e[1]))})},_updateProgressBar:function(t){var e=this;if(t){if(-1!=e.completedTimeFrames.indexOf(t))return;e.completedTimeFrames.push(t);var n=e.model.time.incrementTime(t),i=e.model.time.decrementTime(t);if(n>e.model.time.end){if(t-e.model.time.end!=0)return;n=t,t=i}if(0==e.availableTimeFrames.length||e.availableTimeFrames[e.availableTimeFrames.length-1][1]<t)e.availableTimeFrames.push([t,n]);else if(n<e.availableTimeFrames[0][0])e.availableTimeFrames.unshift([t,n]);else for(var r=0;r<e.availableTimeFrames.length;r++){if(t-e.availableTimeFrames[r][1]==0){r+1<e.availableTimeFrames.length&&n-e.availableTimeFrames[r+1][0]==0?(e.availableTimeFrames[r][1]=e.availableTimeFrames[r+1][1],e.availableTimeFrames.splice(r+1,1)):e.availableTimeFrames[r][1]=n;break}if(n-e.availableTimeFrames[r][0]==0){e.availableTimeFrames[r][0]=t;break}if(t-e.availableTimeFrames[r][1]>0&&n-e.availableTimeFrames[r+1][0]<0){e.availableTimeFrames.splice(r+1,0,[t,n]);break}}}else e.availableTimeFrames=[],e.completedTimeFrames=[];var a=this.progressBar.selectAll("path").data(e.availableTimeFrames);a.exit().remove(),a.enter().append("path").attr("class","domain").merge(a).each(function(t){d3.select(this).attr("d","M"+e.xScale(t[0])+",0H"+e.xScale(t[1])).classed("rounded",1==e.availableTimeFrames.length)})},getValueWidth:function(t,e){return this.valueText.node().getBoundingClientRect().width},_getBrushed:function(){var t=this;return function(){t.model.time.playing&&t.model.time.set("playing",!1,null,!1),t._optionClasses(),t.element.classed("vzb-ts-dragging",!0);var e=void 0;if(d3.event.sourceEvent){d3.event.sourceEvent.preventDefault(),t.model.time.dragStart();var n=a.roundStep(Math.round(d3.mouse(this)[0]),1);e=t.xScale.invert(n);var i=t.width;n>i?n=i:n<0&&(n=0),t.handle.attr("cx",n),t.valueText.attr("transform","translate("+n+","+t.height/2+")"),t.valueText.text(t.model.time.formatDate(e,"ui"))}e-t.model.time.value!=0&&t._setTime(e)}},_getBrushedEnd:function(){var t=this;return function(){t._setTime.recallLast(),t.element.classed("vzb-ts-dragging",!1),t.model.time.dragStop(),t.model.time.snap()}},_setHandle:function(t){var e=this,n=this.model.time.value,i=this.xScale(n);this.element.classed("vzb-ts-disabled",this.model.time.end<=this.model.time.start),null==e.prevPosition&&(e.prevPosition=i);var r=i>e.prevPosition?this.model.time.delayAnimations:0;t?(this.handle.attr("cx",e.prevPosition).transition().duration(r).ease(d3.easeLinear).attr("cx",i),this.valueText.attr("transform","translate("+e.prevPosition+","+this.height/2+")").transition("text").delay(r).text(this.model.time.formatDate(n,"ui")),this.valueText.transition().duration(r).ease(d3.easeLinear).attr("transform","translate("+i+","+this.height/2+")")):(this.handle.interrupt().attr("cx",i),this.valueText.interrupt().interrupt("text").transition("text"),this.valueText.attr("transform","translate("+i+","+this.height/2+")").text(this.model.time.formatDate(n,"ui"))),e.prevPosition=i},_setTime:function(t){var e=this,n=!this.model.time.dragging&&!this.model.time.playing;e.model.time.getModelObject("value").set(t,!1,n)},_optionClasses:function(){var t=this.ui.show_ticks,e=this.ui.show_value,n=this.ui.show_value_when_drag_play,i=this.ui.axis_aligned,r=this.ui.show_button&&this.model.time.playable;this.xAxis.labelerOptions({scaleType:"time",removeAllLabels:!t,limitMaxTickNumber:3,showOuter:!1,toolMargin:{left:10,right:10,top:0,bottom:30},fitIntoScale:"optimistic"}),this.element.classed("vzb-ts-hide-play-button",!r),this.element.classed("vzb-playing",this.model.time.playing),this.element.classed("vzb-ts-show-value",e),this.element.classed("vzb-ts-show-value-when-drag-play",n),this.element.classed("vzb-ts-axis-aligned",i)}});e.default=d},function(t,e){t.exports='<div class="vzb-timeslider vzb-ts-loading">\n  <div class="vzb-ts-slider-wrapper">\n    <svg class="vzb-ts-slider">\n      <g>\n        <g class="vzb-ts-slider-axis"></g>\n        <g class="vzb-ts-slider-progress"></g>\n        <g class="vzb-ts-slider-select"></g>\n        <circle class="vzb-ts-slider-handle"></circle>\n        <text class="vzb-ts-slider-value"></text>\n        <line class="vzb-ts-slider-slide"></line>\n      </g>\n      </svg>\n  </div>\n\n  \x3c!-- SVG VIZABI ICONS\n       source: https://github.com/encharm/Font-Awesome-SVG-PNG/ --\x3e\n  <div class="vzb-ts-btns">\n    <button class="vzb-ts-btn-loading vzb-ts-btn">\n      <div class=\'vzb-loader\'></div>\n    </button>\n    <button class="vzb-ts-btn-play vzb-ts-btn">\n      <svg class="vzb-icon vzb-icon-play" viewBox="3 3 42 42"\n           xmlns="http://www.w3.org/2000/svg">\n        <path xmlns="http://www.w3.org/2000/svg" d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm-4 29V15l12 9-12 9z"/>\n      </svg>\n    </button>\n    <button class="vzb-ts-btn-pause vzb-ts-btn">\n      <svg class="vzb-icon vzb-icon-pause" viewBox="3 3 42 42"\n           xmlns="http://www.w3.org/2000/svg">\n        <path xmlns="http://www.w3.org/2000/svg" d="M24 4C12.95 4 4 12.95 4 24s8.95 20 20 20 20-8.95 20-20S35.05 4 24 4zm-2 28h-4V16h4v16zm8 0h-4V16h4v16z"/>\n      </svg>\n    </button>\n  </div>\n</div>\n'},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(r),s=n(5),o=i(s),l=n(31),c=i(l),u=n(21),h={wrapper:"vzb-treemenu-wrap",wrapper_outer:"vzb-treemenu-wrap-outer",background:"vzb-treemenu-background",close:"vzb-treemenu-close",search:"vzb-treemenu-search",list:"vzb-treemenu-list",list_outer:"vzb-treemenu-list-outer",list_item:"vzb-treemenu-list-item",list_item_leaf:"vzb-treemenu-list-item-leaf",leaf:"vzb-treemenu-leaf",leaf_content:"vzb-treemenu-leaf-content",leaf_content_item:"vzb-treemenu-leaf-content-item",leaf_content_item_title:"vzb-treemenu-leaf-content-item-title",leaf_content_item_descr:"vzb-treemenu-leaf-content-item-descr",hasChild:"vzb-treemenu-list-item-children",list_item_label:"vzb-treemenu-list-item-label",list_top_level:"vzb-treemenu-list-top",search_wrap:"vzb-treemenu-search-wrap",isSpecial:"vzb-treemenu-list-item-special",hidden:"vzb-hidden",title:"vzb-treemenu-title",scaletypes:"vzb-treemenu-scaletypes",scaletypesDisabled:"vzb-treemenu-scaletypes-disabled",scaletypesActive:"vzb-treemenu-scaletypes-active",alignYt:"vzb-align-y-top",alignYb:"vzb-align-y-bottom",alignXl:"vzb-align-x-left",alignXr:"vzb-align-x-right",alignXc:"vzb-align-x-center",menuHorizontal:"vzb-treemenu-horizontal",menuVertical:"vzb-treemenu-vertical",absPosVert:"vzb-treemenu-abs-pos-vert",absPosHoriz:"vzb-treemenu-abs-pos-horiz",menuOpenLeftSide:"vzb-treemenu-open-left-side",noTransition:"notransition"},d={MOUSE_LOCS:[],MOUSE_LOCS_TRACKED:3,DELAY:200,TOLERANCE:150,LAST_DELAY_LOC:null,TIMEOUT:null,SEARCH_PROPERTY:"id",SUBMENUS:"children",SEARCH_MIN_STR:1,RESIZE_TIMEOUT:null,MOBILE_BREAKPOINT:400,CURRENT_PATH:[],MIN_COL_WIDTH:60,MENU_DIRECTION:1,MAX_MENU_WIDTH:320,MENU_OPEN_LEFTSIDE:!1},f=c.default.extend({init:function(t,e,n){var i=this;this.parent=t,this.entity=e,this.OPTIONS=n,this.width=this.OPTIONS.MIN_COL_WIDTH,this.direction=this.OPTIONS.MENU_DIRECTION,this._setDirectionClass(),this.menuItems=[];var r=void 0;return this.entity.empty()?this:(this.entity.each(function(){r=d3.selectAll(this.childNodes).filter(function(){return d3.select(this).classed(h.list)})}),r.empty()&&(r=this.entity),e.selectAll("."+h.list_item).filter(function(){return this.parentNode==r.node()}).each(function(){i.addSubmenu(d3.select(this))}),this)},setWidth:function(t,e,n){if(this.width!=t&&this.entity.node()){if(this.width=t,(this.entity.classed(h.list_top_level)||this.entity.classed("active"))&&1==this.direction&&(n?this.entity.style("width",this.width+"px"):this.entity.transition().delay(0).duration(100).style("width",this.width+"px")),this.entity.classed(h.list_top_level)&&this.entity.selectAll("."+h.leaf).style("width",this.width-1+"px"),e)for(var i=0;i<this.menuItems.length;i++)this.menuItems[i].setWidth(this.width,e,n);return this}},setDirection:function(t,e){if(this.direction=t,this.entity.style("width","").style("height",""),e)for(var n=0;n<this.menuItems.length;n++)this.menuItems[n].setDirection(this.direction,e);return this._setDirectionClass(),this},_setDirectionClass:function(){1==this.direction?(this.entity.classed(h.menuVertical,!1),this.entity.classed(h.menuHorizontal,!0)):(this.entity.classed(h.menuHorizontal,!1),this.entity.classed(h.menuVertical,!0))},addSubmenu:function(t){this.menuItems.push(new p(this,t,this.OPTIONS))},open:function(){var t=this;return this.isActive()||(t.parent.parentMenu.openSubmenuNow=!0,this.closeNeighbors(function(){1==t.direction?(t._openHorizontal(),t.calculateMissingWidth(0)):t._openVertical()}),t.parent.parentMenu.openSubmenuNow=!1),this},calculateMissingWidth:function(t,e){var n=this;this.entity.classed(h.list_top_level)?t>this.OPTIONS.MAX_MENU_WIDTH&&"function"==typeof e&&e(t-this.OPTIONS.MAX_MENU_WIDTH):this.parent.parentMenu.calculateMissingWidth(t+this.width,function(t){t>0?n.reduceWidth(t,function(t){"function"==typeof e&&e(t)}):"function"==typeof e&&e(t)})},restoreWidth:function(t,e,n){var i=this;if(e)this.parent.parentMenu.restoreWidth(t,!1,n);else if(t<=0)"function"==typeof n&&n();else if(this.entity.classed(h.list_top_level))"function"==typeof n&&n();else{var r=this.entity.node().offsetWidth,a=Math.min(t,i.width);if(r<a){var s=r/a*250;this.entity.transition().delay(0).duration(s).style("width",a+"px").on("end",function(){}),i.parent.parentMenu.restoreWidth(t-a,!1,n)}else this.parent.parentMenu.restoreWidth(t,!1,n)}},reduceWidth:function(t,e){var n=this,i=this.entity.node().offsetWidth;if(i<=this.OPTIONS.MIN_COL_WIDTH)e(t-n.width+i);else{var r=Math.max(this.OPTIONS.MIN_COL_WIDTH,n.width-t),a=250/(n.width/r);this.entity.transition().delay(0).duration(a).style("width",r+"px").on("end",function(){e(t-n.width+r)})}},_openHorizontal:function(){var t=this;t.entity.classed("active",!0).transition().delay(0).duration(250).style("width",t.width+"px").on("end",function(){t.marqueeToggle(!0)})},_openVertical:function(){var t=this;t.entity.style("height","0px"),t.entity.transition().delay(0).duration(250).style("height",36*t.menuItems.length+"px").on("end",function(){t.entity.style("height","auto"),t.marqueeToggle(!0),t.scrollToFitView()}),t.entity.classed("active",!0)},closeAllChildren:function(t){for(var e=0,n=0;n<this.menuItems.length;n++)this.menuItems[n].isActive()&&(++e,this.menuItems[n].submenu.close(function(){0==--e&&"function"==typeof t&&t()}));0==e&&"function"==typeof t&&t()},closeNeighbors:function(t){this.parent?this.parent.closeNeighbors(t):t()},close:function(t){var e=this;this.closeAllChildren(function(){1==e.direction?e._closeHorizontal(t):e._closeVertical(t)})},_closeHorizontal:function(t){var e=(this.entity.node().offsetWidth,this),n=e.parent.parentMenu.openSubmenuNow;e.entity.transition().delay(0).duration(20).style("width","0px").on("end",function(){e.marqueeToggle(!1),e.entity.classed("active",!1),n?"function"==typeof t&&t():e.restoreWidth(e.OPTIONS.MAX_MENU_WIDTH,!0,function(){"function"==typeof t&&t()})})},_closeVertical:function(t){var e=this;e.entity.transition().delay(0).duration(100).style("height","0px").on("end",function(){e.marqueeToggle(!1),e.entity.classed("active",!1),"function"==typeof t&&t()})},isActive:function(){return this.entity.classed("active")},hasActiveParentNeighbour:function(){return this.menuItems.filter(function(t){return t.isActive()}).some(function(t){return!!d3.select(t.entity).node().classed(h.hasChild)})},marqueeToggle:function(t){for(var e=0;e<this.menuItems.length;e++)this.menuItems[e].marqueeToggle(t)},marqueeToggleAll:function(t){for(var e=0;e<this.menuItems.length;e++)this.menuItems[e].marqueeToggleAll(t)},findItemById:function(t){for(var e=0;e<this.menuItems.length;e++){if(this.menuItems[e].entity.data().id==t)return this.menuItems[e];if(this.menuItems[e].submenu){var n=this.menuItems[e].submenu.findItemById(t);if(n)return n}}return null},getTopMenu:function(){return this.parent?this.parent.parentMenu.getTopMenu():this},scrollToFitView:function(){var t=this.getTopMenu().entity.node().parentNode,e=this.entity.node().parentNode,n=t.getBoundingClientRect(),i=e.getBoundingClientRect(),r=i.top-n.top;if(r+i.height>n.height){var a=i.height>n.height?n.height-10:i.height+10,s=t.scrollTop+a-n.height+r;d3.select(t).transition().duration(100).tween("scrolltoptween",function(e){return function(){var n=d3.interpolateNumber(this.scrollTop,e);return function(e){t.scrollTop=n(e)}}}(s))}}}),p=c.default.extend({init:function(t,e,n){var i=this;this.parentMenu=t,this.entity=e;var r=e.select("."+h.list_outer);return r.node()&&(this.submenu=new f(this,r,n)),this.entity.select("."+h.list_item_label).on("mouseenter",function(){a.isTouchDevice()||(1!=i.parentMenu.direction||d3.select(this).attr("children")?i.parentMenu.hasActiveParentNeighbour()||i.closeNeighbors():(i.openSubmenu(),i.marqueeToggle(!0)))}).on("click.item",function(){if(!a.isTouchDevice())if(d3.event.stopPropagation(),1==i.parentMenu.direction)i.openSubmenu();else{var t=d3.select(this);if(!t.attr("children"))return;i.toggleSubmenu()}}).onTap(function(t){if(d3.event.stopPropagation(),2==i.parentMenu.direction){if(!i.entity.select("."+h.list_item_label).attr("children"))return}i.toggleSubmenu()}),this},setWidth:function(t,e,n){return this.submenu&&e&&this.submenu.setWidth(t,e,n),this},setDirection:function(t,e){return this.submenu&&e&&this.submenu.setDirection(t,e),this},toggleSubmenu:function(){this.submenu&&(this.submenu.isActive()?this.submenu.close():this.submenu.open())},openSubmenu:function(){this.submenu?this.submenu.open():this.closeNeighbors()},closeNeighbors:function(t){this.parentMenu.closeAllChildren(t)},isActive:function(){return this.submenu&&this.submenu.isActive()},marqueeToggleAll:function(t){this.entity.selectAll("."+h.list_item_label).each(function(){var e=d3.select(this).select("span"),n=d3.select(this.parentNode);if(n.classed("marquee",!1),e.style("left",""),e.style("right",""),e.style("width",""),t&&e.node().scrollWidth>e.node().offsetWidth){e.attr("data-content",e.text());var i=30+e.node().scrollWidth;e.style("left",-i+"px"),e.style("right",-i+"px"),e.style("width",i+"px"),n.classed("marquee",!0)}})},marqueeToggle:function(t){var e=this.entity.select("."+h.list_item_label).select("span");if(this.entity.classed("marquee",!1),e.style("left",""),e.style("right",""),e.style("width",""),t&&e.node().scrollWidth>e.node().offsetWidth){e.attr("data-content",e.text());var n=30+e.node().scrollWidth;e.style("left",-n+"px"),e.style("right",-n+"px"),e.style("width",n+"px"),this.entity.classed("marquee",!0)}}}),v=o.default.extend({tree:function(t){return arguments.length?(this._tree=t,this):this._tree},callback:function(t){return arguments.length?(this._callback=t,this):this._callback},markerID:function(t){return arguments.length?(this._markerID=t,this.targetModel(this.model.marker[this._markerID]),this):this._markerID},targetModel:function(t){return arguments.length?(this._targetModel&&this._targetModel.off("change",this.change),this._targetModel=t,this._targetModel.on("change",this.change),this._targetModel.isHook()&&(this._targetProp="which"),this._targetModel.isEntities()&&(this._targetProp="dim"),this):this._targetModel},targetProp:function(t){return arguments.length?(this._targetProp=t,this):this._targetProp},alignX:function(t){return arguments.length?(this._alignX=t,this):this._alignX},alignY:function(t){return arguments.length?(this._alignY=t,this):this._alignY},top:function(t){return arguments.length?(this._top=t,this):this._top},left:function(t){return arguments.length?(this._left=t,this):this._left},init:function(t,e){this.name="gapminder-treemenu",this.model_expects=[{name:"marker",type:"marker"},{name:"marker_tags",type:"marker"},{name:"time",type:"time"},{name:"locale",type:"locale"}],this.context=e,this.menuEntity=null,this._super(t,e),this._callback=function(t){console.log("Indicator selector: stub callback fired. New indicator is ",t)},this._alignX="center",this._alignY="center",this.OPTIONS=a.deepClone(d),this.change=this.change.bind(this)},change:function(t,e){(-1!=e.indexOf("."+this._targetProp)||this._targetModel.isHook()&&-1!=e.indexOf(".scaleType"))&&this.updateView()},ready:function(){this.updateView();var t=void 0;this.model.marker_tags&&(t=this.model.marker_tags.label.getData()),this._buildIndicatorsTree(t)},readyOnce:function(){this.element=d3.select(this.placeholder);var t=this;this.element.selectAll("div").remove(),this.element.append("div").attr("class",h.background).on("click",function(){d3.event.stopPropagation(),t.toggle()}),this.wrapperOuter=this.element.append("div").classed(h.wrapper_outer,!0).classed(h.noTransition,!0),this.wrapper=this.wrapperOuter.append("div").classed(h.wrapper,!0).classed(h.noTransition,!0).classed("vzb-dialog-scrollable",!0),this.wrapper.on("click",function(){d3.event.stopPropagation()}),this.wrapper.append("div").attr("class",h.close).html(u.close).on("click",function(){d3.event.stopPropagation(),t.toggle()}).select("svg").attr("width","0px").attr("height","0px").attr("class",h.close+"-icon"),this.wrapper.append("div").classed(h.scaletypes,!0).append("span"),this.wrapper.append("div").classed(h.title,!0).append("span"),this.wrapper.append("div").classed(h.search_wrap,!0).append("input").classed(h.search,!0).attr("type","search").attr("id",h.search),d3.select("body").on("mousemove",t._mousemoveDocument),this.wrapper.on("mouseleave",function(){}),this.translator=this.model.locale.getTFunction(),t._enableSearch(),t.resize()},_buildIndicatorsTree:function(t){!0!==t&&t||(t=[]);var e=this,n={};n._root={id:"_root",children:[]},n._unclassified={id:"_unclassified",type:"folder",name:this.translator("buttons/unclassified"),children:[]},t.forEach(function(t){n[t.tag]={id:t.tag,name:t.name,type:"folder",children:[]}});var i=n._root;i.children.push(n._unclassified),t.forEach(function(t){t.parent&&n[t.parent]?n[t.parent].children.push(n[t.tag]):i.children.push(n[t.tag])}),a.forEach(this.model.marker._root._data,function(t){if("data"===t._type){var i=t.getConceptprops(),r=t.getDatasetName();n[r]={id:r,type:"dataset",children:[]},n._root.children.push(n[r]),a.forEach(i,function(i,s){if("_none"!=i.tags){i.tags||(i.tags=r||"_unclassified");var o={id:s,name:i.name,name_catalog:i.name_catalog,description:i.description,dataSource:t._name};i.tags.split(",").forEach(function(t){t=t.trim(),n[t]?n[t].children.push(o):(e.consoleGroupOpen||(console.groupCollapsed("Some tags were are not found, so indicators went under 'Unclassified' menu"),e.consoleGroupOpen=!0),a.warn("tag '"+t+"' for indicator '"+s+"'"),n._unclassified.children.push(o))})}})}}),e.consoleGroupOpen&&(console.groupEnd(),delete e.consoleGroupOpen),this._sortChildren(i),this.indicatorsTree=i},_sortChildren:function(t,e){var n=this;t.children&&(t.children.sort(a.firstBy()(function(t,e){return t="dataset"===t.type?1:0,(e="dataset"===e.type?1:0)-t}).thenBy(function(t,e){return t=t.children?1:0,e=e.children?1:0,t-e}).thenBy(function(t,n){if(!e){if("time"==t.id)return-1;if("time"==n.id)return 1;if("advanced"==t.id)return 1;if("advanced"==n.id)return-1;if("_default"==t.id)return 1;if("_default"==n.id)return-1}return(t.name_catalog||t.name)>(n.name_catalog||n.name)?1:-1})),t.children.forEach(function(t){n._sortChildren(t,!0)}))},resize:function(){var t=this;this.profiles={small:{col_width:200},medium:{col_width:200},large:{col_width:200}};var e=this._top,n=this._left;if(!this.wrapper)return a.warn("treemenu resize() abort because container is undefined");this.wrapper.classed(h.noTransition,!0),this.wrapper.node().scrollTop=0,this.activeProfile=this.profiles[this.getLayoutProfile()],this.OPTIONS.IS_MOBILE="small"===this.getLayoutProfile(),this.menuEntity&&(this.menuEntity.setWidth(this.activeProfile.col_width,!0,!0),this.OPTIONS.IS_MOBILE?2!=this.menuEntity.direction&&(this.menuEntity.setDirection(2,!0),this.OPTIONS.MENU_DIRECTION=2):1!=this.menuEntity.direction&&(this.menuEntity.setDirection(1,!0),this.OPTIONS.MENU_DIRECTION=1)),this.width=t.element.node().offsetWidth,this.height=t.element.node().offsetHeight;var i=this.wrapperOuter.node().getBoundingClientRect(),r=i.width,s=i.height;if(r)if(this.OPTIONS.IS_MOBILE)this.clearPos();else{(e||n)&&(this.wrapperOuter.node().offsetTop<10&&this.wrapperOuter.style("top","10px"),this.height-t.wrapperOuter.node().offsetTop-s<0&&(s>this.height&&(s=this.height-20),this.wrapperOuter.style("top",this.height-s-10+"px"),this.wrapperOuter.style("bottom","auto")),e&&(e=t.wrapperOuter.node().offsetTop));var o=void 0;o=this.wrapperOuter.classed(h.alignYb)?this.wrapperOuter.node().offsetTop+this.wrapperOuter.node().offsetHeight:this.height-this.wrapperOuter.node().offsetTop,this.wrapper.style("max-height",o-10+"px"),this.wrapperOuter.classed(h.alignXc,"center"===this._alignX),this.wrapperOuter.style("margin-left","center"===this._alignX?"-"+r/2+"px":null),"center"===this._alignX?this.OPTIONS.MAX_MENU_WIDTH=this.width/2-.5*r-10:this.OPTIONS.MAX_MENU_WIDTH=this.width-this.wrapperOuter.node().offsetLeft-r-10;var l=this.activeProfile.col_width+2*this.OPTIONS.MIN_COL_WIDTH,c=this.wrapperOuter.node().offsetLeft;this.OPTIONS.MENU_OPEN_LEFTSIDE=this.OPTIONS.MAX_MENU_WIDTH<l&&c>this.OPTIONS.MAX_MENU_WIDTH+10,this.OPTIONS.MENU_OPEN_LEFTSIDE?(c<l+10&&(c=l+10),this.OPTIONS.MAX_MENU_WIDTH=c-10):this.OPTIONS.MAX_MENU_WIDTH<l&&(c-=l-this.OPTIONS.MAX_MENU_WIDTH,this.OPTIONS.MAX_MENU_WIDTH=l),n?n=c:c!=this.wrapperOuter.node().offsetLeft&&(this.wrapperOuter.style("left","auto"),this.wrapperOuter.style("right",this.width-c-i.width+"px")),this._top=e,this._left=n,(n||e)&&this.setPos(),this.wrapperOuter.classed("vzb-treemenu-open-left-side",!this.OPTIONS.IS_MOBILE&&this.OPTIONS.MENU_OPEN_LEFTSIDE)}return this.wrapper.node().offsetHeight,this.wrapper.classed(h.noTransition,!1),this.setHorizontalMenuHeight(),this},toggle:function(){var t=this,e=!this.element.classed(h.hidden);this.element.classed(h.hidden,e),e?(this.clearPos(),this.menuEntity.marqueeToggle(!1)):(this.setPos(),!a.isTouchDevice()&&this.focusSearch(),this.resize(),this.scrollToSelected()),this.wrapper.classed(h.noTransition,e),this.parent.components.forEach(function(n){"gapminder-dialogs"==n.name?d3.select(n.placeholder.parentNode).classed("vzb-blur",!e):n.element.classed?n.element.classed("vzb-blur",n!=t&&!e):d3.select(n.element).classed("vzb-blur",n!=t&&!e)}),this.width=t.element.node().offsetWidth},scrollToSelected:function(){if(this.selectedNode){var t=this,e=function(t,e){t.scrollTop=0;var n=t.getBoundingClientRect(),i=e.getBoundingClientRect(),r=i.bottom-n.top-t.offsetHeight+10;t.scrollTop=r};if(2==this.menuEntity.direction)e(this.wrapper.node(),this.selectedNode),t.menuEntity.marqueeToggleAll(!0);else{this.menuEntity.findItemById(d3.select(this.selectedNode).data().id).submenu.calculateMissingWidth(0,function(){t.menuEntity.marqueeToggleAll(!0)});for(var n=this.selectedNode,i=void 0;!a.hasClass(n,h.list_top_level);)"LI"==n.tagName&&(i=a.hasClass(n.parentNode,h.list_top_level)?n.parentNode.parentNode:n.parentNode,e(i,n)),n=n.parentNode}}},setPos:function(){var t=this._top,e=this._left,n=this.wrapperOuter.node().getBoundingClientRect();if(t&&(this.wrapperOuter.style("top",t+"px"),this.wrapperOuter.style("bottom","auto"),this.wrapperOuter.classed(h.absPosVert,t)),e){var i=this.element.node().offsetWidth-e-n.width;i=i<10?10:i,this.wrapperOuter.style("right",i+"px"),this.wrapperOuter.style("left","auto"),this.wrapperOuter.classed(h.absPosHoriz,i)}},clearPos:function(){this._top="",this._left="",this.wrapperOuter.attr("style",""),this.wrapperOuter.classed(h.absPosVert,""),this.wrapperOuter.classed(h.absPosHoriz,""),this.wrapperOuter.classed(h.menuOpenLeftSide,""),this.wrapper.style("max-height","")},setHorizontalMenuHeight:function(){var t=null;if(this.menuEntity&&1==this.OPTIONS.MENU_DIRECTION&&this.menuEntity.menuItems.length){var e=parseInt(this.menuEntity.menuItems[0].entity.style("height"),10)||0,n=e*this._maxChildCount,i=Math.max(this.menuEntity.menuItems.length,3)*e+this.menuEntity.entity.node().offsetTop+parseInt(this.wrapper.style("padding-bottom"),10);t=Math.max(n,i)+"px"}this.wrapper.classed(h.noTransition,!0),this.wrapper.node().offsetHeight,this.wrapper.style("height",t),this.wrapper.node().offsetHeight,this.wrapper.classed(h.noTransition,!1)},_enableSearch:function(){var t=this,e=this.wrapper.select("."+h.search),n=function(e){var n={_id:"root",children:[]},i=function(e,n,i){var r=n[i].name;if(!r&&t.translator){r=t.translator("indicator/"+n[i][t.OPTIONS.SEARCH_PROPERTY]+"/"+t._targetModel._type)||t.translator("indicator/"+n[i][t.OPTIONS.SEARCH_PROPERTY])}return r&&r.toLowerCase().indexOf(e.toLowerCase())>=0};return function r(a){for(var s=t.OPTIONS.SUBMENUS,o=0;o<a.length;o++){var l=!1;l=i(e,a,o),l&&n.children.push(a[o]),!l&&a[o][s]&&r(a[o][s])}}(t.dataFiltered.children),n.children=a.unique(n.children,function(t){return t.id}),n},i=!1,r=a.debounce(function(){var r=e.node().value;(i||""!=r)&&(i=""!=r,r.length>=t.OPTIONS.SEARCH_MIN_STR?t.redraw(n(r),!0):t.redraw())},250);e.on("input",r)},_selectIndicator:function(t){this._callback(this._targetProp,t),this.toggle()},redraw:function(t,e){function n(t,e,r){if(e.children){i._maxChildCount=Math.max(i._maxChildCount,e.children.length);var s=r?t:t.append("div").classed(h.list_outer,!0),o=s.append("ul").classed(h.list,!r).classed(h.list_top_level,r).classed("vzb-dialog-scrollable",!0).selectAll("li").data(e.children,function(t){return t.id}).enter().append("li");o.append("span").classed(h.list_item_label,!0).attr("children",function(t){return t.children?"true":null}).attr("type",function(t){return t.type?t.type:null}).on("click",function(t){d3.select(this).attr("children")||(d3.event.stopPropagation(),i._selectIndicator({concept:t.id,dataSource:t.dataSource}))}).append("span").text(function(t){var e="_default"===t.id?i.translator("indicator/_default/"+c):t.name_catalog||t.name||t.id;return e||""===e||a.warn("translation missing: NAME of "+t.id),e||""}),o.classed(h.list_item,!0).classed(h.hasChild,function(t){return t.children}).classed(h.isSpecial,function(t){return t.special}).each(function(t){var e=d3.select(this);if(!t.children){var s=e.append("div").attr("class",h.menuHorizontal+" "+h.list_outer+" "+h.list_item_leaf);s.on("click",function(t){i._selectIndicator({concept:t.id,dataSource:t.dataSource})});var o=s.append("div").classed(h.leaf+" "+h.leaf_content+" vzb-dialog-scrollable",!0);o.append("span").classed(h.leaf_content_item+" "+h.leaf_content_item_title,!0).text(function(t){return("_default"===t.id?i.translator("indicator/_default/"+c):t.name)||""});var l=void 0;o.append("span").classed(h.leaf_content_item,!0).text(function(t){var e="_default"===t.id?i.translator("unit/_default/"+c):t.unit;return l=!e,i.translator("hints/units")+": "+e||""}).classed("vzb-hidden",l);var u=void 0;o.append("span").classed(h.leaf_content_item+" "+h.leaf_content_item_descr,!0).text(function(t){var e="_default"===t.id?i.translator("description/_default/"+c):t.description;return u=!e,l&&u?i.translator("hints/nodescr"):e||""}).classed("vzb-hidden",u&&!l)}if(t.id==i._targetModel[i._targetProp]){var d=void 0;if(i.selectedNode&&r)for(d=i.selectedNode.parentNode,d3.select(i.selectedNode).select("."+h.list_item_leaf).classed("active",!1);!a.hasClass(d,h.list_top_level);)"UL"==d.tagName&&d3.select(d.parentNode).classed("active",!1),d=d.parentNode;if(!i.selectedNode||r){for(d=this.parentNode,d3.select(this).classed("item-active",!0).select("."+h.list_item_leaf).classed("active",!0);!a.hasClass(d,h.list_top_level);)"UL"==d.tagName&&d3.select(d.parentNode).classed("active",!0),"LI"==d.tagName&&d3.select(d).classed("item-active",!0),d=d.parentNode;i.selectedNode=this}}n(e,t)})}}var i=this,r=i._targetModel.isHook(),s=void 0,o=void 0,l={};a.forEach(this.model.marker._root._data,function(t){"data"===t._type&&a.deepExtend(l,t.getConceptprops())});var c=i._targetModel._type;if(e)s=t;else{if(null==t&&(t=this._tree),r)o=a.keys(l).filter(function(t){if(i._targetModel.allow&&i._targetModel.allow.names){if(-1!=i._targetModel.allow.names.indexOf("!"+t))return!1;if(-1!=i._targetModel.allow.names.indexOf(t))return!0;if(i._targetModel.allow.namesOnlyThese)return!1}if(!i._targetModel.allow||!i._targetModel.allow.scales)return!0;if("*"==i._targetModel.allow.scales[0])return!0;if(!l[t].scales)return!0;for(var e=l[t].scales.length-1;e>=0;e--)if(i._targetModel.allow.scales.indexOf(l[t].scales[e])>-1)return!0;return!1});else if(i._targetModel.isEntities()){var u=["entity_domain","entity_set"];o=a.keys(l).filter(function(t){return u.indexOf(l[t].concept_type)>-1})}else o=a.keys(l);s=a.pruneTree(t,function(t){return o.indexOf(t.id)>-1}),this.dataFiltered=s}if(this.wrapper.select("ul").remove(),this.element.select("."+h.title).select("span").text(this.translator(i._targetModel.isEntities()?i._targetModel._root._name+"/"+i._targetModel._name:"buttons/"+(r?i._targetModel._name:c+"/"+i._targetProp))),this.element.select("."+h.search).attr("placeholder",this.translator("placeholder/search")+"..."),this._maxChildCount=0,this.OPTIONS.IS_MOBILE?this.OPTIONS.MENU_DIRECTION=2:this.OPTIONS.MENU_DIRECTION=1,this.selectedNode=null,n(this.wrapper,s,!0),this.menuEntity=new f(null,this.wrapper.selectAll("."+h.list_top_level),this.OPTIONS),this.menuEntity&&this.menuEntity.setDirection(this.OPTIONS.MENU_DIRECTION),this.menuEntity&&this.menuEntity.setWidth(this.activeProfile.col_width,!0,!0),this.setHorizontalMenuHeight(),!e){var d="_default";if(o.indexOf(this._targetModel[i._targetProp])>-1&&(d=this._targetModel[i._targetProp]),l[d]||a.error("Concept properties of "+d+" are missing from the set, or the set is empty. Put a breakpoint here and check what you have in indicatorsDB"),!l[d].scales)return this.element.select("."+h.scaletypes).classed(h.hidden,!0),!0;var p=r?l[d].scales.filter(function(t){return!i._targetModel.allow||!i._targetModel.allow.scales||("*"==i._targetModel.allow.scales[0]||i._targetModel.allow.scales.indexOf(t)>-1)}):[];if(0==p.length)this.element.select("."+h.scaletypes).classed(h.hidden,!0);else{var v=this.element.select("."+h.scaletypes).classed(h.hidden,!1).selectAll("span").data(p,function(t){return t});v.exit().remove(),v=v.enter().append("span").on("click",function(t){d3.event.stopPropagation(),i._setModel("scaleType",t)}).merge(v);var g=i._targetModel.scaleType;v.classed(h.scaletypesDisabled,p.length<2).classed(h.scaletypesActive,function(t){return(t==g||"log"===t&&"genericLog"===g)&&p.length>1}).text(function(t){return i.translator("scaletype/"+t)})}}return this},updateView:function(){if(this._targetModel){this.wrapperOuter.classed(h.absPosVert,this._top),this.wrapperOuter.classed(h.alignYt,"top"===this._alignY),this.wrapperOuter.classed(h.alignYb,"bottom"===this._alignY),this.wrapperOuter.classed(h.absPosHoriz,this._left),this.wrapperOuter.classed(h.alignXl,"left"===this._alignX),this.wrapperOuter.classed(h.alignXr,"right"===this._alignX);var t=this._setModel.bind(this);return this.callback(t).tree(this.indicatorsTree).redraw(),this.wrapper.select("."+h.search).node().value="",this}},focusSearch:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.wrapper.select("."+h.search).node();t?e.focus():e.blur()},_setModel:function(t,e){var n=this._targetModel;"which"==t&&n.setWhich(e),"scaleType"==t&&n.setScaleType(e),"dim"==t&&n.setDimension(e)}});e.default=v},function(t,e,n){function i(t){return n(r(t))}function r(t){var e=a[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var a={"./_dialog.js":11,"./about/about.js":164,"./axes/axes.js":165,"./colors/colors.js":167,"./dialogs.js":168,"./find/find.js":169,"./grouping/grouping.js":170,"./label/label.js":171,"./moreoptions/moreoptions.js":172,"./opacity/opacity.js":173,"./presentation/presentation.js":174,"./show/show.js":175,"./side/side.js":176,"./size/size.js":177,"./speed/speed.js":178,"./stack/stack.js":179,"./timedisplay/timedisplay.js":181,"./zoom/zoom.js":183};i.keys=function(){return Object.keys(a)},i.resolve=r,t.exports=i,i.id=424},function(t,e,n){function i(t){return n(r(t))}function r(t){var e=a[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var a={"./d3.axisWithLabelPicker.js":108,"./d3.collisionResolver.js":426,"./d3.colorPicker.js":163,"./d3.dynamicBackground.js":182,"./d3.genericLogScale.js":155,"./d3.geoProjection.js":427,"./d3.touchEvents.js":156,"./labels.js":428,"./requireAll.js":104,"./svgexport.js":430,"./textEllipsis.js":431,"./topojson.js":432};i.keys=function(){return Object.keys(a)},i.resolve=r,t.exports=i,i.id=425},function(t,e,n){"use strict";function i(){return function(){function t(t){if(null==i)return void console.warn("D3 collision resolver stopped: missing a CSS slector");if(null==r)return void console.warn("D3 collision resolver stopped: missing height of the canvas");if(null==s)return void console.warn("D3 collision resolver stopped: missing pointer within data objects. Example: value = 'valueY' ");if(null==h)return void console.warn("D3 collision resolver stopped: missing a key for data. Example: key = 'geo' ");n=.8*t.node().getBBox().height;for(var a=t.filter(function(t){return l(t,o)}).sort(function(t,e){return d3.ascending(t.valueY,e.valueY)}).data(),c={},u=0;u<a.length-1;u++){var d=a[u],f=a[u+1];if(d.shiftY||(d.shiftY=0),f.shiftY=0,!(f.valueY-d.valueY-d.shiftY>=n)){var p=0;d.valueY>n&&(0==u?p=Math.min(n,d.valueY):d.valueY-a[u-1].valueY+a[u-1].shiftY>n&&(p=Math.min(n,d.valueY-a[u-1].valueY+a[u-1].shiftY))),d.upperAvailable=p;var v=0;f.valueY<r&&(u==a.length-2?v=Math.min(n,r-f.valueY):a[u+2].valueY-f.valueY>n&&(v=Math.min(n,a[u+2].valueY-f.valueY))),f.underAvailable=v;var g=n-(f.valueY-d.valueY-d.shiftY);c[d[h]]={},c[f[h]]={},p>=g/2&&v>=g/2?(d.shiftY=-g/2,f.shiftY=g/2):p>=g/2?(f.shiftY=v,d.shiftY=-Math.min(p,g-v)):v>=g/2?(d.shiftY-=p,f.shiftY=Math.min(v,g-p)):(d.shiftY=-p,f.shiftY=v),c[d[h]].valueY=d.valueY+d.shiftY,c[f[h]].valueY=f.valueY+f.shiftY}}t.each(function(t,n){c[t[h]]&&c[t[h]].valueY&&d3.select(this).selectAll(i).transition().duration(e).attr("transform","translate(0,"+c[t[h]].valueY+")")})}var e=300,n=0,i=null;t.selector=function(e){return arguments.length?(i=e,t):i};var r=null;t.height=function(e){return arguments.length?(r=e,t):r};var a=d3.scaleLinear().domain([0,1]).range([0,1]);t.scale=function(e){return arguments.length?(a=e,t):a};var s=null;t.value=function(e){return arguments.length?(s=e,t):s};var o=null;t.time=function(e){return arguments.length?(o=e,t):o};var l=function(){return!0};t.filter=function(e){return arguments.length?(l=e,t):l};var c=null;t.fixed=function(e){return arguments.length?(c=e,t):c};var u=null;t.handleResult=function(e){return arguments.length?(u=e,t):u};var h=null;return t.KEY=function(e){return arguments.length?(h=e,t):h},t}()}Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){function t(t,n){return{type:"Feature",id:t.id,properties:t.properties,geometry:e(t.geometry,n)}}function e(t,n){if(!t)return null;if("GeometryCollection"===t.type)return{type:"GeometryCollection",geometries:object.geometries.map(function(t){return e(t,n)})};if(!fe.hasOwnProperty(t.type))return null;var i=fe[t.type];return d3.geoUstream(t,n(i)),i.result()}function n(){}function i(t){if((e=t.length)<4)return!1;for(var e,n=0,i=t[e-1][1]*t[0][0]-t[e-1][0]*t[0][1];++n<e;)i+=t[n-1][1]*t[n][0]-t[n-1][0]*t[n][1];return i<=0}function r(t,e){for(var n=e[0],i=e[1],r=!1,a=0,s=t.length,o=s-1;a<s;o=a++){var l=t[a],c=l[0],u=l[1],h=t[o],d=h[0],f=h[1];u>i^f>i&&n<(d-c)*(i-u)/(f-u)+c&&(r=!r)}return r}function a(t){return t?t/Math.sin(t):1}function s(t){return t>0?1:t<0?-1:0}function o(t){return t>1?me:t<-1?-me:Math.asin(t)}function l(t){return t>1?0:t<-1?ge:Math.acos(t)}function c(t){return t>0?Math.sqrt(t):0}function u(t){function e(t,e){var n=Math.cos(t),r=Math.cos(e),a=Math.sin(e),s=r*n,o=-((1-s?Math.log(.5*(1+s))/(1-s):-.5)+i/(1+s));return[o*r*Math.sin(t),o*a]}var n=Math.tan(.5*t),i=2*Math.log(Math.cos(.5*t))/(n*n);return e.invert=function(e,n){var r,a=Math.sqrt(e*e+n*n),s=-.5*t,l=50;if(!a)return[0,0];do{var c=.5*s,u=Math.cos(c),h=Math.sin(c),d=Math.tan(c),f=Math.log(1/u);s-=r=(2/d*f-i*d-a)/(-f/(h*h)+1-i/(2*u*u))}while(Math.abs(r)>pe&&--l>0);var p=Math.sin(s);return[Math.atan2(e*p,a*Math.cos(s)),o(n*p/a)]},e}function h(){var t=me,e=we(u),n=e(t);return n.radius=function(n){return arguments.length?e(t=n*ge/180):t/ge*180},n}function d(t,e){var n=Math.cos(e),i=a(l(n*Math.cos(t/=2)));return[2*n*Math.sin(t)*i,Math.sin(e)*i]}function f(t){function e(t,e){var o=Math.cos(e),l=Math.cos(t/=2);return[(1+o)*Math.sin(t),(r*e>-Math.atan2(l,a)-.001?0:10*-r)+s+Math.sin(e)*i-(1+o)*n*l]}var n=Math.sin(t),i=Math.cos(t),r=t>0?1:-1,a=Math.tan(r*t),s=(1+n-i)/2;return e.invert=function(t,e){var o=0,l=0,c=50;do{var u=Math.cos(o),h=Math.sin(o),d=Math.cos(l),f=Math.sin(l),p=1+d,v=p*h-t,g=s+f*i-p*n*u-e,m=.5*p*u,b=-h*f,_=.5*n*p*h,y=i*d+n*u*f,M=b*_-y*m,w=.5*(g*b-v*y)/M,x=(v*_-g*m)/M;o-=w,l-=x}while((Math.abs(w)>pe||Math.abs(x)>pe)&&--c>0);return r*l>-Math.atan2(Math.cos(o),a)-.001?[2*o,l]:null},e}function p(){var t=ge/9,e=t>0?1:-1,n=Math.tan(e*t),i=we(f),r=i(t),a=r.stream;return r.parallel=function(r){return arguments.length?(n=Math.tan((e=(t=r*ge/180)>0?1:-1)*t),i(t)):t/ge*180},r.stream=function(i){var s=r.rotate(),o=a(i),l=(r.rotate([0,0]),a(i));return r.rotate(s),o.sphere=function(){l.polygonStart(),l.lineStart();for(var i=-180*e;e*i<180;i+=90*e)l.point(i,90*e);for(;e*(i-=t)>=-180;)l.point(i,e*-Math.atan2(Math.cos(i*_e/2),n)*ye);l.lineEnd(),l.polygonEnd()},o},r}function v(t){return((t=Math.exp(2*t))-1)/(t+1)}function g(t){return.5*(Math.exp(t)-Math.exp(-t))}function m(t){return.5*(Math.exp(t)+Math.exp(-t))}function b(t){return Math.log(t+c(t*t+1))}function _(t){return Math.log(t+c(t*t-1))}function y(t,e){var n=Math.tan(e/2),i=c(1-n*n),r=1+i*Math.cos(t/=2),a=Math.sin(t)*i/r,s=n/r,o=a*a,l=s*s;return[4/3*a*(3+o-3*l),4/3*s*(3+3*o-l)]}function M(t,e){var n=Math.abs(e);return n<ge/4?[t,Math.log(Math.tan(ge/4+e/2))]:[t*Math.cos(n)*(2*Math.SQRT2-1/Math.sin(n)),s(e)*(2*Math.SQRT2*(n-ge/4)-Math.log(Math.tan(n/2)))]}function w(t){function e(t,e){var i=Se(t,e);if(Math.abs(t)>me){var r=Math.atan2(i[1],i[0]),a=Math.sqrt(i[0]*i[0]+i[1]*i[1]),s=n*Math.round((r-me)/n)+me,l=Math.atan2(Math.sin(r-=s),2-Math.cos(r));r=s+o(ge/a*Math.sin(l))-l,i[0]=a*Math.cos(r),i[1]=a*Math.sin(r)}return i}var n=2*ge/t;return e.invert=function(t,e){var i=Math.sqrt(t*t+e*e);if(i>me){var r=Math.atan2(e,t),a=n*Math.round((r-me)/n)+me,s=r>a?-1:1,o=i*Math.cos(a-r),l=1/Math.tan(s*Math.acos((o-ge)/Math.sqrt(ge*(ge-2*o)+i*i)));r=a+2*Math.atan((l+s*Math.sqrt(l*l-3))/3),t=i*Math.cos(r),e=i*Math.sin(r)}return Se.invert(t,e)},e}function x(){var t=5,e=we(w),n=e(t),i=n.stream,r=.01,a=-Math.cos(r*_e),s=Math.sin(r*_e);return n.lobes=function(n){return arguments.length?e(t=+n):t},n.stream=function(e){var l=n.rotate(),c=i(e),u=(n.rotate([0,0]),i(e));return n.rotate(l),c.sphere=function(){u.polygonStart(),u.lineStart();for(var e=0,n=360/t,i=2*ge/t,l=90-180/t,c=me;e<t;++e,l-=n,c-=i)u.point(Math.atan2(s*Math.cos(c),a)*ye,o(s*Math.sin(c))*ye),l<-90?(u.point(-90,-180-l-r),u.point(-90,-180-l+r)):(u.point(90,l+r),u.point(90,l-r));u.lineEnd(),u.polygonEnd()},c},n}function S(t){return function(e){var n,i=t*Math.sin(e),r=30;do{e-=n=(e+Math.sin(e)-i)/(1+Math.cos(e))}while(Math.abs(n)>pe&&--r>0);return e/2}}function z(t,e,n){function i(n,i){return[t*n*Math.cos(i=r(i)),e*Math.sin(i)]}var r=S(n);return i.invert=function(i,r){var a=o(r/e);return[i/(t*Math.cos(a)),o((2*a+Math.sin(2*a))/n)]},i}function O(t,e){var n=2.00276,i=ze(e);return[n*t/(1/Math.cos(e)+1.11072/Math.cos(i)),(e+Math.SQRT2*Math.sin(i))/n]}function E(t){var e=0,n=we(t),i=n(e);return i.parallel=function(t){return arguments.length?n(e=t*ge/180):e/ge*180},i}function k(t,e){return[t*Math.cos(e),e]}function T(t){function e(e,i){var r=n+t-i,a=r?e*Math.cos(i)/r:r;return[r*Math.sin(a),n-r*Math.cos(a)]}if(!t)return k;var n=1/Math.tan(t);return e.invert=function(e,i){var r=Math.sqrt(e*e+(i=n-i)*i),a=n+t-r;return[r/Math.cos(a)*Math.atan2(e,i),a]},e}function P(t){function e(e,n){for(var i=Math.sin(n),r=Math.cos(n),a=new Array(3),c=0;c<3;++c){var u=t[c];if(a[c]=L(n-u[1],u[3],u[2],r,i,e-u[0]),!a[c][0])return u.point;a[c][1]=A(a[c][1]-u.v[1])}for(var h=l.slice(),c=0;c<3;++c){var d=2==c?0:c+1,f=C(t[c].v[0],a[c][0],a[d][0]);a[c][1]<0&&(f=-f),c?1==c?(f=s-f,h[0]-=a[c][0]*Math.cos(f),h[1]-=a[c][0]*Math.sin(f)):(f=o-f,h[0]+=a[c][0]*Math.cos(f),h[1]+=a[c][0]*Math.sin(f)):(h[0]+=a[c][0]*Math.cos(f),h[1]-=a[c][0]*Math.sin(f))}return h[0]/=3,h[1]/=3,h}t=t.map(function(t){return[t[0],t[1],Math.sin(t[1]),Math.cos(t[1])]});for(var n,i=t[2],r=0;r<3;++r,i=n)n=t[r],i.v=L(n[1]-i[1],i[3],i[2],n[3],n[2],n[0]-i[0]),i.point=[0,0];var a=C(t[0].v[0],t[2].v[0],t[1].v[0]),s=C(t[0].v[0],t[1].v[0],t[2].v[0]),o=ge-a;t[2].point[1]=0,t[0].point[0]=-(t[1].point[0]=.5*t[0].v[0]);var l=[t[2].point[0]=t[0].point[0]+t[2].v[0]*Math.cos(a),2*(t[0].point[1]=t[1].point[1]=t[2].v[0]*Math.sin(a))];return e}function D(){var t=[[0,0],[0,0],[0,0]],e=we(P),n=e(t),i=n.rotate;return delete n.rotate,n.points=function(r){if(!arguments.length)return t;t=r;var a=d3.geoCentroid({type:"MultiPoint",coordinates:t}),s=[-a[0],-a[1]];return i.call(n,s),e(t.map(d3.geoRotation(s)).map(I))},n.points([[-150,55],[-35,55],[-92.5,10]])}function L(t,e,n,i,r,a){var s,c=Math.cos(a);if(Math.abs(t)>1||Math.abs(a)>1)s=l(n*r+e*i*c);else{var u=Math.sin(.5*t),h=Math.sin(.5*a);s=2*o(Math.sqrt(u*u+e*i*h*h))}return Math.abs(s)>pe?[s,Math.atan2(i*Math.sin(a),e*r-n*i*c)]:[0,0]}function C(t,e,n){return l(.5*(t*t+e*e-n*n)/(t*e))}function A(t){return t-2*ge*Math.floor((t+ge)/(2*ge))}function I(t){return[t[0]*_e,t[1]*_e]}function R(t,e){var n=c(1-Math.sin(e));return[2/be*t*n,be*(1-n)]}function j(t){function e(t,e){return[t,(t?t/Math.sin(t):1)*(Math.sin(e)*Math.cos(t)-n*Math.cos(e))]}var n=Math.tan(t);return e.invert=n?function(t,e){t&&(e*=Math.sin(t)/t);var i=Math.cos(t);return[t,2*Math.atan2(Math.sqrt(i*i+n*n-e*e)-i,n-e)]}:function(t,e){return[t,o(t?e*Math.tan(t)/t:e)]},e}function N(t,e){var n=Math.sqrt(3);return[n*t*(2*Math.cos(2*e/3)-1)/be,n*be*Math.sin(e/3)]}function q(t){function e(t,e){return[t*n,Math.sin(e)/n]}var n=Math.cos(t);return e.invert=function(t,e){return[t/n,o(e*n)]},e}function F(t){function e(t,e){return[t*n,(1+n)*Math.tan(.5*e)]}var n=Math.cos(t);return e.invert=function(t,e){return[t/n,2*Math.atan(e/(1+n))]},e}function H(t,e){var n=Math.sqrt(8/(3*ge));return[n*t*(1-Math.abs(e)/ge),n*e]}function B(t,e){var n=Math.sqrt(4-3*Math.sin(Math.abs(e)));return[2/Math.sqrt(6*ge)*t*n,s(e)*Math.sqrt(2*ge/3)*(2-n)]}function V(t,e){var n=Math.sqrt(ge*(4+ge));return[2/n*t*(1+Math.sqrt(1-4*e*e/(ge*ge))),4/n*e]}function W(t,e){var n=(2+me)*Math.sin(e);e/=2;for(var i=0,r=1/0;i<10&&Math.abs(r)>pe;i++){var a=Math.cos(e);e-=r=(e+Math.sin(e)*(a+2)-n)/(2*a*(1+a))}return[2/Math.sqrt(ge*(4+ge))*t*(1+Math.cos(e)),2*Math.sqrt(ge/(4+ge))*Math.sin(e)]}function Y(t,e){return[t*(1+Math.cos(e))/Math.sqrt(2+ge),2*e/Math.sqrt(2+ge)]}function U(t,e){for(var n=(1+me)*Math.sin(e),i=0,r=1/0;i<10&&Math.abs(r)>pe;i++)e-=r=(e+Math.sin(e)-n)/(1+Math.cos(e));return n=Math.sqrt(2+ge),[t*(1+Math.cos(e))/n,2*e/n]}function G(t,e){var n=Math.sin(t/=2),i=Math.cos(t),r=Math.sqrt(Math.cos(e)),a=Math.cos(e/=2),s=Math.sin(e)/(a+Math.SQRT2*i*r),o=Math.sqrt(2/(1+s*s)),l=Math.sqrt((Math.SQRT2*a+(i+n)*r)/(Math.SQRT2*a+(i-n)*r));return[ke*(o*(l-1/l)-2*Math.log(l)),ke*(o*s*(l+1/l)-2*Math.atan(s))]}function X(t,e){var n=Math.tan(e/2);return[t*Te*c(1-n*n),(1+Te)*n]}function K(t,e){var n=e/2,i=Math.cos(n);return[2*t/be*Math.cos(e)*i*i,be*Math.tan(n)]}function Q(t,e){function n(e,n){var a=Pe(e,n),s=a[0],o=a[1],l=s*s+o*o;if(l>r){var c=Math.sqrt(l),u=Math.atan2(o,s),h=i*Math.round(u/i),d=u-h,f=t*Math.cos(d),p=(t*Math.sin(d)-d*Math.sin(f))/(me-f),v=$(d,p),g=(ge-t)/Z(v,f,ge);s=c;var m,b=50;do{s-=m=(t+Z(v,f,s)*g-c)/(v(s)*g)}while(Math.abs(m)>pe&&--b>0);o=d*Math.sin(s),s<me&&(o-=p*(s-me));var _=Math.sin(h),y=Math.cos(h);a[0]=s*y-o*_,a[1]=s*_+o*y}return a}var i=2*ge/e,r=t*t;return n.invert=function(e,n){var a=e*e+n*n;if(a>r){var s=Math.sqrt(a),o=Math.atan2(n,e),l=i*Math.round(o/i),c=o-l,e=s*Math.cos(c);n=s*Math.sin(c);for(var u=e-me,h=Math.sin(e),d=n/h,f=e<me?1/0:0,p=10;;){var v=t*Math.sin(d),g=t*Math.cos(d),m=Math.sin(g),b=me-g,_=(v-d*m)/b,y=$(d,_);if(Math.abs(f)<ve||!--p)break;d-=f=(d*h-_*u-n)/(h-2*u*(b*(g+d*v*Math.cos(g)-m)-v*(v-d*m))/(b*b))}s=t+Z(y,g,e)*(ge-t)/Z(y,g,ge),o=l+d,e=s*Math.cos(o),n=s*Math.sin(o)}return Pe.invert(e,n)},n}function $(t,e){return function(n){var i=t*Math.cos(n);return n<me&&(i-=e),Math.sqrt(1+i*i)}}function J(){var t=6,e=30*_e,n=Math.cos(e),i=Math.sin(e),r=we(Q),a=r(e,t),s=a.stream,o=-Math.cos(.01*_e),l=Math.sin(.01*_e);return a.radius=function(a){return arguments.length?(n=Math.cos(e=a*_e),i=Math.sin(e),r(e,t)):e*ye},a.lobes=function(n){return arguments.length?r(e,t=+n):t},a.stream=function(e){var r=a.rotate(),c=s(e),u=(a.rotate([0,0]),s(e));return a.rotate(r),c.sphere=function(){u.polygonStart(),u.lineStart();for(var e=0,r=2*ge/t,a=0;e<t;++e,a-=r)u.point(Math.atan2(l*Math.cos(a),o)*ye,Math.asin(l*Math.sin(a))*ye),u.point(Math.atan2(i*Math.cos(a-r/2),n)*ye,Math.asin(i*Math.sin(a-r/2))*ye);u.lineEnd(),u.polygonEnd()},c},a}function Z(t,e,n){for(var i=(n-e)/50,r=t(e)+t(n),a=1,s=e;a<50;++a)r+=2*t(s+=i);return.5*r*i}function tt(t,e,n,i,r,a,s,o){function l(l,c){if(!c)return[t*l/ge,0];var u=c*c,h=t+u*(e+u*(n+u*i)),d=c*(r-1+u*(a-o+u*s)),f=(h*h+d*d)/(2*d),p=l*Math.asin(h/f)/ge;return[f*Math.sin(p),c*(1+u*o)+f*(1-Math.cos(p))]}return arguments.length<8&&(o=0),l.invert=function(l,u){var h,d,f=ge*l/t,p=u,v=50;do{var g=p*p,m=t+g*(e+g*(n+g*i)),b=p*(r-1+g*(a-o+g*s)),_=m*m+b*b,y=2*b,M=_/y,w=M*M,x=Math.asin(m/M)/ge,S=f*x;if(xB2=m*m,dxBd=(2*e+g*(4*n+6*g*i))*p,dyBd=r+g*(3*a+5*g*s),dpd=2*(m*dxBd+b*(dyBd-1)),dqd=2*(dyBd-1),dmd=(dpd*y-_*dqd)/(y*y),cos=Math.cos(S),sin=Math.sin(S),mcos=M*cos,msin=M*sin,dd=f/ge*(1/c(1-xB2/w))*(dxBd*M-m*dmd)/w,fx=msin-l,fy=p*(1+g*o)+M-mcos-u,x=dmd*sin+mcos*dd,x=mcos*x,y=1+dmd-(dmd*cos-msin*dd),y=msin*x,denominator=x*y-y*x,!denominator)break;f-=h=(fy*x-fx*y)/denominator,p-=d=(fx*y-fy*x)/denominator}while((Math.abs(h)>pe||Math.abs(d)>pe)&&--v>0);return[f,p]},l}function et(t,e){var n=t*t,i=e*e;return[t*(1-.162388*i)*(.87-952426e-9*n*n),e*(1+i/12)]}function nt(t){function e(){var t=!1,e=we(n),i=e(t);return i.quincuncial=function(n){return arguments.length?e(t=!!n):t},i}function n(e){var n=e?function(e,n){var r=Math.abs(e)<me,a=t(r?e:e>0?e-ge:e+ge,n),o=(a[0]-a[1])*Math.SQRT1_2,l=(a[0]+a[1])*Math.SQRT1_2;if(r)return[o,l];var c=i*Math.SQRT1_2,u=o>0^l>0?-1:1;return[u*o-s(l)*c,u*l-s(o)*c]}:function(e,n){var r=e>0?-.5:.5,a=t(e+r*ge,n);return a[0]-=r*i,a};return t.invert&&(n.invert=e?function(e,n){var r=(e+n)*Math.SQRT1_2,a=(n-e)*Math.SQRT1_2,s=Math.abs(r)<.5*i&&Math.abs(a)<.5*i;if(!s){var o=i*Math.SQRT1_2,l=r>0^a>0?-1:1,c=-l*(e+(a>0?1:-1)*o),u=-l*(n+(r>0?1:-1)*o);r=(-c-u)*Math.SQRT1_2,a=(c-u)*Math.SQRT1_2}var h=t.invert(r,a);return s||(h[0]+=r>0?ge:-ge),h}:function(e,n){var r=e>0?-.5:.5,a=t.invert(e+r*i,n),s=a[0]-r*ge;return s<-ge?s+=2*ge:s>ge&&(s-=2*ge),a[0]=s,a}),n}var i=t(me,0)[0]-t(-me,0)[0];return e.raw=n,e}function it(t,e){var n=s(t),i=s(e),r=Math.cos(e),a=Math.cos(t)*r,l=Math.sin(t)*r,c=Math.sin(i*e);t=Math.abs(Math.atan2(l,c)),e=o(a),Math.abs(t-me)>pe&&(t%=me);var u=rt(t>ge/4?me-t:t,e);return t>ge/4&&(c=u[0],u[0]=-u[1],u[1]=-c),u[0]*=n,u[1]*=-i,u}function rt(t,e){if(e===me)return[0,0];var n=Math.sin(e),i=n*n,r=i*i,a=1+r,s=1+3*r,l=1-r,u=o(1/Math.sqrt(a)),h=l+i*a*u,d=(1-n)/h,f=Math.sqrt(d),p=d*a,v=Math.sqrt(p),g=f*l;if(0===t)return[0,-(g+i*v)];var m=Math.cos(e),b=1/m,_=2*n*m,y=(-3*i+u*s)*_,M=(-h*m-(1-n)*y)/(h*h),w=.5*M/f,x=l*w-2*i*f*_,S=i*a*M+d*s*_,z=-b*_,O=-b*S,E=-2*b*x,k=4*t/ge;if(t>.222*ge||e<ge/4&&t>.175*ge){var T=(g+i*c(p*(1+r)-g*g))/(1+r);if(t>ge/4)return[T,T];var P=T,D=.5*T,L=50;T=.5*(D+P);do{var C=Math.sqrt(p-T*T),A=T*(E+z*C)+O*o(T/v)-k;if(!A)break;A<0?D=T:P=T,T=.5*(D+P)}while(Math.abs(P-D)>pe&&--L>0)}else{var I,T=pe,L=25;do{var R=T*T,C=c(p-R),j=E+z*C,A=T*j+O*o(T/v)-k,N=j+(O-z*R)/C;T-=I=C?A/N:0}while(Math.abs(I)>pe&&--L>0)}return[T,-g-i*c(p-T*T)]}function at(t,e){for(var n=0,i=1,r=.5,a=50;;){var s=r*r,o=Math.sqrt(r),l=Math.asin(1/Math.sqrt(1+s)),c=1-s+r*(1+s)*l,u=(1-o)/c,h=Math.sqrt(u),d=u*(1+s),f=h*(1-s),p=d-t*t,v=Math.sqrt(p),g=e+f+r*v;if(Math.abs(i-n)<ve||0==--a||0===g)break;g>0?n=r:i=r,r=.5*(n+i)}if(!a)return null;var m=Math.asin(o),b=Math.cos(m),_=1/b,y=2*o*b,M=(-3*r+l*(1+3*s))*y,w=(-c*b-(1-o)*M)/(c*c);return[ge/4*(t*(-2*_*(.5*w/h*(1-s)-2*r*h*y)+-_*y*v)+-_*(r*(1+s)*w+u*(1+3*s)*y)*Math.asin(t/Math.sqrt(d))),m]}function st(t,e,n){if(!t){var i=ot(e,1-n);return[[0,i[0]/i[1]],[1/i[1],0],[i[2]/i[1],0]]}var r=ot(t,n);if(!e)return[[r[0],0],[r[1],0],[r[2],0]];var i=ot(e,1-n),a=i[1]*i[1]+n*r[0]*r[0]*i[0]*i[0];return[[r[0]*i[2]/a,r[1]*r[2]*i[0]*i[1]/a],[r[1]*i[1]/a,-r[0]*r[2]*i[0]*i[2]/a],[r[2]*i[1]*i[2]/a,-n*r[0]*r[1]*i[0]/a]]}function ot(t,e){var n,i,r,a,s;if(e<pe)return a=Math.sin(t),i=Math.cos(t),n=.25*e*(t-a*i),[a-n*i,i+n*a,1-.5*e*a*a,t-n];if(e>=1-pe)return n=.25*(1-e),i=m(t),a=v(t),r=1/i,s=i*g(t),[a+n*(s-t)/(i*i),r-n*a*r*(s-t),r+n*a*r*(s+t),2*Math.atan(Math.exp(t))-me+n*(s-t)/i];var l=[1,0,0,0,0,0,0,0,0],u=[Math.sqrt(e),0,0,0,0,0,0,0,0],h=0;for(i=Math.sqrt(1-e),s=1;Math.abs(u[h]/l[h])>pe&&h<8;)n=l[h++],u[h]=.5*(n-i),l[h]=.5*(n+i),i=c(n*i),s*=2;r=s*l[h]*t;do{a=u[h]*Math.sin(i=r)/l[h],r=.5*(o(a)+r)}while(--h);return[Math.sin(r),a=Math.cos(r),a/Math.cos(r-i),r]}function lt(t,e,n){var i=Math.abs(t),r=Math.abs(e),a=g(r);if(i){var o=1/Math.sin(i),l=1/(Math.tan(i)*Math.tan(i)),u=-(l+n*a*a*o*o-1+n),h=(n-1)*l,d=.5*(-u+Math.sqrt(u*u-4*h));return[ct(Math.atan(1/Math.sqrt(d)),n)*s(t),ct(Math.atan(c((d/l-1)/n)),1-n)*s(e)]}return[0,ct(Math.atan(a),1-n)*s(e)]}function ct(t,e){if(!e)return t;if(1===e)return Math.log(Math.tan(t/2+ge/4));for(var n=1,i=Math.sqrt(1-e),r=Math.sqrt(e),a=0;Math.abs(r)>pe;a++){if(t%ge){var s=Math.atan(i*Math.tan(t)/n);s<0&&(s+=ge),t+=s+~~(t/ge)*ge}else t+=t;r=(n+i)/2,i=Math.sqrt(n*i),r=((n=r)-i)/2}return t/(Math.pow(2,a)*n)}function ut(t,e){var n=(Math.SQRT2-1)/(Math.SQRT2+1),i=Math.sqrt(1-n*n),r=ct(me,i*i),a=Math.log(Math.tan(ge/4+Math.abs(e)/2)),s=Math.exp(-1*a)/Math.sqrt(n),o=ht(s*Math.cos(-1*t),s*Math.sin(-1*t)),l=lt(o[0],o[1],i*i);return[-l[1],(e>=0?1:-1)*(.5*r-l[0])]}function ht(t,e){var n=t*t,i=e+1,r=1-n-e*e;return[.5*((t>=0?me:-me)-Math.atan2(r,2*t)),-.25*Math.log(r*r+4*n)+.5*Math.log(i*i+n)]}function dt(t,e){var n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function ft(t){function e(t,e){var a=r(t,e);t=a[0],e=a[1];var s=Math.sin(e),o=Math.cos(e),c=Math.cos(t),u=l(n*s+i*o*c),h=Math.sin(u),d=Math.abs(h)>pe?u/h:1;return[d*i*Math.sin(t),(Math.abs(t)>me?d:-d)*(n*o-i*s*c)]}var n=Math.sin(t),i=Math.cos(t),r=pt(t);return r.invert=pt(-t),e.invert=function(t,e){var i=Math.sqrt(t*t+e*e),a=-Math.sin(i),s=Math.cos(i),o=i*s,l=-e*a,u=i*n,h=c(o*o+l*l-u*u),d=Math.atan2(o*u+l*h,l*u-o*h),f=(i>me?-1:1)*Math.atan2(t*a,i*Math.cos(d)*s+e*Math.sin(d)*a);return r.invert(f,d)},e}function pt(t){var e=Math.sin(t),n=Math.cos(t);return function(t,i){var r=Math.cos(i),a=Math.cos(t)*r,s=Math.sin(t)*r,l=Math.sin(i);return[Math.atan2(s,a*n-l*e),o(l*n+a*e)]}}function vt(){var t=0,e=we(ft),n=e(t),i=n.rotate,r=n.stream,a=d3.geoCircle();return n.parallel=function(i){if(!arguments.length)return t/ge*180;var r=n.rotate();return e(t=i*ge/180).rotate(r)},n.rotate=function(e){return arguments.length?(i.call(n,[e[0],e[1]-t/ge*180]),a.center([-e[0],-e[1]]),n):(e=i.call(n),e[1]+=t/ge*180,e)},n.stream=function(t){return t=r(t),t.sphere=function(){t.polygonStart();var e,n=a.radius(89.99)().coordinates[0],i=n.length-1,r=-1;for(t.lineStart();++r<i;)t.point((e=n[r])[0],e[1]);for(t.lineEnd(),n=a.radius(90.01)().coordinates[0],i=n.length-1,t.lineStart();--r>=0;)t.point((e=n[r])[0],e[1]);t.lineEnd(),t.polygonEnd()},t},n}function gt(t,e){function n(n,i){var r=Ie(n/e,i);return r[0]*=t,r}return arguments.length<2&&(e=t),1===e?Ie:e===1/0?bt:(n.invert=function(n,i){var r=Ie.invert(n/t,i);return r[0]*=e,r},n)}function mt(){var t=2,e=we(gt),n=e(t);return n.coefficient=function(n){return arguments.length?e(t=+n):t},n}function bt(t,e){return[t*Math.cos(e)/Math.cos(e/=2),2*Math.sin(e)]}function _t(t,e){for(var n,i=Math.sin(e)*(e<0?2.43763:2.67595),r=0;r<20&&(e-=n=(e+Math.sin(e)-i)/(1+Math.cos(e)),!(Math.abs(n)<pe));r++);return[.85*t*Math.cos(e*=.5),Math.sin(e)*(e<0?1.93052:1.75859)]}function yt(t){function e(e,u){var h,d=Math.abs(u);if(d>i){var f=Math.min(t-1,Math.max(0,Math.floor((e+ge)/c)));e+=ge*(t-1)/t-f*c,h=d3.geoCollignon.raw(e,d),h[0]=h[0]*r/a-r*(t-1)/(2*t)+f*r/t,h[1]=s+4*(h[1]-o)*l/r,u<0&&(h[1]=-h[1])}else h=n(e,u);return h[0]/=2,h}var n=d3.geoCylindricalEqualArea.raw(0),i=Re*ge/180,r=2*ge,a=d3.geoCollignon.raw(ge,i)[0]-d3.geoCollignon.raw(-ge,i)[0],s=n(0,i)[1],o=d3.geoCollignon.raw(0,i)[1],l=d3.geoCollignon.raw(0,me)[1]-o,c=2*ge/t;return e.invert=function(e,i){e*=2;var u=Math.abs(i);if(u>s){var h=Math.min(t-1,Math.max(0,Math.floor((e+ge)/c)));e=(e+ge*(t-1)/t-h*c)*a/r;var d=d3.geoCollignon.raw.invert(e,.25*(u-s)*r/l+o);return d[0]-=ge*(t-1)/t-h*c,i<0&&(d[1]=-d[1]),d}return n.invert(e,i)},e}function Mt(){function t(){var t=180/e;return{type:"Polygon",coordinates:[d3.range(-180,180+t/2,t).map(function(t,e){return[t,1&e?90-1e-6:Re]}).concat(d3.range(180,-180-t/2,-t).map(function(t,e){return[t,1&e?1e-6-90:-Re]}))]}}var e=2,n=we(yt),i=n(e),r=i.stream;return i.lobes=function(t){return arguments.length?n(e=+t):e},i.stream=function(e){var n=i.rotate(),a=r(e),s=(i.rotate([0,0]),r(e));return i.rotate(n),a.sphere=function(){d3.geoStream(t(),s)},a},i}function wt(t){function e(e,r){var o,l,d=1-Math.sin(r);if(d&&d<2){var f,p=me-r,v=25;do{var g=Math.sin(p),m=Math.cos(p),b=a+Math.atan2(g,i-m),_=1+h-2*i*m;p-=f=(p-u*a-i*g+_*b-.5*d*n)/(2*i*g*b)}while(Math.abs(f)>ve&&--v>0);o=s*Math.sqrt(_),l=e*b/ge}else o=s*(t+d),l=e*a/ge;return[o*Math.sin(l),c-o*Math.cos(l)]}var n,i=1+t,r=Math.sin(1/i),a=o(r),s=2*Math.sqrt(ge/(n=ge+4*a*i)),c=.5*s*(i+Math.sqrt(t*(2+t))),u=t*t,h=i*i;return e.invert=function(t,e){var r=t*t+(e-=c)*e,d=(1+h-r/(s*s))/(2*i),f=l(d),p=Math.sin(f),v=a+Math.atan2(p,i-d);return[o(t/Math.sqrt(r))*ge/v,o(1-2*(f-u*a-i*p+(1+h-2*i*d)*v)/n)]},e}function xt(){var t=1,e=we(wt),n=e(t);return n.ratio=function(n){return arguments.length?e(t=+n):t},n}function St(t,e){return e>-je?(t=Oe(t,e),t[1]+=Ne,t):k(t,e)}function zt(t,e){return Math.abs(e)>je?(t=Oe(t,e),t[1]-=e>0?Ne:-Ne,t):k(t,e)}function Ot(t,e){return[3*t/(2*ge)*Math.sqrt(ge*ge/3-e*e),e]}function Et(t){function e(e,n){if(Math.abs(Math.abs(n)-me)<pe)return[0,n<0?-2:2];var i=Math.sin(n),r=Math.pow((1+i)/(1-i),t/2),a=.5*(r+1/r)+Math.cos(e*=t);return[2*Math.sin(e)/a,(r-1/r)/a]}return e.invert=function(e,n){var i=Math.abs(n);if(Math.abs(i-2)<pe)return e?null:[0,s(n)*me];if(i>2)return null;e/=2,n/=2;var r=e*e,a=n*n,l=2*n/(1+r+a);return l=Math.pow((1+l)/(1-l),1/t),[Math.atan2(2*e,1-r-a)/t,o((l-1)/(l+1))]},e}function kt(){var t=.5,e=we(Et),n=e(t);return n.spacing=function(n){return arguments.length?e(t=+n):t},n}function Tt(t,e){return[t*(1+Math.sqrt(Math.cos(e)))/2,e/(Math.cos(e/2)*Math.cos(t/6))]}function Pt(t,e){var n=t*t,i=e*e;return[t*(.975534+i*(-.0143059*n-.119161+-.0547009*i)),e*(1.00384+n*(.0802894+-.02855*i+199025e-9*n)+i*(.0998909+-.0491032*i))]}function Dt(t,e){return[Math.sin(t)/Math.cos(e),Math.tan(e)*Math.cos(t)]}function Lt(t){function e(e,r){var a=r-t,s=Math.abs(a)<pe?e*n:Math.abs(s=ge/4+r/2)<pe||Math.abs(Math.abs(s)-me)<pe?0:e*a/Math.log(Math.tan(s)/i);return[s,a]}var n=Math.cos(t),i=Math.tan(ge/4+t/2);return e.invert=function(e,r){var a,s=r+t;return[Math.abs(r)<pe?e/n:Math.abs(a=ge/4+s/2)<pe||Math.abs(Math.abs(a)-me)<pe?0:e*Math.log(Math.tan(a)/i)/r,s]},e}function Ct(t,e){return[t,1.25*Math.log(Math.tan(ge/4+.4*e))]}function At(t){function e(e,i){for(var r,a=Math.cos(i),s=2/(1+a*Math.cos(e)),o=s*a*Math.sin(e),l=s*Math.sin(i),c=n,u=t[c],h=u[0],d=u[1];--c>=0;)u=t[c],h=u[0]+o*(r=h)-l*d,d=u[1]+o*d+l*r;return h=o*(r=h)-l*d,d=o*d+l*r,[h,d]}var n=t.length-1;return e.invert=function(e,i){var r=20,a=e,s=i;do{for(var l,c=n,u=t[c],h=u[0],d=u[1],f=0,p=0;--c>=0;)u=t[c],f=h+a*(l=f)-s*p,p=d+a*p+s*l,h=u[0]+a*(l=h)-s*d,d=u[1]+a*d+s*l;f=h+a*(l=f)-s*p,p=d+a*p+s*l,h=a*(l=h)-s*d-e,d=a*d+s*l-i;var v,g,m=f*f+p*p;a-=v=(h*f+d*p)/m,s-=g=(d*f-h*p)/m}while(Math.abs(v)+Math.abs(g)>pe*pe&&--r>0);if(r){var b=Math.sqrt(a*a+s*s),_=2*Math.atan(.5*b),y=Math.sin(_);return[Math.atan2(a*y,b*Math.cos(_)),b?o(s*y/b):0]}},e}function It(){var t=qe.miller,e=we(At),n=e(t);return n.coefficients=function(n){return arguments.length?e(t="string"==typeof n?qe[n]:n):t},n}function Rt(t,e){var n=Math.sqrt(6),i=Math.sqrt(7),r=Math.asin(7*Math.sin(e)/(3*n));return[n*t*(2*Math.cos(2*r/3)-1)/i,9*Math.sin(r/3)/i]}function jt(t,e){for(var n,i=(1+Math.SQRT1_2)*Math.sin(e),r=e,a=0;a<25&&(r-=n=(Math.sin(r/2)+Math.sin(r)-i)/(.5*Math.cos(r/2)+Math.cos(r)),!(Math.abs(n)<pe));a++);return[t*(1+2*Math.cos(r)/Math.cos(r/2))/(3*Math.SQRT2),2*Math.sqrt(3)*Math.sin(r/2)/Math.sqrt(2+Math.SQRT2)]}function Nt(t,e){for(var n,i=Math.sqrt(6/(4+ge)),r=(1+ge/4)*Math.sin(e),a=e/2,s=0;s<25&&(a-=n=(a/2+Math.sin(a)-r)/(.5+Math.cos(a)),!(Math.abs(n)<pe));s++);return[i*(.5+Math.cos(a))*t/1.5,i*a]}function qt(t,e){var n=e*e,i=n*n;return[t*(.8707-.131979*n+i*(i*(.003971*n-.001529*i)-.013791)),e*(1.007226+n*(.015085+i*(.028874*n-.044475-.005916*i)))]}function Ft(t,e){return[t*(1+Math.cos(e))/2,2*(e-Math.tan(e/2))]}function Ht(t,e){var n=e*e;return[t,e*(Fe+n*n*(He+n*(Be+Ve*n)))]}function Bt(t,e){if(Math.abs(e)<pe)return[t,0];var n=Math.tan(e),i=t*Math.sin(e);return[Math.sin(i)/n,e+(1-Math.cos(i))/n]}function Vt(t){function e(e,i){var r=n?Math.tan(e*n/2)/n:e/2;if(!i)return[2*r,-t];var a=2*Math.atan(r*Math.sin(i)),s=1/Math.tan(i);return[Math.sin(a)*s,i+(1-Math.cos(a))*s-t]}var n=Math.sin(t);return e.invert=function(e,i){if(Math.abs(i+=t)<pe)return[n?2*Math.atan(n*e/2)/n:e,0];var r,a=e*e+i*i,s=0,c=10;do{var u=Math.tan(s),h=1/Math.cos(s),d=a-2*i*s+s*s;s-=r=(u*d+2*(s-i))/(2+d*h*h+2*(s-i)*u)}while(Math.abs(r)>pe&&--c>0);var f=e*(u=Math.tan(s)),p=Math.tan(Math.abs(i)<Math.abs(s+1/u)?.5*o(f):.5*l(f)+ge/4)/Math.sin(s);return[n?2*Math.atan(n*p)/n:2*p,s]},e}function Wt(t,e){var n,i=Math.min(18,36*Math.abs(e)/ge),r=Math.floor(i),a=i-r,s=(n=Ke[r])[0],o=n[1],l=(n=Ke[++r])[0],c=n[1],u=(n=Ke[Math.min(19,++r)])[0],h=n[1];return[t*(l+a*(u-s)/2+a*a*(u-2*l+s)/2),(e>0?me:-me)*(c+a*(h-o)/2+a*a*(h-2*c+o)/2)]}function Yt(t){function e(e,n){var i=Math.cos(n),r=(t-1)/(t-i*Math.cos(e));return[r*i*Math.sin(e),r*Math.sin(n)]}return e.invert=function(e,n){var i=e*e+n*n,r=Math.sqrt(i),a=(t-Math.sqrt(1-i*(t+1)/(t-1)))/((t-1)/r+r/(t-1));return[Math.atan2(e*a,r*Math.sqrt(1-a*a)),r?o(n*a/r):0]},e}function Ut(t,e){function n(e,n){var s=i(e,n),o=s[1],l=o*a/(t-1)+r;return[s[0]*r/l,o/l]}var i=Yt(t);if(!e)return i;var r=Math.cos(e),a=Math.sin(e);return n.invert=function(e,n){var s=(t-1)/(t-1-n*a);return i.invert(s*e,s*n*r)},n}function Gt(){var t=1.4,e=0,n=we(Ut),i=n(t,e);return i.distance=function(i){return arguments.length?n(t=+i,e):t},i.tilt=function(i){return arguments.length?n(t,e=i*ge/180):180*e/ge},i}function Xt(t,e){var n=Math.tan(e/2),i=Math.sin(ge/4*n);return[t*(.74482-.34588*i*i),1.70711*n]}function Kt(t){function e(e,a){var s=l(Math.cos(a)*Math.cos(e-n)),o=l(Math.cos(a)*Math.cos(e-i)),u=a<0?-1:1;return s*=s,o*=o,[(s-o)/(2*t),u*c(4*r*o-(r-s+o)*(r-s+o))/(2*t)]}if(!t)return d3.geoAzimuthalEquidistant.raw;var n=-t/2,i=-n,r=t*t,a=Math.tan(i),s=.5/Math.sin(i);return e.invert=function(t,e){var r,o,c=e*e,u=Math.cos(Math.sqrt(c+(r=t+n)*r)),h=Math.cos(Math.sqrt(c+(r=t+i)*r));return[Math.atan2(o=u-h,r=(u+h)*a),(e<0?-1:1)*l(Math.sqrt(r*r+o*o)*s)]},e}function Qt(){var t=[[0,0],[0,0]],e=we(Kt),n=e(0),i=n.rotate;return delete n.rotate,n.points=function(n){if(!arguments.length)return t;t=n;var r=d3.geoInterpolate(n[0],n[1]),a=r(.5),s=d3.geoRotation([-a[0],-a[1]])(n[0]),l=.5*r.distance,c=-o(Math.sin(s[1]*_e)/Math.sin(l));return s[0]>0&&(c=ge-c),i.call(s,[-a[0],-a[1],-c*ye]),e(2*l)},n}function $t(t){function e(t,e){var i=d3.geoGnomonic.raw(t,e);return i[0]*=n,i}var n=Math.cos(t);return e.invert=function(t,e){return d3.geoGnomonic.raw.invert(t/n,e)},e}function Jt(){var t=[[0,0],[0,0]],e=we($t),n=e(0),i=n.rotate;return delete n.rotate,n.points=function(n){if(!arguments.length)return t;t=n;var r=d3.geoInterpolate(n[0],n[1]),a=r(.5),s=d3.geoRotation([-a[0],-a[1]])(n[0]),l=.5*r.distance,c=-o(Math.sin(s[1]*_e)/Math.sin(l));return s[0]>0&&(c=ge-c),i.call(s,[-a[0],-a[1],-c*ye]),e(l)},n}function Zt(t,e){if(Math.abs(e)<pe)return[t,0];var n=Math.abs(e/me),i=o(n);if(Math.abs(t)<pe||Math.abs(Math.abs(e)-me)<pe)return[0,s(e)*ge*Math.tan(i/2)];var r=Math.cos(i),a=Math.abs(ge/t-t/ge)/2,l=a*a,c=r/(n+r-1),u=c*(2/n-1),h=u*u,d=h+l,f=c-h,p=l+c;return[s(t)*ge*(a*f+Math.sqrt(l*f*f-d*(c*c-h)))/d,s(e)*ge*(u*p-a*Math.sqrt((l+1)*d-p*p))/d]}function te(t,e){if(Math.abs(e)<pe)return[t,0];var n=Math.abs(e/me),i=o(n);if(Math.abs(t)<pe||Math.abs(Math.abs(e)-me)<pe)return[0,s(e)*ge*Math.tan(i/2)];var r=Math.cos(i),a=Math.abs(ge/t-t/ge)/2,l=a*a,u=r*(Math.sqrt(1+l)-a*r)/(1+l*n*n);return[s(t)*ge*u,s(e)*ge*c(1-u*(2*a+u))]}function ee(t,e){if(Math.abs(e)<pe)return[t,0];var n=e/me,i=o(n);if(Math.abs(t)<pe||Math.abs(Math.abs(e)-me)<pe)return[0,ge*Math.tan(i/2)];var r=(ge/t-t/ge)/2,a=n/(1+Math.cos(i));return[ge*(s(t)*c(r*r+1-a*a)-r),ge*a]}function ne(t,e){if(!e)return[t,0];var n=Math.abs(e);if(!t||n===me)return[0,e];var i=n/me,r=i*i,a=(8*i-r*(r+2)-5)/(2*r*(i-1)),o=a*a,l=i*a,u=r+o+2*l,h=i+3*a,d=t/me,f=d+1/d,p=s(Math.abs(t)-me)*Math.sqrt(f*f-4),v=p*p,g=u*(r+o*v-1)+(1-r)*(r*(h*h+4*o)+12*l*o+4*o*o),m=(p*(u+o-1)+2*c(g))/(4*u+v);return[s(t)*me*m,s(e)*me*c(1+p*Math.abs(m)-m*m)]}function ie(t,e){return[t*Math.sqrt(1-3*e*e/(ge*ge)),e]}function re(t,e){var n=.90631*Math.sin(e),i=Math.sqrt(1-n*n),r=Math.sqrt(2/(1+i*Math.cos(t/=3)));return[2.66723*i*r*Math.sin(t),1.24104*n*r]}function ae(t,e){var n=Math.cos(e),i=Math.cos(t)*n,r=1-i,a=Math.cos(t=Math.atan2(Math.sin(t)*n,-Math.sin(e))),s=Math.sin(t);return n=c(1-i*i),[s*n-a*r,-a*n-s*r]}function se(t,e){var n=d(t,e);return[(n[0]+t/me)/2,(n[1]+e)/2]}d3.geoProject=function(t,n){var i=n.stream;if(!i)throw new Error("not yet supported");return(t&&oe.hasOwnProperty(t.type)?oe[t.type]:e)(t,i)};var oe={Feature:t,FeatureCollection:function(e,n){return{type:"FeatureCollection",features:e.features.map(function(e){return t(e,n)})}}},le=[],ce=[],ue={point:function(t,e){le.push([t,e])},result:function(){var t=le.length?le.length<2?{type:"Point",coordinates:le[0]}:{type:"MultiPoint",coordinates:le}:null;return le=[],t}},he={lineStart:n,point:function(t,e){le.push([t,e])},lineEnd:function(){le.length&&(ce.push(le),le=[])},result:function(){var t=ce.length?ce.length<2?{type:"LineString",coordinates:ce[0]}:{type:"MultiLineString",coordinates:ce}:null;return ce=[],t}},de={polygonStart:n,lineStart:n,point:function(t,e){le.push([t,e])},lineEnd:function(){var t=le.length;if(t){do{le.push(le[0].slice())}while(++t<4);ce.push(le),le=[]}},polygonEnd:n,result:function(){if(!ce.length)return null;var t=[],e=[];return ce.forEach(function(n){i(n)?t.push([n]):e.push(n)}),e.forEach(function(e){var n=e[0];t.some(function(t){return!!r(t[0],n)&&(t.push(e),!0)})||t.push([e])}),ce=[],t.length?t.length>1?{type:"MultiPolygon",coordinates:t}:{type:"Polygon",coordinates:t[0]}:null}},fe={Point:ue,MultiPoint:ue,LineString:he,MultiLineString:he,Polygon:de,MultiPolygon:de,Sphere:de},pe=1e-6,ve=pe*pe,ge=Math.PI,me=ge/2,be=Math.sqrt(ge),_e=ge/180,ye=180/ge,Me=d3.geoProjection,we=d3.geoProjectionMutator;d3.geoInterrupt=function(t){function e(e,n){for(var i=n<0?-1:1,r=o[+(n<0)],a=0,s=r.length-1;a<s&&e>r[a][2][0];++a);var l=t(e-r[a][1][0],n);return l[0]+=t(r[a][1][0],i*n>i*r[a][0][1]?r[a][0][1]:n)[0],l}function n(){s=o.map(function(e){return e.map(function(e){var n,i=t(e[0][0],e[0][1])[0],r=t(e[2][0],e[2][1])[0],a=t(e[1][0],e[0][1])[1],s=t(e[1][0],e[1][1])[1];return a>s&&(n=a,a=s,s=n),[[i,a],[r,s]]})})}function i(){for(var t=1e-6,e=[],n=0,i=o[0].length;n<i;++n){var a=o[0][n],s=180*a[0][0]/ge,l=180*a[0][1]/ge,c=180*a[1][1]/ge,u=180*a[2][0]/ge,h=180*a[2][1]/ge;e.push(r([[s+t,l+t],[s+t,c-t],[u-t,c-t],[u-t,h+t]],30))}for(var n=o[1].length-1;n>=0;--n){var a=o[1][n],s=180*a[0][0]/ge,l=180*a[0][1]/ge,c=180*a[1][1]/ge,u=180*a[2][0]/ge,h=180*a[2][1]/ge;e.push(r([[u-t,h-t],[u-t,c+t],[s+t,c+t],[s+t,l-t]],30))}return{type:"Polygon",coordinates:[d3.merge(e)]}}function r(t,e){for(var n,i,r,a=-1,s=t.length,o=t[0],l=[];++a<s;){n=t[a],i=(n[0]-o[0])/e,r=(n[1]-o[1])/e;for(var c=0;c<e;++c)l.push([o[0]+c*i,o[1]+c*r]);o=n}return l.push(n),l}function a(t,e){return Math.abs(t[0]-e[0])<pe&&Math.abs(t[1]-e[1])<pe}var s,o=[[[[-ge,0],[0,me],[ge,0]]],[[[-ge,0],[0,-me],[ge,0]]]];t.invert&&(e.invert=function(n,i){for(var r=s[+(i<0)],l=o[+(i<0)],c=0,u=r.length;c<u;++c){var h=r[c];if(h[0][0]<=n&&n<h[1][0]&&h[0][1]<=i&&i<h[1][1]){var d=t.invert(n-t(l[c][1][0],0)[0],i);return d[0]+=l[c][1][0],a(e(d[0],d[1]),[n,i])?d:null}}});var l=d3.geoProjection(e),c=l.stream;return l.stream=function(t){var e=l.rotate(),n=c(t),r=(l.rotate([0,0]),c(t));return l.rotate(e),n.sphere=function(){d3.geoStream(i(),r)},n},l.lobes=function(t){return arguments.length?(o=t.map(function(t){return t.map(function(t){return[[t[0][0]*ge/180,t[0][1]*ge/180],[t[1][0]*ge/180,t[1][1]*ge/180],[t[2][0]*ge/180,t[2][1]*ge/180]]})}),n(),l):o.map(function(t){return t.map(function(t){return[[180*t[0][0]/ge,180*t[0][1]/ge],[180*t[1][0]/ge,180*t[1][1]/ge],[180*t[2][0]/ge,180*t[2][1]/ge]]})})},l},(d3.geoAiry=h).raw=u,d.invert=function(t,e){if(!(t*t+4*e*e>ge*ge+pe)){var n=t,i=e,r=25;do{var a,s=Math.sin(n),o=Math.sin(n/2),c=Math.cos(n/2),u=Math.sin(i),h=Math.cos(i),d=Math.sin(2*i),f=u*u,p=h*h,v=o*o,g=1-p*c*c,m=g?l(h*c)*Math.sqrt(a=1/g):a=0,b=2*m*h*o-t,_=m*u-e,y=a*(p*v+m*h*c*f),M=a*(.5*s*d-2*m*u*o),w=.25*a*(d*o-m*u*p*s),x=a*(f*c+m*v*h),S=M*w-x*y;if(!S)break;var z=(_*M-b*x)/S,O=(b*w-_*y)/S;n-=z,i-=O}while((Math.abs(z)>pe||Math.abs(O)>pe)&&--r>0);return[n,i]}},(d3.geoAitoff=function(){return Me(d)}).raw=d,(d3.geoArmadillo=p).raw=f,y.invert=function(t,e){if(t*=3/8,e*=3/8,!t&&Math.abs(e)>1)return null;var n=t*t,i=e*e,r=1+n+i,a=Math.sqrt(.5*(r-Math.sqrt(r*r-4*e*e))),l=o(a)/3,c=a?_(Math.abs(e/a))/3:b(Math.abs(t))/3,u=Math.cos(l),h=m(c),d=h*h-u*u;return[2*s(t)*Math.atan2(g(c)*u,.25-d),2*s(e)*Math.atan2(h*Math.sin(l),.25+d)]},(d3.geoAugust=function(){return Me(y)}).raw=y;var xe=Math.log(1+Math.SQRT2);M.invert=function(t,e){if((i=Math.abs(e))<xe)return[t,2*Math.atan(Math.exp(e))-me];var n,i,r=Math.sqrt(8),a=ge/4,o=25;do{var l=Math.cos(a/2),c=Math.tan(a/2);a-=n=(r*(a-ge/4)-Math.log(c)-i)/(r-.5*l*l/c)}while(Math.abs(n)>ve&&--o>0);return[t/(Math.cos(a)*(r-1/Math.sin(a))),s(e)*a]},(d3.geoBaker=function(){return Me(M)}).raw=M;var Se=d3.geoAzimuthalEquidistant.raw;(d3.geoBerghaus=x).raw=w;var ze=S(ge),Oe=z(Math.SQRT2/me,Math.SQRT2,ge);(d3.geoMollweide=function(){return Me(Oe)}).raw=Oe,O.invert=function(t,e){var n,i,r=2.00276,a=r*e,s=e<0?-ge/4:ge/4,o=25;do{i=a-Math.SQRT2*Math.sin(s),s-=n=(Math.sin(2*s)+2*s-ge*Math.sin(i))/(2*Math.cos(2*s)+2+ge*Math.cos(i)*Math.SQRT2*Math.cos(s))}while(Math.abs(n)>pe&&--o>0);return i=a-Math.SQRT2*Math.sin(s),[t*(1/Math.cos(i)+1.11072/Math.cos(s))/r,i]},(d3.geoBoggs=function(){return Me(O)}).raw=O,k.invert=function(t,e){return[t/Math.cos(e),e]},(d3.geoSinusoidal=function(){return Me(k)}).raw=k,(d3.geoBonne=function(){return E(T).parallel(45)}).raw=T;var Ee=z(1,4/ge,ge);(d3.geoBromley=function(){return Me(Ee)}).raw=Ee,(d3.geoChamberlin=D).raw=P,R.invert=function(t,e){var n=(n=e/be-1)*n;return[n>0?t*Math.sqrt(ge/n)/2:0,o(1-n)]},(d3.geoCollignon=function(){return Me(R)}).raw=R,(d3.geoCraig=function(){return E(j)}).raw=j,N.invert=function(t,e){var n=Math.sqrt(3),i=3*o(e/(n*be));return[be*t/(n*(2*Math.cos(2*i/3)-1)),i]},(d3.geoCraster=function(){return Me(N)}).raw=N,(d3.geoCylindricalEqualArea=function(){return E(q)}).raw=q,(d3.geoCylindricalStereographic=function(){return E(F)}).raw=F,H.invert=function(t,e){var n=Math.sqrt(8/(3*ge)),i=e/n;return[t/(n*(1-Math.abs(i)/ge)),i]},(d3.geoEckert1=function(){return Me(H)}).raw=H,B.invert=function(t,e){var n=2-Math.abs(e)/Math.sqrt(2*ge/3);return[t*Math.sqrt(6*ge)/(2*n),s(e)*o((4-n*n)/3)]},(d3.geoEckert2=function(){return Me(B)}).raw=B,V.invert=function(t,e){var n=Math.sqrt(ge*(4+ge))/2;return[t*n/(1+c(1-e*e*(4+ge)/(4*ge))),e*n/2]},(d3.geoEckert3=function(){return Me(V)}).raw=V,W.invert=function(t,e){var n=.5*e*Math.sqrt((4+ge)/ge),i=o(n),r=Math.cos(i);return[t/(2/Math.sqrt(ge*(4+ge))*(1+r)),o((i+n*(r+2))/(2+me))]},(d3.geoEckert4=function(){return Me(W)}).raw=W,Y.invert=function(t,e){var n=Math.sqrt(2+ge),i=e*n/2;return[n*t/(1+Math.cos(i)),i]},(d3.geoEckert5=function(){return Me(Y)}).raw=Y,U.invert=function(t,e){var n=1+me,i=Math.sqrt(n/2);return[2*t*i/(1+Math.cos(e*=i)),o((e+Math.sin(e))/n)]},(d3.geoEckert6=function(){return Me(U)}).raw=U,G.invert=function(t,e){var n=d3.geoAugust.raw.invert(t/1.2,1.065*e);if(!n)return null;var i=n[0],r=n[1],a=20;t/=ke,e/=ke;do{var s=i/2,o=r/2,l=Math.sin(s),c=Math.cos(s),u=Math.sin(o),h=Math.cos(o),d=Math.cos(r),f=Math.sqrt(d),p=u/(h+Math.SQRT2*c*f),v=p*p,g=Math.sqrt(2/(1+v)),m=Math.SQRT2*h+(c+l)*f,b=Math.SQRT2*h+(c-l)*f,_=m/b,y=Math.sqrt(_),M=y-1/y,w=y+1/y,x=g*M-2*Math.log(y)-t,S=g*p*w-2*Math.atan(p)-e,z=u&&Math.SQRT1_2*f*l*v/u,O=(Math.SQRT2*c*h+f)/(2*(h+Math.SQRT2*c*f)*(h+Math.SQRT2*c*f)*f),E=-.5*p*g*g*g,k=E*z,T=E*O,P=(P=2*h+Math.SQRT2*f*(c-l))*P*y,D=(Math.SQRT2*c*h*f+d)/P,L=-Math.SQRT2*l*u/(f*P),C=M*k-2*D/y+g*(D+D/_),A=M*T-2*L/y+g*(L+L/_),I=p*w*k-2*z/(1+v)+g*w*z+g*p*(D-D/_),R=p*w*T-2*O/(1+v)+g*w*O+g*p*(L-L/_),j=A*I-R*C;if(!j)break;var N=(S*A-x*R)/j,q=(x*I-S*C)/j;i-=N,r=Math.max(-me,Math.min(me,r-q))}while((Math.abs(N)>pe||Math.abs(q)>pe)&&--a>0);return Math.abs(Math.abs(r)-me)<pe?[0,r]:a&&[i,r]};var ke=3+2*Math.SQRT2;(d3.geoEisenlohr=function(){return Me(G)}).raw=G,X.invert=function(t,e){var n=e/(1+Te);return[t?t/(Te*c(1-n*n)):0,2*Math.atan(n)]};var Te=Math.cos(35*_e);(d3.geoFahey=function(){return Me(X)}).raw=X,K.invert=function(t,e){var n=Math.atan(e/be),i=Math.cos(n),r=2*n;return[t*be*.5/(Math.cos(r)*i*i),r]},(d3.geoFoucaut=function(){return Me(K)}).raw=K,d3.geoGilbert=function(t){function e(e){return t([.5*e[0],o(Math.tan(.5*e[1]*_e))*ye])}var n=d3.geoEquirectangular().scale(ye).translate([0,0]);return t.invert&&(e.invert=function(e){return e=t.invert(e),e[0]*=2,e[1]=2*Math.atan(Math.sin(e[1]*_e))*ye,e}),e.stream=function(e){e=t.stream(e);var i=n.stream({point:function(t,n){e.point(.5*t,o(Math.tan(.5*-n*_e))*ye)},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}});return i.sphere=function(){e.sphere()},i.valid=!1,i},e};var Pe=d3.geoAzimuthalEquidistant.raw;(d3.geoGingery=J).raw=Q;var De=tt(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555);(d3.geoGinzburg4=function(){return Me(De)}).raw=De;var Le=tt(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742);(d3.geoGinzburg5=function(){return Me(Le)}).raw=Le;var Ce=tt(5/6*ge,-.62636,-.0344,0,1.3493,-.05524,0,.045);(d3.geoGinzburg6=function(){return Me(Ce)}).raw=Ce,et.invert=function(t,e){var n,i=t,r=e,a=50;do{var s=r*r;r-=n=(r*(1+s/12)-e)/(1+s/4)}while(Math.abs(n)>pe&&--a>0);a=50,t/=1-.162388*s;do{var o=(o=i*i)*o;i-=n=(i*(.87-952426e-9*o)-t)/(.87-.00476213*o)}while(Math.abs(n)>pe&&--a>0);return[i,r]},(d3.geoGinzburg8=function(){return Me(et)}).raw=et;var Ae=tt(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);(d3.geoGinzburg9=function(){return Me(Ae)}).raw=Ae,it.invert=function(t,e){var n=s(t),i=s(e),r=-n*t,a=-i*e,l=a/r<1,c=at(l?a:r,l?r:a),u=c[0],h=c[1];l&&(u=-me-u);var d=Math.cos(h),t=Math.cos(u)*d,e=Math.sin(u)*d,f=Math.sin(h);return[n*(Math.atan2(e,-f)+ge),i*o(t)]},d3.geoGringorten=nt(it),ut.invert=function(t,e){var n=(Math.SQRT2-1)/(Math.SQRT2+1),i=Math.sqrt(1-n*n),r=ct(me,i*i),a=st(.5*r-e,-t,i*i),s=dt(a[0],a[1]);return[Math.atan2(s[1],s[0])/-1,2*Math.atan(Math.exp(-.5*Math.log(n*s[0]*s[0]+n*s[1]*s[1])))-me]},d3.geoGuyou=nt(ut),(d3.geoHammerRetroazimuthal=vt).raw=ft;var Ie=d3.geoAzimuthalEqualArea.raw;bt.invert=function(t,e){var n=2*o(e/2);return[t*Math.cos(n/2)/Math.cos(n),n]},(d3.geoHammer=mt).raw=gt,_t.invert=function(t,e){var n=Math.abs(n=e*(e<0?.5179951515653813:.5686373742600607))>1-pe?n>0?me:-me:o(n);return[1.1764705882352942*t/Math.cos(n),Math.abs(n=((n+=n)+Math.sin(n))*(e<0?.4102345310814193:.3736990601468637))>1-pe?n>0?me:-me:o(n)]},(d3.geoHatano=function(){return Me(_t)}).raw=_t;var Re=41+48/36+37/3600;(d3.geoHealpix=Mt).raw=yt,(d3.geoHill=xt).raw=wt;var je=.7109889596207567,Ne=.0528035274542;St.invert=function(t,e){return e>-je?Oe.invert(t,e-Ne):k.invert(t,e)},(d3.geoSinuMollweide=function(){return Me(St).rotate([-20,-55])}).raw=St,zt.invert=function(t,e){return Math.abs(e)>je?Oe.invert(t,e+(e>0?Ne:-Ne)):k.invert(t,e)},(d3.geoHomolosine=function(){return Me(zt)}).raw=zt,Ot.invert=function(t,e){return[2/3*ge*t/Math.sqrt(ge*ge/3-e*e),e]},(d3.geoKavrayskiy7=function(){return Me(Ot)}).raw=Ot,(d3.geoLagrange=kt).raw=Et,Tt.invert=function(t,e){var n=Math.abs(t),i=Math.abs(e),r=ge/Math.SQRT2,a=pe,s=me;i<r?s*=i/r:a+=6*l(r/i);for(var o=0;o<25;o++){var u=Math.sin(s),h=c(Math.cos(s)),d=Math.sin(s/2),f=Math.cos(s/2),p=Math.sin(a/6),v=Math.cos(a/6),g=.5*a*(1+h)-n,m=s/(f*v)-i,b=h?-.25*a*u/h:0,_=.5*(1+h),y=(1+.5*s*d/f)/(f*v),M=s/f*(p/6)/(v*v),w=b*M-y*_,x=(g*M-m*_)/w,S=(m*b-g*y)/w;if(s-=x,a-=S,Math.abs(x)<pe&&Math.abs(S)<pe)break}return[t<0?-a:a,e<0?-s:s]},(d3.geoLarrivee=function(){return Me(Tt)}).raw=Tt,Pt.invert=function(t,e){var n=s(t)*ge,i=e/2,r=50;do{var a=n*n,o=i*i,l=n*i,c=n*(.975534+o*(-.0143059*a-.119161+-.0547009*o))-t,u=i*(1.00384+a*(.0802894+-.02855*o+199025e-9*a)+o*(.0998909+-.0491032*o))-e,h=.975534-o*(.119161+3*a*.0143059+.0547009*o),d=-l*(.238322+.2188036*o+.0286118*a),f=l*(.1605788+7961e-7*a+-.0571*o),p=1.00384+a*(.0802894+199025e-9*a)+o*(3*(.0998909-.02855*a)-.245516*o),v=d*f-p*h,g=(u*d-c*p)/v,m=(c*f-u*h)/v;n-=g,i-=m}while((Math.abs(g)>pe||Math.abs(m)>pe)&&--r>0);return r&&[n,i]},(d3.geoLaskowski=function(){return Me(Pt)}).raw=Pt,Dt.invert=function(t,e){var n=t*t,i=e*e,r=i+1,a=t?Math.SQRT1_2*Math.sqrt((r-Math.sqrt(n*n+2*n*(i-1)+r*r))/n+1):1/Math.sqrt(r);return[o(t*a),s(e)*l(a)]},(d3.geoLittrow=function(){return Me(Dt)}).raw=Dt,(d3.geoLoximuthal=function(){return E(Lt).parallel(40)}).raw=Lt,Ct.invert=function(t,e){return[t,2.5*Math.atan(Math.exp(.8*e))-.625*ge]},(d3.geoMiller=function(){return Me(Ct)}).raw=Ct;var qe={alaska:[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],gs48:[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],gs50:[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],miller:[[.9245,0],[0,0],[.01943,0]],lee:[[.721316,0],[0,0],[-.00881625,-.00617325]]};(d3.geoModifiedStereographic=It).raw=At,Rt.invert=function(t,e){var n=Math.sqrt(6),i=Math.sqrt(7),r=3*o(e*i/9);return[t*i/(n*(2*Math.cos(2*r/3)-1)),o(3*Math.sin(r)*n/7)]},(d3.geoMtFlatPolarParabolic=function(){return Me(Rt)}).raw=Rt,jt.invert=function(t,e){var n=e*Math.sqrt(2+Math.SQRT2)/(2*Math.sqrt(3)),i=2*o(n);return[3*Math.SQRT2*t/(1+2*Math.cos(i)/Math.cos(i/2)),o((n+Math.sin(i))/(1+Math.SQRT1_2))]},(d3.geoMtFlatPolarQuartic=function(){return Me(jt)}).raw=jt,Nt.invert=function(t,e){var n=Math.sqrt(6/(4+ge)),i=e/n;return Math.abs(Math.abs(i)-me)<pe&&(i=i<0?-me:me),[1.5*t/(n*(.5+Math.cos(i))),o((i/2+Math.sin(i))/(1+ge/4))]},(d3.geoMtFlatPolarSinusoidal=function(){return Me(Nt)}).raw=Nt,qt.invert=function(t,e){var n,i=e,r=25;do{var a=i*i,s=a*a;i-=n=(i*(1.007226+a*(.015085+s*(.028874*a-.044475-.005916*s)))-e)/(1.007226+a*(.045255+s*(.259866*a-.311325-.005916*11*s)))}while(Math.abs(n)>pe&&--r>0);return[t/(.8707+(a=i*i)*(a*(a*a*a*(.003971-.001529*a)-.013791)-.131979)),i]},(d3.geoNaturalEarth=function(){return Me(qt)}).raw=qt,Ft.invert=function(t,e){for(var n=e/2,i=0,r=1/0;i<10&&Math.abs(r)>pe;i++){var a=Math.cos(e/2);e-=r=(e-Math.tan(e/2)-n)/(1-.5/(a*a))}return[2*t/(1+Math.cos(e)),e]},(d3.geoNellHammer=function(){return Me(Ft)}).raw=Ft;var Fe=1.0148,He=.23185,Be=-.14499,Ve=.02406,We=Fe,Ye=5*He,Ue=7*Be,Ge=9*Ve;Ht.invert=function(t,e){e>1.790857183?e=1.790857183:e<-1.790857183&&(e=-1.790857183);var n,i=e;do{var r=i*i;i-=n=(i*(Fe+r*r*(He+r*(Be+Ve*r)))-e)/(We+r*r*(Ye+r*(Ue+Ge*r)))}while(Math.abs(n)>pe);return[t,i]},(d3.geoPatterson=function(){return Me(Ht)}).raw=Ht;var Xe=nt(ut);(d3.geoPeirceQuincuncial=function(){return Xe().quincuncial(!0).rotate([-90,-90,45]).clipAngle(180-1e-6)}).raw=Xe.raw,Bt.invert=function(t,e){if(Math.abs(e)<pe)return[t,0];var n,i=t*t+e*e,r=.5*e,a=10;do{var c=Math.tan(r),u=1/Math.cos(r),h=i-2*e*r+r*r;r-=n=(c*h+2*(r-e))/(2+h*u*u+2*(r-e)*c)}while(Math.abs(n)>pe&&--a>0);return c=Math.tan(r),[(Math.abs(e)<Math.abs(r+1/c)?o(t*c):s(t)*(l(Math.abs(t*c))+me))/Math.sin(r),r]},(d3.geoPolyconic=function(){return Me(Bt)}).raw=Bt,(d3.geoRectangularPolyconic=function(){return E(Vt)}).raw=Vt;var Ke=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];Ke.forEach(function(t){t[1]*=1.0144}),Wt.invert=function(t,e){var n=e/me,i=90*n,r=Math.min(18,Math.abs(i/5)),a=Math.max(0,Math.floor(r));do{var s=Ke[a][1],o=Ke[a+1][1],l=Ke[Math.min(19,a+2)][1],c=l-s,u=l-2*o+s,h=2*(Math.abs(n)-o)/c,d=u/c,f=h*(1-d*h*(1-2*d*h));if(f>=0||1===a){i=(e>=0?5:-5)*(f+r);var p,v=50;do{r=Math.min(18,Math.abs(i)/5),a=Math.floor(r),f=r-a,s=Ke[a][1],o=Ke[a+1][1],l=Ke[Math.min(19,a+2)][1],i-=(p=(e>=0?me:-me)*(o+f*(l-s)/2+f*f*(l-2*o+s)/2)-e)*ye}while(Math.abs(p)>ve&&--v>0);break}}while(--a>=0);var g=Ke[a][0],m=Ke[a+1][0],b=Ke[Math.min(19,a+2)][0];return[t/(m+f*(b-g)/2+f*f*(b-2*m+g)/2),i*_e]},(d3.geoRobinson=function(){return Me(Wt)}).raw=Wt,(d3.geoSatellite=Gt).raw=Ut,Xt.invert=function(t,e){var n=e/1.70711,i=Math.sin(ge/4*n);return[t/(.74482-.34588*i*i),2*Math.atan(n)]},(d3.geoTimes=function(){return Me(Xt)}).raw=Xt,(d3.geoTwoPointEquidistant=Qt).raw=Kt,(d3.geoTwoPointAzimuthal=Jt).raw=$t,Zt.invert=function(t,e){if(Math.abs(e)<pe)return[t,0];if(Math.abs(t)<pe)return[0,me*Math.sin(2*Math.atan(e/ge))];var n=(t/=ge)*t,i=(e/=ge)*e,r=n+i,a=r*r,o=-Math.abs(e)*(1+r),c=o-2*i+n,u=-2*o+1+2*i+a,h=i/u+(2*c*c*c/(u*u*u)-9*o*c/(u*u))/27,d=(o-c*c/(3*u))/u,f=2*Math.sqrt(-d/3),p=l(3*h/(d*f))/3;return[ge*(r-1+Math.sqrt(1+2*(n-i)+a))/(2*t),s(e)*ge*(-f*Math.cos(p+ge/3)-c/(3*u))]},(d3.geoVanDerGrinten=function(){return Me(Zt)}).raw=Zt,te.invert=function(t,e){if(!t)return[0,me*Math.sin(2*Math.atan(e/ge))];var n=Math.abs(t/ge),i=(1-n*n-(e/=ge)*e)/(2*n),r=i*i,a=Math.sqrt(r+1);return[s(t)*ge*(a-i),s(e)*me*Math.sin(2*Math.atan2(Math.sqrt((1-2*i*n)*(i+a)-n),Math.sqrt(a+i+n)))]},(d3.geoVanDerGrinten2=function(){return Me(te)}).raw=te,ee.invert=function(t,e){if(!e)return[t,0];var n=e/ge,i=(ge*ge*(1-n*n)-t*t)/(2*ge*t);return[t?ge*(s(t)*Math.sqrt(i*i+1)-i):0,me*Math.sin(2*Math.atan(n))]},(d3.geoVanDerGrinten3=function(){return Me(ee)}).raw=ee,ne.invert=function(t,e){if(!t||!e)return[t,e];e/=ge;var n=s(t)*t/me,i=(n*n-1+4*e*e)/Math.abs(n),r=i*i,a=2*e,o=50;do{var l=a*a,c=(8*a-l*(l+2)-5)/(2*l*(a-1)),u=(3*a-l*a-10)/(2*l*a),h=c*c,d=a*c,f=a+c,p=f*f,v=a+3*c,g=p*(l+h*r-1)+(1-l)*(l*(v*v+4*h)+h*(12*d+4*h)),m=-2*f*(4*d*h+(1-4*l+3*l*l)*(1+u)+h*(14*l-6-r+(8*l-8-2*r)*u)+d*(12*l-8+(10*l-10-r)*u)),b=Math.sqrt(g),_=i*(p+h-1)+2*b-n*(4*p+r),y=i*(2*c*u+2*f*(1+u))+m/b-8*f*(i*(-1+h+p)+2*b)*(1+u)/(r+4*p);a-==_/y}while(>pe&&--o>0);return[s(t)*(Math.sqrt(i*i+4)+i)*ge/4,me*a]},(d3.geoVanDerGrinten4=function(){return Me(ne)}).raw=ne;var Qe=function(){var t=4*ge+3*Math.sqrt(3),e=2*Math.sqrt(2*ge*Math.sqrt(3)/t);return z(e*Math.sqrt(3)/ge,e,t/6)}();(d3.geoWagner4=function(){return Me(Qe)}).raw=Qe,ie.invert=function(t,e){return[t/Math.sqrt(1-3*e*e/(ge*ge)),e]},(d3.geoWagner6=function(){return Me(ie)}).raw=ie,re.invert=function(t,e){var n=t/2.66723,i=e/1.24104,r=Math.sqrt(n*n+i*i),a=2*o(r/2);return[3*Math.atan2(t*Math.tan(a),2.66723*r),r&&o(e*Math.sin(a)/(1.24104*.90631*r))]},(d3.geoWagner7=function(){return Me(re)}).raw=re,ae.invert=function(t,e){var n=-.5*(t*t+e*e),i=Math.sqrt(-n*(2+n)),r=e*n+t*i,a=t*n-e*i,s=Math.sqrt(a*a+r*r);return[Math.atan2(i*r,s*(1+n)),s?-o(i*a/s):0]},(d3.geoWiechel=function(){return Me(ae)}).raw=ae,se.invert=function(t,e){var n=t,i=e,r=25;do{var a,s=Math.cos(i),o=Math.sin(i),c=Math.sin(2*i),u=o*o,h=s*s,d=Math.sin(n),f=Math.cos(n/2),p=Math.sin(n/2),v=p*p,g=1-h*f*f,m=g?l(s*f)*Math.sqrt(a=1/g):a=0,b=.5*(2*m*s*p+n/me)-t,_=.5*(m*o+i)-e,y=.5*a*(h*v+m*s*f*u)+.5/me,M=a*(d*c/4-m*o*p),w=.125*a*(c*p-m*o*h*d),x=.5*a*(u*f+m*v*s)+.5,S=M*w-x*y,z=(_*M-b*x)/S,O=(b*w-_*y)/S;n-=z,i-=O}while((Math.abs(z)>pe||Math.abs(O)>pe)&&--r>0);return[n,i]},(d3.geoWinkel3=function(){return Me(se)}).raw=se}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(r),s=n(31),o=i(s),l=n(429),c=i(l),u=n(21),h=function(t){return function(){function e(t,n){return t.each(function(t,e){var i=d3.select(this);i.append("rect").attr("class","vzb-label-glow").attr("filter","url("+location.pathname+"#vzb-glow-filter)"),i.append("rect").attr("class","vzb-label-fill vzb-tooltip-border");var o=i.append("text").attr("class",s+"-label-content stroke");if(i.style("paint-order").length||(i.insert("text","."+s+"-label-content").attr("class",s+"-label-content "+s+"-label-shadow vzb-noexport"),o.classed("stroke",!1)),!n){var l=i.append("g").attr("class",s+"-label-x vzb-transparent");a.setIcon(l,u.close),l.insert("circle","svg"),l.select("svg").attr("class",s+"-label-x-icon").attr("width","0px").attr("height","0px"),l.on("click",function(){d3.event.defaultPrevented||(d3.event.stopPropagation(),r.model.marker.clearHighlighted(),r.model.marker.selectMarker(t))})}}),n||t.call(o).on("mouseover",function(t){if(!a.isTouchDevice()){r.model.marker.highlightMarker(t);var e=r.KEY||r.model.entities.getDimension();r.entityLabels.sort(function(n,i){return n[e]!=t[e]?-1:1}),d3.select(this).selectAll("."+s+"-label-x").classed("vzb-transparent",!1)}}).on("mouseout",function(t){a.isTouchDevice()||(r.model.marker.clearHighlighted(),d3.select(this).selectAll("."+s+"-label-x").classed("vzb-transparent",!0))}).on("click",function(t){if(a.isTouchDevice()){var e=d3.select(this).selectAll("."+s+"-label-x"),n=r.KEY||r.model.entities.getDimension(),i=e.classed("vzb-transparent");i&&(r.entityLabels.sort(function(e,i){return e[n]!=t[n]?-1:1}),r.showCloseCross(null,!1)),e.classed("vzb-transparent",!i),r.options.SUPPRESS_HIGHLIGHT_DURING_PLAY&&r.model.time.playing||(i?r.model.marker.setHighlight(t):r.model.marker.clearHighlighted())}}),e}function n(t,e,n,a,s,o,l,c,u,h,d){var f=n||r.cached[t[r.KEY]],p=d3.select(a),v=!s&&0!==s||!o&&0!==o||!l&&0!==l||!c&&0!==c;if(v)return p.classed("vzb-invisible",v),void d.classed("vzb-invisible",v);var g=r.context.width,m=r.context.height,b=f.rectBBox,_=b.height,y=f.rectOffsetX,M=f.rectOffsetY;s+b.x<=0?(s=-b.x,f.labelX_=(s-r.xScale(f.labelX0))/g):s+y>g&&(s=g-y,f.labelX_=(s-r.xScale(f.labelX0))/g),o+b.y<=0?(o=-b.y,f.labelY_=(o-r.yScale(f.labelY0))/m):o+M>m&&(o=m-M,f.labelY_=(o-r.yScale(f.labelY0))/m),null==u&&(u=r.context.duration),f._new&&(u=0,delete f._new),u?h&&!t.hidden?(p.classed("vzb-invisible",t.hidden),p.attr("transform","translate("+s+","+o+")").style("opacity",0).transition().duration(u).ease(d3.easeExp).style("opacity",1).on("interrupt",function(){p.style("opacity",1)}),d.classed("vzb-invisible",t.hidden),d.attr("transform","translate("+s+","+o+")").style("opacity",0).transition().duration(u).ease(d3.easeExp).style("opacity",1).on("interrupt",function(){d.style("opacity",1)})):h&&t.hidden?(p.style("opacity",1).transition().duration(u).ease(d3.easeExp).style("opacity",0).on("end",function(){p.style("opacity",1).classed("vzb-invisible",t.hidden)}),d.style("opacity",1).transition().duration(u).ease(d3.easeExp).style("opacity",0).on("end",function(){d.style("opacity",1).classed("vzb-invisible",t.hidden)})):(p.transition().duration(u).ease(d3.easeLinear).attr("transform","translate("+s+","+o+")"),d.transition().duration(u).ease(d3.easeLinear).attr("transform","translate("+s+","+o+")")):(p.interrupt().attr("transform","translate("+s+","+o+")").transition(),d.interrupt().attr("transform","translate("+s+","+o+")").transition(),h&&p.classed("vzb-invisible",t.hidden),h&&d.classed("vzb-invisible",t.hidden));var w=l-s,x=c-o,S=p.select("text").node().getBBox(),z=.5*-S.width,O=.2*-_,E=r.model.ui.chart.labels,k=E.removeLabelBox?S:b,T=r.activeProfile.labelLeashCoeff||0,P=i({x:w,y:x,r:f.scaledS0},{x:z,y:O,width:2*k.height*T+k.width,height:k.height*(2*T+1)});if(d.select("line").classed("vzb-invisible",P),!P){if(E.removeLabelBox){var D=180*Math.atan2(w-z,x-O)/Math.PI,L=D>=0&&D<=180?.5*k.width:.5*-k.width,C=Math.abs(D)<=90?.55*k.height:.45*-k.height;z+=Math.abs(w-z)>.5*S.width?L:0,O+=Math.abs(x-O)>.5*S.height?C:.05*S.height}var A=Math.abs(w)>Math.abs(x)?Math.abs(w):Math.abs(x);d.select("line").style("stroke-dasharray","0 "+f.scaledS0+" "+2*~~A),d.selectAll("line").attr("x1",w).attr("y1",x).attr("x2",z).attr("y2",O)}}function i(t,e){var n=Math.abs(t.x-e.x),i=Math.abs(t.y-e.y),r=.5*e.width,a=.5*e.height;return!(n>r+t.r)&&(!(i>a+t.r)&&(n<=r||(i<=a||Math.pow(n-r,2)+Math.pow(i-a,2)<=Math.pow(t.r,2))))}var r=t,s=void 0;e.setCssPrefix=function(t){return s=t,e};var o=d3.drag().on("start",function(t,e){d3.event.sourceEvent.stopPropagation();r.KEY}).on("drag",function(t,n){var i=r.KEY;if(r.model.ui.chart.labels.dragging){this.druging||(r.druging=t[i]);var a=r.cached[t[i]];a.labelFixed=!0;var s=r.context.width,o=r.context.height;a.labelX_+=d3.event.dx/s,a.labelY_+=d3.event.dy/o;var l=r.xScale(a.labelX0)+a.labelX_*s,c=r.yScale(a.labelY0)+a.labelY_*o,u=r.xScale(a.labelX0),h=r.yScale(a.labelY0),d=r.entityLines.filter(function(e){return e[i]==t[i]});e._repositionLabels(t,n,null,this,l,c,u,h,0,null,d)}}).on("end",function(t,e){var n=r.KEY;if(r.druging){var i=r.cached[t[n]];r.druging=null,i.labelOffset[0]=i.labelX_,i.labelOffset[1]=i.labelY_,r.model.marker.setLabelOffset(t,[i.labelX_,i.labelY_])}});return e.line=function(t){t.append("line").attr("class",s+"-label-line")},e._repositionLabels=n,e}()},d={LABELS_CONTAINER_CLASS:"",LINES_CONTAINER_CLASS:"",LINES_CONTAINER_SELECTOR:"",CSS_PREFIX:"",SUPPRESS_HIGHLIGHT_DURING_PLAY:!0},f=o.default.extend({init:function(t,e){this.context=t,this.options=a.extend({},d),this.label=h(this),this._xScale=null,this._yScale=null,this._closeCrossHeight=0,this.labelSizeTextScale=null},ready:function(){this.KEY=this.context.model.entities.getDimension(),this.updateIndicators(),this.updateLabelSizeLimits()},readyOnce:function(){var t=this;this.model=this.context.model,this.model.on("change:marker.select",function(){t.context._readyOnce&&t.selectDataPoints()}),this.model.marker.size_label&&this.model.on("change:marker.size_label.extent",function(e,n){t.context._readyOnce&&(t.updateLabelSizeLimits(),t.model.time.splash||t.updateLabelsOnlyTextSize())}),this.model.ui.chart.labels.hasOwnProperty("removeLabelBox")&&this.model.on("change:ui.chart.labels.removeLabelBox",function(e,n){t.context._readyOnce&&t.updateLabelsOnlyTextSize()}),this.KEY=this.context.model.entities.getDimension(),this.cached={},this.label.setCssPrefix(this.options.CSS_PREFIX),this.rootEl=this.context.root.element instanceof Array?this.context.root.element:d3.select(this.context.root.element),this.labelsContainer=this.rootEl.select("."+this.options.LABELS_CONTAINER_CLASS),this.linesContainer=this.rootEl.select("."+this.options.LINES_CONTAINER_CLASS),this.updateIndicators(),this.updateSize(),this.selectDataPoints(),this._initLabelTooltip()},config:function(t){a.extend(this.options,t)},updateLabelSizeLimits:function(){var t=this;if(this.model.marker.size_label){var e=this.model.marker.size_label.extent||[0,1],n=this.activeProfile.minLabelTextSize,i=this.activeProfile.maxLabelTextSize,r=i-n;this.minLabelTextSize=Math.max(n+r*e[0],n),this.maxLabelTextSize=Math.max(n+r*e[1],n),"constant"==this.model.marker.size_label.use&&(this.minLabelTextSize=this.maxLabelTextSize),"ordinal"!==this.model.marker.size_label.scaleType||"constant"==this.model.marker.size_label.use?this.labelSizeTextScale.range([t.minLabelTextSize,t.maxLabelTextSize]):this.labelSizeTextScale.rangePoints([t.minLabelTextSize,t.maxLabelTextSize],0).range()}},updateIndicators:function(){this.model.marker.size_label&&(this.labelSizeTextScale=this.model.marker.size_label.getScale())},setScales:function(t,e){this._xScale=t,this._yScale=e},setCloseCrossHeight:function(t){this._closeCrossHeight!=t&&(this._closeCrossHeight=t,this.updateLabelCloseGroupSize(this.entityLabels.selectAll("."+this.options.CSS_PREFIX+"-label-x"),this._closeCrossHeight))},xScale:function(t){return this._xScale?this._xScale(t):t*this.context.width},yScale:function(t){return this._yScale?this._yScale(t):t*this.context.height},selectDataPoints:function(){var t=this,e=this.KEY,n=this.options.CSS_PREFIX;this.entityLabels=this.labelsContainer.selectAll("."+n+"-entity").data(t.model.marker.select,function(t){return t[e]}),this.entityLines=this.linesContainer.selectAll("g.entity-line."+n+"-entity").data(t.model.marker.select,function(t){return t[e]}),this.entityLabels.exit().each(function(n){null!=t.cached[n[e]]&&(t.cached[n[e]]=void 0)}).remove(),this.entityLines.exit().remove(),this.entityLines=this.entityLines.enter().insert("g",function(n){return this.querySelector("."+t.options.LINES_CONTAINER_SELECTOR_PREFIX+(0,c.default)(n[e]))}).attr("class",function(t,i){return n+"-entity entity-line line-"+t[e]}).each(function(e,n){t.label.line(d3.select(this))}).merge(this.entityLines),this.entityLabels=this.entityLabels.enter().append("g").attr("class",function(t,i){return n+"-entity label-"+t[e]}).each(function(n,i){t.cached[n[e]]={_new:!0},t.label(d3.select(this))}).merge(this.entityLabels)},showCloseCross:function(t,e){var n=this.KEY;this.entityLabels.filter(function(e){return!t||e[n]==t[n]}).select("."+this.options.CSS_PREFIX+"-label-x").classed("vzb-transparent",!e)},highlight:function(t,e){var n=this.KEY,i=this.entityLabels;t&&(i=i.filter(function(e){return!t||e[n]==t[n]})),i.classed("vzb-highlighted",e)},updateLabel:function(t,e,n,i,r,s,o,l,c,u,h){var d=this,f=this.KEY;if(t[f]!=d.druging){var p=this.options.CSS_PREFIX;if(d.model.marker.isSelected(t)&&null!=d.entityLabels){null==d.cached[t[f]]&&this.selectDataPoints();var v=d.cached[t[f]];if(n&&a.extend(v,n),null!=v.scaledS0&&null!=v.labelX0&&null!=v.labelY0||this._initNewCache(v,i,r,s,o,c),null==v.labelX_||null==v.labelY_){var g=a.find(d.model.marker.select,function(e){return e[f]==t[f]});v.labelOffset=g.labelOffset||[0,0]}var m=!v.labelX0&&0!==v.labelX0||!v.labelY0&&0!==v.labelY0||!v.scaledS0&&0!==v.scaledS0,b=d.entityLines.filter(function(e){return e[f]==t[f]});d.entityLabels.filter(function(e){return e[f]==t[f]}).each(function(n){var i=d3.select(this);if(m)return i.classed("vzb-invisible",m),void b.classed("vzb-invisible",m);var r=i.selectAll("."+p+"-label-content").text(l);d._updateLabelSize(t,e,null,i,c,r),d.positionLabel(t,e,null,this,u,h,b)})}}},_initNewCache:function(t,e,n,i,r,s){(i||0===i)&&(t.scaledS0=a.areaToRadius(this.context.sScale(i))),t.labelX0=e,t.labelY0=n,t.valueLST=s,t.scaledC0=null!=r?this.context.cScale(r):this.context.COLOR_WHITEISH},_initLabelTooltip:function(){this.tooltipEl=this.labelsContainer.append("g").attr("class",this.options.CSS_PREFIX+"-tooltip")},setTooltip:function(t,e,n,i){if(e){var r=0,a=this.options.CSS_PREFIX;if(this.tooltipEl.raise().text(null),this.label(this.tooltipEl,!0),t){var s={};this._initNewCache(s,i.valueX,i.valueY,i.valueS,i.valueC,i.valueLST),this.tooltipEl.classed(this.options.CSS_PREFIX+"-tooltip",!1).classed(this.options.CSS_PREFIX+"-entity",!0).selectAll("."+a+"-label-content").text(i.labelText),this._updateLabelSize(t,null,s,this.tooltipEl,i.valueLST),r=this.positionLabel(t,null,s,this.tooltipEl.node(),0,null,this.tooltipEl.select(".lineemptygroup"))}this.tooltipEl.classed(this.options.CSS_PREFIX+"-entity",!1).classed(this.options.CSS_PREFIX+"-tooltip",!0).selectAll("."+a+"-label-content").text(e),this._updateLabelSize(t,null,n,this.tooltipEl,null),this.positionLabel(t,null,n,this.tooltipEl.node(),0,null,this.tooltipEl.select(".lineemptygroup"),r)}else this.tooltipEl.text(null)},setTooltipFontSize:function(t){this.tooltipEl.style("font-size",t)},_updateLabelSize:function(t,e,n,i,r,a){var s=this,o=this.KEY,l=n||s.cached[t[o]],c=this.options.CSS_PREFIX,u=s.model.ui.chart.labels||{};i.classed("vzb-label-boxremoved",u.removeLabelBox);var h=a||i.selectAll("."+c+"-label-content");if(s.labelSizeTextScale)if(null!=r){var d=s.labelSizeTextScale.range(),f=d[0]+Math.sqrt((s.labelSizeTextScale(r)-d[0])*(d[1]-d[0]));h.attr("font-size",f+"px")}else h.attr("font-size","");var p=h.node().getBBox(),v=i.selectAll("rect");if(!l.textWidth||l.textWidth!=p.width){l.textWidth=p.width;var g=s._closeCrossHeight||p.height,m=s.model.locale.isRTL(),b=i.select("."+c+"-label-x").attr("transform","translate("+(m?-p.width-4:4)+","+.85*-p.height+")");this.updateLabelCloseGroupSize(b,g),v.attr("width",p.width+8).attr("height",1.2*p.height).attr("x",-p.width-4).attr("y",.85*-p.height).attr("rx",.2*p.height).attr("ry",.2*p.height),l.rectBBox=v.node().getBBox(),l.rectOffsetX=l.rectBBox.width+l.rectBBox.x,l.rectOffsetY=l.rectBBox.height+l.rectBBox.y}var _=i.select(".vzb-label-glow");_.attr("stroke")!==l.scaledC0&&_.attr("stroke",l.scaledC0)},updateLabelCloseGroupSize:function(t,e){t.select("circle").attr("cx",0).attr("cy",0).attr("r",.5*e),t.select("svg").attr("x",.5*-e).attr("y",-.5*e).attr("width",e).attr("height",e)},updateLabelsOnlyTextSize:function(){var t=this,e=this.KEY;this.entityLabels.each(function(n,i){t.cached[n[e]];t._updateLabelSize(n,i,null,d3.select(this),t.context.frame.size_label[n[e]]);var r=t.entityLines.filter(function(t){return t[e]==n[e]});t.positionLabel(n,i,null,this,0,null,r)})},updateLabelOnlyPosition:function(t,e,n){var i=this,r=this.KEY,s=this.cached[t[r]];n&&a.extend(s,n);var o=i.entityLines.filter(function(e){return e[r]==t[r]});this.entityLabels.filter(function(e){return e[r]==t[r]}).each(function(n){i.positionLabel(t,e,null,this,0,null,o)})},updateLabelOnlyColor:function(t,e,n){var i=this,r=this.KEY,s=this.cached[t[r]];n&&a.extend(s,n);var o=i.entityLabels.filter(function(e){return e[r]==t[r]});i._updateLabelSize(t,e,null,o,null)},positionLabel:function(t,e,n,i,r,s,o,l){var c=this.KEY,u=n||this.cached[t[c]],h=l||0===l,d=1&(l||0),f=(2&(l||0))>>1,p=0,v=0,g=this.context.width,m=this.context.height,b=this.xScale(u.labelX0),_=this.yScale(u.labelY0),y=u.rectOffsetX,M=u.rectOffsetY;u.labelOffset||(u.labelOffset=[0,0]),u.labelX_=u.labelOffset[0]||(.75*-u.scaledS0-y)/g,u.labelY_=u.labelOffset[1]||(.75*-u.scaledS0-M)/m;var w=b+u.labelX_*g,x=_+u.labelY_*m;if(u.labelOffset[0]+u.labelOffset[1]==0&&((!h&&x-u.rectBBox.height+M<=0||f)&&(v=1,u.labelY_=(.75*u.scaledS0+u.rectBBox.height-M)/m,x=_+u.labelY_*m),(!h&&w-u.rectBBox.width+y<=0||d)&&(p=1,u.labelX_=(.75*u.scaledS0+u.rectBBox.width-y)/g,(w=b+u.labelX_*g)>g&&(p=0,v=0==v&&_-.5*M-u.scaledS0<u.rectBBox.height?1:v,u.labelY_=v?.5*-M+u.rectBBox.height+u.scaledS0:1.5*-M-u.scaledS0,u.labelY_/=m,x=_+u.labelY_*m,u.labelX_=(u.rectBBox.width-y-b)/g,w=b+u.labelX_*g))),h){var S=!1;if(w-u.rectBBox.width+y<=0){var z=b-u.rectBBox.width,O=z>0?a.cathetus(u.scaledS0,z):u.scaledS0;x=v?_+u.rectBBox.height-.5*M+O:_-1.5*M-O,x-u.rectBBox.height<0&&(S=!0)}if(x-u.rectBBox.height+M<=0){var E=_-u.rectBBox.height,k=E>0?a.cathetus(u.scaledS0,E):u.scaledS0;w=p?b+u.rectBBox.width+k:b-2*y-k,(w-u.rectBBox.width<0||w>g)&&(S=!0)}if(S){v++;var T=b-u.rectBBox.width;x=_+u.rectBBox.height-.5*M+(T>0?a.cathetus(u.scaledS0,T):u.scaledS0)}}return this.label._repositionLabels(t,e,n,i,w,x,b,_,r,s,o),2*v+p},updateSize:function(){var t={small:{minLabelTextSize:7,maxLabelTextSize:21,defaultLabelTextSize:12,labelLeashCoeff:.4},medium:{minLabelTextSize:7,maxLabelTextSize:30,defaultLabelTextSize:15,labelLeashCoeff:.3},large:{minLabelTextSize:6,maxLabelTextSize:48,defaultLabelTextSize:20,labelLeashCoeff:.2}},e={medium:{minLabelTextSize:15,maxLabelTextSize:35,defaultLabelTextSize:15,labelLeashCoeff:.3},large:{minLabelTextSize:20,maxLabelTextSize:55,defaultLabelTextSize:20,labelLeashCoeff:.2}};this.activeProfile=this.context.getActiveProfile(t,e),this.updateLabelSizeLimits()}});e.default=f},function(t,e,n){(function(e){!function(e,n){t.exports=n(e)}(void 0!==e?e:this,function(t){if(t.CSS&&t.CSS.escape)return t.CSS.escape;var e=function(t){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var e,n=String(t),i=n.length,r=-1,a="",s=n.charCodeAt(0);++r<i;)e=n.charCodeAt(r),a+=0!=e?e>=1&&e<=31||127==e||0==r&&e>=48&&e<=57||1==r&&e>=48&&e<=57&&45==s?"\\"+e.toString(16)+" ":(0!=r||1!=i||45!=e)&&(e>=128||45==e||95==e||e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122)?n.charAt(r):"\\"+n.charAt(r):"";return a};return t.CSS||(t.CSS={}),t.CSS.escape=e,e})}).call(e,n(77))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(31),r=function(t){return t&&t.__esModule?t:{default:t}}(i),a="",s=[];e.default=r.default.extend({init:function(t){this.context=t,this.shapes=[],this.groups=[],this.counter=0,this.name="",this.label=""},reset:function(){this.container.remove(),this.context.element.selectAll(".vzb-export-redball").remove(),this.context.element.selectAll(".vzb-export-counter").remove(),this.counter=0},prefix:function(t){return arguments.length?(a=t,this):a},deleteClasses:function(t){return arguments.length?(s=t,this):s},open:function(t,e){var n=this;this.svg&&this.reset(),t||(t=this.context.element),e||(e=this.context.name),this.name=e;var i=parseInt(t.style("width"),10)||0,r=parseInt(t.style("height"),10)||0;this.container=t.append("div").attr("class","vzb-svg-export"),this.svg=this.container.node().appendChild(t.select("svg").node().cloneNode(!0)),this.svg=d3.select(this.svg),this.svg.attr("viewBox","0 0 "+i+" "+r).attr("version","1.1").attr("param1","http://www.w3.org/2000/svg").attr("param2","http://www.w3.org/1999/xlink").attr("x","0px").attr("y","0px").attr("style","enable-background:new 0 0 "+i+" "+r).attr("xml:space","preserve"),this.redBall=t.append("div").attr("class","vzb-export-redball").style("position","absolute").style("top","20px").style("right","20px").style("width","20px").style("height","20px").style("background","red").style("color","white").style("text-align","center").style("border-radius","10px").style("font-size","14px").style("line-height","20px").style("opacity",.8).style("cursor","pointer").on("mouseover",function(){d3.select(this).style("opacity",1).text(""),n.counterEl.text("Download")}).on("mouseout",function(){d3.select(this).style("opacity",.8).text(""),n.counterEl.text(n.label)}).on("click",function(){n.close()}),this.counterEl=t.append("div").attr("class","vzb-export-counter").style("position","absolute").style("top","20px").style("right","45px").style("color","red").style("opacity",.8).style("line-height","20px").style("font-size","14px").style("text-align","center"),this.root=this.svg.select("."+a+"graph"),this.root.selectAll("g, text, svg, line, rect").filter(function(){var t=d3.select(this),e=!1;return s.forEach(function(n){e=e||t.classed(n)}),e}).remove(),this.svg.selectAll(".tick line").attr("fill","none").attr("stroke","#999"),this.svg.selectAll("."+a+"axis-x path").attr("fill","none").attr("stroke","#999"),this.svg.selectAll("."+a+"axis-y path").attr("fill","none").attr("stroke","#999")},write:function(t){if(this.root||this.open(),!(this.shapes.indexOf(t.id+"_"+t.time)>-1)){this.shapes.push(t.id+"_"+t.time),-1==this.groups.indexOf(t.time)&&(this.root.append("g").attr("id","g_"+t.time),this.groups.push(t.time)),null==t.opacity&&(t.opacity=.5),null==t.fill&&(t.fill="#ff80dd");var e=this.root.select("#g_"+t.time).append(t.type).attr("id",t.id+"_"+t.time).style("fill",t.fill).style("opacity",t.opacity);switch(t.type){case"path":e.attr("d",t.d);break;case"circle":e.attr("cx",t.cx).attr("cy",t.cy).attr("r",t.r)}this.counter++,this.redBall.style("opacity",this.counter%10/12+.2),this.label=t.type+" shapes: "+this.counter,this.counterEl.text(this.label)}},close:function(){var t='<?xml version="1.0" encoding="utf-8"?> '+this.container.node().innerHTML.replace("param1","xmlns").replace("param2","xmlns:xlink").replace(/\d+(\.\d+)/g,function(t){return Math.round(100*+t)/100+""});if(t.length/1024/1024>2)alert("The file size is "+Math.round(t.length/1024)+"kB, which is too large to download. Will try to print it in the console instead..."),console.log(t);else{var e=document.createElement("a");e.download=this.name+" "+this.counter+" shapes.svg",e.href="data:,"+t,e.click()}}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(31),r=function(t){return t&&t.__esModule?t:{default:t}}(i),a=r.default.extend({init:function(t){this.context=t,this.interact=this._createInteract()},setTooltip:function(t){this.tooltip=t},_createInteract:function(){var t=this;return{mouseOver:function(){var e=d3.event,n=d3.mouse(t.context.element.node());t._setTooltip(d3.select(e.target).attr("data-text"),n[0],n[1])},mouseOut:function(){t._setTooltip()},tap:function(){}}},_setTooltip:function(t,e,n){if(t){this.tooltip.classed("vzb-hidden",!1).selectAll("text").text(t);var i=this.tooltip.select("text").node().getBBox();e-i.width<0?e+=i.width+5:e-=5,n-i.height<0?n+=i.height:n-=11,this.tooltip.attr("transform","translate("+e+","+n+")"),this.tooltip.selectAll("rect").attr("width",i.width+8).attr("height",1.2*i.height).attr("x",-i.width-4).attr("y",.85*-i.height).attr("rx",.2*i.height).attr("ry",.2*i.height)}else this.tooltip.classed("vzb-hidden",!0)},clear:function(t){t.attr("data-text",null)},wrap:function(t,e){var n=d3.select(t),i=Math.abs,r=n.attr("data-text");r||(r=n.text(),n.attr("data-text",r)),n.text(r);for(var a=r,s=a.length,o=n.node().getComputedTextLength();e-o<=0&&""!==a;)a=o>=e?a.slice(0,-i(.5*s)):r.slice(0,i(.5*s)),n.text(a+""),o=n.node().getComputedTextLength(),s=a.length;a!==r?(""===a&&n.text(r[0]),n.on("mouseover.tooltip",this.interact.mouseOver).on("mouseout.tooltip",this.interact.mouseOut).style("pointer-events","all")):n.on("mouseover.tooltip",null).on("mouseout.tooltip",null).style("pointer-events",null)}});e.default=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){function t(t,e){function n(e){var n,i=t.arcs[e<0?~e:e],r=i[0];return t.transform?(n=[0,0],i.forEach(function(t){n[0]+=t[0],n[1]+=t[1]})):n=i[i.length-1],e<0?[n,r]:[r,n]}function i(t,e){for(var n in t){var i=t[n];delete e[i.start],delete i.start,delete i.end,i.forEach(function(t){r[t<0?~t:t]=1}),o.push(i)}}var r={},a={},s={},o=[],l=-1;return e.forEach(function(n,i){var r,a=t.arcs[n<0?~n:n];a.length<3&&!a[1][0]&&!a[1][1]&&(r=e[++l],e[l]=n,e[i]=r)}),e.forEach(function(t){var e,i,r=n(t),o=r[0],l=r[1];if(e=s[o])if(delete s[e.end],e.push(t),e.end=l,i=a[l]){delete a[i.start];var c=i===e?e:e.concat(i);a[c.start=e.start]=s[c.end=i.end]=c}else a[e.start]=s[e.end]=e;else if(e=a[l])if(delete a[e.start],e.unshift(t),e.start=o,i=s[o]){delete s[i.end];var u=i===e?e:i.concat(e);a[u.start=i.start]=s[u.end=e.end]=u}else a[e.start]=s[e.end]=e;else e=[t],a[e.start=o]=s[e.end=l]=e}),i(s,a),i(a,s),e.forEach(function(t){r[t<0?~t:t]||o.push([t])}),o}function e(e,n,i){function r(t){var e=t<0?~t:t;(u[e]||(u[e]=[])).push({i:t,g:c})}function a(t){t.forEach(r)}function s(t){t.forEach(a)}function o(t){"GeometryCollection"===t.type?t.geometries.forEach(o):t.type in h&&(c=t,h[t.type](t.arcs))}var l=[];if(arguments.length>1){var c,u=[],h={LineString:a,MultiLineString:s,Polygon:s,MultiPolygon:function(t){t.forEach(s)}};o(n),u.forEach(arguments.length<3?function(t){l.push(t[0].i)}:function(t){i(t[0].g,t[t.length-1].g)&&l.push(t[0].i)})}else for(var d=0,f=e.arcs.length;d<f;++d)l.push(d);return{type:"MultiLineString",arcs:t(e,l)}}function i(e,i){function r(t){t.forEach(function(e){e.forEach(function(e){(o[e=e<0?~e:e]||(o[e]=[])).push(t)})}),l.push(t)}function a(t){return h(s(e,{type:"Polygon",arcs:[t]}).coordinates[0])>0}var o={},l=[],c=[];return i.forEach(function(t){"Polygon"===t.type?r(t.arcs):"MultiPolygon"===t.type&&t.arcs.forEach(r)}),l.forEach(function(t){if(!t._){var e=[],n=[t];for(t._=1,c.push(e);t=n.pop();)e.push(t),t.forEach(function(t){t.forEach(function(t){o[t<0?~t:t].forEach(function(t){t._||(t._=1,n.push(t))})})})}}),l.forEach(function(t){delete t._}),{type:"MultiPolygon",arcs:c.map(function(i){var r=[];if(i.forEach(function(t){t.forEach(function(t){t.forEach(function(t){o[t<0?~t:t].length<2&&r.push(t)})})}),r=t(e,r),(n=r.length)>1)for(var s,l=a(i[0][0]),c=0;c<n;++c)if(l===a(r[c])){s=r[0],r[0]=r[c],r[c]=s;break}return r})}}function r(t,e){return"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map(function(e){return a(t,e)})}:a(t,e)}function a(t,e){var n={type:"Feature",id:e.id,properties:e.properties||{},geometry:s(t,e)};return null==e.id&&delete n.id,n}function s(t,e){function n(t,e){e.length&&e.pop();for(var n,i=u[t<0?~t:t],r=0,a=i.length;r<a;++r)e.push(n=i[r].slice()),c(n,r);t<0&&o(e,a)}function i(t){return t=t.slice(),c(t,0),t}function r(t){for(var e=[],i=0,r=t.length;i<r;++i)n(t[i],e);return e.length<2&&e.push(e[0].slice()),e}function a(t){for(var e=r(t);e.length<4;)e.push(e[0].slice());return e}function s(t){return t.map(a)}function l(t){var e=t.type;return"GeometryCollection"===e?{type:e,geometries:t.geometries.map(l)}:e in h?{type:e,coordinates:h[e](t)}:null}var c=v(t.transform),u=t.arcs,h={Point:function(t){return i(t.coordinates)},MultiPoint:function(t){return t.coordinates.map(i)},LineString:function(t){return r(t.arcs)},MultiLineString:function(t){return t.arcs.map(r)},Polygon:function(t){return s(t.arcs)},MultiPolygon:function(t){return t.arcs.map(s)}};return l(e)}function o(t,e){for(var n,i=t.length,r=i-e;r<--i;)n=t[r],t[r++]=t[i],t[i]=n}function l(t,e){for(var n=0,i=t.length;n<i;){var r=n+i>>>1;t[r]<e?n=r+1:i=r}return n}function c(t){function e(t,e){t.forEach(function(t){t<0&&(t=~t);var n=r[t];n?n.push(e):r[t]=[e]})}function n(t,n){t.forEach(function(t){e(t,n)})}function i(t,e){"GeometryCollection"===t.type?t.geometries.forEach(function(t){i(t,e)}):t.type in s&&s[t.type](t.arcs,e)}var r={},a=t.map(function(){return[]}),s={LineString:e,MultiLineString:n,Polygon:n,MultiPolygon:function(t,e){t.forEach(function(t){n(t,e)})}};t.forEach(i);for(var o in r)for(var c=r[o],u=c.length,h=0;h<u;++h)for(var d=h+1;d<u;++d){var f,p=c[h],v=c[d];(f=a[p])[o=l(f,v)]!==v&&f.splice(o,0,v),(f=a[v])[o=l(f,p)]!==p&&f.splice(o,0,p)}return a}function u(t,e){function n(t){a.remove(t),t[1][2]=e(t),a.push(t)}var i=v(t.transform),r=g(t.transform),a=p();return e||(e=d),t.arcs.forEach(function(t){for(var s,o,l=[],c=0,u=0,h=t.length;u<h;++u)o=t[u],i(t[u]=[o[0],o[1],1/0],u);for(var u=1,h=t.length-1;u<h;++u)s=t.slice(u-1,u+2),s[1][2]=e(s),l.push(s),a.push(s);for(var u=0,h=l.length;u<h;++u)s=l[u],s.previous=l[u-1],s.next=l[u+1];for(;s=a.pop();){var d=s.previous,f=s.next;s[1][2]<c?s[1][2]=c:c=s[1][2],d&&(d.next=f,d[2]=s[2],n(d)),f&&(f.previous=d,f[0]=s[0],n(f))}t.forEach(r)}),t}function h(t){for(var e,n=-1,i=t.length,r=t[i-1],a=0;++n<i;)e=r,r=t[n],a+=e[0]*r[1]-e[1]*r[0];return.5*a}function d(t){var e=t[0],n=t[1],i=t[2];return Math.abs((e[0]-i[0])*(n[1]-e[1])-(e[0]-n[0])*(i[1]-e[1]))}function f(t,e){return t[1][2]-e[1][2]}function p(){function t(t,e){for(;e>0;){var n=(e+1>>1)-1,r=i[n];if(f(t,r)>=0)break;i[r._=e]=r,i[t._=e=n]=t}}function e(t,e){for(;;){var n=e+1<<1,a=n-1,s=e,o=i[s];if(a<r&&f(i[a],o)<0&&(o=i[s=a]),n<r&&f(i[n],o)<0&&(o=i[s=n]),s===e)break;i[o._=e]=o,i[t._=e=s]=t}}var n={},i=[],r=0;return n.push=function(e){return t(i[e._=r]=e,r++),r},n.pop=function(){if(!(r<=0)){var t,n=i[0];return--r>0&&(t=i[r],e(i[t._=0]=t,0)),n}},n.remove=function(n){var a,s=n._;if(i[s]===n)return s!==--r&&(a=i[r],(f(a,n)<0?t:e)(i[a._=s]=a,s)),s},n}function v(t){if(!t)return m;var e,n,i=t.scale[0],r=t.scale[1],a=t.translate[0],s=t.translate[1];return function(t,o){o||(e=n=0),t[0]=(e+=t[0])*i+a,t[1]=(n+=t[1])*r+s}}function g(t){if(!t)return m;var e,n,i=t.scale[0],r=t.scale[1],a=t.translate[0],s=t.translate[1];return function(t,o){o||(e=n=0);var l=(t[0]-a)/i|0,c=(t[1]-s)/r|0;t[0]=l-e,t[1]=c-n,e=l,n=c}}function m(){}return{version:"1.6.19",mesh:function(t){return s(t,e.apply(this,arguments))},meshArcs:e,merge:function(t){return s(t,i.apply(this,arguments))},mergeArcs:i,feature:r,neighbors:c,presimplify:u}}()},function(t,e){}])});
//# sourceMappingURL=vizabi.min.js.map